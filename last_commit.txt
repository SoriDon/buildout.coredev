Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-06-22T10:42:35+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/94f95a29173807c71bafde5bd8f2b9783d36e2e6

Prepare for Python 3.8

Files changed:
M Products/CMFPlone/PloneControlPanel.py
M Products/CMFPlone/browser/admin.py
M Products/CMFPlone/controlpanel/browser/maintenance.py
M Products/CMFPlone/utils.py

b"diff --git a/Products/CMFPlone/PloneControlPanel.py b/Products/CMFPlone/PloneControlPanel.py\nindex 87131b9b9..b749d2d51 100644\n--- a/Products/CMFPlone/PloneControlPanel.py\n+++ b/Products/CMFPlone/PloneControlPanel.py\n@@ -182,10 +182,10 @@ def _extractAction(self, properties, index):\n         if not name:\n             raise ValueError('A name is required.')\n \n-        if action is not '':\n+        if action != '':\n             action = Expression(text=action)\n \n-        if condition is not '':\n+        if condition != '':\n             condition = Expression(text=condition)\n \n         if category == '':\ndiff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 826b094f0..7b1c1b502 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -57,7 +57,7 @@ def sites(self, root=None):\n         result = []\n         secman = getSecurityManager()\n         for obj in root.values():\n-            if obj.meta_type is 'Folder':\n+            if obj.meta_type == 'Folder':\n                 result = result + self.sites(obj)\n             elif IPloneSiteRoot.providedBy(obj):\n                 if secman.checkPermission(View, obj):\ndiff --git a/Products/CMFPlone/controlpanel/browser/maintenance.py b/Products/CMFPlone/controlpanel/browser/maintenance.py\nindex 2a777a163..275c735e1 100644\n--- a/Products/CMFPlone/controlpanel/browser/maintenance.py\n+++ b/Products/CMFPlone/controlpanel/browser/maintenance.py\n@@ -3,7 +3,6 @@\n from AccessControl.Permissions import view_management_screens\n from Acquisition import aq_inner\n from App.config import getConfiguration\n-from cgi import escape\n from plone.autoform.form import AutoExtensibleForm\n from plone.memoize.view import memoize\n from plone.protect import CheckAuthenticator\n@@ -25,6 +24,11 @@\n except ImportError:\n     LIFETIME = False\n \n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n+\n \n logger = logging.getLogger(__file__)\n \ndiff --git a/Products/CMFPlone/utils.py b/Products/CMFPlone/utils.py\nindex 73f7578ee..930aa3df6 100644\n--- a/Products/CMFPlone/utils.py\n+++ b/Products/CMFPlone/utils.py\n@@ -12,7 +12,6 @@\n from App.Common import package_home\n from App.Dialogs import MessageDialog\n from App.ImageFile import ImageFile\n-from cgi import escape\n from DateTime import DateTime\n from DateTime.interfaces import DateTimeError\n from OFS.CopySupport import CopyError\n@@ -57,6 +56,10 @@\n import warnings\n import zope.interface\n \n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n \n try:\n     from types import ClassType\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-06-22T10:42:35+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/494ace97bd063a2a2d7141d7260f44a0e60f444f

add changenote

Files changed:
A news/2896.feature

b'diff --git a/news/2896.feature b/news/2896.feature\nnew file mode 100644\nindex 000000000..c0eea9eb8\n--- /dev/null\n+++ b/news/2896.feature\n@@ -0,0 +1 @@\n+Add support for Python 3.8 [pbauer]\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-06-22T10:43:17+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/766e357806e670673693817531aaa25215308e7d

Merge pull request #2896 from plone/python38

Prepare for Python 3.8

Files changed:
A news/2896.feature
M Products/CMFPlone/PloneControlPanel.py
M Products/CMFPlone/browser/admin.py
M Products/CMFPlone/controlpanel/browser/maintenance.py
M Products/CMFPlone/utils.py

b"diff --git a/Products/CMFPlone/PloneControlPanel.py b/Products/CMFPlone/PloneControlPanel.py\nindex 87131b9b9..b749d2d51 100644\n--- a/Products/CMFPlone/PloneControlPanel.py\n+++ b/Products/CMFPlone/PloneControlPanel.py\n@@ -182,10 +182,10 @@ def _extractAction(self, properties, index):\n         if not name:\n             raise ValueError('A name is required.')\n \n-        if action is not '':\n+        if action != '':\n             action = Expression(text=action)\n \n-        if condition is not '':\n+        if condition != '':\n             condition = Expression(text=condition)\n \n         if category == '':\ndiff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 826b094f0..7b1c1b502 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -57,7 +57,7 @@ def sites(self, root=None):\n         result = []\n         secman = getSecurityManager()\n         for obj in root.values():\n-            if obj.meta_type is 'Folder':\n+            if obj.meta_type == 'Folder':\n                 result = result + self.sites(obj)\n             elif IPloneSiteRoot.providedBy(obj):\n                 if secman.checkPermission(View, obj):\ndiff --git a/Products/CMFPlone/controlpanel/browser/maintenance.py b/Products/CMFPlone/controlpanel/browser/maintenance.py\nindex 2a777a163..275c735e1 100644\n--- a/Products/CMFPlone/controlpanel/browser/maintenance.py\n+++ b/Products/CMFPlone/controlpanel/browser/maintenance.py\n@@ -3,7 +3,6 @@\n from AccessControl.Permissions import view_management_screens\n from Acquisition import aq_inner\n from App.config import getConfiguration\n-from cgi import escape\n from plone.autoform.form import AutoExtensibleForm\n from plone.memoize.view import memoize\n from plone.protect import CheckAuthenticator\n@@ -25,6 +24,11 @@\n except ImportError:\n     LIFETIME = False\n \n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n+\n \n logger = logging.getLogger(__file__)\n \ndiff --git a/Products/CMFPlone/utils.py b/Products/CMFPlone/utils.py\nindex 73f7578ee..930aa3df6 100644\n--- a/Products/CMFPlone/utils.py\n+++ b/Products/CMFPlone/utils.py\n@@ -12,7 +12,6 @@\n from App.Common import package_home\n from App.Dialogs import MessageDialog\n from App.ImageFile import ImageFile\n-from cgi import escape\n from DateTime import DateTime\n from DateTime.interfaces import DateTimeError\n from OFS.CopySupport import CopyError\n@@ -57,6 +56,10 @@\n import warnings\n import zope.interface\n \n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n \n try:\n     from types import ClassType\ndiff --git a/news/2896.feature b/news/2896.feature\nnew file mode 100644\nindex 000000000..c0eea9eb8\n--- /dev/null\n+++ b/news/2896.feature\n@@ -0,0 +1 @@\n+Add support for Python 3.8 [pbauer]\n\\ No newline at end of file\n"

