Repository: plone.z3cform


Branch: refs/heads/master
Date: 2022-06-08T09:52:36+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.z3cform/commit/9802317ad5c1eefafe89b6c21cb9d16d999469cb

Fix traversal to z3c.form.widget.MultiWidget widgets since z3c.form &gt;= 4.x

This is especially needed for collective.z3cform.datagridfield

Files changed:
M src/plone/z3cform/traversal.py

b'diff --git a/src/plone/z3cform/traversal.py b/src/plone/z3cform/traversal.py\nindex 305740e..e9b2adb 100644\n--- a/src/plone/z3cform/traversal.py\n+++ b/src/plone/z3cform/traversal.py\n@@ -82,6 +82,9 @@ def traverse(self, name, ignored):\n                                 if w.name == full_name]\n                     if len(filtered) == 1:\n                         target = filtered[0]\n+                        # we have to pop "widgets" from parts here\n+                        # this is since z3c.form.widget.MultiWidget >= 4.x\n+                        parts.remove("widgets")\n                     else:\n                         raise TraversalError("\'" + part + "\' not valid index")\n             elif hasattr(target, \'widgets\'):  # Either base form, or subform\n'

Repository: plone.z3cform


Branch: refs/heads/master
Date: 2022-06-08T09:57:32+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.z3cform/commit/081e839f0b9c030878774dd8bf518cd680f6065d

changelog

Files changed:
A news/22.bugfix

b'diff --git a/news/22.bugfix b/news/22.bugfix\nnew file mode 100644\nindex 0000000..9b76f0e\n--- /dev/null\n+++ b/news/22.bugfix\n@@ -0,0 +1,2 @@\n+Fix traversal to `z3c.form.widget.MultiWidget` widgets.\n+[petschki]\n'

Repository: plone.z3cform


Branch: refs/heads/master
Date: 2022-06-10T10:09:04+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.z3cform/commit/28401b170ba3d255fca2478bca4ff716130f7583

Merge pull request #22 from plone/petschki-widget-traversal

Fix ++widget++ traversal to `z3c.form.widget.MultiWidget`

Files changed:
A news/22.bugfix
M src/plone/z3cform/traversal.py

b'diff --git a/news/22.bugfix b/news/22.bugfix\nnew file mode 100644\nindex 0000000..9b76f0e\n--- /dev/null\n+++ b/news/22.bugfix\n@@ -0,0 +1,2 @@\n+Fix traversal to `z3c.form.widget.MultiWidget` widgets.\n+[petschki]\ndiff --git a/src/plone/z3cform/traversal.py b/src/plone/z3cform/traversal.py\nindex 305740e..e9b2adb 100644\n--- a/src/plone/z3cform/traversal.py\n+++ b/src/plone/z3cform/traversal.py\n@@ -82,6 +82,9 @@ def traverse(self, name, ignored):\n                                 if w.name == full_name]\n                     if len(filtered) == 1:\n                         target = filtered[0]\n+                        # we have to pop "widgets" from parts here\n+                        # this is since z3c.form.widget.MultiWidget >= 4.x\n+                        parts.remove("widgets")\n                     else:\n                         raise TraversalError("\'" + part + "\' not valid index")\n             elif hasattr(target, \'widgets\'):  # Either base form, or subform\n'

