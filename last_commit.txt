Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2018-03-12T12:58:14-04:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.app.portlets/commit/1c6f33c16b3ffbdcc43c30e5dedd967fc37141bf

bump version since a 4.3.x branch was created

Files changed:
M CHANGES.rst
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b4befba..6f8996d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -2,7 +2,7 @@ Changelog
 =========
 
 
-4.3.2 (unreleased)
+4.4.0 (unreleased)
 ------------------
 
 Breaking changes:
@@ -17,6 +17,7 @@ Bug fixes:
 
 - Imports are Python3 compatible
   [ale-rt]
+
 - base.Renderer no longer mixes in Acquisition.Explicit,
   so attributes of the renderer will no longer be wrapped.
   [davisagli]
diff --git a/setup.py b/setup.py
index aacab0a..89ff3e9 100644
--- a/setup.py
+++ b/setup.py
@@ -3,7 +3,7 @@
 from setuptools import setup
 
 
-version = '4.3.2.dev0'
+version = '4.4.0.dev0'
 
 setup(
     name='plone.app.portlets',


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2018-03-12T12:58:42-04:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.app.portlets/commit/bdafe8116927a6cb8662aaa7e63b6f1d0b2d69ee

also catch NotFound while traversing portlet add views

Files changed:
M CHANGES.rst
M plone/app/portlets/browser/editmanager.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 6f8996d..098edfb 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,6 +22,12 @@ Bug fixes:
   so attributes of the renderer will no longer be wrapped.
   [davisagli]
 
+- Catch NotFound while trying to traverse to portlet add views
+  to check permission.
+  [davisagli]
+
+- *add item here*
+
 
 4.3.1 (2017-08-07)
 ------------------
diff --git a/plone/app/portlets/browser/editmanager.py b/plone/app/portlets/browser/editmanager.py
index 20a779b..92f0d72 100644
--- a/plone/app/portlets/browser/editmanager.py
+++ b/plone/app/portlets/browser/editmanager.py
@@ -24,6 +24,7 @@
 from Acquisition.interfaces import IAcquirer
 
 from AccessControl import Unauthorized
+from zExceptions import NotFound
 
 from Products.Five.browser import BrowserView
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
@@ -38,6 +39,7 @@
 
 from plone.portlets.interfaces import IPortletAssignmentSettings
 
+
 @implementer(IPortletManagerRenderer)
 class EditPortletManagerRenderer(Explicit):
     """Render a portlet manager in edit mode.
@@ -162,7 +164,7 @@ def check_permission(p):
                 addview = addview[1:]
             try:
                 self.context.restrictedTraverse(str(addview))
-            except (AttributeError, KeyError, Unauthorized,):
+            except (AttributeError, KeyError, Unauthorized, NotFound):
                 return False
             return True
 


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2018-03-12T14:34:44-04:00
Author: David Glick (davisagli) <david.glick@plone.org>
Commit: https://github.com/plone/plone.app.portlets/commit/713e27e7dc5a05c96c03b9d7692531d997d92ac4

Merge pull request #109 from plone/davisagli-traversal-master

Also catch NotFound while traversing portlet add views

Files changed:
M CHANGES.rst
M plone/app/portlets/browser/editmanager.py
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b4befba..098edfb 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -2,7 +2,7 @@ Changelog
 =========
 
 
-4.3.2 (unreleased)
+4.4.0 (unreleased)
 ------------------
 
 Breaking changes:
@@ -17,10 +17,17 @@ Bug fixes:
 
 - Imports are Python3 compatible
   [ale-rt]
+
 - base.Renderer no longer mixes in Acquisition.Explicit,
   so attributes of the renderer will no longer be wrapped.
   [davisagli]
 
+- Catch NotFound while trying to traverse to portlet add views
+  to check permission.
+  [davisagli]
+
+- *add item here*
+
 
 4.3.1 (2017-08-07)
 ------------------
diff --git a/plone/app/portlets/browser/editmanager.py b/plone/app/portlets/browser/editmanager.py
index 20a779b..92f0d72 100644
--- a/plone/app/portlets/browser/editmanager.py
+++ b/plone/app/portlets/browser/editmanager.py
@@ -24,6 +24,7 @@
 from Acquisition.interfaces import IAcquirer
 
 from AccessControl import Unauthorized
+from zExceptions import NotFound
 
 from Products.Five.browser import BrowserView
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
@@ -38,6 +39,7 @@
 
 from plone.portlets.interfaces import IPortletAssignmentSettings
 
+
 @implementer(IPortletManagerRenderer)
 class EditPortletManagerRenderer(Explicit):
     """Render a portlet manager in edit mode.
@@ -162,7 +164,7 @@ def check_permission(p):
                 addview = addview[1:]
             try:
                 self.context.restrictedTraverse(str(addview))
-            except (AttributeError, KeyError, Unauthorized,):
+            except (AttributeError, KeyError, Unauthorized, NotFound):
                 return False
             return True
 
diff --git a/setup.py b/setup.py
index aacab0a..89ff3e9 100644
--- a/setup.py
+++ b/setup.py
@@ -3,7 +3,7 @@
 from setuptools import setup
 
 
-version = '4.3.2.dev0'
+version = '4.4.0.dev0'
 
 setup(
     name='plone.app.portlets',


