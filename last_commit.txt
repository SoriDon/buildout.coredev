Repository: plone.app.theming


Branch: refs/heads/master
Date: 2019-02-14T12:10:37+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.theming/commit/79fdda4fd77a48d4a263dacbbd89760ab0170b8f

fix skinname-encoding in py3 (fixes https://github.com/plone/Products.CMFPlone/issues/2748)

Files changed:
M src/plone/app/theming/browser/controlpanel.py

b"diff --git a/src/plone/app/theming/browser/controlpanel.py b/src/plone/app/theming/browser/controlpanel.py\nindex 051c752..b792bf9 100644\n--- a/src/plone/app/theming/browser/controlpanel.py\n+++ b/src/plone/app/theming/browser/controlpanel.py\n@@ -29,6 +29,7 @@\n from zope.schema.interfaces import IVocabularyFactory\n \n import logging\n+import six\n import zipfile\n \n \n@@ -203,7 +204,9 @@ def update(self):\n \n                 # Theme base settings\n                 if themeBase is not None:\n-                    self.pskin.default_skin = themeBase.encode('utf-8')\n+                    if six.PY2:\n+                        themeBase = themeBase.encode('utf-8')\n+                    self.pskin.default_skin = themeBase\n                 if markSpecialLinks is not None:\n                     self.mark_special_links = markSpecialLinks\n                 if extLinksOpenInNewWindow is not None:\n"

