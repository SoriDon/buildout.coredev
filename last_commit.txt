Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-04-17T12:07:11-05:00
Author: Jens Vagelpohl (dataflake) <jens@dataflake.org>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/139c97d54af24965482be9ccab3c67b9de701578

Fix WSGI access log formatting configuration

Files changed:
A news/88.bugfix
M src/plone/recipe/zope2instance/recipe.py
M src/plone/recipe/zope2instance/tests/wsgi.txt

b'diff --git a/news/88.bugfix b/news/88.bugfix\nnew file mode 100644\nindex 0000000..b068bfe\n--- /dev/null\n+++ b/news/88.bugfix\n@@ -0,0 +1 @@\n+Fix WSGI access log formatting configuration\ndiff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex 5e3bd3c..1d8f8fb 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -1254,7 +1254,7 @@ def render_file_storage(self, file_storage, blob_storage,\n keys = console, accesslog, eventlog\n \n [formatters]\n-keys = generic\n+keys = generic, message\n \n [logger_root]\n level = %(eventlog_level)s\n@@ -1286,7 +1286,7 @@ class = StreamHandler\n class = FileHandler\n args = (\'%(accesslog_name)s\',\'a\')\n level = %(accesslog_level)s\n-formatter = generic\n+formatter = message\n \n [handler_eventlog]\n class = FileHandler\n@@ -1296,4 +1296,7 @@ class = FileHandler\n \n [formatter_generic]\n format = %%(asctime)s %%(levelname)-7.7s [%%(name)s:%%(lineno)s][%%(threadName)s] %%(message)s\n+\n+[formatter_message]\n+format = %%(message)s\n """  # noqa: E501\ndiff --git a/src/plone/recipe/zope2instance/tests/wsgi.txt b/src/plone/recipe/zope2instance/tests/wsgi.txt\nindex 5fff07f..e14eb10 100644\n--- a/src/plone/recipe/zope2instance/tests/wsgi.txt\n+++ b/src/plone/recipe/zope2instance/tests/wsgi.txt\n@@ -101,7 +101,7 @@ The buildout has also created an INI file containing the waitress configuration:\n     keys = console, accesslog, eventlog\n     <BLANKLINE>\n     [formatters]\n-    keys = generic\n+    keys = generic, message\n     <BLANKLINE>\n     [logger_root]\n     level = INFO\n@@ -133,7 +133,7 @@ The buildout has also created an INI file containing the waitress configuration:\n     class = FileHandler\n     args = (\'.../sample-buildout/var/log/instance-access.log\',\'a\')\n     level = INFO\n-    formatter = generic\n+    formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n@@ -143,6 +143,9 @@ The buildout has also created an INI file containing the waitress configuration:\n     <BLANKLINE>\n     [formatter_generic]\n     format = %(asctime)s %(levelname)-7.7s [%(name)s:%(lineno)s][%(threadName)s] %(message)s\n+    <BLANKLINE>\n+    [formatter_message]\n+    format = %(message)s\n \n Custom WSGI options\n ==================\n@@ -249,7 +252,7 @@ The buildout has updated our INI file:\n     class = FileHandler\n     args = (\'var/log/foo.log\',\'a\')\n     level = DEBUG\n-    formatter = generic\n+    formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n'

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-04-17T20:29:01-05:00
Author: Jens Vagelpohl (dataflake) <jens@netz.ooo>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/d8481c0b2ad95eebcf5d8c2f869e6628244010b4

- make checks run again

Files changed:
M news/88.bugfix

b'diff --git a/news/88.bugfix b/news/88.bugfix\nindex b068bfe..e3ae0b8 100644\n--- a/news/88.bugfix\n+++ b/news/88.bugfix\n@@ -1 +1 @@\n-Fix WSGI access log formatting configuration\n+Fix WSGI access log formatting configuration \n'

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-04-18T07:54:59+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/18b6f65c8eb79b796eb0921304a5bee5b18d72d7

Merge pull request #89 from plone/issue_88

Fix WSGI access log formatting configuration

Files changed:
A news/88.bugfix
M src/plone/recipe/zope2instance/recipe.py
M src/plone/recipe/zope2instance/tests/wsgi.txt

b'diff --git a/news/88.bugfix b/news/88.bugfix\nnew file mode 100644\nindex 0000000..e3ae0b8\n--- /dev/null\n+++ b/news/88.bugfix\n@@ -0,0 +1 @@\n+Fix WSGI access log formatting configuration \ndiff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex 5e3bd3c..1d8f8fb 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -1254,7 +1254,7 @@ def render_file_storage(self, file_storage, blob_storage,\n keys = console, accesslog, eventlog\n \n [formatters]\n-keys = generic\n+keys = generic, message\n \n [logger_root]\n level = %(eventlog_level)s\n@@ -1286,7 +1286,7 @@ class = StreamHandler\n class = FileHandler\n args = (\'%(accesslog_name)s\',\'a\')\n level = %(accesslog_level)s\n-formatter = generic\n+formatter = message\n \n [handler_eventlog]\n class = FileHandler\n@@ -1296,4 +1296,7 @@ class = FileHandler\n \n [formatter_generic]\n format = %%(asctime)s %%(levelname)-7.7s [%%(name)s:%%(lineno)s][%%(threadName)s] %%(message)s\n+\n+[formatter_message]\n+format = %%(message)s\n """  # noqa: E501\ndiff --git a/src/plone/recipe/zope2instance/tests/wsgi.txt b/src/plone/recipe/zope2instance/tests/wsgi.txt\nindex 5fff07f..e14eb10 100644\n--- a/src/plone/recipe/zope2instance/tests/wsgi.txt\n+++ b/src/plone/recipe/zope2instance/tests/wsgi.txt\n@@ -101,7 +101,7 @@ The buildout has also created an INI file containing the waitress configuration:\n     keys = console, accesslog, eventlog\n     <BLANKLINE>\n     [formatters]\n-    keys = generic\n+    keys = generic, message\n     <BLANKLINE>\n     [logger_root]\n     level = INFO\n@@ -133,7 +133,7 @@ The buildout has also created an INI file containing the waitress configuration:\n     class = FileHandler\n     args = (\'.../sample-buildout/var/log/instance-access.log\',\'a\')\n     level = INFO\n-    formatter = generic\n+    formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n@@ -143,6 +143,9 @@ The buildout has also created an INI file containing the waitress configuration:\n     <BLANKLINE>\n     [formatter_generic]\n     format = %(asctime)s %(levelname)-7.7s [%(name)s:%(lineno)s][%(threadName)s] %(message)s\n+    <BLANKLINE>\n+    [formatter_message]\n+    format = %(message)s\n \n Custom WSGI options\n ==================\n@@ -249,7 +252,7 @@ The buildout has updated our INI file:\n     class = FileHandler\n     args = (\'var/log/foo.log\',\'a\')\n     level = DEBUG\n-    formatter = generic\n+    formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n'

