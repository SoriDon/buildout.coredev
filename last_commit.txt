Repository: plone.autoform


Branch: refs/heads/master
Date: 2017-02-22T17:04:49+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.autoform/commit/e669ef33b4084d93e3b027dcbc7cf66cbbbdf021

Make of tracebacks of plone.autoform.widgets.ParameterizedWidget calls more verbose in order to ease debugging

Files changed:
M CHANGES.rst
M plone/autoform/widgets.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8d0e00f..ac52c01 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- Make of tracebacks of ``plone.autoform.widgets.ParameterizedWidget`` calls more verbose in order to ease debugging.
+  [jensens]
 
 Bug fixes:
 
diff --git a/plone/autoform/widgets.py b/plone/autoform/widgets.py
index 0ed195a..0661911 100644
--- a/plone/autoform/widgets.py
+++ b/plone/autoform/widgets.py
@@ -52,15 +52,29 @@ def __init__(self, widget_factory=None, **params):
         self.params = params
 
     def __call__(self, field, request):
+        __traceback_info__ = (
+            '{0}, processing:\n'
+            '- field "{1}"\n'
+            '- widget: {2}\n'
+            '- params: {3}\n'.format(
+                self.__class__.__name__,
+                field.__name__,
+                repr(self.widget_factory),
+                self.params
+            )
+        )
         if isinstance(self.widget_factory, basestring):
+            __traceback_info__ += '- resolve dotted name\n'
             self.widget_factory = resolveDottedName(self.widget_factory)
-
         if self.widget_factory is None:
             # use default widget factory for this field type
+            __traceback_info__ += '- use default widget factory\n'
             widget = getMultiAdapter((field, request), IFieldWidget)
         elif IWidget.implementedBy(self.widget_factory):
+            __traceback_info__ += '- call and wrap with FieldWidget\n'
             widget = FieldWidget(field, self.widget_factory(request))
         elif IFieldWidget.implementedBy(self.widget_factory):
+            __traceback_info__ += '- call factory\n'
             widget = self.widget_factory(field, request)
         for k, v in self.params.items():
             setattr(widget, k, v)


Repository: plone.autoform


Branch: refs/heads/master
Date: 2017-02-22T17:25:07+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.autoform/commit/61751d358ff16fc694ab092959d14227fb04f160

better wording, thanks @thet for the hint

Files changed:
M plone/autoform/widgets.py

diff --git a/plone/autoform/widgets.py b/plone/autoform/widgets.py
index 0661911..e06c1c2 100644
--- a/plone/autoform/widgets.py
+++ b/plone/autoform/widgets.py
@@ -64,17 +64,18 @@ def __call__(self, field, request):
             )
         )
         if isinstance(self.widget_factory, basestring):
-            __traceback_info__ += '- resolve dotted name\n'
+            __traceback_info__ += '- resolving dotted name\n'
             self.widget_factory = resolveDottedName(self.widget_factory)
         if self.widget_factory is None:
             # use default widget factory for this field type
-            __traceback_info__ += '- use default widget factory\n'
+            __traceback_info__ += '- using default widget factory\n'
             widget = getMultiAdapter((field, request), IFieldWidget)
         elif IWidget.implementedBy(self.widget_factory):
-            __traceback_info__ += '- call and wrap with FieldWidget\n'
+            __traceback_info__ += '- calling factory, then wrapping with ' \
+                                  'FieldWidget\n'
             widget = FieldWidget(field, self.widget_factory(request))
         elif IFieldWidget.implementedBy(self.widget_factory):
-            __traceback_info__ += '- call factory\n'
+            __traceback_info__ += '- calling factory\n'
             widget = self.widget_factory(field, request)
         for k, v in self.params.items():
             setattr(widget, k, v)


Repository: plone.autoform


Branch: refs/heads/master
Date: 2017-02-22T17:26:09+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.autoform/commit/1b24ddfa8cf6e68914772d5d1c5fe89653c7a7c3

Merge pull request #23 from plone/jensens-more-verbose-tracebacks

Verbose tracebacks of plone.autoform.widgets.ParameterizedWidget

Files changed:
M CHANGES.rst
M plone/autoform/widgets.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8d0e00f..ac52c01 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- Make of tracebacks of ``plone.autoform.widgets.ParameterizedWidget`` calls more verbose in order to ease debugging.
+  [jensens]
 
 Bug fixes:
 
diff --git a/plone/autoform/widgets.py b/plone/autoform/widgets.py
index 0ed195a..e06c1c2 100644
--- a/plone/autoform/widgets.py
+++ b/plone/autoform/widgets.py
@@ -52,15 +52,30 @@ def __init__(self, widget_factory=None, **params):
         self.params = params
 
     def __call__(self, field, request):
+        __traceback_info__ = (
+            '{0}, processing:\n'
+            '- field "{1}"\n'
+            '- widget: {2}\n'
+            '- params: {3}\n'.format(
+                self.__class__.__name__,
+                field.__name__,
+                repr(self.widget_factory),
+                self.params
+            )
+        )
         if isinstance(self.widget_factory, basestring):
+            __traceback_info__ += '- resolving dotted name\n'
             self.widget_factory = resolveDottedName(self.widget_factory)
-
         if self.widget_factory is None:
             # use default widget factory for this field type
+            __traceback_info__ += '- using default widget factory\n'
             widget = getMultiAdapter((field, request), IFieldWidget)
         elif IWidget.implementedBy(self.widget_factory):
+            __traceback_info__ += '- calling factory, then wrapping with ' \
+                                  'FieldWidget\n'
             widget = FieldWidget(field, self.widget_factory(request))
         elif IFieldWidget.implementedBy(self.widget_factory):
+            __traceback_info__ += '- calling factory\n'
             widget = self.widget_factory(field, request)
         for k, v in self.params.items():
             setattr(widget, k, v)


