Repository: plone.app.theming


Branch: refs/heads/master
Date: 2021-09-09T16:52:44+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.theming/commit/4f1fb0d44eb36a9a89d90c002d8b53df36be54fb

Fix unclosed file

fixes #199

Files changed:
A news/199.bugfix
M src/plone/app/theming/utils.py

b'diff --git a/news/199.bugfix b/news/199.bugfix\nnew file mode 100644\nindex 0000000..052c088\n--- /dev/null\n+++ b/news/199.bugfix\n@@ -0,0 +1,2 @@\n+Fix unclosed file when reading manifest.cfg\n+[petschki]\ndiff --git a/src/plone/app/theming/utils.py b/src/plone/app/theming/utils.py\nindex f3ca223..e494e24 100644\n--- a/src/plone/app/theming/utils.py\n+++ b/src/plone/app/theming/utils.py\n@@ -471,9 +471,8 @@ def getThemeFromResourceDirectory(resourceDirectory):\n     """\n     name = resourceDirectory.__name__\n     if resourceDirectory.isFile(MANIFEST_FILENAME):\n-        manifest = getManifest(\n-            resourceDirectory.openFile(MANIFEST_FILENAME), MANIFEST_FORMAT\n-        )\n+        with resourceDirectory.openFile(MANIFEST_FILENAME) as manifest_fp:\n+            manifest = getManifest(manifest_fp, MANIFEST_FORMAT)\n     else:\n         manifest = {}\n \n'

Repository: plone.app.theming


Branch: refs/heads/master
Date: 2021-09-09T18:04:36+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.theming/commit/28d43655caeef6e4c9e4e7c154bd5d98a567ae15

Merge pull request #200 from plone/issue-199

Fix unclosed file

Files changed:
A news/199.bugfix
M src/plone/app/theming/utils.py

b'diff --git a/news/199.bugfix b/news/199.bugfix\nnew file mode 100644\nindex 0000000..052c088\n--- /dev/null\n+++ b/news/199.bugfix\n@@ -0,0 +1,2 @@\n+Fix unclosed file when reading manifest.cfg\n+[petschki]\ndiff --git a/src/plone/app/theming/utils.py b/src/plone/app/theming/utils.py\nindex f3ca223..e494e24 100644\n--- a/src/plone/app/theming/utils.py\n+++ b/src/plone/app/theming/utils.py\n@@ -471,9 +471,8 @@ def getThemeFromResourceDirectory(resourceDirectory):\n     """\n     name = resourceDirectory.__name__\n     if resourceDirectory.isFile(MANIFEST_FILENAME):\n-        manifest = getManifest(\n-            resourceDirectory.openFile(MANIFEST_FILENAME), MANIFEST_FORMAT\n-        )\n+        with resourceDirectory.openFile(MANIFEST_FILENAME) as manifest_fp:\n+            manifest = getManifest(manifest_fp, MANIFEST_FORMAT)\n     else:\n         manifest = {}\n \n'

