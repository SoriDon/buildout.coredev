Repository: Products.CMFFormController


Branch: refs/heads/master
Date: 2016-07-05T23:18:44+02:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/Products.CMFFormController/commit/43011a7c6cc8f4847d73da1bcdaf7cfd810d16bd

Use zope.interface decorator

This not only makes code more pleasent to read,
but also makes the code python 3 compatible
(while maintaining python 2 compatibility).

Files changed:
M CHANGES.rst
M Products/CMFFormController/Actions/BaseFormAction.py
M Products/CMFFormController/ControllerPythonScript.py
M Products/CMFFormController/ControllerValidator.py
M Products/CMFFormController/FSControllerPythonScript.py
M Products/CMFFormController/FSControllerValidator.py
M Products/CMFFormController/FormController.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 28e82bd..386b9a9 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use zope.interface decorator.
+  [gforcada]
 
 
 3.1.0 (2016-05-02)
diff --git a/Products/CMFFormController/Actions/BaseFormAction.py b/Products/CMFFormController/Actions/BaseFormAction.py
index afef302..f8d899a 100644
--- a/Products/CMFFormController/Actions/BaseFormAction.py
+++ b/Products/CMFFormController/Actions/BaseFormAction.py
@@ -1,5 +1,5 @@
 from zope.tales.tales import CompilerError
-from zope.interface import implements
+from zope.interface import implementer
 
 from AccessControl import ClassSecurityInfo
 from Acquisition import aq_base, aq_parent, aq_inner
@@ -20,8 +20,8 @@
     from AccessControl.Role import RoleManager
 
 
+@implementer(IFormAction,)
 class BaseFormAction(RoleManager):
-    implements(IFormAction,)
 
     security = ClassSecurityInfo()
     security.declareObjectPublic()
diff --git a/Products/CMFFormController/ControllerPythonScript.py b/Products/CMFFormController/ControllerPythonScript.py
index eac7052..49fe682 100644
--- a/Products/CMFFormController/ControllerPythonScript.py
+++ b/Products/CMFFormController/ControllerPythonScript.py
@@ -35,7 +35,7 @@
 from FormValidator import FormValidatorContainer
 from interfaces import IControllerPythonScript
 
-from zope.interface import implements
+from zope.interface import implementer
 
 # Track the Python bytecode version
 import imp
@@ -84,6 +84,7 @@ def manage_addControllerPythonScript(self, id, REQUEST=None, submit=None):
     return ''
 
 
+@implementer(IControllerPythonScript)
 class ControllerPythonScript(BaseClass, ControllerBase):
     """Web-callable scripts written in a safe subset of Python.
 
@@ -93,8 +94,6 @@ class ControllerPythonScript(BaseClass, ControllerBase):
 
     meta_type='Controller Python Script'
 
-    implements(IControllerPythonScript)
-
     manage_options = (
         {'label':'Edit',
          'action':'ZPythonScriptHTML_editForm',
diff --git a/Products/CMFFormController/ControllerValidator.py b/Products/CMFFormController/ControllerValidator.py
index bf32195..80db611 100644
--- a/Products/CMFFormController/ControllerValidator.py
+++ b/Products/CMFFormController/ControllerValidator.py
@@ -32,7 +32,7 @@
 from ControllerBase import ControllerBase
 from interfaces import IControllerValidator
 
-from zope.interface import implements
+from zope.interface import implementer
 
 # Track the Python bytecode version
 import imp
@@ -77,6 +77,7 @@ def manage_addControllerValidator(self, id, REQUEST=None, submit=None):
     return ''
 
 
+@implementer(IControllerValidator)
 class ControllerValidator(BaseClass, ControllerBase):
     """Web-callable scripts written in a safe subset of Python.
 
@@ -86,8 +87,6 @@ class ControllerValidator(BaseClass, ControllerBase):
 
     meta_type='Controller Validator'
 
-    implements(IControllerValidator)
-
     manage_options = (
         {'label':'Edit',
          'action':'ZPythonScriptHTML_editForm',
diff --git a/Products/CMFFormController/FSControllerPythonScript.py b/Products/CMFFormController/FSControllerPythonScript.py
index dd73526..3dc6bd6 100644
--- a/Products/CMFFormController/FSControllerPythonScript.py
+++ b/Products/CMFFormController/FSControllerPythonScript.py
@@ -31,16 +31,15 @@
 from utils import log, logException
 from interfaces import IControllerPythonScript
 
-from zope.interface import implements
+from zope.interface import implementer
 
+@implementer(IControllerPythonScript)
 class FSControllerPythonScript (FSControllerBase, BaseClass):
     """FSControllerPythonScripts act like Controller Python Scripts but are not
     directly modifiable from the management interface."""
 
     meta_type = 'Filesystem Controller Python Script'
 
-    implements(IControllerPythonScript)
-
     manage_options=(
            (
             {'label':'Customize', 'action':'manage_main'},
diff --git a/Products/CMFFormController/FSControllerValidator.py b/Products/CMFFormController/FSControllerValidator.py
index 29e0fb7..205ddd4 100644
--- a/Products/CMFFormController/FSControllerValidator.py
+++ b/Products/CMFFormController/FSControllerValidator.py
@@ -26,16 +26,15 @@
 from utils import logException
 from interfaces import IControllerValidator
 
-from zope.interface import implements
+from zope.interface import implementer
 
+@implementer(IControllerValidator)
 class FSControllerValidator (BaseClass, ControllerBase):
     """FSControllerValidators act like Controller Python Scripts but are not
     directly modifiable from the management interface."""
 
     meta_type = 'Filesystem Controller Validator'
 
-    implements(IControllerValidator)
-
     manage_options=(
            (
             {'label':'Customize', 'action':'manage_main'},
diff --git a/Products/CMFFormController/FormController.py b/Products/CMFFormController/FormController.py
index d111cdf..638497f 100644
--- a/Products/CMFFormController/FormController.py
+++ b/Products/CMFFormController/FormController.py
@@ -1,6 +1,6 @@
 from __future__ import nested_scopes
 import os
-from zope.interface import implements
+from zope.interface import implementer
 from zope.structuredtext import stx2html
 
 from AccessControl import ClassSecurityInfo
@@ -27,6 +27,7 @@ def registerFormAction(id, factory, description=''):
     form_action_types[id] = FormActionType(id, factory, description)
 
 
+@implementer(IFormControllerTool)
 class FormController(UniqueObject, SimpleItemWithProperties):
     """ """
 
@@ -36,8 +37,6 @@ class FormController(UniqueObject, SimpleItemWithProperties):
     title = 'Manages form validation and post-validation actions'
     meta_type= 'Form Controller Tool'
 
-    implements(IFormControllerTool)
-
     manage_options = ( ({'label':'Overview', 'action':'manage_overview'},
                         {'label':'Documentation', 'action':'manage_docs'},
                         {'label': 'Validation', 'action': 'manage_formValidatorsForm'},


Repository: Products.CMFFormController


Branch: refs/heads/master
Date: 2016-07-10T19:01:47+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFFormController/commit/a9f2488884bfd4baedbfec36fa8ffe3559503a29

Merge pull request #5 from plone/gforcada-use-zope-decorators

Use zope.interface decorator

Files changed:
M CHANGES.rst
M Products/CMFFormController/Actions/BaseFormAction.py
M Products/CMFFormController/ControllerPythonScript.py
M Products/CMFFormController/ControllerValidator.py
M Products/CMFFormController/FSControllerPythonScript.py
M Products/CMFFormController/FSControllerValidator.py
M Products/CMFFormController/FormController.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 28e82bd..386b9a9 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use zope.interface decorator.
+  [gforcada]
 
 
 3.1.0 (2016-05-02)
diff --git a/Products/CMFFormController/Actions/BaseFormAction.py b/Products/CMFFormController/Actions/BaseFormAction.py
index afef302..f8d899a 100644
--- a/Products/CMFFormController/Actions/BaseFormAction.py
+++ b/Products/CMFFormController/Actions/BaseFormAction.py
@@ -1,5 +1,5 @@
 from zope.tales.tales import CompilerError
-from zope.interface import implements
+from zope.interface import implementer
 
 from AccessControl import ClassSecurityInfo
 from Acquisition import aq_base, aq_parent, aq_inner
@@ -20,8 +20,8 @@
     from AccessControl.Role import RoleManager
 
 
+@implementer(IFormAction,)
 class BaseFormAction(RoleManager):
-    implements(IFormAction,)
 
     security = ClassSecurityInfo()
     security.declareObjectPublic()
diff --git a/Products/CMFFormController/ControllerPythonScript.py b/Products/CMFFormController/ControllerPythonScript.py
index eac7052..49fe682 100644
--- a/Products/CMFFormController/ControllerPythonScript.py
+++ b/Products/CMFFormController/ControllerPythonScript.py
@@ -35,7 +35,7 @@
 from FormValidator import FormValidatorContainer
 from interfaces import IControllerPythonScript
 
-from zope.interface import implements
+from zope.interface import implementer
 
 # Track the Python bytecode version
 import imp
@@ -84,6 +84,7 @@ def manage_addControllerPythonScript(self, id, REQUEST=None, submit=None):
     return ''
 
 
+@implementer(IControllerPythonScript)
 class ControllerPythonScript(BaseClass, ControllerBase):
     """Web-callable scripts written in a safe subset of Python.
 
@@ -93,8 +94,6 @@ class ControllerPythonScript(BaseClass, ControllerBase):
 
     meta_type='Controller Python Script'
 
-    implements(IControllerPythonScript)
-
     manage_options = (
         {'label':'Edit',
          'action':'ZPythonScriptHTML_editForm',
diff --git a/Products/CMFFormController/ControllerValidator.py b/Products/CMFFormController/ControllerValidator.py
index bf32195..80db611 100644
--- a/Products/CMFFormController/ControllerValidator.py
+++ b/Products/CMFFormController/ControllerValidator.py
@@ -32,7 +32,7 @@
 from ControllerBase import ControllerBase
 from interfaces import IControllerValidator
 
-from zope.interface import implements
+from zope.interface import implementer
 
 # Track the Python bytecode version
 import imp
@@ -77,6 +77,7 @@ def manage_addControllerValidator(self, id, REQUEST=None, submit=None):
     return ''
 
 
+@implementer(IControllerValidator)
 class ControllerValidator(BaseClass, ControllerBase):
     """Web-callable scripts written in a safe subset of Python.
 
@@ -86,8 +87,6 @@ class ControllerValidator(BaseClass, ControllerBase):
 
     meta_type='Controller Validator'
 
-    implements(IControllerValidator)
-
     manage_options = (
         {'label':'Edit',
          'action':'ZPythonScriptHTML_editForm',
diff --git a/Products/CMFFormController/FSControllerPythonScript.py b/Products/CMFFormController/FSControllerPythonScript.py
index dd73526..3dc6bd6 100644
--- a/Products/CMFFormController/FSControllerPythonScript.py
+++ b/Products/CMFFormController/FSControllerPythonScript.py
@@ -31,16 +31,15 @@
 from utils import log, logException
 from interfaces import IControllerPythonScript
 
-from zope.interface import implements
+from zope.interface import implementer
 
+@implementer(IControllerPythonScript)
 class FSControllerPythonScript (FSControllerBase, BaseClass):
     """FSControllerPythonScripts act like Controller Python Scripts but are not
     directly modifiable from the management interface."""
 
     meta_type = 'Filesystem Controller Python Script'
 
-    implements(IControllerPythonScript)
-
     manage_options=(
            (
             {'label':'Customize', 'action':'manage_main'},
diff --git a/Products/CMFFormController/FSControllerValidator.py b/Products/CMFFormController/FSControllerValidator.py
index 29e0fb7..205ddd4 100644
--- a/Products/CMFFormController/FSControllerValidator.py
+++ b/Products/CMFFormController/FSControllerValidator.py
@@ -26,16 +26,15 @@
 from utils import logException
 from interfaces import IControllerValidator
 
-from zope.interface import implements
+from zope.interface import implementer
 
+@implementer(IControllerValidator)
 class FSControllerValidator (BaseClass, ControllerBase):
     """FSControllerValidators act like Controller Python Scripts but are not
     directly modifiable from the management interface."""
 
     meta_type = 'Filesystem Controller Validator'
 
-    implements(IControllerValidator)
-
     manage_options=(
            (
             {'label':'Customize', 'action':'manage_main'},
diff --git a/Products/CMFFormController/FormController.py b/Products/CMFFormController/FormController.py
index d111cdf..638497f 100644
--- a/Products/CMFFormController/FormController.py
+++ b/Products/CMFFormController/FormController.py
@@ -1,6 +1,6 @@
 from __future__ import nested_scopes
 import os
-from zope.interface import implements
+from zope.interface import implementer
 from zope.structuredtext import stx2html
 
 from AccessControl import ClassSecurityInfo
@@ -27,6 +27,7 @@ def registerFormAction(id, factory, description=''):
     form_action_types[id] = FormActionType(id, factory, description)
 
 
+@implementer(IFormControllerTool)
 class FormController(UniqueObject, SimpleItemWithProperties):
     """ """
 
@@ -36,8 +37,6 @@ class FormController(UniqueObject, SimpleItemWithProperties):
     title = 'Manages form validation and post-validation actions'
     meta_type= 'Form Controller Tool'
 
-    implements(IFormControllerTool)
-
     manage_options = ( ({'label':'Overview', 'action':'manage_overview'},
                         {'label':'Documentation', 'action':'manage_docs'},
                         {'label': 'Validation', 'action': 'manage_formValidatorsForm'},


