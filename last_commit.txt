Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-07-05T15:33:54+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/f25f9ba996e94474fae4a754386c9ac7bf5ed9d0

Tests: add names to behaviors.

The 'name' property may become required.
See https://github.com/plone/plone.dexterity/issues/169

Files changed:
A news/169.bugfix
M src/plone/restapi/profiles/testing/types/DXTestDocument.xml
M src/plone/restapi/testing.zcml
M src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp

b'diff --git a/news/169.bugfix b/news/169.bugfix\nnew file mode 100644\nindex 000000000..806561cd3\n--- /dev/null\n+++ b/news/169.bugfix\n@@ -0,0 +1 @@\n+Tests: add names to behaviors.  [maurits]\n\\ No newline at end of file\ndiff --git a/src/plone/restapi/profiles/testing/types/DXTestDocument.xml b/src/plone/restapi/profiles/testing/types/DXTestDocument.xml\nindex 07813f7be..23ff971d3 100644\n--- a/src/plone/restapi/profiles/testing/types/DXTestDocument.xml\n+++ b/src/plone/restapi/profiles/testing/types/DXTestDocument.xml\n@@ -20,9 +20,9 @@\n   <property name="klass">plone.restapi.tests.dxtypes.DXTestDocument</property>\n \n   <property name="behaviors">\n-    <element value="plone.restapi.tests.dxtypes.ITestBehavior"/>\n-    <element value="plone.restapi.tests.dxtypes.ITestAnnotationsBehavior"/>\n     <element value="plone.app.dexterity.behaviors.metadata.IBasic"/>\n+    <element value="tests.restapi.test_annotations_behavior"/>\n+    <element value="tests.restapi.test_behavior"/>\n   </property>\n \n   <!-- View information -->\ndiff --git a/src/plone/restapi/testing.zcml b/src/plone/restapi/testing.zcml\nindex ca719afcd..d1cd9a2db 100644\n--- a/src/plone/restapi/testing.zcml\n+++ b/src/plone/restapi/testing.zcml\n@@ -18,6 +18,7 @@\n       />\n   <include package="plone.rfc822" />\n   <plone:behavior\n+      name="tests.restapi.test_behavior"\n       title="Test Behavior"\n       description="Schema-only behavior using attributes"\n       provides=".tests.dxtypes.ITestBehavior"\n@@ -25,6 +26,7 @@\n       />\n \n   <plone:behavior\n+      name="tests.restapi.test_annotations_behavior"\n       title="Test Annotations Behavior"\n       description="Schema-only behavior using annotations"\n       factory="plone.behavior.AnnotationStorage"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp\nindex a7a986395..4b5c5ecfd 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp\n@@ -29,14 +29,14 @@ Content-Type: application/json\n         "plone.ownership": false,\n         "plone.publication": false,\n         "plone.relateditems": false,\n-        "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": false,\n-        "plone.restapi.tests.dxtypes.ITestBehavior": false,\n         "plone.richtext": false,\n         "plone.shortname": false,\n         "plone.tableofcontents": false,\n         "plone.thumb_icon": false,\n         "plone.translatable": false,\n         "plone.versioning": false,\n+        "tests.restapi.test_annotations_behavior": false,\n+        "tests.restapi.test_behavior": false,\n         "title": "My Custom Content Type",\n         "volto.blocks": false\n     },\n@@ -86,8 +86,8 @@ Content-Type: application/json\n                     "plone.richtext",\n                     "plone.shortname",\n                     "plone.tableofcontents",\n-                    "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior",\n-                    "plone.restapi.tests.dxtypes.ITestBehavior",\n+                    "tests.restapi.test_annotations_behavior",\n+                    "tests.restapi.test_behavior",\n                     "plone.thumb_icon",\n                     "plone.versioning"\n                 ],\n@@ -286,18 +286,6 @@ Content-Type: application/json\n                 "title": "Related items",\n                 "type": "boolean"\n             },\n-            "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": {\n-                "description": "Schema-only behavior using annotations",\n-                "factory": "Yes/No",\n-                "title": "Test Annotations Behavior",\n-                "type": "boolean"\n-            },\n-            "plone.restapi.tests.dxtypes.ITestBehavior": {\n-                "description": "Schema-only behavior using attributes",\n-                "factory": "Yes/No",\n-                "title": "Test Behavior",\n-                "type": "boolean"\n-            },\n             "plone.richtext": {\n                 "description": "Adds richtext behavior",\n                 "factory": "Yes/No",\n@@ -334,6 +322,18 @@ Content-Type: application/json\n                 "title": "Versioning",\n                 "type": "boolean"\n             },\n+            "tests.restapi.test_annotations_behavior": {\n+                "description": "Schema-only behavior using annotations",\n+                "factory": "Yes/No",\n+                "title": "Test Annotations Behavior",\n+                "type": "boolean"\n+            },\n+            "tests.restapi.test_behavior": {\n+                "description": "Schema-only behavior using attributes",\n+                "factory": "Yes/No",\n+                "title": "Test Behavior",\n+                "type": "boolean"\n+            },\n             "title": {\n                 "description": "",\n                 "factory": "Text line (String)",\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp\nindex 17d6e31d9..0fc5945ee 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp\n@@ -30,14 +30,14 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n         "plone.ownership": false,\n         "plone.publication": false,\n         "plone.relateditems": false,\n-        "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": false,\n-        "plone.restapi.tests.dxtypes.ITestBehavior": false,\n         "plone.richtext": false,\n         "plone.shortname": false,\n         "plone.tableofcontents": false,\n         "plone.thumb_icon": false,\n         "plone.translatable": false,\n         "plone.versioning": false,\n+        "tests.restapi.test_annotations_behavior": false,\n+        "tests.restapi.test_behavior": false,\n         "title": "My Custom Content Type",\n         "volto.blocks": false\n     },\n@@ -87,8 +87,8 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n                     "plone.richtext",\n                     "plone.shortname",\n                     "plone.tableofcontents",\n-                    "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior",\n-                    "plone.restapi.tests.dxtypes.ITestBehavior",\n+                    "tests.restapi.test_annotations_behavior",\n+                    "tests.restapi.test_behavior",\n                     "plone.thumb_icon",\n                     "plone.versioning"\n                 ],\n@@ -287,18 +287,6 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n                 "title": "Related items",\n                 "type": "boolean"\n             },\n-            "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": {\n-                "description": "Schema-only behavior using annotations",\n-                "factory": "Yes/No",\n-                "title": "Test Annotations Behavior",\n-                "type": "boolean"\n-            },\n-            "plone.restapi.tests.dxtypes.ITestBehavior": {\n-                "description": "Schema-only behavior using attributes",\n-                "factory": "Yes/No",\n-                "title": "Test Behavior",\n-                "type": "boolean"\n-            },\n             "plone.richtext": {\n                 "description": "Adds richtext behavior",\n                 "factory": "Yes/No",\n@@ -335,6 +323,18 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n                 "title": "Versioning",\n                 "type": "boolean"\n             },\n+            "tests.restapi.test_annotations_behavior": {\n+                "description": "Schema-only behavior using annotations",\n+                "factory": "Yes/No",\n+                "title": "Test Annotations Behavior",\n+                "type": "boolean"\n+            },\n+            "tests.restapi.test_behavior": {\n+                "description": "Schema-only behavior using attributes",\n+                "factory": "Yes/No",\n+                "title": "Test Behavior",\n+                "type": "boolean"\n+            },\n             "title": {\n                 "description": "",\n                 "factory": "Text line (String)",\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-07-05T16:52:54+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/e8eaee3f1b0acc4efb2a2a95893ac2764c1cba57

Merge pull request #1457 from plone/maurits-behavior-names

Tests: add names to behaviors.

Files changed:
A news/169.bugfix
M src/plone/restapi/profiles/testing/types/DXTestDocument.xml
M src/plone/restapi/testing.zcml
M src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp

b'diff --git a/news/169.bugfix b/news/169.bugfix\nnew file mode 100644\nindex 000000000..806561cd3\n--- /dev/null\n+++ b/news/169.bugfix\n@@ -0,0 +1 @@\n+Tests: add names to behaviors.  [maurits]\n\\ No newline at end of file\ndiff --git a/src/plone/restapi/profiles/testing/types/DXTestDocument.xml b/src/plone/restapi/profiles/testing/types/DXTestDocument.xml\nindex 07813f7be..23ff971d3 100644\n--- a/src/plone/restapi/profiles/testing/types/DXTestDocument.xml\n+++ b/src/plone/restapi/profiles/testing/types/DXTestDocument.xml\n@@ -20,9 +20,9 @@\n   <property name="klass">plone.restapi.tests.dxtypes.DXTestDocument</property>\n \n   <property name="behaviors">\n-    <element value="plone.restapi.tests.dxtypes.ITestBehavior"/>\n-    <element value="plone.restapi.tests.dxtypes.ITestAnnotationsBehavior"/>\n     <element value="plone.app.dexterity.behaviors.metadata.IBasic"/>\n+    <element value="tests.restapi.test_annotations_behavior"/>\n+    <element value="tests.restapi.test_behavior"/>\n   </property>\n \n   <!-- View information -->\ndiff --git a/src/plone/restapi/testing.zcml b/src/plone/restapi/testing.zcml\nindex ca719afcd..d1cd9a2db 100644\n--- a/src/plone/restapi/testing.zcml\n+++ b/src/plone/restapi/testing.zcml\n@@ -18,6 +18,7 @@\n       />\n   <include package="plone.rfc822" />\n   <plone:behavior\n+      name="tests.restapi.test_behavior"\n       title="Test Behavior"\n       description="Schema-only behavior using attributes"\n       provides=".tests.dxtypes.ITestBehavior"\n@@ -25,6 +26,7 @@\n       />\n \n   <plone:behavior\n+      name="tests.restapi.test_annotations_behavior"\n       title="Test Annotations Behavior"\n       description="Schema-only behavior using annotations"\n       factory="plone.behavior.AnnotationStorage"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp\nindex a7a986395..4b5c5ecfd 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_dexterity_item.resp\n@@ -29,14 +29,14 @@ Content-Type: application/json\n         "plone.ownership": false,\n         "plone.publication": false,\n         "plone.relateditems": false,\n-        "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": false,\n-        "plone.restapi.tests.dxtypes.ITestBehavior": false,\n         "plone.richtext": false,\n         "plone.shortname": false,\n         "plone.tableofcontents": false,\n         "plone.thumb_icon": false,\n         "plone.translatable": false,\n         "plone.versioning": false,\n+        "tests.restapi.test_annotations_behavior": false,\n+        "tests.restapi.test_behavior": false,\n         "title": "My Custom Content Type",\n         "volto.blocks": false\n     },\n@@ -86,8 +86,8 @@ Content-Type: application/json\n                     "plone.richtext",\n                     "plone.shortname",\n                     "plone.tableofcontents",\n-                    "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior",\n-                    "plone.restapi.tests.dxtypes.ITestBehavior",\n+                    "tests.restapi.test_annotations_behavior",\n+                    "tests.restapi.test_behavior",\n                     "plone.thumb_icon",\n                     "plone.versioning"\n                 ],\n@@ -286,18 +286,6 @@ Content-Type: application/json\n                 "title": "Related items",\n                 "type": "boolean"\n             },\n-            "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": {\n-                "description": "Schema-only behavior using annotations",\n-                "factory": "Yes/No",\n-                "title": "Test Annotations Behavior",\n-                "type": "boolean"\n-            },\n-            "plone.restapi.tests.dxtypes.ITestBehavior": {\n-                "description": "Schema-only behavior using attributes",\n-                "factory": "Yes/No",\n-                "title": "Test Behavior",\n-                "type": "boolean"\n-            },\n             "plone.richtext": {\n                 "description": "Adds richtext behavior",\n                 "factory": "Yes/No",\n@@ -334,6 +322,18 @@ Content-Type: application/json\n                 "title": "Versioning",\n                 "type": "boolean"\n             },\n+            "tests.restapi.test_annotations_behavior": {\n+                "description": "Schema-only behavior using annotations",\n+                "factory": "Yes/No",\n+                "title": "Test Annotations Behavior",\n+                "type": "boolean"\n+            },\n+            "tests.restapi.test_behavior": {\n+                "description": "Schema-only behavior using attributes",\n+                "factory": "Yes/No",\n+                "title": "Test Behavior",\n+                "type": "boolean"\n+            },\n             "title": {\n                 "description": "",\n                 "factory": "Text line (String)",\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp\nindex 17d6e31d9..0fc5945ee 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_dexterity_item.resp\n@@ -30,14 +30,14 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n         "plone.ownership": false,\n         "plone.publication": false,\n         "plone.relateditems": false,\n-        "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": false,\n-        "plone.restapi.tests.dxtypes.ITestBehavior": false,\n         "plone.richtext": false,\n         "plone.shortname": false,\n         "plone.tableofcontents": false,\n         "plone.thumb_icon": false,\n         "plone.translatable": false,\n         "plone.versioning": false,\n+        "tests.restapi.test_annotations_behavior": false,\n+        "tests.restapi.test_behavior": false,\n         "title": "My Custom Content Type",\n         "volto.blocks": false\n     },\n@@ -87,8 +87,8 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n                     "plone.richtext",\n                     "plone.shortname",\n                     "plone.tableofcontents",\n-                    "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior",\n-                    "plone.restapi.tests.dxtypes.ITestBehavior",\n+                    "tests.restapi.test_annotations_behavior",\n+                    "tests.restapi.test_behavior",\n                     "plone.thumb_icon",\n                     "plone.versioning"\n                 ],\n@@ -287,18 +287,6 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n                 "title": "Related items",\n                 "type": "boolean"\n             },\n-            "plone.restapi.tests.dxtypes.ITestAnnotationsBehavior": {\n-                "description": "Schema-only behavior using annotations",\n-                "factory": "Yes/No",\n-                "title": "Test Annotations Behavior",\n-                "type": "boolean"\n-            },\n-            "plone.restapi.tests.dxtypes.ITestBehavior": {\n-                "description": "Schema-only behavior using attributes",\n-                "factory": "Yes/No",\n-                "title": "Test Behavior",\n-                "type": "boolean"\n-            },\n             "plone.richtext": {\n                 "description": "Adds richtext behavior",\n                 "factory": "Yes/No",\n@@ -335,6 +323,18 @@ Location: http://localhost:55001/plone/@controlpanels/dexterity-types/my_custom_\n                 "title": "Versioning",\n                 "type": "boolean"\n             },\n+            "tests.restapi.test_annotations_behavior": {\n+                "description": "Schema-only behavior using annotations",\n+                "factory": "Yes/No",\n+                "title": "Test Annotations Behavior",\n+                "type": "boolean"\n+            },\n+            "tests.restapi.test_behavior": {\n+                "description": "Schema-only behavior using attributes",\n+                "factory": "Yes/No",\n+                "title": "Test Behavior",\n+                "type": "boolean"\n+            },\n             "title": {\n                 "description": "",\n                 "factory": "Text line (String)",\n'

