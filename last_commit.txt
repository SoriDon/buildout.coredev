Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2022-07-04T13:10:45+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/f59a196b3e7f1e89ef770c67b8e38da20ea81d1d

fix deprecation warnings from plone.base

Files changed:
A news/166.bugfix
M plone/app/portlets/portlets/navigation.py

b'diff --git a/news/166.bugfix b/news/166.bugfix\nnew file mode 100644\nindex 00000000..3590a460\n--- /dev/null\n+++ b/news/166.bugfix\n@@ -0,0 +1,2 @@\n+fix deprecation warnings from plone.base\n+[jensens]\ndiff --git a/plone/app/portlets/portlets/navigation.py b/plone/app/portlets/portlets/navigation.py\nindex 4d5c4f4c..124c6049 100644\n--- a/plone/app/portlets/portlets/navigation.py\n+++ b/plone/app/portlets/portlets/navigation.py\n@@ -12,6 +12,11 @@\n from plone.app.layout.navigation.root import getNavigationRootObject\n from plone.app.uuid.utils import uuidToObject\n from plone.app.vocabularies.catalog import CatalogSource\n+from plone.base.defaultpage import is_default_page\n+from plone.base.interfaces import INavigationSchema\n+from plone.base.interfaces import INonStructuralFolder\n+from plone.base.interfaces import ISiteSchema\n+from plone.base.utils import safe_callable\n from plone.i18n.normalizer.interfaces import IIDNormalizer\n from plone.memoize.instance import memoize\n from plone.portlets.interfaces import IPortletDataProvider\n@@ -19,12 +24,8 @@\n from Products.CMFCore.interfaces import ISiteRoot\n from Products.CMFCore.utils import getToolByName\n from Products.CMFDynamicViewFTI.interfaces import IBrowserDefault\n-from Products.CMFPlone import utils\n from Products.CMFPlone.browser.navtree import SitemapNavtreeStrategy\n-from Products.CMFPlone.defaultpage import is_default_page\n-from Products.CMFPlone.interfaces import INavigationSchema\n-from Products.CMFPlone.interfaces import INonStructuralFolder\n-from Products.CMFPlone.interfaces import ISiteSchema\n+from Products.CMFPlone.utils import typesToList\n from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile\n from Products.MimetypesRegistry.MimeTypeItem import guess_icon_path\n from zExceptions import NotFound\n@@ -414,7 +415,7 @@ def __init__(self, context, portlet):\n \n         # Acquire a custom nav query if available\n         customQuery = getattr(context, "getCustomNavQuery", None)\n-        if customQuery is not None and utils.safe_callable(customQuery):\n+        if customQuery is not None and safe_callable(customQuery):\n             query = customQuery()\n         else:\n             query = {}\n@@ -444,7 +445,7 @@ def __init__(self, context, portlet):\n         # seem to work with EPI.\n \n         # Only list the applicable types\n-        query["portal_type"] = utils.typesToList(context)\n+        query["portal_type"] = typesToList(context)\n \n         # Apply the desired sort\n         sortAttribute = navtree_properties.getProperty("sortAttribute", None)\n'

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2022-07-05T17:41:15+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/cb9546951b7fb37a877569200f67c4a174545a87

Merge pull request #166 from plone/fix-deprecation-warnings

fix deprecation warnings from plone.base

Files changed:
A news/166.bugfix
M plone/app/portlets/portlets/navigation.py

b'diff --git a/news/166.bugfix b/news/166.bugfix\nnew file mode 100644\nindex 00000000..3590a460\n--- /dev/null\n+++ b/news/166.bugfix\n@@ -0,0 +1,2 @@\n+fix deprecation warnings from plone.base\n+[jensens]\ndiff --git a/plone/app/portlets/portlets/navigation.py b/plone/app/portlets/portlets/navigation.py\nindex 4d5c4f4c..124c6049 100644\n--- a/plone/app/portlets/portlets/navigation.py\n+++ b/plone/app/portlets/portlets/navigation.py\n@@ -12,6 +12,11 @@\n from plone.app.layout.navigation.root import getNavigationRootObject\n from plone.app.uuid.utils import uuidToObject\n from plone.app.vocabularies.catalog import CatalogSource\n+from plone.base.defaultpage import is_default_page\n+from plone.base.interfaces import INavigationSchema\n+from plone.base.interfaces import INonStructuralFolder\n+from plone.base.interfaces import ISiteSchema\n+from plone.base.utils import safe_callable\n from plone.i18n.normalizer.interfaces import IIDNormalizer\n from plone.memoize.instance import memoize\n from plone.portlets.interfaces import IPortletDataProvider\n@@ -19,12 +24,8 @@\n from Products.CMFCore.interfaces import ISiteRoot\n from Products.CMFCore.utils import getToolByName\n from Products.CMFDynamicViewFTI.interfaces import IBrowserDefault\n-from Products.CMFPlone import utils\n from Products.CMFPlone.browser.navtree import SitemapNavtreeStrategy\n-from Products.CMFPlone.defaultpage import is_default_page\n-from Products.CMFPlone.interfaces import INavigationSchema\n-from Products.CMFPlone.interfaces import INonStructuralFolder\n-from Products.CMFPlone.interfaces import ISiteSchema\n+from Products.CMFPlone.utils import typesToList\n from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile\n from Products.MimetypesRegistry.MimeTypeItem import guess_icon_path\n from zExceptions import NotFound\n@@ -414,7 +415,7 @@ def __init__(self, context, portlet):\n \n         # Acquire a custom nav query if available\n         customQuery = getattr(context, "getCustomNavQuery", None)\n-        if customQuery is not None and utils.safe_callable(customQuery):\n+        if customQuery is not None and safe_callable(customQuery):\n             query = customQuery()\n         else:\n             query = {}\n@@ -444,7 +445,7 @@ def __init__(self, context, portlet):\n         # seem to work with EPI.\n \n         # Only list the applicable types\n-        query["portal_type"] = utils.typesToList(context)\n+        query["portal_type"] = typesToList(context)\n \n         # Apply the desired sort\n         sortAttribute = navtree_properties.getProperty("sortAttribute", None)\n'

