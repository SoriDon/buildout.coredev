Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2015-11-23T15:04:18+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.contenttypes/commit/560ff48166294f394daea9eb2e4839cf13db1e41

Create standard news/events collections with selection.any.

Issue https://github.com/plone/Products.CMFPlone/issues/1040

Files changed:
M CHANGES.rst
M plone/app/contenttypes/setuphandlers.py
M plone/app/contenttypes/tests/test_content_profile.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 76477e8..cfecc2d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -11,6 +11,10 @@ New:
 
 Fixes:
 
+- Create standard news/events collections with ``selection.any``.
+  Issue https://github.com/plone/Products.CMFPlone/issues/1040
+  [maurits]
+
 - Avoid AttributeError from potential acquisition issues with folder listings
   [vangheem]
 
diff --git a/plone/app/contenttypes/setuphandlers.py b/plone/app/contenttypes/setuphandlers.py
index efb6f6a..81f9eaa 100644
--- a/plone/app/contenttypes/setuphandlers.py
+++ b/plone/app/contenttypes/setuphandlers.py
@@ -232,11 +232,11 @@ def create_news_topic(portal, target_language):
         #: Query by Type and Review State
         aggregator.query = [
             {'i': u'portal_type',
-             'o': u'plone.app.querystring.operation.selection.is',
+             'o': u'plone.app.querystring.operation.selection.any',
              'v': [u'News Item'],
              },
             {'i': u'review_state',
-             'o': u'plone.app.querystring.operation.selection.is',
+             'o': u'plone.app.querystring.operation.selection.any',
              'v': [u'published'],
              },
         ]
@@ -279,11 +279,11 @@ def create_events_topic(portal, target_language):
         #: Query by Type and Review State
         aggregator.query = [
             {'i': 'portal_type',
-             'o': 'plone.app.querystring.operation.selection.is',
+             'o': 'plone.app.querystring.operation.selection.any',
              'v': ['Event']
              },
             {'i': 'review_state',
-             'o': 'plone.app.querystring.operation.selection.is',
+             'o': 'plone.app.querystring.operation.selection.any',
              'v': ['published']
              },
         ]
diff --git a/plone/app/contenttypes/tests/test_content_profile.py b/plone/app/contenttypes/tests/test_content_profile.py
index 0271fe6..c8684a6 100644
--- a/plone/app/contenttypes/tests/test_content_profile.py
+++ b/plone/app/contenttypes/tests/test_content_profile.py
@@ -173,10 +173,10 @@ def test_news_allowable_types(self):
     def test_news_aggregator_settings(self):
         # Has the news aggregator (Collection) been set up?
         query = [dict(i=u'portal_type',
-                      o=u'plone.app.querystring.operation.selection.is',
+                      o=u'plone.app.querystring.operation.selection.any',
                       v=[u'News Item']),
                  dict(i=u'review_state',
-                      o=u'plone.app.querystring.operation.selection.is',
+                      o=u'plone.app.querystring.operation.selection.any',
                       v=[u'published']),
                  ]
         collection = self.portal['news']['aggregator']


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2015-11-25T11:37:37+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/plone.app.contenttypes/commit/fe1d27eb7f6699f550d73c73e974d245ee8fe2f2

Merge pull request #300 from plone/cmfplone-issue-1040

Create standard news/events collections with selection.any.

Files changed:
M CHANGES.rst
M plone/app/contenttypes/setuphandlers.py
M plone/app/contenttypes/tests/test_content_profile.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 76477e8..cfecc2d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -11,6 +11,10 @@ New:
 
 Fixes:
 
+- Create standard news/events collections with ``selection.any``.
+  Issue https://github.com/plone/Products.CMFPlone/issues/1040
+  [maurits]
+
 - Avoid AttributeError from potential acquisition issues with folder listings
   [vangheem]
 
diff --git a/plone/app/contenttypes/setuphandlers.py b/plone/app/contenttypes/setuphandlers.py
index efb6f6a..81f9eaa 100644
--- a/plone/app/contenttypes/setuphandlers.py
+++ b/plone/app/contenttypes/setuphandlers.py
@@ -232,11 +232,11 @@ def create_news_topic(portal, target_language):
         #: Query by Type and Review State
         aggregator.query = [
             {'i': u'portal_type',
-             'o': u'plone.app.querystring.operation.selection.is',
+             'o': u'plone.app.querystring.operation.selection.any',
              'v': [u'News Item'],
              },
             {'i': u'review_state',
-             'o': u'plone.app.querystring.operation.selection.is',
+             'o': u'plone.app.querystring.operation.selection.any',
              'v': [u'published'],
              },
         ]
@@ -279,11 +279,11 @@ def create_events_topic(portal, target_language):
         #: Query by Type and Review State
         aggregator.query = [
             {'i': 'portal_type',
-             'o': 'plone.app.querystring.operation.selection.is',
+             'o': 'plone.app.querystring.operation.selection.any',
              'v': ['Event']
              },
             {'i': 'review_state',
-             'o': 'plone.app.querystring.operation.selection.is',
+             'o': 'plone.app.querystring.operation.selection.any',
              'v': ['published']
              },
         ]
diff --git a/plone/app/contenttypes/tests/test_content_profile.py b/plone/app/contenttypes/tests/test_content_profile.py
index 0271fe6..c8684a6 100644
--- a/plone/app/contenttypes/tests/test_content_profile.py
+++ b/plone/app/contenttypes/tests/test_content_profile.py
@@ -173,10 +173,10 @@ def test_news_allowable_types(self):
     def test_news_aggregator_settings(self):
         # Has the news aggregator (Collection) been set up?
         query = [dict(i=u'portal_type',
-                      o=u'plone.app.querystring.operation.selection.is',
+                      o=u'plone.app.querystring.operation.selection.any',
                       v=[u'News Item']),
                  dict(i=u'review_state',
-                      o=u'plone.app.querystring.operation.selection.is',
+                      o=u'plone.app.querystring.operation.selection.any',
                       v=[u'published']),
                  ]
         collection = self.portal['news']['aggregator']


