Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-06-18T14:50:53+02:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/2ff7eb96ec017438f28eb76df0a1b28a5269562d

Implement more code review suggestions

Files changed:
M README.rst

b"diff --git a/README.rst b/README.rst\nindex 4dd1e37..8e0535a 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -5,7 +5,7 @@ plone.staticresources\n Static JS and CSS resources for Plone.\n \n \n-This add on contains all JavaScript and CSS resources used by Plone.\n+This add-on contains all JavaScript and CSS resources used by Plone.\n \n Prior to Plone 5.2, they were located in ``static/`` directory of\n ``Products.CMFPlone`` package.\n@@ -18,8 +18,8 @@ complete list of reasons, read the\xc2\xa7 `PLIP\n \n .. note::\n \n-  A note on yarn: We require the use of yarn, because it supports installing\n-  packages in a custom named directory, which npm doesn't (even using\n+  A note on yarn: we require the use of yarn, because it supports installing\n+  packages in a custom named directory, which npm does not (even using\n   ``--prefix``, ``node_modules`` is hardcoded). Our package directory is\n   located at: ``src/plone/staticresources/static/components``.\n \n@@ -32,36 +32,36 @@ This documentation aims at:\n Integrators and Developers\n ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-Who want to customize and/or maintain the frontend of a Plone site for their\n+Who want to customize or maintain the front end of a Plone site for their\n customers:\n \n - upgrade existing versions or install new ``npm`` packages\n - integrate new JavaScript/CSS behavior, eventually wrapped in a ``pattern``\n-for optimal integration and reuse within Plone frontend ecosystem\n+  for optimal integration and reuse within Plone front end ecosystem\n \n \n-Themers\n-^^^^^^^\n+Themer authors\n+^^^^^^^^^^^^^^\n \n Who want to change the look and feel of a Plone site and need to:\n \n - understand how to correctly bundle changes made into existing or new frontend\n code\n--\n+- XXX\n \n \n Plone Core Developers\n ^^^^^^^^^^^^^^^^^^^^^\n \n-Who want to want to help add/enhance this add-on itself.\n+Who want to help enhance this add-on itself.\n \n \n Workflow\n --------\n \n Default Plone buildout configuration adds an executable in\n-`./bin/plone-compile-resources` which generates compiled bundles (normal,\n-minified and respective maps) in `plone/staticresources/static/`.\n+``./bin/plone-compile-resources`` which generates compiled bundles (normal,\n+minified and respective maps) in ``plone/staticresources/static/``.\n \n .. note::\n \n@@ -98,15 +98,15 @@ For Patternslib, visit: http://github.com/patternslib/Patterns\n How to upgrade the resources in this package\n --------------------------------------------\n \n-- Increase ``npm`` package versions in ``package.json``, i.e. sections\n+- Increase ``npm`` package versions in ``package.json``, in sections\n ``dependencies`` or ``devDependencies``.\n - Run ``yarn upgrade`` (cannot be ``npm``)\n - Run ``./bin/plone-compile-resources -b plone``,\n-``./bin/plone-compile-resources -b plone-logged-in`` and whatever bundle you're\n-going to build in your buildout's root directory.\n+  ``./bin/plone-compile-resources -b plone-logged-in`` and whatever bundle\n+  you are going to build in your buildout's root directory.\n   .. For more info on ``plone-compile-resources`` see: XXX\n - Increase the ``last_compilation`` date in\n-``src/plone/staticresources/profiles/default/registry/bundles.xml``.\n+  ``src/plone/staticresources/profiles/default/registry/bundles.xml``.\n - Submit a PR and run the tests on Jenkins.\n \n \n@@ -114,7 +114,7 @@ How to generate the ``plone-compile-resources`` script\n ------------------------------------------------------\n \n The ``plone-compile-resources`` script can be used to compile bundles from the\n-command line. In a glimpse, the script starts up a Plone instance, reads the\n+command line. In short, the script starts up a Plone instance, reads the\n resources and bundles configured in the registry and compiles a JS/CSS bundle\n based on that configuration. See ``plone-compile-resources --help`` for more\n information.\n@@ -146,25 +146,24 @@ What has changed since Plone 5.1\n --------------------------------\n \n - All static resources - bundle resources, compiled bundles, external packages -\n-from ``Products.CMFPlone.static`` have been moved here.\n+  from ``Products.CMFPlone.static`` have been moved here.\n - The bundle and resource registrations from ``Products.CMFPlone``'s\n-``dependencies`` profile have also been moved here.\n+  ``dependencies`` profile have also been moved here.\n - The ``plone-compile-resources`` script has been moved here.\n - The ``thememapper`` bundle from plone.app.theming has been moved here.\n - The ``plone.resourceeditor`` bundle from ``plone.resourceeditor``\n-package has been moved here.\n+  package has been moved here.\n - The ``toolbar`` pattern from ``Products.CMFPlone.static.toolbar`` has been\n-moved to ``mockup`` package.\n+  moved to ``mockup`` package.\n - ``mockup`` package now uses npm registry and yarn instead of bower.\n \n \n Warning\n -------\n \n-If you update ``r.js`` or ``less``, you'll need to manually re-apply a patch\n-that gets us cache busting resource downloads so we can build through the web. See:\n+If you update ``r.js`` or ``less``, you willl need to manually re-apply a patch\n+that gives us cache busting resource downloads so we can build through the web. See:\n - https://github.com/plone/Products.CMFPlone/commit/2d3865805efc6b72dce236eb68e502d8c57717b6\n-and\n - https://github.com/plone/Products.CMFPlone/commit/bd1f9ba99d1ad40bb7fe1c00eaa32b8884aae5e2\n \n \n"

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-06-18T14:50:53+02:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/f1f28661091d1d0b9a9ddd4cdc8acde8143fe427

Fix typo

Files changed:
M README.rst

b'diff --git a/README.rst b/README.rst\nindex 8e0535a..682a285 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -13,7 +13,7 @@ Prior to Plone 5.2, they were located in ``static/`` directory of\n Due to the specific tooling and workflows used to build frontend resources, and\n also the different maintenance and release needs of ``Products.CMFPlone``\n itself, Plone static resources are now distributed in this package. For a\n-complete list of reasons, read the\xc2\xa7 `PLIP\n+complete list of reasons, read the `PLIP\n 1653<https://github.com/plone/Products.CMFPlone/issues/1653>`_.\n \n .. note::\n'

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-06-18T14:50:53+02:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/d4618b53e1220b23e601f489ac8d9d71dfe53700

More fixes from code review

Files changed:
M README.rst

b"diff --git a/README.rst b/README.rst\nindex 682a285..180a333 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -13,8 +13,8 @@ Prior to Plone 5.2, they were located in ``static/`` directory of\n Due to the specific tooling and workflows used to build frontend resources, and\n also the different maintenance and release needs of ``Products.CMFPlone``\n itself, Plone static resources are now distributed in this package. For a\n-complete list of reasons, read the `PLIP\n-1653<https://github.com/plone/Products.CMFPlone/issues/1653>`_.\n+complete list of reasons, read the `PLIP 1653\n+<https://github.com/plone/Products.CMFPlone/issues/1653>`_.\n \n .. note::\n \n@@ -74,7 +74,7 @@ be similar to:\n - http://localhost:8080//++plone++static/++unique++2019-01-08%2006%3A53%3A49.000248/plone-compiled.min.js\n - http://localhost:8080/++plone++static/++unique++2019-01-08%2006%3A53%3A49.040248/plone-logged-in-compiled.min.js\n \n-In development mode, XXX: Explain what happens/entry point roles of:\n+In development mode, XXX: Explain what happens, including how the roles of entry points like:\n \n - http://localhost:8080/++resource++plone.js\n - http://localhost:8080/++resource++plone-logged-in.js\n@@ -119,9 +119,9 @@ resources and bundles configured in the registry and compiles a JS/CSS bundle\n based on that configuration. See ``plone-compile-resources --help`` for more\n information.\n \n-When using the coredev buildout, ``plone-compile-resources`` script is\n-automatically generated. If you use a custom buildout, you might need to add\n-something similar to:\n+When using buildout, ``plone-compile-resources`` script is automatically\n+generated. If you use a custom buildout, you might need to add something\n+similar to:\n \n .. code-block:: ini\n   [buildout]\n@@ -150,7 +150,7 @@ What has changed since Plone 5.1\n - The bundle and resource registrations from ``Products.CMFPlone``'s\n   ``dependencies`` profile have also been moved here.\n - The ``plone-compile-resources`` script has been moved here.\n-- The ``thememapper`` bundle from plone.app.theming has been moved here.\n+- The ``thememapper`` bundle from ``plone.app.theming`` has been moved here.\n - The ``plone.resourceeditor`` bundle from ``plone.resourceeditor``\n   package has been moved here.\n - The ``toolbar`` pattern from ``Products.CMFPlone.static.toolbar`` has been\n"

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-06-18T15:48:20+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/a613933e739036e31af4e55fc696998e4a8f72ca

update docs

Files changed:
M README.rst

b'diff --git a/README.rst b/README.rst\nindex 180a333..9affde4 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -35,9 +35,10 @@ Integrators and Developers\n Who want to customize or maintain the front end of a Plone site for their\n customers:\n \n-- upgrade existing versions or install new ``npm`` packages\n+- upgrade existing versions or install new ``npm`` packages.\n+\n - integrate new JavaScript/CSS behavior, eventually wrapped in a ``pattern``\n-  for optimal integration and reuse within Plone front end ecosystem\n+  for optimal integration and reuse within Plone front end ecosystem.\n \n \n Themer authors\n@@ -45,9 +46,7 @@ Themer authors\n \n Who want to change the look and feel of a Plone site and need to:\n \n-- understand how to correctly bundle changes made into existing or new frontend\n-code\n-- XXX\n+- understand how to correctly bundle changes from existing or new frontend code.\n \n \n Plone Core Developers\n@@ -56,34 +55,32 @@ Plone Core Developers\n Who want to help enhance this add-on itself.\n \n \n-Workflow\n---------\n+Compiling bundles\n+-----------------\n \n-Default Plone buildout configuration adds an executable in\n+The default Plone buildout configuration adds an executable in\n ``./bin/plone-compile-resources`` which generates compiled bundles (normal,\n-minified and respective maps) in ``plone/staticresources/static/``.\n+minified and respective maps) in ``plone/staticresources/static/``\n+or whereever the ``csscompilation`` and ``jscompilation`` attributes of the bundle registration in the resource registry points to.\n \n .. note::\n \n   You can see all the options of this executable by running\n   ``./bin/plone-compile-resources --help``\n \n-The files in this directory are served by Plone. In production mode URLs will\n-be similar to:\n \n-- http://localhost:8080//++plone++static/++unique++2019-01-08%2006%3A53%3A49.000248/plone-compiled.min.js\n-- http://localhost:8080/++plone++static/++unique++2019-01-08%2006%3A53%3A49.040248/plone-logged-in-compiled.min.js\n+Building the ``plone`` bundle::\n \n-In development mode, XXX: Explain what happens, including how the roles of entry points like:\n+  ./bin/plone-compile-resources -b plone\n \n-- http://localhost:8080/++resource++plone.js\n-- http://localhost:8080/++resource++plone-logged-in.js\n-- http://demo.plone.org/++plone++static/plone.less\n-- http://localhost:8080//++plone++static/plone-logged-in.less\n \n+Building the ``plone-logged-in`` bundle::\n \n-How to develop on ``patterns``\n-------------------------------\n+  ./bin/plone-compile-resources -b plone-logged-in\n+\n+\n+Developing patterns\n+-------------------\n \n All JavaScript code in this package is downloaded via ``yarn`` into\n ``src/plone/staticresources/static/components``. Nothing in that directory\n@@ -100,13 +97,16 @@ How to upgrade the resources in this package\n \n - Increase ``npm`` package versions in ``package.json``, in sections\n ``dependencies`` or ``devDependencies``.\n-- Run ``yarn upgrade`` (cannot be ``npm``)\n+\n+- Run ``yarn upgrade`` (cannot be ``npm``).\n+\n - Run ``./bin/plone-compile-resources -b plone``,\n-  ``./bin/plone-compile-resources -b plone-logged-in`` and whatever bundle\n+  ``./bin/plone-compile-resources -b plone-logged-in`` or whatever bundle\n   you are going to build in your buildout\'s root directory.\n-  .. For more info on ``plone-compile-resources`` see: XXX\n+\n - Increase the ``last_compilation`` date in\n   ``src/plone/staticresources/profiles/default/registry/bundles.xml``.\n+\n - Submit a PR and run the tests on Jenkins.\n \n \n@@ -158,6 +158,53 @@ What has changed since Plone 5.1\n - ``mockup`` package now uses npm registry and yarn instead of bower.\n \n \n+The resource registry and it\'s production and development modes\n+---------------------------------------------------------------\n+\n+The files in  the directory ``plone/staticresources/static/`` are served by Plone.\n+In production mode Plone will combine the bundles (if configured) into single files.\n+The URLs will be similar to:\n+\n+- http://localhost:8080//++plone++production/++unique++2019-01-08%2006%3A53%3A49.000248/default.js\n+- http://localhost:8080//++plone++production/++unique++2019-01-08%2006%3A53%3A49.000248/default.css\n+\n+\n+In development mode all bundles are served separately as non-compiled versions.\n+The URLs will be similar to:\n+\n+\n+- http://localhost:8080/++resource++plone.js\n+- http://localhost:8080/++resource++plone-logged-in.js\n+- http://localhost:8080/++plone++static/plone.less\n+- http://localhost:8080//++plone++static/plone-logged-in.less\n+\n+\n+If you set the resource registry to development mode you can set "Develop JavaScript" and "Develop CSS" for individual bundles.\n+Then each of the bundle resources are served individually, which makes it easy to develop on Mockup.\n+In this case, the bundle resources are served from the Mockup package instead of plone.staticresources.\n+The URLs will be similar to:\n+\n+http://localhost:8080/Plone/++resource++mockup/livesearch/pattern.js\n+http://localhost:8080/Plone/++resource++mockup/livesearch/pattern.livesearch.less\n+\n+Have a look on how plone.staticresources and mockup register their resources:\n+\n+In ZCML:\n+\n+https://github.com/plone/mockup/blob/master/mockup/configure.zcml\n+https://github.com/plone/plone.staticresources/blob/master/src/plone/staticresources/configure.zcml\n+\n+In the resource registry:\n+\n+https://github.com/plone/plone.staticresources/blob/master/src/plone/staticresources/profiles/default/registry/bundles.xml\n+https://github.com/plone/plone.staticresources/blob/master/src/plone/staticresources/profiles/default/registry/resources.xml\n+\n+\n+For more information on the Plone resource registry see the documentation at:\n+\n+https://docs.plone.org/adapt-and-extend/theming/resourceregistry.html\n+\n+\n Warning\n -------\n \n'

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-06-18T15:52:17+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/1a7f6a45ba5bcaac0b271edf293bd1be851cef0e

formating

Files changed:
M README.rst

b"diff --git a/README.rst b/README.rst\nindex 9affde4..1917f8f 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -7,21 +7,15 @@ Static JS and CSS resources for Plone.\n \n This add-on contains all JavaScript and CSS resources used by Plone.\n \n-Prior to Plone 5.2, they were located in ``static/`` directory of\n-``Products.CMFPlone`` package.\n+Prior to Plone 5.2, they were located in ``static/`` directory of ``Products.CMFPlone`` package.\n \n-Due to the specific tooling and workflows used to build frontend resources, and\n-also the different maintenance and release needs of ``Products.CMFPlone``\n-itself, Plone static resources are now distributed in this package. For a\n-complete list of reasons, read the `PLIP 1653\n-<https://github.com/plone/Products.CMFPlone/issues/1653>`_.\n+Due to the specific tooling and workflows used to build frontend resources, and also the different maintenance and release needs of ``Products.CMFPlone`` itself, Plone static resources are now distributed in this package.\n+For a complete list of reasons, read the `PLIP 1653 <https://github.com/plone/Products.CMFPlone/issues/1653>`_.\n \n .. note::\n \n-  A note on yarn: we require the use of yarn, because it supports installing\n-  packages in a custom named directory, which npm does not (even using\n-  ``--prefix``, ``node_modules`` is hardcoded). Our package directory is\n-  located at: ``src/plone/staticresources/static/components``.\n+  A note on yarn: we require the use of yarn, because it supports installing packages in a custom named directory, which npm does not (even using ``--prefix``, ``node_modules`` is hardcoded).\n+  Our package directory is located at: ``src/plone/staticresources/static/components``.\n \n \n Target audience\n@@ -32,13 +26,11 @@ This documentation aims at:\n Integrators and Developers\n ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-Who want to customize or maintain the front end of a Plone site for their\n-customers:\n+Who want to customize or maintain the front end of a Plone site for their customers:\n \n - upgrade existing versions or install new ``npm`` packages.\n \n-- integrate new JavaScript/CSS behavior, eventually wrapped in a ``pattern``\n-  for optimal integration and reuse within Plone front end ecosystem.\n+- integrate new JavaScript/CSS behavior, eventually wrapped in a ``pattern`` for optimal integration and reuse within Plone front end ecosystem.\n \n \n Themer authors\n@@ -58,15 +50,12 @@ Who want to help enhance this add-on itself.\n Compiling bundles\n -----------------\n \n-The default Plone buildout configuration adds an executable in\n-``./bin/plone-compile-resources`` which generates compiled bundles (normal,\n-minified and respective maps) in ``plone/staticresources/static/``\n-or whereever the ``csscompilation`` and ``jscompilation`` attributes of the bundle registration in the resource registry points to.\n+The default Plone buildout configuration adds an executable in ``./bin/plone-compile-resources``.\n+This script generates compiled bundles (normal, minified and respective maps) in ``plone/staticresources/static/`` or whereever the ``csscompilation`` and ``jscompilation`` attributes of the bundle registration in the resource registry points to.\n \n .. note::\n \n-  You can see all the options of this executable by running\n-  ``./bin/plone-compile-resources --help``\n+  You can see all the options of this executable by running ``./bin/plone-compile-resources --help``\n \n \n Building the ``plone`` bundle::\n@@ -82,10 +71,9 @@ Building the ``plone-logged-in`` bundle::\n Developing patterns\n -------------------\n \n-All JavaScript code in this package is downloaded via ``yarn`` into\n-``src/plone/staticresources/static/components``. Nothing in that directory\n-should be manually edited. If you need to fix something, do it in the original\n-repository and eventually upgrade its version (next section).\n+All JavaScript code in this package is downloaded via ``yarn`` into ``src/plone/staticresources/static/components``.\n+Nothing in that directory should be manually edited.\n+If you need to fix something, do it in the original repository and eventually upgrade its version (next section).\n \n For Mockup, the original repository is: https://github.com/plone/mockup/\n \n@@ -95,17 +83,13 @@ For Patternslib, visit: http://github.com/patternslib/Patterns\n How to upgrade the resources in this package\n --------------------------------------------\n \n-- Increase ``npm`` package versions in ``package.json``, in sections\n-``dependencies`` or ``devDependencies``.\n+- Increase ``npm`` package versions in ``package.json``, in sections ``dependencies`` or ``devDependencies``.\n \n - Run ``yarn upgrade`` (cannot be ``npm``).\n \n-- Run ``./bin/plone-compile-resources -b plone``,\n-  ``./bin/plone-compile-resources -b plone-logged-in`` or whatever bundle\n-  you are going to build in your buildout's root directory.\n+- Run ``./bin/plone-compile-resources -b plone``, ``./bin/plone-compile-resources -b plone-logged-in`` or whatever bundle you are going to build in your buildout's root directory.\n \n-- Increase the ``last_compilation`` date in\n-  ``src/plone/staticresources/profiles/default/registry/bundles.xml``.\n+- Increase the ``last_compilation`` date in ``src/plone/staticresources/profiles/default/registry/bundles.xml``.\n \n - Submit a PR and run the tests on Jenkins.\n \n@@ -113,15 +97,11 @@ How to upgrade the resources in this package\n How to generate the ``plone-compile-resources`` script\n ------------------------------------------------------\n \n-The ``plone-compile-resources`` script can be used to compile bundles from the\n-command line. In short, the script starts up a Plone instance, reads the\n-resources and bundles configured in the registry and compiles a JS/CSS bundle\n-based on that configuration. See ``plone-compile-resources --help`` for more\n-information.\n+The ``plone-compile-resources`` script can be used to compile bundles from the command line.\n+In short, the script starts up a Plone instance, reads the resources and bundles configured in the registry and compiles a JS/CSS bundle based on that configuration. See ``plone-compile-resources --help`` for more information.\n \n-When using buildout, ``plone-compile-resources`` script is automatically\n-generated. If you use a custom buildout, you might need to add something\n-similar to:\n+When using buildout, ``plone-compile-resources`` script is automatically generated.\n+If you use a custom buildout, you might need to add something similar to:\n \n .. code-block:: ini\n   [buildout]\n@@ -145,16 +125,18 @@ similar to:\n What has changed since Plone 5.1\n --------------------------------\n \n-- All static resources - bundle resources, compiled bundles, external packages -\n-  from ``Products.CMFPlone.static`` have been moved here.\n-- The bundle and resource registrations from ``Products.CMFPlone``'s\n-  ``dependencies`` profile have also been moved here.\n+- All static resources - bundle resources, compiled bundles, external packages - from ``Products.CMFPlone.static`` have been moved here.\n+\n+- The bundle and resource registrations from ``Products.CMFPlone``'s ``dependencies`` profile have also been moved here.\n+\n - The ``plone-compile-resources`` script has been moved here.\n+\n - The ``thememapper`` bundle from ``plone.app.theming`` has been moved here.\n-- The ``plone.resourceeditor`` bundle from ``plone.resourceeditor``\n-  package has been moved here.\n-- The ``toolbar`` pattern from ``Products.CMFPlone.static.toolbar`` has been\n-  moved to ``mockup`` package.\n+\n+- The ``plone.resourceeditor`` bundle from ``plone.resourceeditor`` package has been moved here.\n+\n+- The ``toolbar`` pattern from ``Products.CMFPlone.static.toolbar`` has been moved to ``mockup`` package.\n+\n - ``mockup`` package now uses npm registry and yarn instead of bower.\n \n \n@@ -208,9 +190,10 @@ https://docs.plone.org/adapt-and-extend/theming/resourceregistry.html\n Warning\n -------\n \n-If you update ``r.js`` or ``less``, you willl need to manually re-apply a patch\n-that gives us cache busting resource downloads so we can build through the web. See:\n+If you update ``r.js`` or ``less``, you willl need to manually re-apply a patch that gives us cache busting resource downloads so we can build through the web. See:\n+\n - https://github.com/plone/Products.CMFPlone/commit/2d3865805efc6b72dce236eb68e502d8c57717b6\n+\n - https://github.com/plone/Products.CMFPlone/commit/bd1f9ba99d1ad40bb7fe1c00eaa32b8884aae5e2\n \n \n"

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-06-18T15:55:27+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/80464b7929b23b2dc78bbb3c3adcfd15b8b2621e

Merge pull request #13 from plone/thet-docs

More documentation improvements (WIP)

Files changed:
M README.rst

b'diff --git a/README.rst b/README.rst\nindex 4dd1e37..1917f8f 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -5,23 +5,17 @@ plone.staticresources\n Static JS and CSS resources for Plone.\n \n \n-This add on contains all JavaScript and CSS resources used by Plone.\n+This add-on contains all JavaScript and CSS resources used by Plone.\n \n-Prior to Plone 5.2, they were located in ``static/`` directory of\n-``Products.CMFPlone`` package.\n+Prior to Plone 5.2, they were located in ``static/`` directory of ``Products.CMFPlone`` package.\n \n-Due to the specific tooling and workflows used to build frontend resources, and\n-also the different maintenance and release needs of ``Products.CMFPlone``\n-itself, Plone static resources are now distributed in this package. For a\n-complete list of reasons, read the\xc2\xa7 `PLIP\n-1653<https://github.com/plone/Products.CMFPlone/issues/1653>`_.\n+Due to the specific tooling and workflows used to build frontend resources, and also the different maintenance and release needs of ``Products.CMFPlone`` itself, Plone static resources are now distributed in this package.\n+For a complete list of reasons, read the `PLIP 1653 <https://github.com/plone/Products.CMFPlone/issues/1653>`_.\n \n .. note::\n \n-  A note on yarn: We require the use of yarn, because it supports installing\n-  packages in a custom named directory, which npm doesn\'t (even using\n-  ``--prefix``, ``node_modules`` is hardcoded). Our package directory is\n-  located at: ``src/plone/staticresources/static/components``.\n+  A note on yarn: we require the use of yarn, because it supports installing packages in a custom named directory, which npm does not (even using ``--prefix``, ``node_modules`` is hardcoded).\n+  Our package directory is located at: ``src/plone/staticresources/static/components``.\n \n \n Target audience\n@@ -32,63 +26,54 @@ This documentation aims at:\n Integrators and Developers\n ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-Who want to customize and/or maintain the frontend of a Plone site for their\n-customers:\n+Who want to customize or maintain the front end of a Plone site for their customers:\n \n-- upgrade existing versions or install new ``npm`` packages\n-- integrate new JavaScript/CSS behavior, eventually wrapped in a ``pattern``\n-for optimal integration and reuse within Plone frontend ecosystem\n+- upgrade existing versions or install new ``npm`` packages.\n \n+- integrate new JavaScript/CSS behavior, eventually wrapped in a ``pattern`` for optimal integration and reuse within Plone front end ecosystem.\n \n-Themers\n-^^^^^^^\n+\n+Themer authors\n+^^^^^^^^^^^^^^\n \n Who want to change the look and feel of a Plone site and need to:\n \n-- understand how to correctly bundle changes made into existing or new frontend\n-code\n--\n+- understand how to correctly bundle changes from existing or new frontend code.\n \n \n Plone Core Developers\n ^^^^^^^^^^^^^^^^^^^^^\n \n-Who want to want to help add/enhance this add-on itself.\n+Who want to help enhance this add-on itself.\n \n \n-Workflow\n---------\n+Compiling bundles\n+-----------------\n \n-Default Plone buildout configuration adds an executable in\n-`./bin/plone-compile-resources` which generates compiled bundles (normal,\n-minified and respective maps) in `plone/staticresources/static/`.\n+The default Plone buildout configuration adds an executable in ``./bin/plone-compile-resources``.\n+This script generates compiled bundles (normal, minified and respective maps) in ``plone/staticresources/static/`` or whereever the ``csscompilation`` and ``jscompilation`` attributes of the bundle registration in the resource registry points to.\n \n .. note::\n \n-  You can see all the options of this executable by running\n-  ``./bin/plone-compile-resources --help``\n+  You can see all the options of this executable by running ``./bin/plone-compile-resources --help``\n \n-The files in this directory are served by Plone. In production mode URLs will\n-be similar to:\n \n-- http://localhost:8080//++plone++static/++unique++2019-01-08%2006%3A53%3A49.000248/plone-compiled.min.js\n-- http://localhost:8080/++plone++static/++unique++2019-01-08%2006%3A53%3A49.040248/plone-logged-in-compiled.min.js\n+Building the ``plone`` bundle::\n \n-In development mode, XXX: Explain what happens/entry point roles of:\n+  ./bin/plone-compile-resources -b plone\n \n-- http://localhost:8080/++resource++plone.js\n-- http://localhost:8080/++resource++plone-logged-in.js\n-- http://demo.plone.org/++plone++static/plone.less\n-- http://localhost:8080//++plone++static/plone-logged-in.less\n \n+Building the ``plone-logged-in`` bundle::\n+\n+  ./bin/plone-compile-resources -b plone-logged-in\n \n-How to develop on ``patterns``\n-------------------------------\n \n-All JavaScript code in this package is downloaded via ``yarn`` into\n-``src/plone/staticresources/static/components``. Nothing in that directory\n-should be manually edited. If you need to fix something, do it in the original\n-repository and eventually upgrade its version (next section).\n+Developing patterns\n+-------------------\n+\n+All JavaScript code in this package is downloaded via ``yarn`` into ``src/plone/staticresources/static/components``.\n+Nothing in that directory should be manually edited.\n+If you need to fix something, do it in the original repository and eventually upgrade its version (next section).\n \n For Mockup, the original repository is: https://github.com/plone/mockup/\n \n@@ -98,30 +83,25 @@ For Patternslib, visit: http://github.com/patternslib/Patterns\n How to upgrade the resources in this package\n --------------------------------------------\n \n-- Increase ``npm`` package versions in ``package.json``, i.e. sections\n-``dependencies`` or ``devDependencies``.\n-- Run ``yarn upgrade`` (cannot be ``npm``)\n-- Run ``./bin/plone-compile-resources -b plone``,\n-``./bin/plone-compile-resources -b plone-logged-in`` and whatever bundle you\'re\n-going to build in your buildout\'s root directory.\n-  .. For more info on ``plone-compile-resources`` see: XXX\n-- Increase the ``last_compilation`` date in\n-``src/plone/staticresources/profiles/default/registry/bundles.xml``.\n+- Increase ``npm`` package versions in ``package.json``, in sections ``dependencies`` or ``devDependencies``.\n+\n+- Run ``yarn upgrade`` (cannot be ``npm``).\n+\n+- Run ``./bin/plone-compile-resources -b plone``, ``./bin/plone-compile-resources -b plone-logged-in`` or whatever bundle you are going to build in your buildout\'s root directory.\n+\n+- Increase the ``last_compilation`` date in ``src/plone/staticresources/profiles/default/registry/bundles.xml``.\n+\n - Submit a PR and run the tests on Jenkins.\n \n \n How to generate the ``plone-compile-resources`` script\n ------------------------------------------------------\n \n-The ``plone-compile-resources`` script can be used to compile bundles from the\n-command line. In a glimpse, the script starts up a Plone instance, reads the\n-resources and bundles configured in the registry and compiles a JS/CSS bundle\n-based on that configuration. See ``plone-compile-resources --help`` for more\n-information.\n+The ``plone-compile-resources`` script can be used to compile bundles from the command line.\n+In short, the script starts up a Plone instance, reads the resources and bundles configured in the registry and compiles a JS/CSS bundle based on that configuration. See ``plone-compile-resources --help`` for more information.\n \n-When using the coredev buildout, ``plone-compile-resources`` script is\n-automatically generated. If you use a custom buildout, you might need to add\n-something similar to:\n+When using buildout, ``plone-compile-resources`` script is automatically generated.\n+If you use a custom buildout, you might need to add something similar to:\n \n .. code-block:: ini\n   [buildout]\n@@ -145,26 +125,75 @@ something similar to:\n What has changed since Plone 5.1\n --------------------------------\n \n-- All static resources - bundle resources, compiled bundles, external packages -\n-from ``Products.CMFPlone.static`` have been moved here.\n-- The bundle and resource registrations from ``Products.CMFPlone``\'s\n-``dependencies`` profile have also been moved here.\n+- All static resources - bundle resources, compiled bundles, external packages - from ``Products.CMFPlone.static`` have been moved here.\n+\n+- The bundle and resource registrations from ``Products.CMFPlone``\'s ``dependencies`` profile have also been moved here.\n+\n - The ``plone-compile-resources`` script has been moved here.\n-- The ``thememapper`` bundle from plone.app.theming has been moved here.\n-- The ``plone.resourceeditor`` bundle from ``plone.resourceeditor``\n-package has been moved here.\n-- The ``toolbar`` pattern from ``Products.CMFPlone.static.toolbar`` has been\n-moved to ``mockup`` package.\n+\n+- The ``thememapper`` bundle from ``plone.app.theming`` has been moved here.\n+\n+- The ``plone.resourceeditor`` bundle from ``plone.resourceeditor`` package has been moved here.\n+\n+- The ``toolbar`` pattern from ``Products.CMFPlone.static.toolbar`` has been moved to ``mockup`` package.\n+\n - ``mockup`` package now uses npm registry and yarn instead of bower.\n \n \n+The resource registry and it\'s production and development modes\n+---------------------------------------------------------------\n+\n+The files in  the directory ``plone/staticresources/static/`` are served by Plone.\n+In production mode Plone will combine the bundles (if configured) into single files.\n+The URLs will be similar to:\n+\n+- http://localhost:8080//++plone++production/++unique++2019-01-08%2006%3A53%3A49.000248/default.js\n+- http://localhost:8080//++plone++production/++unique++2019-01-08%2006%3A53%3A49.000248/default.css\n+\n+\n+In development mode all bundles are served separately as non-compiled versions.\n+The URLs will be similar to:\n+\n+\n+- http://localhost:8080/++resource++plone.js\n+- http://localhost:8080/++resource++plone-logged-in.js\n+- http://localhost:8080/++plone++static/plone.less\n+- http://localhost:8080//++plone++static/plone-logged-in.less\n+\n+\n+If you set the resource registry to development mode you can set "Develop JavaScript" and "Develop CSS" for individual bundles.\n+Then each of the bundle resources are served individually, which makes it easy to develop on Mockup.\n+In this case, the bundle resources are served from the Mockup package instead of plone.staticresources.\n+The URLs will be similar to:\n+\n+http://localhost:8080/Plone/++resource++mockup/livesearch/pattern.js\n+http://localhost:8080/Plone/++resource++mockup/livesearch/pattern.livesearch.less\n+\n+Have a look on how plone.staticresources and mockup register their resources:\n+\n+In ZCML:\n+\n+https://github.com/plone/mockup/blob/master/mockup/configure.zcml\n+https://github.com/plone/plone.staticresources/blob/master/src/plone/staticresources/configure.zcml\n+\n+In the resource registry:\n+\n+https://github.com/plone/plone.staticresources/blob/master/src/plone/staticresources/profiles/default/registry/bundles.xml\n+https://github.com/plone/plone.staticresources/blob/master/src/plone/staticresources/profiles/default/registry/resources.xml\n+\n+\n+For more information on the Plone resource registry see the documentation at:\n+\n+https://docs.plone.org/adapt-and-extend/theming/resourceregistry.html\n+\n+\n Warning\n -------\n \n-If you update ``r.js`` or ``less``, you\'ll need to manually re-apply a patch\n-that gets us cache busting resource downloads so we can build through the web. See:\n+If you update ``r.js`` or ``less``, you willl need to manually re-apply a patch that gives us cache busting resource downloads so we can build through the web. See:\n+\n - https://github.com/plone/Products.CMFPlone/commit/2d3865805efc6b72dce236eb68e502d8c57717b6\n-and\n+\n - https://github.com/plone/Products.CMFPlone/commit/bd1f9ba99d1ad40bb7fe1c00eaa32b8884aae5e2\n \n \n'

