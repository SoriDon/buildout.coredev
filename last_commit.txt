Repository: plone.restapi


Branch: refs/heads/master
Date: 2019-05-07T16:39:22+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.restapi/commit/8edd880ee2e6b6906626b5505d3cde392648c56a

Fix invalid auth token response msgs.

Files changed:
M src/plone/restapi/services/auth/renew.py
M src/plone/restapi/tests/test_auth.py

b'diff --git a/src/plone/restapi/services/auth/renew.py b/src/plone/restapi/services/auth/renew.py\nindex 258e3b05..cbf18325 100644\n--- a/src/plone/restapi/services/auth/renew.py\n+++ b/src/plone/restapi/services/auth/renew.py\n@@ -10,6 +10,7 @@\n class Renew(Service):\n     """Renew authentication token\n     """\n+\n     def reply(self):\n         plugin = None\n         acl_users = getToolByName(self, "acl_users")\n@@ -36,8 +37,8 @@ def reply(self):\n             # Don\'t generate authentication tokens for anonymous users.\n             self.request.response.setStatus(401)\n             return dict(error=dict(\n-                type=\'Invalid authentication token\',\n-                message=\'The authentication token is invalid.\'))\n+                type=\'Invalid or expired authentication token\',\n+                message=\'The authentication token is invalid or expired.\'))\n         user = mtool.getAuthenticatedMember()\n         payload = {}\n         payload[\'fullname\'] = user.getProperty(\'fullname\')\ndiff --git a/src/plone/restapi/tests/test_auth.py b/src/plone/restapi/tests/test_auth.py\nindex 0d996158..20889aa6 100644\n--- a/src/plone/restapi/tests/test_auth.py\n+++ b/src/plone/restapi/tests/test_auth.py\n@@ -202,5 +202,5 @@ def test_renew_fails_on_invalid_token(self):\n         )\n         self.assertEqual(\n             res[\'error\'][\'type\'],\n-            \'Invalid authentication token\'\n+            \'Invalid or expired authentication token\'\n         )\n'

