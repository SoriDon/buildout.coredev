Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2017-02-16T11:45:37+02:00
Author: Tiberiu Ichim (tiberiuichim) <tiberiu.ichim@gmail.com>
Commit: https://github.com/plone/plone.app.iterate/commit/a3c13406a66a262e7411c5de0b517beba9348e03

Products.CMFPlacefulWorkflow requires workflow policy id to be bytestring

Files changed:
M CHANGES.rst
M plone/app/iterate/interfaces.py
M plone/app/iterate/subscribers/workflow.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 701375c..4a6f01a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Change ``IIterateSettings.checkout_workflow_policy`` to ASCIILine,
+  as required by ``Products.CMFWorkflowPolicy``.
 
 
 3.3.1 (2017-02-12)
diff --git a/plone/app/iterate/interfaces.py b/plone/app/iterate/interfaces.py
index 3262538..e195c17 100644
--- a/plone/app/iterate/interfaces.py
+++ b/plone/app/iterate/interfaces.py
@@ -321,7 +321,7 @@ class IIterateSettings(Interface):
         required=False
     )
 
-    checkout_workflow_policy = schema.TextLine(
+    checkout_workflow_policy = schema.ASCIILine(
         title=_(u'Checkout workflow policy'),
         description=u'',
         default=u'checkout_workflow_policy',
diff --git a/plone/app/iterate/subscribers/workflow.py b/plone/app/iterate/subscribers/workflow.py
index e4a1dd9..572245e 100644
--- a/plone/app/iterate/subscribers/workflow.py
+++ b/plone/app/iterate/subscribers/workflow.py
@@ -47,7 +47,7 @@ def handleCheckout(event):
     settings = registry.forInterface(IIterateSettings)
     if not settings.enable_checkout_workflow:
         return
-    policy_id = settings.checkout_workflow_policy
+    policy_id = str(settings.checkout_workflow_policy)
 
     existing_policy = getattr(
         aq_base(event.working_copy), WorkflowPolicyConfig_id, None)


Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2017-02-20T16:45:20+01:00
Author: Tiberiu Ichim (tiberiuichim) <tiberiu.ichim@gmail.com>
Commit: https://github.com/plone/plone.app.iterate/commit/1f32721d89ab48391a918a8baa9523c52fc7a9cc

Use string instead of unicode for checkout_workflow_policy default

Files changed:
M plone/app/iterate/interfaces.py

diff --git a/plone/app/iterate/interfaces.py b/plone/app/iterate/interfaces.py
index e195c17..b671536 100644
--- a/plone/app/iterate/interfaces.py
+++ b/plone/app/iterate/interfaces.py
@@ -324,6 +324,6 @@ class IIterateSettings(Interface):
     checkout_workflow_policy = schema.ASCIILine(
         title=_(u'Checkout workflow policy'),
         description=u'',
-        default=u'checkout_workflow_policy',
+        default='checkout_workflow_policy',
         required=True
     )


Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2017-03-07T11:04:33+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.iterate/commit/2ce9eca63de6defd2ade9edf3a96c6897d7f3d83

Merge pull request #40 from tiberiuichim/master

Products.CMFPlacefulWorkflow requires workflow policy id to be byteststring

Files changed:
M CHANGES.rst
M plone/app/iterate/interfaces.py
M plone/app/iterate/subscribers/workflow.py

diff --git a/CHANGES.rst b/CHANGES.rst
index fa0bc9e..95c8890 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -15,7 +15,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Change ``IIterateSettings.checkout_workflow_policy`` to ASCIILine,
+  as required by ``Products.CMFWorkflowPolicy``.
 
 
 3.3.1 (2017-02-12)
diff --git a/plone/app/iterate/interfaces.py b/plone/app/iterate/interfaces.py
index 3262538..b671536 100644
--- a/plone/app/iterate/interfaces.py
+++ b/plone/app/iterate/interfaces.py
@@ -321,9 +321,9 @@ class IIterateSettings(Interface):
         required=False
     )
 
-    checkout_workflow_policy = schema.TextLine(
+    checkout_workflow_policy = schema.ASCIILine(
         title=_(u'Checkout workflow policy'),
         description=u'',
-        default=u'checkout_workflow_policy',
+        default='checkout_workflow_policy',
         required=True
     )
diff --git a/plone/app/iterate/subscribers/workflow.py b/plone/app/iterate/subscribers/workflow.py
index e4a1dd9..572245e 100644
--- a/plone/app/iterate/subscribers/workflow.py
+++ b/plone/app/iterate/subscribers/workflow.py
@@ -47,7 +47,7 @@ def handleCheckout(event):
     settings = registry.forInterface(IIterateSettings)
     if not settings.enable_checkout_workflow:
         return
-    policy_id = settings.checkout_workflow_policy
+    policy_id = str(settings.checkout_workflow_policy)
 
     existing_policy = getattr(
         aq_base(event.working_copy), WorkflowPolicyConfig_id, None)


