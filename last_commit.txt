Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2018-06-24T14:53:42+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/38ad3591eb1a96783f75fe44740fda8677229acf

fix tests for py3

Files changed:
M Products/CMFQuickInstallerTool/tests/testSetup.py
M Products/CMFQuickInstallerTool/tests/test_browser.py

b"diff --git a/Products/CMFQuickInstallerTool/tests/testSetup.py b/Products/CMFQuickInstallerTool/tests/testSetup.py\nindex 9a12262..44288a2 100644\n--- a/Products/CMFQuickInstallerTool/tests/testSetup.py\n+++ b/Products/CMFQuickInstallerTool/tests/testSetup.py\n@@ -41,6 +41,18 @@ def test_getToolByName(self):\n             getToolByName(self.portal, 'portal_quickinstaller', None))\n \n     def test_uninstall_self_via_portal_setup(self):\n+        self.assertTrue('portal_quickinstaller' in self.portal.objectIds())\n+        from Products.GenericSetup import profile_registry\n+        from Products.GenericSetup import EXTENSION\n+        profile_registry.registerProfile(\n+            'uninstall',\n+            'CMFQI uninstall profile',\n+            'Uninstall profile for CMFQuickInstallerTool',\n+            'profiles/uninstall',\n+            'Products.CMFQuickInstallerTool',\n+            EXTENSION,\n+            for_=None)\n+\n         setup_tool = self.portal.portal_setup\n         setup_tool.runAllImportStepsFromProfile(\n             'Products.CMFQuickInstallerTool:uninstall')\ndiff --git a/Products/CMFQuickInstallerTool/tests/test_browser.py b/Products/CMFQuickInstallerTool/tests/test_browser.py\nindex 1056127..01a7390 100644\n--- a/Products/CMFQuickInstallerTool/tests/test_browser.py\n+++ b/Products/CMFQuickInstallerTool/tests/test_browser.py\n@@ -97,7 +97,7 @@ def test_installProducts_post(self):\n         # First we need to get a url so we have a referer to get back to.\n         # Otherwise we get a redirect to '', which means to 'installProducts',\n         # which will fail because it is a GET request.\n-        self.browser.open(qi.absolute_url())\n+        self.browser.open(qi.absolute_url() + '/manage_installProductsForm')\n         # Now the POST.\n         self.browser.post(url, 'products:list=%s&_authenticator=%s' % (\n             product, csrf_token))\n@@ -106,7 +106,7 @@ def test_installProducts_post(self):\n                         'Failed to install %s' % product)\n         self.assertEqual(\n             self.browser.url,\n-            'http://nohost/plone/portal_quickinstaller')\n+            'http://nohost/plone/portal_quickinstaller/manage_installProductsForm')\n \n     def test_installProducts_get(self):\n         # Now with a GET request.\n"

Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2018-06-27T00:07:45+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/0da97e3c3a2598b4342a48c5cecd13f2c6285fd1

InitializeClass was moved to AccessControl.class_init

Files changed:
M Products/CMFQuickInstallerTool/InstalledProduct.py
M Products/CMFQuickInstallerTool/QuickInstallerTool.py

b'diff --git a/Products/CMFQuickInstallerTool/InstalledProduct.py b/Products/CMFQuickInstallerTool/InstalledProduct.py\nindex 6aa872f..db6d150 100644\n--- a/Products/CMFQuickInstallerTool/InstalledProduct.py\n+++ b/Products/CMFQuickInstallerTool/InstalledProduct.py\n@@ -1,7 +1,7 @@\n # -*- coding: utf-8 -*-\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from DateTime import DateTime\n from OFS.SimpleItem import SimpleItem\n from Products.CMFCore.permissions import ManagePortal\ndiff --git a/Products/CMFQuickInstallerTool/QuickInstallerTool.py b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\nindex 961cc7e..a2c51fe 100644\n--- a/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n+++ b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n@@ -5,7 +5,7 @@\n from Acquisition import aq_get\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.config import getConfiguration\n from OFS.ObjectManager import ObjectManager\n from OFS.SimpleItem import SimpleItem\n'

Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2018-08-08T23:55:19+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/d1469e58f8de857f60e46b2445f0d6b0236a8e7e

Make the test pass on Python 2 and Python 3

Files changed:
M Products/CMFQuickInstallerTool/tests/install.txt

b"diff --git a/Products/CMFQuickInstallerTool/tests/install.txt b/Products/CMFQuickInstallerTool/tests/install.txt\nindex c9a750c..ee4201e 100644\n--- a/Products/CMFQuickInstallerTool/tests/install.txt\n+++ b/Products/CMFQuickInstallerTool/tests/install.txt\n@@ -225,13 +225,13 @@ Installing the product now runs the default-profile.\n \n Make sure the property was set by the default-profile.\n \n-  >>> 'UninstallTest' in sp.getProperty('default_page_types', [])\n+  >>> b'UninstallTest' in sp.getProperty('default_page_types', [])\n   True\n \n There is no uninstall-profile yet, so the property is kept on uninstalling.\n \n   >>> qi.getUninstallProfile('QITest4')\n-  >>> 'UninstallTest' in sp.getProperty('default_page_types', [])\n+  >>> b'UninstallTest' in sp.getProperty('default_page_types', [])\n   True\n \n Install again.\n@@ -251,5 +251,5 @@ Register a uninstall profile that points to the profiles/test_uninstall\n Uninstalling now runs the uninstall-profile, thus removing the property.\n \n   >>> qi.uninstallProducts(products=['QITest4'])\n-  >>> 'UninstallTest' in sp.getProperty('default_page_types', [])\n+  >>> b'UninstallTest' in sp.getProperty('default_page_types', [])\n   False\n"

Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2018-08-08T23:55:34+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/742d3ae48b4a11022679bc486a8679003b6a4214

Update changelog

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 53f5b46..e3b172b 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -20,8 +20,8 @@ New features:\n \n Bug fixes:\n \n-- Fix relative imports for py3\n-  [pbauer]\n+- Python 2 / 3 compatability\n+  [ale-rt, jensens, pbauer]\n \n \n 3.0.16 (2018-01-30)\n'

Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2018-08-14T21:10:53+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/1dc4b50ba6cddfa25f9d268fd435b57928f69c21

fix test for py2

Files changed:
M Products/CMFQuickInstallerTool/tests/testSetup.py

b"diff --git a/Products/CMFQuickInstallerTool/tests/testSetup.py b/Products/CMFQuickInstallerTool/tests/testSetup.py\nindex 44288a2..0944bf9 100644\n--- a/Products/CMFQuickInstallerTool/tests/testSetup.py\n+++ b/Products/CMFQuickInstallerTool/tests/testSetup.py\n@@ -42,18 +42,20 @@ def test_getToolByName(self):\n \n     def test_uninstall_self_via_portal_setup(self):\n         self.assertTrue('portal_quickinstaller' in self.portal.objectIds())\n-        from Products.GenericSetup import profile_registry\n-        from Products.GenericSetup import EXTENSION\n-        profile_registry.registerProfile(\n-            'uninstall',\n-            'CMFQI uninstall profile',\n-            'Uninstall profile for CMFQuickInstallerTool',\n-            'profiles/uninstall',\n-            'Products.CMFQuickInstallerTool',\n-            EXTENSION,\n-            for_=None)\n-\n         setup_tool = self.portal.portal_setup\n+        name = 'Products.CMFQuickInstallerTool:uninstall'\n+        if name not in [i['id'] for i in setup_tool.listProfileInfo()]:\n+            from Products.GenericSetup import profile_registry\n+            from Products.GenericSetup import EXTENSION\n+            profile_registry.registerProfile(\n+                'uninstall',\n+                'CMFQI uninstall profile',\n+                'Uninstall profile for CMFQuickInstallerTool',\n+                'profiles/uninstall',\n+                'Products.CMFQuickInstallerTool',\n+                EXTENSION,\n+                for_=None)\n+\n         setup_tool.runAllImportStepsFromProfile(\n             'Products.CMFQuickInstallerTool:uninstall')\n         self.assertFalse('portal_quickinstaller' in self.portal.objectIds())\n"

Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2018-08-16T08:25:17+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/5142e900d901e227b486754fd3986c4800e052c4

Merge pull request #20 from plone/python3

fix tests for py3

Files changed:
M CHANGES.rst
M Products/CMFQuickInstallerTool/InstalledProduct.py
M Products/CMFQuickInstallerTool/QuickInstallerTool.py
M Products/CMFQuickInstallerTool/tests/install.txt
M Products/CMFQuickInstallerTool/tests/testSetup.py
M Products/CMFQuickInstallerTool/tests/test_browser.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 53f5b46..e3b172b 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -20,8 +20,8 @@ New features:\n \n Bug fixes:\n \n-- Fix relative imports for py3\n-  [pbauer]\n+- Python 2 / 3 compatability\n+  [ale-rt, jensens, pbauer]\n \n \n 3.0.16 (2018-01-30)\ndiff --git a/Products/CMFQuickInstallerTool/InstalledProduct.py b/Products/CMFQuickInstallerTool/InstalledProduct.py\nindex 6aa872f..db6d150 100644\n--- a/Products/CMFQuickInstallerTool/InstalledProduct.py\n+++ b/Products/CMFQuickInstallerTool/InstalledProduct.py\n@@ -1,7 +1,7 @@\n # -*- coding: utf-8 -*-\n from AccessControl import ClassSecurityInfo\n from Acquisition import aq_base\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from DateTime import DateTime\n from OFS.SimpleItem import SimpleItem\n from Products.CMFCore.permissions import ManagePortal\ndiff --git a/Products/CMFQuickInstallerTool/QuickInstallerTool.py b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\nindex 961cc7e..a2c51fe 100644\n--- a/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n+++ b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n@@ -5,7 +5,7 @@\n from Acquisition import aq_get\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n-from App.class_init import InitializeClass\n+from AccessControl.class_init import InitializeClass\n from App.config import getConfiguration\n from OFS.ObjectManager import ObjectManager\n from OFS.SimpleItem import SimpleItem\ndiff --git a/Products/CMFQuickInstallerTool/tests/install.txt b/Products/CMFQuickInstallerTool/tests/install.txt\nindex c9a750c..ee4201e 100644\n--- a/Products/CMFQuickInstallerTool/tests/install.txt\n+++ b/Products/CMFQuickInstallerTool/tests/install.txt\n@@ -225,13 +225,13 @@ Installing the product now runs the default-profile.\n \n Make sure the property was set by the default-profile.\n \n-  >>> 'UninstallTest' in sp.getProperty('default_page_types', [])\n+  >>> b'UninstallTest' in sp.getProperty('default_page_types', [])\n   True\n \n There is no uninstall-profile yet, so the property is kept on uninstalling.\n \n   >>> qi.getUninstallProfile('QITest4')\n-  >>> 'UninstallTest' in sp.getProperty('default_page_types', [])\n+  >>> b'UninstallTest' in sp.getProperty('default_page_types', [])\n   True\n \n Install again.\n@@ -251,5 +251,5 @@ Register a uninstall profile that points to the profiles/test_uninstall\n Uninstalling now runs the uninstall-profile, thus removing the property.\n \n   >>> qi.uninstallProducts(products=['QITest4'])\n-  >>> 'UninstallTest' in sp.getProperty('default_page_types', [])\n+  >>> b'UninstallTest' in sp.getProperty('default_page_types', [])\n   False\ndiff --git a/Products/CMFQuickInstallerTool/tests/testSetup.py b/Products/CMFQuickInstallerTool/tests/testSetup.py\nindex 9a12262..0944bf9 100644\n--- a/Products/CMFQuickInstallerTool/tests/testSetup.py\n+++ b/Products/CMFQuickInstallerTool/tests/testSetup.py\n@@ -41,7 +41,21 @@ def test_getToolByName(self):\n             getToolByName(self.portal, 'portal_quickinstaller', None))\n \n     def test_uninstall_self_via_portal_setup(self):\n+        self.assertTrue('portal_quickinstaller' in self.portal.objectIds())\n         setup_tool = self.portal.portal_setup\n+        name = 'Products.CMFQuickInstallerTool:uninstall'\n+        if name not in [i['id'] for i in setup_tool.listProfileInfo()]:\n+            from Products.GenericSetup import profile_registry\n+            from Products.GenericSetup import EXTENSION\n+            profile_registry.registerProfile(\n+                'uninstall',\n+                'CMFQI uninstall profile',\n+                'Uninstall profile for CMFQuickInstallerTool',\n+                'profiles/uninstall',\n+                'Products.CMFQuickInstallerTool',\n+                EXTENSION,\n+                for_=None)\n+\n         setup_tool.runAllImportStepsFromProfile(\n             'Products.CMFQuickInstallerTool:uninstall')\n         self.assertFalse('portal_quickinstaller' in self.portal.objectIds())\ndiff --git a/Products/CMFQuickInstallerTool/tests/test_browser.py b/Products/CMFQuickInstallerTool/tests/test_browser.py\nindex 1056127..01a7390 100644\n--- a/Products/CMFQuickInstallerTool/tests/test_browser.py\n+++ b/Products/CMFQuickInstallerTool/tests/test_browser.py\n@@ -97,7 +97,7 @@ def test_installProducts_post(self):\n         # First we need to get a url so we have a referer to get back to.\n         # Otherwise we get a redirect to '', which means to 'installProducts',\n         # which will fail because it is a GET request.\n-        self.browser.open(qi.absolute_url())\n+        self.browser.open(qi.absolute_url() + '/manage_installProductsForm')\n         # Now the POST.\n         self.browser.post(url, 'products:list=%s&_authenticator=%s' % (\n             product, csrf_token))\n@@ -106,7 +106,7 @@ def test_installProducts_post(self):\n                         'Failed to install %s' % product)\n         self.assertEqual(\n             self.browser.url,\n-            'http://nohost/plone/portal_quickinstaller')\n+            'http://nohost/plone/portal_quickinstaller/manage_installProductsForm')\n \n     def test_installProducts_get(self):\n         # Now with a GET request.\n"

