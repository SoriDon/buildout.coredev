Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2017-10-23T09:33:00+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/83b442e5f2bb0caace355789a9ba2c02619c6eb3

Fix test (partly cherry-picked from https://github.com/plone/Products.CMFPlone/commit/3b5eb0068284469365a71a9a3a683233fa5706b8)

Files changed:
M Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups.py

diff --git a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups.py b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups.py
index 901a13c44..ee099614d 100644
--- a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups.py
+++ b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups.py
@@ -295,18 +295,18 @@ def test_groups_modify_roles(self):
         self.browser.getControl(name='searchstring').value = 'group1'
 
         # Check that role is not selected yet and then select it and apply it.
-        self.assertFalse(self.browser.getControl(
-            name='group_group1:list', index=1
-        ).getControl(value='Contributor').selected)
-        self.browser.getControl(
-            name='group_group1:list', index=1
-        ).getControl(value='Contributor').selected = True
+        form = self.browser.getForm(id='groups_search')
+        ctrl = form._form.get('group_group1:list', index=1)
+        self.assertEqual(ctrl._value, 'Site Administrator')
+        self.assertFalse(ctrl.checked)
+        ctrl.checked = True
         self.browser.getControl('Save').click()
 
         # Check that role is now selected
-        self.browser.getControl(
-            name='group_group1:list', index=1
-        ).getControl(value='Contributor').selected
+        form = self.browser.getForm(id='groups_search')
+        ctrl = form._form.get('group_group1:list', index=1)
+        self.assertEqual(ctrl._value, 'Site Administrator')
+        self.assertTrue(ctrl.checked)
 
     def test_groups_delete_group(self):
         self.browser.open(self.groups_url)


