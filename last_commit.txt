Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-14T12:37:56+05:30
Author: rohnsha0 (rohnsha0) <rohnsha0@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/1175e41c299c6d29284dc2c16d69836675bc44cb

Fixed all known instances of plone.com in plone/Products.CMFPlone

Files changed:
M Products/CMFPlone/browser/templates/accessibility-info.pt
M Products/CMFPlone/browser/templates/ajax_main_template.pt
M Products/CMFPlone/browser/templates/colophon.pt
M Products/CMFPlone/browser/templates/footer.pt
M Products/CMFPlone/browser/templates/plone-frontpage.pt
M Products/CMFPlone/browser/templates/plone-overview.pt

b'diff --git a/Products/CMFPlone/browser/templates/accessibility-info.pt b/Products/CMFPlone/browser/templates/accessibility-info.pt\nindex 77e1609fec..1b7a1b15c2 100644\n--- a/Products/CMFPlone/browser/templates/accessibility-info.pt\n+++ b/Products/CMFPlone/browser/templates/accessibility-info.pt\n@@ -16,7 +16,7 @@\n \n \n       <p><tal:i18n i18n:translate="description_accessibility_info">\n-            This site uses the open source Content Management System <a href="https://plone.com" i18n:name="plone">Plone</a>.\n+            This site uses the open source Content Management System <a href="https://plone.org" i18n:name="plone">Plone</a>.\n             It meets the Web Content Accessibility Guidelines\n \t    (<a href="https://www.w3.org/TR/WCAG20/"><acronym i18n:name="wcag"\n                   title="Web Content Accessibility Guidelines"\ndiff --git a/Products/CMFPlone/browser/templates/ajax_main_template.pt b/Products/CMFPlone/browser/templates/ajax_main_template.pt\nindex 3f8ef8bc10..81eab03a4a 100644\n--- a/Products/CMFPlone/browser/templates/ajax_main_template.pt\n+++ b/Products/CMFPlone/browser/templates/ajax_main_template.pt\n@@ -40,7 +40,7 @@\n     <metal:javascriptslot define-slot="javascript_head_slot" />\n \n     <link tal:replace="structure provider:plone.htmlhead.links" />\n-    <meta name="generator" content="Plone - http://plone.com" />\n+    <meta name="generator" content="Plone - http://plone.org" />\n     </tal:ajaxhead>\n \n </head>\ndiff --git a/Products/CMFPlone/browser/templates/colophon.pt b/Products/CMFPlone/browser/templates/colophon.pt\nindex 3610b9ff92..8ee479c3ab 100644\n--- a/Products/CMFPlone/browser/templates/colophon.pt\n+++ b/Products/CMFPlone/browser/templates/colophon.pt\n@@ -8,7 +8,7 @@\n \n   <div class="card card-classic" id="portal-colophon" metal:define-macro="portlet">\n     <div class="card-body">\n-      <a href="http://plone.com" target="_blank"\n+      <a href="http://plone.org" target="_blank"\n          title="This site was built using the Plone Open Source CMS/WCM."\n          i18n:attributes="title title_built_with_plone;"\n          i18n:translate="label_powered_by_plone">\ndiff --git a/Products/CMFPlone/browser/templates/footer.pt b/Products/CMFPlone/browser/templates/footer.pt\nindex 85e77a2b11..2581534645 100644\n--- a/Products/CMFPlone/browser/templates/footer.pt\n+++ b/Products/CMFPlone/browser/templates/footer.pt\n@@ -12,7 +12,7 @@\n       <span i18n:translate="description_copyright" tal:omit-tag="">\n       The\n       <span i18n:name="plonecms" tal:omit-tag="">\n-           <a href="http://plone.com" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>\n+           <a href="http://plone.org" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>\n       </span>\n       is\n       <abbr title="Copyright" i18n:name="copyright" i18n:attributes="title title_copyright;">&copy;</abbr>\ndiff --git a/Products/CMFPlone/browser/templates/plone-frontpage.pt b/Products/CMFPlone/browser/templates/plone-frontpage.pt\nindex badf8795fe..dec2737973 100644\n--- a/Products/CMFPlone/browser/templates/plone-frontpage.pt\n+++ b/Products/CMFPlone/browser/templates/plone-frontpage.pt\n@@ -12,7 +12,7 @@\n \n   <div class="hero">\n     <h1>Welcome!</h1>\n-    <p><a class="btn btn-primary" href="https://plone.com" target="_blank">Learn more about Plone</a></p>\n+    <p><a class="btn btn-primary" href="https://plone.org" target="_blank">Learn more about Plone</a></p>\n   </div>\n \n   <p class="discreet">\n@@ -39,7 +39,7 @@ Before you start exploring your newly created Plone site, please do the followin\n <p>After that, we suggest you do one or more of the following:</p>\n \n <ul>\n-    <li>Find out <a class="link-plain" href="https://plone.com/features/" target="_blank">What\'s new in Plone</a>.</li>\n+    <li>Find out <a class="link-plain" href="https://plone.org/what-is-plone/plone" target="_blank">What\'s new in Plone</a>.</li>\n     <li>Read the <a class="link-plain" href="https://docs.plone.org" target="_blank">documentation</a>.</li>\n     <li>Follow a <a class="link-plain" href="https://training.plone.org" target="_blank">training</a>.</li>\n     <li>Explore the <a class="link-plain" href="https://plone.org/download/add-ons" target="_blank">available add-ons</a> for Plone.</li>\ndiff --git a/Products/CMFPlone/browser/templates/plone-overview.pt b/Products/CMFPlone/browser/templates/plone-overview.pt\nindex 2e1b2e50d3..c7dd976eb2 100644\n--- a/Products/CMFPlone/browser/templates/plone-overview.pt\n+++ b/Products/CMFPlone/browser/templates/plone-overview.pt\n@@ -31,14 +31,9 @@\n                 i18n:attributes="alt" /></p>\n         <h1 i18n:translate="">Plone is up and running.</h1>\n         <p class="lead">\n-            <span i18n:translate="label_plone_com_description"> For an introduction to Plone, success stories, demos, providers, visit</span>\n-            <a href="http://plone.com"\n-              title="Plone.com"\n-              target="_blank"\n-              i18n:attributes="title label_plone_com_title;">plone.com</a>.\n-            <span i18n:translate="label_plone_org_description"> For documentation, add-ons, support, community, visit</span>\n+            <span i18n:translate="label_plone_org_description"> For an introduction to Plone, documentation, demos, add-ons, support, and community, visit</span>\n             <a href="http://plone.org"\n-              title="Plone Community Home"\n+              title="Plone Homepage"\n               i18n:attributes="title label_plone_org_title;">plone.org</a>.\n           </p>\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-14T12:41:35+05:30
Author: rohnsha0 (rohnsha0) <rohnsha0@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/3f5f0df6fca767d57e6fb820b562433c28aed940

log entry for PR

Files changed:
A news/3568.bugfix

b'diff --git a/news/3568.bugfix b/news/3568.bugfix\nnew file mode 100644\nindex 0000000000..450997a173\n--- /dev/null\n+++ b/news/3568.bugfix\n@@ -0,0 +1,2 @@\n+Fixed all known instances of plone.com in plone/Products.CMFPlone\n+[rohnsha0]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-14T12:46:24+05:30
Author: Rohan Shaw (rohnsha0) <86848116+rohnsha0@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/be8781891908f59152e09bbc8411b819e5dd117d

Merge branch 'master' into Issue3568

Files changed:
A news/3581.bugfix
A news/3587.bugfix
M Products/CMFPlone/browser/configure.zcml
M Products/CMFPlone/browser/interfaces.py
M Products/CMFPlone/browser/main_template.py
M Products/CMFPlone/tests/testRegistrationTool.py

b'diff --git a/Products/CMFPlone/browser/configure.zcml b/Products/CMFPlone/browser/configure.zcml\nindex 419bbca7bc..4c3152dd4f 100644\n--- a/Products/CMFPlone/browser/configure.zcml\n+++ b/Products/CMFPlone/browser/configure.zcml\n@@ -99,6 +99,7 @@\n       for="*"\n       name="main_template"\n       class=".main_template.MainTemplate"\n+      allowed_interface=".interfaces.IMainTemplate"\n       permission="zope.Public"\n       />\n \ndiff --git a/Products/CMFPlone/browser/interfaces.py b/Products/CMFPlone/browser/interfaces.py\nindex 404b172258..9a09561e91 100644\n--- a/Products/CMFPlone/browser/interfaces.py\n+++ b/Products/CMFPlone/browser/interfaces.py\n@@ -1,4 +1,5 @@\n from zope import schema\n+from zope.interface import Attribute\n from zope.interface import Interface\n \n from plone.schema import Email\n@@ -189,6 +190,9 @@ def createSiteMap():\n class IMainTemplate(Interface):\n     """Interface to the view that generated the main_template"""\n \n+    macros = Attribute("Macros")\n+    template_name = Attribute("Template name")\n+\n \n class IGlobalStatusMessage(Interface):\n     """Interface to the view that generated the main_template"""\ndiff --git a/Products/CMFPlone/browser/main_template.py b/Products/CMFPlone/browser/main_template.py\nindex 707ca21284..b68867268e 100644\n--- a/Products/CMFPlone/browser/main_template.py\n+++ b/Products/CMFPlone/browser/main_template.py\n@@ -22,9 +22,9 @@ def template_name(self):\n \n     @property\n     def macros(self):\n-        # Reinstanciating the templatefile is a workaround for\n+        # Reinstantiating the templatefile is a workaround for\n         # https://github.com/plone/Products.CMFPlone/issues/2666\n-        # Without this a inifite recusion in a template\n+        # Without this an infinite recursion in a template\n         # (i.e. a template that calls its own view)\n         # kills the instance instead of raising a RecursionError.\n         return ViewPageTemplateFile(self.template_name).macros\ndiff --git a/Products/CMFPlone/tests/testRegistrationTool.py b/Products/CMFPlone/tests/testRegistrationTool.py\nindex d7d16eef9b..f9e722d42d 100644\n--- a/Products/CMFPlone/tests/testRegistrationTool.py\n+++ b/Products/CMFPlone/tests/testRegistrationTool.py\n@@ -242,7 +242,7 @@ def testMailPasswordEncoding(self):\n         mail_settings.email_from_address = \'bar@baz.com\'\n \n         # Set the portal email encoding\n-        mail_settings.email_charset = \'us-ascii\'\n+        self.assertEqual(mail_settings.email_charset, \'utf-8\')\n \n         from zope.publisher.browser import TestRequest\n         self.registration.mailPassword(member_id, TestRequest())\n@@ -250,7 +250,7 @@ def testMailPasswordEncoding(self):\n         msg = message_from_bytes(mails.messages[0])\n \n         # Ensure charset (and thus Content-Type) were set via template\n-        self.assertEqual(msg[\'Content-Type\'], \'text/plain; charset="us-ascii"\')\n+        self.assertEqual(msg[\'Content-Type\'], \'text/plain; charset="utf-8"\')\n \n \n class TestPasswordGeneration(PloneTestCase.PloneTestCase):\ndiff --git a/news/3581.bugfix b/news/3581.bugfix\nnew file mode 100644\nindex 0000000000..32eba96b1f\n--- /dev/null\n+++ b/news/3581.bugfix\n@@ -0,0 +1,2 @@\n+Allow access to the macros of the main_template, also from skin templates.\n+[maurits]\ndiff --git a/news/3587.bugfix b/news/3587.bugfix\nnew file mode 100644\nindex 0000000000..dd9e106c25\n--- /dev/null\n+++ b/news/3587.bugfix\n@@ -0,0 +1,2 @@\n+Change test to make sure e-mail is sent in utf-8\n+[erral]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-14T14:08:12+05:30
Author: Rohan Shaw (rohnsha0) <86848116+rohnsha0@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/dde117a175c307585ba1c5956f28291cdd74911c

Update Products/CMFPlone/browser/templates/plone-overview.pt

Co-authored-by: Steve Piercy &lt;web@stevepiercy.com&gt;

Files changed:
M Products/CMFPlone/browser/templates/plone-overview.pt

b'diff --git a/Products/CMFPlone/browser/templates/plone-overview.pt b/Products/CMFPlone/browser/templates/plone-overview.pt\nindex c7dd976eb2..973e924e8e 100644\n--- a/Products/CMFPlone/browser/templates/plone-overview.pt\n+++ b/Products/CMFPlone/browser/templates/plone-overview.pt\n@@ -33,7 +33,7 @@\n         <p class="lead">\n             <span i18n:translate="label_plone_org_description"> For an introduction to Plone, documentation, demos, add-ons, support, and community, visit</span>\n             <a href="http://plone.org"\n-              title="Plone Homepage"\n+              title="Plone CMS: Open Source Content Management"\n               i18n:attributes="title label_plone_org_title;">plone.org</a>.\n           </p>\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-14T14:09:47+05:30
Author: Rohan Shaw (rohnsha0) <86848116+rohnsha0@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/ea7a5e70df0dedf607a20c3b858fc23a50f20dec

Update Products/CMFPlone/browser/templates/plone-frontpage.pt

Co-authored-by: Steve Piercy &lt;web@stevepiercy.com&gt;

Files changed:
M Products/CMFPlone/browser/templates/plone-frontpage.pt

b'diff --git a/Products/CMFPlone/browser/templates/plone-frontpage.pt b/Products/CMFPlone/browser/templates/plone-frontpage.pt\nindex dec2737973..99f000f8bf 100644\n--- a/Products/CMFPlone/browser/templates/plone-frontpage.pt\n+++ b/Products/CMFPlone/browser/templates/plone-frontpage.pt\n@@ -39,7 +39,7 @@ Before you start exploring your newly created Plone site, please do the followin\n <p>After that, we suggest you do one or more of the following:</p>\n \n <ul>\n-    <li>Find out <a class="link-plain" href="https://plone.org/what-is-plone/plone" target="_blank">What\'s new in Plone</a>.</li>\n+    <li>Get the latest <a class="link-plain" href="https://plone.org/what-is-plone/plone" target="_blank">news</a> about Plone.</li>\n     <li>Read the <a class="link-plain" href="https://docs.plone.org" target="_blank">documentation</a>.</li>\n     <li>Follow a <a class="link-plain" href="https://training.plone.org" target="_blank">training</a>.</li>\n     <li>Explore the <a class="link-plain" href="https://plone.org/download/add-ons" target="_blank">available add-ons</a> for Plone.</li>\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-15T06:48:24+05:30
Author: rohnsha0 (rohnsha0) <rohnsha0@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/ccf3a39cf2c2e1af5ebad2584b585b1a657ba667

Reverted changes

Files changed:
M Products/CMFPlone/browser/templates/plone-overview.pt

b'diff --git a/Products/CMFPlone/browser/templates/plone-overview.pt b/Products/CMFPlone/browser/templates/plone-overview.pt\nindex 973e924e8e..9081f153d7 100644\n--- a/Products/CMFPlone/browser/templates/plone-overview.pt\n+++ b/Products/CMFPlone/browser/templates/plone-overview.pt\n@@ -33,7 +33,7 @@\n         <p class="lead">\n             <span i18n:translate="label_plone_org_description"> For an introduction to Plone, documentation, demos, add-ons, support, and community, visit</span>\n             <a href="http://plone.org"\n-              title="Plone CMS: Open Source Content Management"\n+              title="Plone Community Home"\n               i18n:attributes="title label_plone_org_title;">plone.org</a>.\n           </p>\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-15T09:59:24+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/b26a47f151be920387a2593258da7a21206f4e6f

Merge pull request #3607 from rohnsha0/Issue3568

Fixed all known instances of plone.com (to plone.org) in plone/CMFPlone (Issue #3568)

Files changed:
A news/3568.bugfix
M Products/CMFPlone/browser/templates/accessibility-info.pt
M Products/CMFPlone/browser/templates/ajax_main_template.pt
M Products/CMFPlone/browser/templates/colophon.pt
M Products/CMFPlone/browser/templates/footer.pt
M Products/CMFPlone/browser/templates/plone-frontpage.pt
M Products/CMFPlone/browser/templates/plone-overview.pt

b'diff --git a/Products/CMFPlone/browser/templates/accessibility-info.pt b/Products/CMFPlone/browser/templates/accessibility-info.pt\nindex 77e1609fec..1b7a1b15c2 100644\n--- a/Products/CMFPlone/browser/templates/accessibility-info.pt\n+++ b/Products/CMFPlone/browser/templates/accessibility-info.pt\n@@ -16,7 +16,7 @@\n \n \n       <p><tal:i18n i18n:translate="description_accessibility_info">\n-            This site uses the open source Content Management System <a href="https://plone.com" i18n:name="plone">Plone</a>.\n+            This site uses the open source Content Management System <a href="https://plone.org" i18n:name="plone">Plone</a>.\n             It meets the Web Content Accessibility Guidelines\n \t    (<a href="https://www.w3.org/TR/WCAG20/"><acronym i18n:name="wcag"\n                   title="Web Content Accessibility Guidelines"\ndiff --git a/Products/CMFPlone/browser/templates/ajax_main_template.pt b/Products/CMFPlone/browser/templates/ajax_main_template.pt\nindex 3f8ef8bc10..81eab03a4a 100644\n--- a/Products/CMFPlone/browser/templates/ajax_main_template.pt\n+++ b/Products/CMFPlone/browser/templates/ajax_main_template.pt\n@@ -40,7 +40,7 @@\n     <metal:javascriptslot define-slot="javascript_head_slot" />\n \n     <link tal:replace="structure provider:plone.htmlhead.links" />\n-    <meta name="generator" content="Plone - http://plone.com" />\n+    <meta name="generator" content="Plone - http://plone.org" />\n     </tal:ajaxhead>\n \n </head>\ndiff --git a/Products/CMFPlone/browser/templates/colophon.pt b/Products/CMFPlone/browser/templates/colophon.pt\nindex 3610b9ff92..8ee479c3ab 100644\n--- a/Products/CMFPlone/browser/templates/colophon.pt\n+++ b/Products/CMFPlone/browser/templates/colophon.pt\n@@ -8,7 +8,7 @@\n \n   <div class="card card-classic" id="portal-colophon" metal:define-macro="portlet">\n     <div class="card-body">\n-      <a href="http://plone.com" target="_blank"\n+      <a href="http://plone.org" target="_blank"\n          title="This site was built using the Plone Open Source CMS/WCM."\n          i18n:attributes="title title_built_with_plone;"\n          i18n:translate="label_powered_by_plone">\ndiff --git a/Products/CMFPlone/browser/templates/footer.pt b/Products/CMFPlone/browser/templates/footer.pt\nindex 85e77a2b11..2581534645 100644\n--- a/Products/CMFPlone/browser/templates/footer.pt\n+++ b/Products/CMFPlone/browser/templates/footer.pt\n@@ -12,7 +12,7 @@\n       <span i18n:translate="description_copyright" tal:omit-tag="">\n       The\n       <span i18n:name="plonecms" tal:omit-tag="">\n-           <a href="http://plone.com" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>\n+           <a href="http://plone.org" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>\n       </span>\n       is\n       <abbr title="Copyright" i18n:name="copyright" i18n:attributes="title title_copyright;">&copy;</abbr>\ndiff --git a/Products/CMFPlone/browser/templates/plone-frontpage.pt b/Products/CMFPlone/browser/templates/plone-frontpage.pt\nindex badf8795fe..99f000f8bf 100644\n--- a/Products/CMFPlone/browser/templates/plone-frontpage.pt\n+++ b/Products/CMFPlone/browser/templates/plone-frontpage.pt\n@@ -12,7 +12,7 @@\n \n   <div class="hero">\n     <h1>Welcome!</h1>\n-    <p><a class="btn btn-primary" href="https://plone.com" target="_blank">Learn more about Plone</a></p>\n+    <p><a class="btn btn-primary" href="https://plone.org" target="_blank">Learn more about Plone</a></p>\n   </div>\n \n   <p class="discreet">\n@@ -39,7 +39,7 @@ Before you start exploring your newly created Plone site, please do the followin\n <p>After that, we suggest you do one or more of the following:</p>\n \n <ul>\n-    <li>Find out <a class="link-plain" href="https://plone.com/features/" target="_blank">What\'s new in Plone</a>.</li>\n+    <li>Get the latest <a class="link-plain" href="https://plone.org/what-is-plone/plone" target="_blank">news</a> about Plone.</li>\n     <li>Read the <a class="link-plain" href="https://docs.plone.org" target="_blank">documentation</a>.</li>\n     <li>Follow a <a class="link-plain" href="https://training.plone.org" target="_blank">training</a>.</li>\n     <li>Explore the <a class="link-plain" href="https://plone.org/download/add-ons" target="_blank">available add-ons</a> for Plone.</li>\ndiff --git a/Products/CMFPlone/browser/templates/plone-overview.pt b/Products/CMFPlone/browser/templates/plone-overview.pt\nindex 2e1b2e50d3..9081f153d7 100644\n--- a/Products/CMFPlone/browser/templates/plone-overview.pt\n+++ b/Products/CMFPlone/browser/templates/plone-overview.pt\n@@ -31,12 +31,7 @@\n                 i18n:attributes="alt" /></p>\n         <h1 i18n:translate="">Plone is up and running.</h1>\n         <p class="lead">\n-            <span i18n:translate="label_plone_com_description"> For an introduction to Plone, success stories, demos, providers, visit</span>\n-            <a href="http://plone.com"\n-              title="Plone.com"\n-              target="_blank"\n-              i18n:attributes="title label_plone_com_title;">plone.com</a>.\n-            <span i18n:translate="label_plone_org_description"> For documentation, add-ons, support, community, visit</span>\n+            <span i18n:translate="label_plone_org_description"> For an introduction to Plone, documentation, demos, add-ons, support, and community, visit</span>\n             <a href="http://plone.org"\n               title="Plone Community Home"\n               i18n:attributes="title label_plone_org_title;">plone.org</a>.\ndiff --git a/news/3568.bugfix b/news/3568.bugfix\nnew file mode 100644\nindex 0000000000..450997a173\n--- /dev/null\n+++ b/news/3568.bugfix\n@@ -0,0 +1,2 @@\n+Fixed all known instances of plone.com in plone/Products.CMFPlone\n+[rohnsha0]\n'

