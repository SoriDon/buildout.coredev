Repository: plone.app.layout


Branch: refs/heads/master
Date: 2018-01-28T15:22:01+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.layout/commit/d160c9b2848c84706985448e0b6e48292e032024

Use `get_installer` in tests.

Files changed:
M CHANGES.rst
M plone/app/layout/viewlets/tests/test_content.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 4dc2cfc..2d909a8 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -15,6 +15,8 @@ New features:
 
 Bug fixes:
 
+- Use ``get_installer`` in tests.  [maurits]
+
 - Imports are Python3 compatible
   [ale-rt]
 
diff --git a/plone/app/layout/viewlets/tests/test_content.py b/plone/app/layout/viewlets/tests/test_content.py
index 297f2a2..6fe448a 100644
--- a/plone/app/layout/viewlets/tests/test_content.py
+++ b/plone/app/layout/viewlets/tests/test_content.py
@@ -201,6 +201,7 @@ class TestDexterityRelatedItemsViewlet(ViewletsTestCase):
 
     def afterSetUp(self):
         """ create some sample content to test with """
+        from Products.CMFPlone.utils import get_installer
         if not HAS_DEXTERITY:
             return
         self.setRoles(('Manager',))
@@ -224,7 +225,8 @@ def afterSetUp(self):
             'Dexterity Item with relatedItems behavior', 'dex2')
         self.folder.invokeFactory(
             'Dexterity Item without relatedItems behavior', 'dex3')
-        self.portal.portal_quickinstaller.installProduct('plone.app.intid')
+        qi = get_installer(self.portal)
+        qi.install_product('plone.app.intid')
         intids = getUtility(IIntIds)
         self.folder.dex1.relatedItems = [
             RelationValue(intids.getId(self.folder.doc1)),


Repository: plone.app.layout


Branch: refs/heads/master
Date: 2018-01-29T09:55:20+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.layout/commit/181ff1b689c5ad4db87c99d4c04697be7469dbdb

Merge pull request #139 from plone/no-qi

Use `get_installer` in tests.

Files changed:
M CHANGES.rst
M plone/app/layout/viewlets/tests/test_content.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 88f933d..c707eca 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -15,6 +15,8 @@ New features:
 
 Bug fixes:
 
+- Use ``get_installer`` in tests.  [maurits]
+
 - Imports are Python3 compatible
   [ale-rt, jensens]
 
diff --git a/plone/app/layout/viewlets/tests/test_content.py b/plone/app/layout/viewlets/tests/test_content.py
index 297f2a2..6fe448a 100644
--- a/plone/app/layout/viewlets/tests/test_content.py
+++ b/plone/app/layout/viewlets/tests/test_content.py
@@ -201,6 +201,7 @@ class TestDexterityRelatedItemsViewlet(ViewletsTestCase):
 
     def afterSetUp(self):
         """ create some sample content to test with """
+        from Products.CMFPlone.utils import get_installer
         if not HAS_DEXTERITY:
             return
         self.setRoles(('Manager',))
@@ -224,7 +225,8 @@ def afterSetUp(self):
             'Dexterity Item with relatedItems behavior', 'dex2')
         self.folder.invokeFactory(
             'Dexterity Item without relatedItems behavior', 'dex3')
-        self.portal.portal_quickinstaller.installProduct('plone.app.intid')
+        qi = get_installer(self.portal)
+        qi.install_product('plone.app.intid')
         intids = getUtility(IIntIds)
         self.folder.dex1.relatedItems = [
             RelationValue(intids.getId(self.folder.doc1)),


