Repository: plone.app.caching


Branch: refs/heads/master
Date: 2019-09-13T09:01:54+02:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/plone.app.caching/commit/de1e9b6ce3c2a4b0edeffbc4a6f32dd21b286eff

Fix python3 related encoding error on manual purge page.

Files changed:
A news/51.bugfix
M plone/app/caching/browser/controlpanel.py

b"diff --git a/news/51.bugfix b/news/51.bugfix\nnew file mode 100644\nindex 0000000..d37cdc4\n--- /dev/null\n+++ b/news/51.bugfix\n@@ -0,0 +1,2 @@\n+Fix python3 related encoding error on manual purge page.\n+[agitator]\n\\ No newline at end of file\ndiff --git a/plone/app/caching/browser/controlpanel.py b/plone/app/caching/browser/controlpanel.py\nindex a383038..e331e80 100644\n--- a/plone/app/caching/browser/controlpanel.py\n+++ b/plone/app/caching/browser/controlpanel.py\n@@ -562,6 +562,11 @@ def processPurge(self):\n                 _(u'There were errors.'), 'error')\n             return\n \n+        if six.PY3:\n+            urls = [x.decode('utf8') if isinstance(x, six.binary_type)\n+                    else x for x in urls\n+                   ]\n+\n         purger = getUtility(IPurger)\n         serverURL = self.request['SERVER_URL']\n \n"

Repository: plone.app.caching


Branch: refs/heads/master
Date: 2019-09-13T10:48:59+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.caching/commit/e1b310c0e9e61c5d0c010c2e018c2173a081df57

Merge pull request #52 from plone/py3purgefix

Fix python3 related encoding error on manual purge page.

Files changed:
A news/51.bugfix
M plone/app/caching/browser/controlpanel.py

b"diff --git a/news/51.bugfix b/news/51.bugfix\nnew file mode 100644\nindex 0000000..d37cdc4\n--- /dev/null\n+++ b/news/51.bugfix\n@@ -0,0 +1,2 @@\n+Fix python3 related encoding error on manual purge page.\n+[agitator]\n\\ No newline at end of file\ndiff --git a/plone/app/caching/browser/controlpanel.py b/plone/app/caching/browser/controlpanel.py\nindex a383038..e331e80 100644\n--- a/plone/app/caching/browser/controlpanel.py\n+++ b/plone/app/caching/browser/controlpanel.py\n@@ -562,6 +562,11 @@ def processPurge(self):\n                 _(u'There were errors.'), 'error')\n             return\n \n+        if six.PY3:\n+            urls = [x.decode('utf8') if isinstance(x, six.binary_type)\n+                    else x for x in urls\n+                   ]\n+\n         purger = getUtility(IPurger)\n         serverURL = self.request['SERVER_URL']\n \n"

