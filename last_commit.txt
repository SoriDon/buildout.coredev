Repository: plone.restapi


Branch: refs/heads/master
Date: 2021-11-24T11:21:28+01:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/2dce57e7c358428e90b84b029c32e59e0847b70b

Fix schema generation when /@types/ is used in a context

Files changed:
A news/1271.bugfix
M src/plone/restapi/types/utils.py

b'diff --git a/news/1271.bugfix b/news/1271.bugfix\nnew file mode 100644\nindex 000000000..925692c68\n--- /dev/null\n+++ b/news/1271.bugfix\n@@ -0,0 +1 @@\n+Fix schema generation when /@types/ is used in a context. [ericof]\ndiff --git a/src/plone/restapi/types/utils.py b/src/plone/restapi/types/utils.py\nindex cb6c48ac6..43b7cbe06 100644\n--- a/src/plone/restapi/types/utils.py\n+++ b/src/plone/restapi/types/utils.py\n@@ -300,7 +300,7 @@ def serializeSchema(schema):\n \n def get_info_for_type(context, request, name):\n     """Get JSON info for the given portal type"""\n-    schema = get_jsonschema_for_portal_type(name, getSite(), request)\n+    schema = get_jsonschema_for_portal_type(name, context, request)\n \n     if not hasattr(context, "schema"):\n         return schema\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2021-11-24T11:44:29+01:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/37096229ce93bb4f10f40c15740fa93eca203453

Update translated_messages_types_folder example

Files changed:
M src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp

b'diff --git a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\nindex f3b29f211..d911fb50d 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n@@ -87,7 +87,7 @@ Content-Type: application/json+schema\n             "title": "Permitir comentarios",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@sources/allow_discussion"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Folder/@sources/allow_discussion"\n             }\n         },\n         "contributors": {\n@@ -106,7 +106,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -126,7 +126,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -177,7 +177,7 @@ Content-Type: application/json+schema\n             "title": "Idioma",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n             }\n         },\n         "nextPreviousEnabled": {\n@@ -200,10 +200,10 @@ Content-Type: application/json+schema\n                 "title": "Related",\n                 "type": "string",\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             },\n-            "title": "Contenido relacionado",\n+            "title": "Related Items",\n             "type": "array",\n             "uniqueItems": true,\n             "widgetOptions": {\n@@ -211,7 +211,7 @@ Content-Type: application/json+schema\n                     "recentlyUsed": true\n                 },\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             }\n         },\n@@ -239,7 +239,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Keywords"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Keywords"\n                 }\n             }\n         },\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2021-11-24T12:26:37+01:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/03984f5f0338a1fd0ec8b48886282e92befd30cd

More updates to documentation examples

Files changed:
M src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp
M src/plone/restapi/tests/http-examples/types_document.resp
M src/plone/restapi/tests/http-examples/types_document_put.req

b'diff --git a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\nindex d911fb50d..a2b07b64e 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n@@ -203,7 +203,7 @@ Content-Type: application/json+schema\n                     "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             },\n-            "title": "Related Items",\n+            "title": "Contenido relacionado",\n             "type": "array",\n             "uniqueItems": true,\n             "widgetOptions": {\ndiff --git a/src/plone/restapi/tests/http-examples/types_document.resp b/src/plone/restapi/tests/http-examples/types_document.resp\nindex ddb61a645..5b395ff9e 100644\n--- a/src/plone/restapi/tests/http-examples/types_document.resp\n+++ b/src/plone/restapi/tests/http-examples/types_document.resp\n@@ -93,7 +93,7 @@ Content-Type: application/json+schema\n             "title": "Allow discussion",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@sources/allow_discussion"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@sources/allow_discussion"\n             }\n         },\n         "author_email": {\n@@ -127,7 +127,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -147,7 +147,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -198,7 +198,7 @@ Content-Type: application/json+schema\n             "title": "Language",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n             }\n         },\n         "relatedItems": {\n@@ -213,7 +213,7 @@ Content-Type: application/json+schema\n                 "title": "Related",\n                 "type": "string",\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             },\n             "title": "Related Items",\n@@ -224,7 +224,7 @@ Content-Type: application/json+schema\n                     "recentlyUsed": true\n                 },\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             }\n         },\n@@ -252,7 +252,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Keywords"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Keywords"\n                 }\n             }\n         },\ndiff --git a/src/plone/restapi/tests/http-examples/types_document_put.req b/src/plone/restapi/tests/http-examples/types_document_put.req\nindex 423676245..dd2f11a5e 100644\n--- a/src/plone/restapi/tests/http-examples/types_document_put.req\n+++ b/src/plone/restapi/tests/http-examples/types_document_put.req\n@@ -50,7 +50,7 @@ Content-Type: application/json\n             "title": "Allow discussion",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@sources/allow_discussion"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@sources/allow_discussion"\n             }\n         },\n         "author_email": {\n@@ -96,7 +96,7 @@ Content-Type: application/json\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -116,7 +116,7 @@ Content-Type: application/json\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -167,7 +167,7 @@ Content-Type: application/json\n             "title": "Language",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n             }\n         },\n         "relatedItems": {\n@@ -182,7 +182,7 @@ Content-Type: application/json\n                 "title": "Related",\n                 "type": "string",\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             },\n             "title": "Related Items",\n@@ -193,7 +193,7 @@ Content-Type: application/json\n                     "recentlyUsed": true\n                 },\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             }\n         },\n@@ -221,7 +221,7 @@ Content-Type: application/json\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Keywords"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Keywords"\n                 }\n             }\n         },\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2021-11-24T12:58:15+01:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/134c36172ae4278ab4ba494bf2277cd100339bc2

Merge pull request #1272 from plone/issue-1271-fix-contextual-schema

Fix schema generation when /@types/ is used in a context

Files changed:
A news/1271.bugfix
M src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp
M src/plone/restapi/tests/http-examples/types_document.resp
M src/plone/restapi/tests/http-examples/types_document_put.req
M src/plone/restapi/types/utils.py

b'diff --git a/news/1271.bugfix b/news/1271.bugfix\nnew file mode 100644\nindex 000000000..925692c68\n--- /dev/null\n+++ b/news/1271.bugfix\n@@ -0,0 +1 @@\n+Fix schema generation when /@types/ is used in a context. [ericof]\ndiff --git a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\nindex f3b29f211..a2b07b64e 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n@@ -87,7 +87,7 @@ Content-Type: application/json+schema\n             "title": "Permitir comentarios",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@sources/allow_discussion"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Folder/@sources/allow_discussion"\n             }\n         },\n         "contributors": {\n@@ -106,7 +106,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -126,7 +126,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -177,7 +177,7 @@ Content-Type: application/json+schema\n             "title": "Idioma",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n             }\n         },\n         "nextPreviousEnabled": {\n@@ -200,7 +200,7 @@ Content-Type: application/json+schema\n                 "title": "Related",\n                 "type": "string",\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             },\n             "title": "Contenido relacionado",\n@@ -211,7 +211,7 @@ Content-Type: application/json+schema\n                     "recentlyUsed": true\n                 },\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             }\n         },\n@@ -239,7 +239,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Keywords"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Folder/@vocabularies/plone.app.vocabularies.Keywords"\n                 }\n             }\n         },\ndiff --git a/src/plone/restapi/tests/http-examples/types_document.resp b/src/plone/restapi/tests/http-examples/types_document.resp\nindex ddb61a645..5b395ff9e 100644\n--- a/src/plone/restapi/tests/http-examples/types_document.resp\n+++ b/src/plone/restapi/tests/http-examples/types_document.resp\n@@ -93,7 +93,7 @@ Content-Type: application/json+schema\n             "title": "Allow discussion",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@sources/allow_discussion"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@sources/allow_discussion"\n             }\n         },\n         "author_email": {\n@@ -127,7 +127,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -147,7 +147,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -198,7 +198,7 @@ Content-Type: application/json+schema\n             "title": "Language",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n             }\n         },\n         "relatedItems": {\n@@ -213,7 +213,7 @@ Content-Type: application/json+schema\n                 "title": "Related",\n                 "type": "string",\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             },\n             "title": "Related Items",\n@@ -224,7 +224,7 @@ Content-Type: application/json+schema\n                     "recentlyUsed": true\n                 },\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             }\n         },\n@@ -252,7 +252,7 @@ Content-Type: application/json+schema\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Keywords"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Keywords"\n                 }\n             }\n         },\ndiff --git a/src/plone/restapi/tests/http-examples/types_document_put.req b/src/plone/restapi/tests/http-examples/types_document_put.req\nindex 423676245..dd2f11a5e 100644\n--- a/src/plone/restapi/tests/http-examples/types_document_put.req\n+++ b/src/plone/restapi/tests/http-examples/types_document_put.req\n@@ -50,7 +50,7 @@ Content-Type: application/json\n             "title": "Allow discussion",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@sources/allow_discussion"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@sources/allow_discussion"\n             }\n         },\n         "author_email": {\n@@ -96,7 +96,7 @@ Content-Type: application/json\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -116,7 +116,7 @@ Content-Type: application/json\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Users"\n                 }\n             }\n         },\n@@ -167,7 +167,7 @@ Content-Type: application/json\n             "title": "Language",\n             "type": "string",\n             "vocabulary": {\n-                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n+                "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.SupportedContentLanguages"\n             }\n         },\n         "relatedItems": {\n@@ -182,7 +182,7 @@ Content-Type: application/json\n                 "title": "Related",\n                 "type": "string",\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             },\n             "title": "Related Items",\n@@ -193,7 +193,7 @@ Content-Type: application/json\n                     "recentlyUsed": true\n                 },\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Catalog"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Catalog"\n                 }\n             }\n         },\n@@ -221,7 +221,7 @@ Content-Type: application/json\n             "uniqueItems": true,\n             "widgetOptions": {\n                 "vocabulary": {\n-                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Keywords"\n+                    "@id": "http://localhost:55001/plone/dexterity-types/Document/@vocabularies/plone.app.vocabularies.Keywords"\n                 }\n             }\n         },\ndiff --git a/src/plone/restapi/types/utils.py b/src/plone/restapi/types/utils.py\nindex cb6c48ac6..43b7cbe06 100644\n--- a/src/plone/restapi/types/utils.py\n+++ b/src/plone/restapi/types/utils.py\n@@ -300,7 +300,7 @@ def serializeSchema(schema):\n \n def get_info_for_type(context, request, name):\n     """Get JSON info for the given portal type"""\n-    schema = get_jsonschema_for_portal_type(name, getSite(), request)\n+    schema = get_jsonschema_for_portal_type(name, context, request)\n \n     if not hasattr(context, "schema"):\n         return schema\n'

