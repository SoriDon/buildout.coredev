Repository: mockup


Branch: refs/heads/master
Date: 2015-12-02T14:39:34+01:00
Author: Alexander Pilz (pilz) <pilz@syslab.com>
Commit: https://github.com/plone/mockup/commit/edc63c235161733ef45eacb026ebc43957369140

Take complex portal types into account

In folder_contents view, the news item icon doesn't appear because its portal_type is "News Item". The code in line 4 results in a class string "contenttype-news item", which effectively means two classes, "contenttype-news" and "item".

Another typical case where this fails is for custom content types, which by default with dexterity will be named something like "my.package.mytype". This results in the class string "contenttype-my.package.mytype" which can't be referenced in css, as it is illegal.

This patch simply replaces these cases with a dash. For news items, this results in contenttype-news-item, which is exactly how the news item icon is coded in contents.plone.less, so news items will immediately have an icon again.

Files changed:
M mockup/patterns/structure/templates/tablerow.xml

diff --git a/mockup/patterns/structure/templates/tablerow.xml b/mockup/patterns/structure/templates/tablerow.xml
index 96ff810..896761a 100644
--- a/mockup/patterns/structure/templates/tablerow.xml
+++ b/mockup/patterns/structure/templates/tablerow.xml
@@ -1,7 +1,7 @@
 <td class="selection"><input type="checkbox" <% if(selected){ %> checked="checked" <% } %>/></td>
 
 <td class="title">
-  <a href="<%- getURL %>" class="manage state-<%- review_state %> contenttype-<%- portal_type.toLowerCase() %>"
+  <a href="<%- getURL %>" class="manage state-<%- review_state %> contenttype-<%- portal_type.toLowerCase().replace(/\.| /g, '-') %>"
   title="<%- portal_type %>" >
  
    <%- Title %></a>


Repository: mockup


Branch: refs/heads/master
Date: 2015-12-02T08:06:09-06:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/f53fd7f1730424af4968ede49ccf752df8b93262

Merge pull request #614 from plone/pilz-fix-icons-in-foldercontents

Take complex portal types into account

Files changed:
M mockup/patterns/structure/templates/tablerow.xml

diff --git a/mockup/patterns/structure/templates/tablerow.xml b/mockup/patterns/structure/templates/tablerow.xml
index 96ff810..896761a 100644
--- a/mockup/patterns/structure/templates/tablerow.xml
+++ b/mockup/patterns/structure/templates/tablerow.xml
@@ -1,7 +1,7 @@
 <td class="selection"><input type="checkbox" <% if(selected){ %> checked="checked" <% } %>/></td>
 
 <td class="title">
-  <a href="<%- getURL %>" class="manage state-<%- review_state %> contenttype-<%- portal_type.toLowerCase() %>"
+  <a href="<%- getURL %>" class="manage state-<%- review_state %> contenttype-<%- portal_type.toLowerCase().replace(/\.| /g, '-') %>"
   title="<%- portal_type %>" >
  
    <%- Title %></a>


