Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-05-09T16:00:42-05:00
Author: Jens Vagelpohl (dataflake) <jens@mineralware.com>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/61ea78d5f3e2b130156853088e2d528176421935

Prevent constant `waitress.queue` log messages on the console

Files changed:
A news/110.bugfix
M src/plone/recipe/zope2instance/recipe.py
M src/plone/recipe/zope2instance/tests/wsgi.txt

b'diff --git a/news/110.bugfix b/news/110.bugfix\nnew file mode 100644\nindex 0000000..278a1d3\n--- /dev/null\n+++ b/news/110.bugfix\n@@ -0,0 +1,2 @@\n+Prevent constant `waitress.queue` log messages on the console and just send\n+them to the event log.\ndiff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex d04405a..56db86d 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -1268,7 +1268,7 @@ def render_file_storage(self, file_storage, blob_storage,\n     %(pipeline)s\n \n [loggers]\n-keys = root, plone, waitress, wsgi\n+keys = root, plone, waitress.queue, waitress, wsgi\n \n [handlers]\n keys = console, accesslog, eventlog\n@@ -1285,6 +1285,12 @@ def render_file_storage(self, file_storage, blob_storage,\n handlers = %(event_handlers)s\n qualname = plone\n \n+[logger_waitress.queue]\n+level = INFO\n+handlers = eventlog\n+qualname = waitress.queue\n+propagate = 0\n+\n [logger_waitress]\n level = %(eventlog_level)s\n handlers = %(event_handlers)s\ndiff --git a/src/plone/recipe/zope2instance/tests/wsgi.txt b/src/plone/recipe/zope2instance/tests/wsgi.txt\nindex e14eb10..2159038 100644\n--- a/src/plone/recipe/zope2instance/tests/wsgi.txt\n+++ b/src/plone/recipe/zope2instance/tests/wsgi.txt\n@@ -95,7 +95,7 @@ The buildout has also created an INI file containing the waitress configuration:\n         zope\n     <BLANKLINE>\n     [loggers]\n-    keys = root, plone, waitress, wsgi\n+    keys = root, plone, waitress.queue, waitress, wsgi\n     <BLANKLINE>\n     [handlers]\n     keys = console, accesslog, eventlog\n@@ -112,6 +112,12 @@ The buildout has also created an INI file containing the waitress configuration:\n     handlers = eventlog\n     qualname = plone\n     <BLANKLINE>\n+    [logger_waitress.queue]\n+    level = INFO\n+    handlers = eventlog\n+    qualname = waitress.queue\n+    propagate = 0\n+    <BLANKLINE>\n     [logger_waitress]\n     level = INFO\n     handlers = eventlog\n@@ -237,6 +243,12 @@ The buildout has updated our INI file:\n     handlers = eventlog\n     qualname = plone\n     <BLANKLINE>\n+    [logger_waitress.queue]\n+    level = INFO\n+    handlers = eventlog\n+    qualname = waitress.queue\n+    propagate = 0\n+    <BLANKLINE>\n     [logger_waitress]\n     level = ERROR\n     handlers = eventlog\n@@ -346,6 +358,12 @@ The buildout has updated our INI file:\n     handlers =\n     qualname = plone\n     <BLANKLINE>\n+    [logger_waitress.queue]\n+    level = INFO\n+    handlers = eventlog\n+    qualname = waitress.queue\n+    propagate = 0\n+    <BLANKLINE>\n     [logger_waitress]\n     level = INFO\n     handlers =\n'

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-05-10T14:30:11+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/1aa57291372ae3274cd27a57489e56a7a3761630

Merge pull request #111 from plone/issue_110

Prevent constant `waitress.queue` log messages on the console

Files changed:
A news/110.bugfix
M src/plone/recipe/zope2instance/recipe.py
M src/plone/recipe/zope2instance/tests/wsgi.txt

b'diff --git a/news/110.bugfix b/news/110.bugfix\nnew file mode 100644\nindex 0000000..278a1d3\n--- /dev/null\n+++ b/news/110.bugfix\n@@ -0,0 +1,2 @@\n+Prevent constant `waitress.queue` log messages on the console and just send\n+them to the event log.\ndiff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex d9f766b..c57ca0f 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -1268,7 +1268,7 @@ def render_file_storage(self, file_storage, blob_storage,\n     %(pipeline)s\n \n [loggers]\n-keys = root, plone, waitress, wsgi\n+keys = root, plone, waitress.queue, waitress, wsgi\n \n [handlers]\n keys = console, accesslog, eventlog\n@@ -1285,6 +1285,12 @@ def render_file_storage(self, file_storage, blob_storage,\n handlers = %(event_handlers)s\n qualname = plone\n \n+[logger_waitress.queue]\n+level = INFO\n+handlers = eventlog\n+qualname = waitress.queue\n+propagate = 0\n+\n [logger_waitress]\n level = %(eventlog_level)s\n handlers = %(event_handlers)s\ndiff --git a/src/plone/recipe/zope2instance/tests/wsgi.txt b/src/plone/recipe/zope2instance/tests/wsgi.txt\nindex e14eb10..2159038 100644\n--- a/src/plone/recipe/zope2instance/tests/wsgi.txt\n+++ b/src/plone/recipe/zope2instance/tests/wsgi.txt\n@@ -95,7 +95,7 @@ The buildout has also created an INI file containing the waitress configuration:\n         zope\n     <BLANKLINE>\n     [loggers]\n-    keys = root, plone, waitress, wsgi\n+    keys = root, plone, waitress.queue, waitress, wsgi\n     <BLANKLINE>\n     [handlers]\n     keys = console, accesslog, eventlog\n@@ -112,6 +112,12 @@ The buildout has also created an INI file containing the waitress configuration:\n     handlers = eventlog\n     qualname = plone\n     <BLANKLINE>\n+    [logger_waitress.queue]\n+    level = INFO\n+    handlers = eventlog\n+    qualname = waitress.queue\n+    propagate = 0\n+    <BLANKLINE>\n     [logger_waitress]\n     level = INFO\n     handlers = eventlog\n@@ -237,6 +243,12 @@ The buildout has updated our INI file:\n     handlers = eventlog\n     qualname = plone\n     <BLANKLINE>\n+    [logger_waitress.queue]\n+    level = INFO\n+    handlers = eventlog\n+    qualname = waitress.queue\n+    propagate = 0\n+    <BLANKLINE>\n     [logger_waitress]\n     level = ERROR\n     handlers = eventlog\n@@ -346,6 +358,12 @@ The buildout has updated our INI file:\n     handlers =\n     qualname = plone\n     <BLANKLINE>\n+    [logger_waitress.queue]\n+    level = INFO\n+    handlers = eventlog\n+    qualname = waitress.queue\n+    propagate = 0\n+    <BLANKLINE>\n     [logger_waitress]\n     level = INFO\n     handlers =\n'

