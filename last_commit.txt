Repository: mockup


Branch: refs/heads/master
Date: 2016-02-11T20:05:31+13:00
Author: Tommy Yu (metatoaster) <tommy.yu@auckland.ac.nz>
Commit: https://github.com/plone/mockup/commit/a5f6d4f334f131b79c690676f29d8afa831fb853

Change the comment to test skips

- Rather than silently drop them, make a note of them to actually get
  that handled later.

Files changed:
M mockup/tests/pattern-relateditems-test.js

diff --git a/mockup/tests/pattern-relateditems-test.js b/mockup/tests/pattern-relateditems-test.js
index be79e36..d580210 100644
--- a/mockup/tests/pattern-relateditems-test.js
+++ b/mockup/tests/pattern-relateditems-test.js
@@ -170,8 +170,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop').remove();
     });
-/*fgrcon
-    it('select an item by clicking add button', function () {
+
+    it.skip('select an item by clicking add button', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -194,9 +194,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon 
-    it('deselect an item from selected items using click', function () {
+
+    it.skip('deselect an item from selected items using click', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -230,9 +229,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
-    it('deselect an item from results using click', function () {
+
+    it.skip('deselect an item from results using click', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -263,9 +261,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
-    it('allow only a single type to be selectable', function () {
+
+    it.skip('allow only a single type to be selectable', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems" />' +
@@ -291,9 +288,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
-    it('clicking folder button filters to that folder', function() {
+
+    it.skip('clicking folder button filters to that folder', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -317,9 +313,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
-/*fgrcon
-    it('after selecting a folder, it remains in the results list', function() {
+
+    it.skip('after selecting a folder, it remains in the results list', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -345,9 +340,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
-    it('clicking on breadcrumbs goes back up', function() {
+
+    it.skip('clicking on breadcrumbs goes back up', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -377,8 +371,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
-/*fgrcon    it('maximum number of selected items', function() {
+
+    it.skip('maximum number of selected items', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -400,7 +394,7 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
+
     it('init selection', function() {
       var $el = $('' +
         '<div>' +
@@ -419,8 +413,8 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-/*fgrcon
-    it('test tree initialized', function() {
+
+    it.skip('test tree initialized', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -445,7 +439,7 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-    it('test tree select', function() {
+    it.skip('test tree select', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -474,7 +468,7 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-    it('test tree sub select', function() {
+    it.skip('test tree sub select', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -505,7 +499,7 @@ define([
       $el.remove();
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
+
     it('test tree cancel', function() {
       var $el = $('' +
         '<div>' +
@@ -536,8 +530,6 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-
-
   });
 
 });


Repository: mockup


Branch: refs/heads/master
Date: 2016-02-11T20:05:31+13:00
Author: Tommy Yu (metatoaster) <tommy.yu@auckland.ac.nz>
Commit: https://github.com/plone/mockup/commit/c17138a1e64aacd8a3139100e2f444cfd141c3da

Patch test data with helper function, remove skip

- This patches up the test data with a function to add in the expected
  fields to not cause rendering errors.
- Also included is the patch to search helper function with the dummy
  json provider to restore the search by folder functionality as per
  upgrade in Products.CMFCore.
- Remove the skip designation for all affected tests within the
  relateditems pattern.

Side note:
- These "attributes" need to be really documented somewhere to either
  ensure third-party users can use this, or tell them not to.

Files changed:
M mockup/tests/pattern-relateditems-test.js

diff --git a/mockup/tests/pattern-relateditems-test.js b/mockup/tests/pattern-relateditems-test.js
index d580210..a027d62 100644
--- a/mockup/tests/pattern-relateditems-test.js
+++ b/mockup/tests/pattern-relateditems-test.js
@@ -56,6 +56,17 @@ define([
           {UID: 'asdfasdf9sdf', Title: 'Mike', path: '/about/staff/mike', portal_type: 'Document', getIcon: ""},
           {UID: 'cvbcvb82345', Title: 'Joe', path: '/about/staff/joe', portal_type: 'Document', getIcon: ""}
         ];
+
+        var addMissingFields = function(item) {
+          item.getURL = 'http://localhost:8081' + item.path;
+          item.is_folderish = item.portal_type === 'Folder';
+          item.review_state = 'published';
+        };
+
+        _.each(root, addMissingFields);
+        _.each(about, addMissingFields);
+        _.each(staff, addMissingFields);
+
         var searchables = about.concat(root).concat(staff);
 
         var addUrls = function(list) {
@@ -91,6 +102,8 @@ define([
             var criteria = query.criteria[i];
             if (criteria.i === 'path') {
               path = criteria.v.split('::')[0];
+            } else if (criteria.i === 'is_folderish') {
+              term = criteria;
             } else {
               term = criteria.v;
             }
@@ -107,11 +120,17 @@ define([
             var q;
             var keys = (item.UID + ' ' + item.Title + ' ' + item.path + ' ' + item.portal_type).toLowerCase();
             if (typeof(term) === 'object') {
-              for (var i = 0; i < term.length; i = i + 1) {
-                q = term[i].toLowerCase();
-                if (keys.indexOf(q) > -1) {
+              if (term.i === 'is_folderish') {
+                if (item.is_folderish) {
                   results.push(item);
-                  break;
+                }
+              } else {
+                for (var i = 0; i < term.length; i = i + 1) {
+                  q = term[i].toLowerCase();
+                  if (keys.indexOf(q) > -1) {
+                    results.push(item);
+                    break;
+                  }
                 }
               }
             } else {
@@ -171,7 +190,7 @@ define([
       $('.select2-sizer, .select2-drop').remove();
     });
 
-    it.skip('select an item by clicking add button', function () {
+    it('select an item by clicking add button', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -195,7 +214,7 @@ define([
       $('.select2-sizer, .select2-drop').remove();
     });
 
-    it.skip('deselect an item from selected items using click', function () {
+    it('deselect an item from selected items using click', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -230,7 +249,7 @@ define([
       $('.select2-sizer, .select2-drop').remove();
     });
 
-    it.skip('deselect an item from results using click', function () {
+    it('deselect an item from results using click', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -262,7 +281,7 @@ define([
       $('.select2-sizer, .select2-drop').remove();
     });
 
-    it.skip('allow only a single type to be selectable', function () {
+    it('allow only a single type to be selectable', function () {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems" />' +
@@ -282,14 +301,14 @@ define([
       $('.pattern-relateditems-result-select').first().click();
       expect(pattern.$el.select2('data')).to.have.length(0);
 
-      $('.pattern-relateditems-type-Image .pattern-relateditems-result-select').first().click();
+      $('.contenttype-image:parent').first().click();
       expect(pattern.$el.select2('data')).to.have.length(1);
 
       $el.remove();
       $('.select2-sizer, .select2-drop').remove();
     });
 
-    it.skip('clicking folder button filters to that folder', function() {
+    it('clicking folder button filters to that folder', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -314,7 +333,7 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-    it.skip('after selecting a folder, it remains in the results list', function() {
+    it('after selecting a folder, it remains in the results list', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -341,7 +360,7 @@ define([
       $('.select2-sizer, .select2-drop').remove();
     });
 
-    it.skip('clicking on breadcrumbs goes back up', function() {
+    it('clicking on breadcrumbs goes back up', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -372,7 +391,7 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-    it.skip('maximum number of selected items', function() {
+    it('maximum number of selected items', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -414,7 +433,7 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-    it.skip('test tree initialized', function() {
+    it('test tree initialized', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -439,7 +458,7 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-    it.skip('test tree select', function() {
+    it('test tree select', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
@@ -468,7 +487,7 @@ define([
       $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-    it.skip('test tree sub select', function() {
+    it('test tree sub select', function() {
       var $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +


Repository: mockup


Branch: refs/heads/master
Date: 2016-02-11T20:34:29+13:00
Author: Tommy Yu (metatoaster) <tommy.yu@auckland.ac.nz>
Commit: https://github.com/plone/mockup/commit/92660e7362857c4bde57bfc4dd4d5901f231de72

Better individual test isolation.

Files changed:
M mockup/tests/pattern-relateditems-test.js

diff --git a/mockup/tests/pattern-relateditems-test.js b/mockup/tests/pattern-relateditems-test.js
index a027d62..d996989 100644
--- a/mockup/tests/pattern-relateditems-test.js
+++ b/mockup/tests/pattern-relateditems-test.js
@@ -11,6 +11,8 @@ define([
   window.mocha.setup('bdd').globals(['jQuery*']);
   $.fx.off = true;
 
+  var $el;
+
   /* ==========================
    TEST: Related Items
   ========================== */
@@ -173,8 +175,14 @@ define([
       });
     });
 
+    afterEach(function() {
+      this.server.restore();
+      $el.remove();
+      $('.select2-sizer, .select2-drop').remove();
+    });
+
     it('test initialize', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -185,13 +193,10 @@ define([
       expect($('.select2-container-multi', $el)).to.have.length(1);
       expect($('.pattern-relateditems-container', $el)).to.have.length(1);
       expect($('.pattern-relateditems-path', $el)).to.have.length(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
 
     it('select an item by clicking add button', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -209,13 +214,10 @@ define([
         expect(pattern.$el.select2('val')[0]).to.equal('gfn5634f');
       }).click();
       clock.tick(1000);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
 
     it('deselect an item from selected items using click', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -244,13 +246,10 @@ define([
       // backspaceEvent.which = 8;
       // $('.select2-search-field input').trigger( backspaceEvent );
       // expect(pattern.$el.select2('data')).to.have.length(0);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
 
     it('deselect an item from results using click', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -276,13 +275,10 @@ define([
       expect($result.is('.pattern-relateditems-active')).to.equal(false);
       expect(pattern.$el.select2('data')).to.have.length(0);
       expect(pattern.$el.select2('val')).to.have.length(0);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
 
     it('allow only a single type to be selectable', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems" />' +
         '</div>').appendTo('body');
@@ -303,13 +299,10 @@ define([
 
       $('.contenttype-image:parent').first().click();
       expect(pattern.$el.select2('data')).to.have.length(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
 
     it('clicking folder button filters to that folder', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -328,13 +321,10 @@ define([
         expect(pattern.browsing).to.be.equal(true);
         expect(pattern.currentPath).to.equal($(this).attr('data-path'));
       }).click();
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('after selecting a folder, it remains in the results list', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -355,13 +345,10 @@ define([
       var result = $('.pattern-relateditems-result-path')
         .filter(function() { return $(this).text() === '/about'; });
       expect(result.length).to.equal(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
 
     it('clicking on breadcrumbs goes back up', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -386,13 +373,10 @@ define([
       }).click();
       clock.tick(1000);
       expect(pattern.currentPath).to.equal('/about');
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('maximum number of selected items', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -409,13 +393,10 @@ define([
       expect(pattern.$el.select2('data')).to.have.length(1);
       $('.pattern-relateditems-result-select').last().click();
       expect(pattern.$el.select2('data')).to.have.length(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('init selection', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -428,13 +409,10 @@ define([
       var clock = sinon.useFakeTimers();
       pattern.$el.select2('open');
       clock.tick(1000);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('test tree initialized', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -453,13 +431,10 @@ define([
       clock.tick(1000);
 
       expect($el.find('.pat-tree ul li').length).to.equal(4);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('test tree select', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -482,13 +457,10 @@ define([
       clock.tick(1000);
 
       expect($el.find('.crumb').length).to.equal(2);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('test tree sub select', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -514,13 +486,10 @@ define([
       clock.tick(1000);
 
       expect($el.find('.crumb').length).to.equal(3);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('test tree cancel', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -544,9 +513,6 @@ define([
 
       expect($el.find('.crumb').length).to.equal(1);
       expect($el.find('.tree-container').is(':visible')).to.equal(false);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
   });


Repository: mockup


Branch: refs/heads/master
Date: 2016-02-11T07:28:45-06:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/be5fbffa49ef061c038115f190dab90cf89a8948

Merge pull request #628 from plone/uncomment-realteditems-tests

Uncomment realteditems tests

Files changed:
M mockup/tests/pattern-relateditems-test.js

diff --git a/mockup/tests/pattern-relateditems-test.js b/mockup/tests/pattern-relateditems-test.js
index be79e36..d996989 100644
--- a/mockup/tests/pattern-relateditems-test.js
+++ b/mockup/tests/pattern-relateditems-test.js
@@ -11,6 +11,8 @@ define([
   window.mocha.setup('bdd').globals(['jQuery*']);
   $.fx.off = true;
 
+  var $el;
+
   /* ==========================
    TEST: Related Items
   ========================== */
@@ -56,6 +58,17 @@ define([
           {UID: 'asdfasdf9sdf', Title: 'Mike', path: '/about/staff/mike', portal_type: 'Document', getIcon: ""},
           {UID: 'cvbcvb82345', Title: 'Joe', path: '/about/staff/joe', portal_type: 'Document', getIcon: ""}
         ];
+
+        var addMissingFields = function(item) {
+          item.getURL = 'http://localhost:8081' + item.path;
+          item.is_folderish = item.portal_type === 'Folder';
+          item.review_state = 'published';
+        };
+
+        _.each(root, addMissingFields);
+        _.each(about, addMissingFields);
+        _.each(staff, addMissingFields);
+
         var searchables = about.concat(root).concat(staff);
 
         var addUrls = function(list) {
@@ -91,6 +104,8 @@ define([
             var criteria = query.criteria[i];
             if (criteria.i === 'path') {
               path = criteria.v.split('::')[0];
+            } else if (criteria.i === 'is_folderish') {
+              term = criteria;
             } else {
               term = criteria.v;
             }
@@ -107,11 +122,17 @@ define([
             var q;
             var keys = (item.UID + ' ' + item.Title + ' ' + item.path + ' ' + item.portal_type).toLowerCase();
             if (typeof(term) === 'object') {
-              for (var i = 0; i < term.length; i = i + 1) {
-                q = term[i].toLowerCase();
-                if (keys.indexOf(q) > -1) {
+              if (term.i === 'is_folderish') {
+                if (item.is_folderish) {
                   results.push(item);
-                  break;
+                }
+              } else {
+                for (var i = 0; i < term.length; i = i + 1) {
+                  q = term[i].toLowerCase();
+                  if (keys.indexOf(q) > -1) {
+                    results.push(item);
+                    break;
+                  }
                 }
               }
             } else {
@@ -154,8 +175,14 @@ define([
       });
     });
 
+    afterEach(function() {
+      this.server.restore();
+      $el.remove();
+      $('.select2-sizer, .select2-drop').remove();
+    });
+
     it('test initialize', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -166,13 +193,10 @@ define([
       expect($('.select2-container-multi', $el)).to.have.length(1);
       expect($('.pattern-relateditems-container', $el)).to.have.length(1);
       expect($('.pattern-relateditems-path', $el)).to.have.length(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
-/*fgrcon
+
     it('select an item by clicking add button', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -190,14 +214,10 @@ define([
         expect(pattern.$el.select2('val')[0]).to.equal('gfn5634f');
       }).click();
       clock.tick(1000);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon 
+
     it('deselect an item from selected items using click', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -226,14 +246,10 @@ define([
       // backspaceEvent.which = 8;
       // $('.select2-search-field input').trigger( backspaceEvent );
       // expect(pattern.$el.select2('data')).to.have.length(0);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
+
     it('deselect an item from results using click', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -259,14 +275,10 @@ define([
       expect($result.is('.pattern-relateditems-active')).to.equal(false);
       expect(pattern.$el.select2('data')).to.have.length(0);
       expect(pattern.$el.select2('val')).to.have.length(0);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
+
     it('allow only a single type to be selectable', function () {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems" />' +
         '</div>').appendTo('body');
@@ -285,16 +297,12 @@ define([
       $('.pattern-relateditems-result-select').first().click();
       expect(pattern.$el.select2('data')).to.have.length(0);
 
-      $('.pattern-relateditems-type-Image .pattern-relateditems-result-select').first().click();
+      $('.contenttype-image:parent').first().click();
       expect(pattern.$el.select2('data')).to.have.length(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
+
     it('clicking folder button filters to that folder', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -313,14 +321,10 @@ define([
         expect(pattern.browsing).to.be.equal(true);
         expect(pattern.currentPath).to.equal($(this).attr('data-path'));
       }).click();
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
-/*fgrcon
+
     it('after selecting a folder, it remains in the results list', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -341,14 +345,10 @@ define([
       var result = $('.pattern-relateditems-result-path')
         .filter(function() { return $(this).text() === '/about'; });
       expect(result.length).to.equal(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop').remove();
     });
-*/
-/*fgrcon
+
     it('clicking on breadcrumbs goes back up', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -373,13 +373,10 @@ define([
       }).click();
       clock.tick(1000);
       expect(pattern.currentPath).to.equal('/about');
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
-/*fgrcon    it('maximum number of selected items', function() {
-      var $el = $('' +
+
+    it('maximum number of selected items', function() {
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        data-pat-relateditems="width: 300px;' +
@@ -396,13 +393,10 @@ define([
       expect(pattern.$el.select2('data')).to.have.length(1);
       $('.pattern-relateditems-result-select').last().click();
       expect(pattern.$el.select2('data')).to.have.length(1);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
+
     it('init selection', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -415,13 +409,10 @@ define([
       var clock = sinon.useFakeTimers();
       pattern.$el.select2('open');
       clock.tick(1000);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-/*fgrcon
+
     it('test tree initialized', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -440,13 +431,10 @@ define([
       clock.tick(1000);
 
       expect($el.find('.pat-tree ul li').length).to.equal(4);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('test tree select', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -469,13 +457,10 @@ define([
       clock.tick(1000);
 
       expect($el.find('.crumb').length).to.equal(2);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
     it('test tree sub select', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -501,13 +486,10 @@ define([
       clock.tick(1000);
 
       expect($el.find('.crumb').length).to.equal(3);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
-*/
+
     it('test tree cancel', function() {
-      var $el = $('' +
+      $el = $('' +
         '<div>' +
         ' <input class="pat-relateditems"' +
         '        value="asdf1234,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"' +
@@ -531,13 +513,8 @@ define([
 
       expect($el.find('.crumb').length).to.equal(1);
       expect($el.find('.tree-container').is(':visible')).to.equal(false);
-
-      $el.remove();
-      $('.select2-sizer, .select2-drop, .select2-drop-mask').remove();
     });
 
-
-
   });
 
 });


