Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2022-02-02T17:49:23+01:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/f7afcc200f97f5a29246346b37d9460f5573b644

remove viewlet

Files changed:
A news/268.bugfix
A plone/app/upgrade/v60/profiles/to6004/viewlets.xml
M plone/app/upgrade/v60/configure.zcml
M plone/app/upgrade/v60/profiles.zcml

b'diff --git a/news/268.bugfix b/news/268.bugfix\nnew file mode 100644\nindex 00000000..79bebc70\n--- /dev/null\n+++ b/news/268.bugfix\n@@ -0,0 +1,2 @@\n+Upgrade step to remove the removed viewlet plone.header\n+[erral]\ndiff --git a/plone/app/upgrade/v60/configure.zcml b/plone/app/upgrade/v60/configure.zcml\nindex 9ca8fdb8..fdcec2b4 100644\n--- a/plone/app/upgrade/v60/configure.zcml\n+++ b/plone/app/upgrade/v60/configure.zcml\n@@ -87,6 +87,11 @@\n           handler="..utils.null_upgrade_step"\n           />\n \n+      <gs:upgradeDepends\n+           title="Run to6004 upgrade profile."\n+           import_profile="plone.app.upgrade.v60:to6004"\n+           />\n+\n     </gs:upgradeSteps>\n \n </configure>\ndiff --git a/plone/app/upgrade/v60/profiles.zcml b/plone/app/upgrade/v60/profiles.zcml\nindex 065a579f..e31f4f4a 100644\n--- a/plone/app/upgrade/v60/profiles.zcml\n+++ b/plone/app/upgrade/v60/profiles.zcml\n@@ -19,6 +19,15 @@\n       provides="Products.GenericSetup.interfaces.EXTENSION"\n       />\n \n+  <genericsetup:registerProfile\n+      name="to6004"\n+      title="Upgrade profile to Plone 6.0.0a4 (6004)"\n+      directory="profiles/to6004"\n+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      />\n+\n+\n   <!--\n     This is special, we want to reread the profile to create the FTI only if the old FTI\n     is not already a Dexterity one\ndiff --git a/plone/app/upgrade/v60/profiles/to6004/viewlets.xml b/plone/app/upgrade/v60/profiles/to6004/viewlets.xml\nnew file mode 100644\nindex 00000000..0153936f\n--- /dev/null\n+++ b/plone/app/upgrade/v60/profiles/to6004/viewlets.xml\n@@ -0,0 +1,6 @@\n+<?xml version="1.0"?>\n+<object>\n+  <order manager="plone.portaltop" skinname="Plone Default">\n+    <viewlet name="plone.header" remove="true"/>\n+  </order>\n+</object>\n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2022-02-09T17:44:21+01:00
Author: agitator (agitator) <agitator@users.noreply.github.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/94fc3c66b2840f57479036547c0176f15bf9b0df

Merge pull request #268 from plone/erral-remove-viewlet-in-viewlet

remove viewlet

Files changed:
A news/268.bugfix
A plone/app/upgrade/v60/profiles/to6004/viewlets.xml
M plone/app/upgrade/v60/configure.zcml
M plone/app/upgrade/v60/profiles.zcml

b'diff --git a/news/268.bugfix b/news/268.bugfix\nnew file mode 100644\nindex 00000000..79bebc70\n--- /dev/null\n+++ b/news/268.bugfix\n@@ -0,0 +1,2 @@\n+Upgrade step to remove the removed viewlet plone.header\n+[erral]\ndiff --git a/plone/app/upgrade/v60/configure.zcml b/plone/app/upgrade/v60/configure.zcml\nindex 9ca8fdb8..fdcec2b4 100644\n--- a/plone/app/upgrade/v60/configure.zcml\n+++ b/plone/app/upgrade/v60/configure.zcml\n@@ -87,6 +87,11 @@\n           handler="..utils.null_upgrade_step"\n           />\n \n+      <gs:upgradeDepends\n+           title="Run to6004 upgrade profile."\n+           import_profile="plone.app.upgrade.v60:to6004"\n+           />\n+\n     </gs:upgradeSteps>\n \n </configure>\ndiff --git a/plone/app/upgrade/v60/profiles.zcml b/plone/app/upgrade/v60/profiles.zcml\nindex 065a579f..e31f4f4a 100644\n--- a/plone/app/upgrade/v60/profiles.zcml\n+++ b/plone/app/upgrade/v60/profiles.zcml\n@@ -19,6 +19,15 @@\n       provides="Products.GenericSetup.interfaces.EXTENSION"\n       />\n \n+  <genericsetup:registerProfile\n+      name="to6004"\n+      title="Upgrade profile to Plone 6.0.0a4 (6004)"\n+      directory="profiles/to6004"\n+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      />\n+\n+\n   <!--\n     This is special, we want to reread the profile to create the FTI only if the old FTI\n     is not already a Dexterity one\ndiff --git a/plone/app/upgrade/v60/profiles/to6004/viewlets.xml b/plone/app/upgrade/v60/profiles/to6004/viewlets.xml\nnew file mode 100644\nindex 00000000..0153936f\n--- /dev/null\n+++ b/plone/app/upgrade/v60/profiles/to6004/viewlets.xml\n@@ -0,0 +1,6 @@\n+<?xml version="1.0"?>\n+<object>\n+  <order manager="plone.portaltop" skinname="Plone Default">\n+    <viewlet name="plone.header" remove="true"/>\n+  </order>\n+</object>\n'

