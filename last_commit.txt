Repository: plone.app.theming


Branch: refs/heads/master
Date: 2019-08-13T13:10:54+02:00
Author: Fred van Dijk (fredvd) <fredvd@gmail.com>
Commit: https://github.com/plone/plone.app.theming/commit/8699aeb8a9669b5999383b4a14d5eafd8d5d4f58

Fix python3 error when ttw theme name doubles fs theme

Python 3 throws TypeError, filter not subscriptable.  could add TypeError to the exception, but makes swallowing errors more generic...

Files changed:
M src/plone/app/theming/browser/controlpanel.py

b'diff --git a/src/plone/app/theming/browser/controlpanel.py b/src/plone/app/theming/browser/controlpanel.py\nindex b792bf9..8bff914 100644\n--- a/src/plone/app/theming/browser/controlpanel.py\n+++ b/src/plone/app/theming/browser/controlpanel.py\n@@ -439,11 +439,11 @@ def themeList(self):\n             if len([x for x in self.availableThemes if x.__name__ == theme.__name__]) > 1:\n                 # Then we make sure we\'re using the TTW version, not the filesystem version.\n                 try:\n-                    theme = filter(lambda x: x.__name__ == theme.__name__, self.zodbThemes)[0]\n+                    theme = list(filter(lambda x: x.__name__ == theme.__name__, self.zodbThemes))[0]\n                     override = True\n                 # Or when TTW is not available, the first available filesystem version.\n                 except IndexError:\n-                    theme = filter(lambda x: x.__name__ == theme.__name__, self.availableThemes)[0]\n+                    theme = list(filter(lambda x: x.__name__ == theme.__name__, self.availableThemes))[0]\n \n             previewUrl = "++resource++plone.app.theming/defaultPreview.png"\n             if theme.preview:\n'

Repository: plone.app.theming


Branch: refs/heads/master
Date: 2019-08-23T11:26:27+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.app.theming/commit/37642001c55eb4764f5d287085e974a834ce2467

Merge pull request #163 from plone/fredvd-python3-themefilter

Fix python3 error when ttw theme name doubles fs theme

Files changed:
M src/plone/app/theming/browser/controlpanel.py

b'diff --git a/src/plone/app/theming/browser/controlpanel.py b/src/plone/app/theming/browser/controlpanel.py\nindex b792bf9..8bff914 100644\n--- a/src/plone/app/theming/browser/controlpanel.py\n+++ b/src/plone/app/theming/browser/controlpanel.py\n@@ -439,11 +439,11 @@ def themeList(self):\n             if len([x for x in self.availableThemes if x.__name__ == theme.__name__]) > 1:\n                 # Then we make sure we\'re using the TTW version, not the filesystem version.\n                 try:\n-                    theme = filter(lambda x: x.__name__ == theme.__name__, self.zodbThemes)[0]\n+                    theme = list(filter(lambda x: x.__name__ == theme.__name__, self.zodbThemes))[0]\n                     override = True\n                 # Or when TTW is not available, the first available filesystem version.\n                 except IndexError:\n-                    theme = filter(lambda x: x.__name__ == theme.__name__, self.availableThemes)[0]\n+                    theme = list(filter(lambda x: x.__name__ == theme.__name__, self.availableThemes))[0]\n \n             previewUrl = "++resource++plone.app.theming/defaultPreview.png"\n             if theme.preview:\n'

