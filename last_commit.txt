Repository: plone.staticresources


Branch: refs/heads/master
Date: 2022-06-15T12:19:13+03:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.staticresources/commit/9889a65ac56a23d518c543926307fa6d591e958b

Add image fullscreen support thru fullscreen API

Files changed:
A news/226.feature
A src/plone/staticresources/static/plone-fullscreen/fullscreen.css
A src/plone/staticresources/static/plone-fullscreen/fullscreen.js
M src/plone/staticresources/profiles/default/registry/bundles.xml

b'diff --git a/news/226.feature b/news/226.feature\nnew file mode 100644\nindex 00000000..2aefa874\n--- /dev/null\n+++ b/news/226.feature\n@@ -0,0 +1,2 @@\n+Add image full screen support thru full screen API\n+[MrTango]\ndiff --git a/src/plone/staticresources/profiles/default/registry/bundles.xml b/src/plone/staticresources/profiles/default/registry/bundles.xml\nindex 9d4acdf4..864a6cfe 100644\n--- a/src/plone/staticresources/profiles/default/registry/bundles.xml\n+++ b/src/plone/staticresources/profiles/default/registry/bundles.xml\n@@ -25,4 +25,12 @@\n     <value key="load_defer">False</value>\n   </records>\n \n+  <records prefix="plone.bundles/plone-fullscreen" interface="Products.CMFPlone.interfaces.IBundleRegistry">\n+    <value key="enabled">True</value>\n+    <value key="jscompilation">++plone++static/plone-fullscreen/fullscreen.js</value>\n+    <value key="csscompilation">++plone++static/plone-fullscreen/fullscreen.css</value>\n+    <value key="load_async">True</value>\n+    <value key="load_defer">False</value>\n+  </records>\n+\n </registry>\ndiff --git a/src/plone/staticresources/static/plone-fullscreen/fullscreen.css b/src/plone/staticresources/static/plone-fullscreen/fullscreen.css\nnew file mode 100644\nindex 00000000..f3a766c6\n--- /dev/null\n+++ b/src/plone/staticresources/static/plone-fullscreen/fullscreen.css\n@@ -0,0 +1,31 @@\n+\n+.zoomable:fullscreen {\n+  width: 100%;\n+  display: grid;\n+  grid-template-rows: auto;\n+}\n+.zoomable:fullscreen img {\n+  margin: 0;\n+  position: fixed;\n+  top: 0;\n+  width: 100%;\n+  height: 100%;\n+  min-width: 0;\n+  max-width: none;\n+  min-height: 0;\n+  max-height: none;\n+  box-sizing: border-box;\n+  object-fit: contain;\n+  transform: none;\n+}\n+.zoomable:fullscreen .image-caption{\n+  color: white;\n+  width: 100%;\n+  display: block;\n+  position: fixed;\n+  bottom: 0;\n+  padding: 0.5em max(50% - 380px, 1em);\n+  font-size: 1.2em;\n+  text-align: center;\n+  background-color: rgba(0, 0, 0, 0.377);\n+}\ndiff --git a/src/plone/staticresources/static/plone-fullscreen/fullscreen.js b/src/plone/staticresources/static/plone-fullscreen/fullscreen.js\nnew file mode 100644\nindex 00000000..5cbf585c\n--- /dev/null\n+++ b/src/plone/staticresources/static/plone-fullscreen/fullscreen.js\n@@ -0,0 +1,25 @@\n+document.addEventListener("DOMContentLoaded", function (event) {\n+  let all = document.querySelectorAll(".zoomable");\n+  if (all.length > 0) {\n+    for (let i of all) {\n+      i.addEventListener("click", (e) => {\n+        if (\n+          document.fullscreenElement != null ||\n+          document.webkitFullscreenElement != null\n+        ) {\n+          if (document.exitFullscreen) {\n+            document.exitFullscreen();\n+          } else {\n+            document.webkitCancelFullScreen();\n+          }\n+        } else {\n+          if (i.requestFullscreen) {\n+            i.requestFullscreen();\n+          } else {\n+            i.webkitRequestFullScreen();\n+          }\n+        }\n+      });\n+    }\n+  }\n+});\n'

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2022-06-15T15:56:59+03:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.staticresources/commit/050f109e2333dce03587b8fb898e3c7571bcd5fb

add cursor poiter for zoomable images

Files changed:
M src/plone/staticresources/static/plone-fullscreen/fullscreen.css

b'diff --git a/src/plone/staticresources/static/plone-fullscreen/fullscreen.css b/src/plone/staticresources/static/plone-fullscreen/fullscreen.css\nindex f3a766c6..f5162922 100644\n--- a/src/plone/staticresources/static/plone-fullscreen/fullscreen.css\n+++ b/src/plone/staticresources/static/plone-fullscreen/fullscreen.css\n@@ -1,4 +1,7 @@\n \n+.zoomable{\n+  cursor: pointer;\n+}\n .zoomable:fullscreen {\n   width: 100%;\n   display: grid;\n@@ -18,7 +21,7 @@\n   object-fit: contain;\n   transform: none;\n }\n-.zoomable:fullscreen .image-caption{\n+.zoomable:fullscreen figcaption{\n   color: white;\n   width: 100%;\n   display: block;\n'

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2022-06-17T17:28:11+03:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.staticresources/commit/7963c145c9d8d78f654f053c8eb13fe849ce075d

disable async for plone-fullscreen bundle

Files changed:
M src/plone/staticresources/profiles/default/registry/bundles.xml

b'diff --git a/src/plone/staticresources/profiles/default/registry/bundles.xml b/src/plone/staticresources/profiles/default/registry/bundles.xml\nindex 864a6cfe..1ce2ca29 100644\n--- a/src/plone/staticresources/profiles/default/registry/bundles.xml\n+++ b/src/plone/staticresources/profiles/default/registry/bundles.xml\n@@ -29,7 +29,7 @@\n     <value key="enabled">True</value>\n     <value key="jscompilation">++plone++static/plone-fullscreen/fullscreen.js</value>\n     <value key="csscompilation">++plone++static/plone-fullscreen/fullscreen.css</value>\n-    <value key="load_async">True</value>\n+    <value key="load_async">False</value>\n     <value key="load_defer">False</value>\n   </records>\n \n'

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2022-06-17T18:35:01+03:00
Author: Maik Derstappen (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.staticresources/commit/d721c66c497527a0776e8cfaffb7c60668eb181c

Merge pull request #226 from plone/image-fullscreen-support

Add image fullscreen support thru fullscreen API

Files changed:
A news/226.feature
A src/plone/staticresources/static/plone-fullscreen/fullscreen.css
A src/plone/staticresources/static/plone-fullscreen/fullscreen.js
M src/plone/staticresources/profiles/default/registry/bundles.xml

b'diff --git a/news/226.feature b/news/226.feature\nnew file mode 100644\nindex 00000000..2aefa874\n--- /dev/null\n+++ b/news/226.feature\n@@ -0,0 +1,2 @@\n+Add image full screen support thru full screen API\n+[MrTango]\ndiff --git a/src/plone/staticresources/profiles/default/registry/bundles.xml b/src/plone/staticresources/profiles/default/registry/bundles.xml\nindex 9d4acdf4..1ce2ca29 100644\n--- a/src/plone/staticresources/profiles/default/registry/bundles.xml\n+++ b/src/plone/staticresources/profiles/default/registry/bundles.xml\n@@ -25,4 +25,12 @@\n     <value key="load_defer">False</value>\n   </records>\n \n+  <records prefix="plone.bundles/plone-fullscreen" interface="Products.CMFPlone.interfaces.IBundleRegistry">\n+    <value key="enabled">True</value>\n+    <value key="jscompilation">++plone++static/plone-fullscreen/fullscreen.js</value>\n+    <value key="csscompilation">++plone++static/plone-fullscreen/fullscreen.css</value>\n+    <value key="load_async">False</value>\n+    <value key="load_defer">False</value>\n+  </records>\n+\n </registry>\ndiff --git a/src/plone/staticresources/static/plone-fullscreen/fullscreen.css b/src/plone/staticresources/static/plone-fullscreen/fullscreen.css\nnew file mode 100644\nindex 00000000..f5162922\n--- /dev/null\n+++ b/src/plone/staticresources/static/plone-fullscreen/fullscreen.css\n@@ -0,0 +1,34 @@\n+\n+.zoomable{\n+  cursor: pointer;\n+}\n+.zoomable:fullscreen {\n+  width: 100%;\n+  display: grid;\n+  grid-template-rows: auto;\n+}\n+.zoomable:fullscreen img {\n+  margin: 0;\n+  position: fixed;\n+  top: 0;\n+  width: 100%;\n+  height: 100%;\n+  min-width: 0;\n+  max-width: none;\n+  min-height: 0;\n+  max-height: none;\n+  box-sizing: border-box;\n+  object-fit: contain;\n+  transform: none;\n+}\n+.zoomable:fullscreen figcaption{\n+  color: white;\n+  width: 100%;\n+  display: block;\n+  position: fixed;\n+  bottom: 0;\n+  padding: 0.5em max(50% - 380px, 1em);\n+  font-size: 1.2em;\n+  text-align: center;\n+  background-color: rgba(0, 0, 0, 0.377);\n+}\ndiff --git a/src/plone/staticresources/static/plone-fullscreen/fullscreen.js b/src/plone/staticresources/static/plone-fullscreen/fullscreen.js\nnew file mode 100644\nindex 00000000..5cbf585c\n--- /dev/null\n+++ b/src/plone/staticresources/static/plone-fullscreen/fullscreen.js\n@@ -0,0 +1,25 @@\n+document.addEventListener("DOMContentLoaded", function (event) {\n+  let all = document.querySelectorAll(".zoomable");\n+  if (all.length > 0) {\n+    for (let i of all) {\n+      i.addEventListener("click", (e) => {\n+        if (\n+          document.fullscreenElement != null ||\n+          document.webkitFullscreenElement != null\n+        ) {\n+          if (document.exitFullscreen) {\n+            document.exitFullscreen();\n+          } else {\n+            document.webkitCancelFullScreen();\n+          }\n+        } else {\n+          if (i.requestFullscreen) {\n+            i.requestFullscreen();\n+          } else {\n+            i.webkitRequestFullScreen();\n+          }\n+        }\n+      });\n+    }\n+  }\n+});\n'

