Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2022-03-30T16:58:37+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.contenttypes/commit/0c28da0eaa18c5fc1c7d74bb9d5d0b9b21b9e496

Fix external links with leading space (fix https://github.com/plone/Products.CMFPlone/issues/3466)

Files changed:
M plone/app/contenttypes/browser/link_redirect_view.py

b'diff --git a/plone/app/contenttypes/browser/link_redirect_view.py b/plone/app/contenttypes/browser/link_redirect_view.py\nindex fc8e7419..a3a6c0c6 100644\n--- a/plone/app/contenttypes/browser/link_redirect_view.py\n+++ b/plone/app/contenttypes/browser/link_redirect_view.py\n@@ -33,7 +33,7 @@ class LinkRedirectView(BrowserView):\n     index = ViewPageTemplateFile(\'templates/link.pt\')\n \n     def _url_uses_scheme(self, schemes, url=None):\n-        url = url or self.context.remoteUrl\n+        url = url or self.context.remoteUrl.strip()\n         for scheme in schemes:\n             if url.startswith(scheme):\n                 return True\n@@ -69,14 +69,14 @@ def url(self):\n         """\n         url = replace_link_variables_by_paths(\n             self.context,\n-            self.context.remoteUrl\n+            self.context.remoteUrl.strip()\n         )\n         return url\n \n     def display_link(self):\n-        """Format the url for display \n+        """Format the url for display\n         """\n-    \n+\n         url = self.url()\n         if \'resolveuid\' in url:\n             uid = url.split(\'/\')[-1]\n'

