Repository: plone.app.viewletmanager


Branch: refs/heads/master
Date: 2022-11-10T09:28:30+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.viewletmanager/commit/b1445f9177d1965463cf3768a5a217513249e98a

Improve `manage-viewlets` usability

Files changed:
M plone/app/viewletmanager/manage-viewletmanager.pt
M plone/app/viewletmanager/manage-viewlets.pt

b'diff --git a/plone/app/viewletmanager/manage-viewletmanager.pt b/plone/app/viewletmanager/manage-viewletmanager.pt\nindex f34b8a5..b8d8343 100644\n--- a/plone/app/viewletmanager/manage-viewletmanager.pt\n+++ b/plone/app/viewletmanager/manage-viewletmanager.pt\n@@ -1,6 +1,7 @@\n-<div class="container mb-3">\n+<div class="container mb-3"\n+     tal:define="manager_id view/normalized_name">\n \n-  <div class="managedViewlets" tal:attributes="id view/normalized_name" i18n:domain="plone">\n+  <div class="managedViewlets" id="${manager_id}" i18n:domain="plone">\n \n     <div class="card" tal:define="auth_token context/@@authenticator/token | nothing">\n \n@@ -10,7 +11,7 @@\n \n       <div class="card-body">\n \n-        <div tal:repeat="viewlet options/viewlets" tal:attributes="class python:\'viewlet %s\' % (viewlet[\'hidden\'] and \'hiddenViewlet\' or \'\')">\n+        <div tal:repeat="viewlet options/viewlets" class="${python:\'viewlet %s\' % (\'hiddenViewlet\' if viewlet[\'hidden\'] else \'\')}">\n \n           <div class="card mb-3">\n \n@@ -20,18 +21,26 @@\n                 Viewlet <span class="text-muted" tal:content="viewlet/name">Viewlet name</span> (<span tal:replace="viewlet/index">Index</span>)\n               </div>\n \n-              <a class="btn btn-sm btn-outline-primary up mx-1 text-decoration-none" tal:condition="viewlet/up_url | nothing" tal:attributes="href string:${viewlet/up_url}&_authenticator=${auth_token}">\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject"\n+                 href="${viewlet/up_url}&_authenticator=${auth_token}#${manager_id}"\n+                 tal:condition="viewlet/up_url | nothing">\n                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-short" viewBox="0 0 16 16">\n                   <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>\n                 </svg>\n               </a>\n-              <a class="btn btn-sm btn-outline-primary down mx-1 text-decoration-none" tal:condition="viewlet/down_url | nothing" tal:attributes="href string:${viewlet/down_url}&_authenticator=${auth_token}">\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject"\n+                 href="${viewlet/down_url}&_authenticator=${auth_token}#${manager_id}"\n+                 tal:condition="viewlet/down_url | nothing">\n                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-short" viewBox="0 0 16 16">\n                   <path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z"/>\n                 </svg>\n               </a>\n-              <a class="btn btn-sm btn-outline-primary hide mx-1 text-decoration-none" i18n:translate="label_hide_item" tal:attributes="href string:${viewlet/hide_url}&_authenticator=${auth_token}">Hide</a>\n-              <a class="btn btn-sm btn-outline-primary show mx-1 text-decoration-none" i18n:translate="label_show_item" tal:attributes="href string:${viewlet/show_url}&_authenticator=${auth_token}">Show</a>\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject ${python:\'active\' if not viewlet[\'hidden\'] else \'\'}"\n+                 href="${viewlet/hide_url}&_authenticator=${auth_token}#${manager_id}"\n+                 i18n:translate="label_hide_item">Hide</a>\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject ${python:\'active\' if viewlet[\'hidden\'] else \'\'}"\n+                 href="${viewlet/show_url}&_authenticator=${auth_token}#${manager_id}"\n+                 i18n:translate="label_show_item">Show</a>\n \n             </div>\n \n@@ -49,4 +58,4 @@\n \n   </div>\n \n-</div>\n\\ No newline at end of file\n+</div>\ndiff --git a/plone/app/viewletmanager/manage-viewlets.pt b/plone/app/viewletmanager/manage-viewlets.pt\nindex add7796..c7b3c6c 100644\n--- a/plone/app/viewletmanager/manage-viewlets.pt\n+++ b/plone/app/viewletmanager/manage-viewlets.pt\n@@ -6,32 +6,21 @@\n       metal:use-macro="here/main_template/macros/master"\n       i18n:domain="plone">\n \n-      <metal:javascript_head_slot fill-slot="javascript_head_slot">\n-          <script type="text/javascript" charset="utf-8">\n-              (function($) {\n-                  $(function() {\n-                      $(\'.managedViewlets\').on(\'click\', \'.up, .down, .hide, .show\', function (e) {\n-                            e.preventDefault();\n-                            var url = $(e.currentTarget).attr(\'href\'),\n-                                vm = $(e.delegateTarget);\n-                            $(vm).load(url + \' #\' + $(vm).attr(\'id\') + \'.managedViewlets > div\');\n-                      });\n-                  });\n-              })(jQuery);\n-          </script>\n-      </metal:javascript_head_slot>\n-\n <body>\n+\n <metal:main fill-slot="main">\n \n     <style type="text/css" media="screen">\n         #portal-top { margin-top: 1em; }\n         #portal-footer-wrapper { background-color: unset; color: unset; text-align: left; padding: 0; }\n-        #plone-toolbar { padding-top: 1em; }        \n+        #plone-toolbar { padding-top: 1em; }\n         #plone-toolbar .card-header { color: #000; }\n         #plone-toolbar .card-body { background-color: #333; }\n         #plone-toolbar .d-flex { display: block; }\n         #plone-toolbar .btn { margin: 5px 5px 0 0; }\n+        .hiddenViewlet .card {\n+            --bs-card-border-color: var(--bs-gray-300);\n+        }\n     </style>\n \n     <div class="xcontainer">\n@@ -63,7 +52,7 @@\n         </div>\n \n         <div tal:replace="structure provider:plone.belowcontentbody" />\n-    \n+\n     </div>\n \n </metal:main>\n'

Repository: plone.app.viewletmanager


Branch: refs/heads/master
Date: 2022-11-10T09:28:35+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.viewletmanager/commit/9c5eabb062fb9d442dbb170ea109d30b177fb8ae

changenote

Files changed:
A news/27.bugfix

b'diff --git a/news/27.bugfix b/news/27.bugfix\nnew file mode 100644\nindex 0000000..9a8dad4\n--- /dev/null\n+++ b/news/27.bugfix\n@@ -0,0 +1,2 @@\n+Improve ``manage-viewlets`` usability.\n+[petschki]\n'

Repository: plone.app.viewletmanager


Branch: refs/heads/master
Date: 2022-11-10T17:59:52+01:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/plone.app.viewletmanager/commit/ef4ed40dcdc48ee586a62d86d8d37f2e14aaecf0

Merge pull request #28 from plone/petschki-manage-viewlets

Files changed:
A news/27.bugfix
M plone/app/viewletmanager/manage-viewletmanager.pt
M plone/app/viewletmanager/manage-viewlets.pt

b'diff --git a/news/27.bugfix b/news/27.bugfix\nnew file mode 100644\nindex 0000000..9a8dad4\n--- /dev/null\n+++ b/news/27.bugfix\n@@ -0,0 +1,2 @@\n+Improve ``manage-viewlets`` usability.\n+[petschki]\ndiff --git a/plone/app/viewletmanager/manage-viewletmanager.pt b/plone/app/viewletmanager/manage-viewletmanager.pt\nindex f34b8a5..b8d8343 100644\n--- a/plone/app/viewletmanager/manage-viewletmanager.pt\n+++ b/plone/app/viewletmanager/manage-viewletmanager.pt\n@@ -1,6 +1,7 @@\n-<div class="container mb-3">\n+<div class="container mb-3"\n+     tal:define="manager_id view/normalized_name">\n \n-  <div class="managedViewlets" tal:attributes="id view/normalized_name" i18n:domain="plone">\n+  <div class="managedViewlets" id="${manager_id}" i18n:domain="plone">\n \n     <div class="card" tal:define="auth_token context/@@authenticator/token | nothing">\n \n@@ -10,7 +11,7 @@\n \n       <div class="card-body">\n \n-        <div tal:repeat="viewlet options/viewlets" tal:attributes="class python:\'viewlet %s\' % (viewlet[\'hidden\'] and \'hiddenViewlet\' or \'\')">\n+        <div tal:repeat="viewlet options/viewlets" class="${python:\'viewlet %s\' % (\'hiddenViewlet\' if viewlet[\'hidden\'] else \'\')}">\n \n           <div class="card mb-3">\n \n@@ -20,18 +21,26 @@\n                 Viewlet <span class="text-muted" tal:content="viewlet/name">Viewlet name</span> (<span tal:replace="viewlet/index">Index</span>)\n               </div>\n \n-              <a class="btn btn-sm btn-outline-primary up mx-1 text-decoration-none" tal:condition="viewlet/up_url | nothing" tal:attributes="href string:${viewlet/up_url}&_authenticator=${auth_token}">\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject"\n+                 href="${viewlet/up_url}&_authenticator=${auth_token}#${manager_id}"\n+                 tal:condition="viewlet/up_url | nothing">\n                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-short" viewBox="0 0 16 16">\n                   <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>\n                 </svg>\n               </a>\n-              <a class="btn btn-sm btn-outline-primary down mx-1 text-decoration-none" tal:condition="viewlet/down_url | nothing" tal:attributes="href string:${viewlet/down_url}&_authenticator=${auth_token}">\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject"\n+                 href="${viewlet/down_url}&_authenticator=${auth_token}#${manager_id}"\n+                 tal:condition="viewlet/down_url | nothing">\n                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-short" viewBox="0 0 16 16">\n                   <path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z"/>\n                 </svg>\n               </a>\n-              <a class="btn btn-sm btn-outline-primary hide mx-1 text-decoration-none" i18n:translate="label_hide_item" tal:attributes="href string:${viewlet/hide_url}&_authenticator=${auth_token}">Hide</a>\n-              <a class="btn btn-sm btn-outline-primary show mx-1 text-decoration-none" i18n:translate="label_show_item" tal:attributes="href string:${viewlet/show_url}&_authenticator=${auth_token}">Show</a>\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject ${python:\'active\' if not viewlet[\'hidden\'] else \'\'}"\n+                 href="${viewlet/hide_url}&_authenticator=${auth_token}#${manager_id}"\n+                 i18n:translate="label_hide_item">Hide</a>\n+              <a class="btn btn-sm btn-outline-primary mx-1 text-decoration-none pat-inject ${python:\'active\' if viewlet[\'hidden\'] else \'\'}"\n+                 href="${viewlet/show_url}&_authenticator=${auth_token}#${manager_id}"\n+                 i18n:translate="label_show_item">Show</a>\n \n             </div>\n \n@@ -49,4 +58,4 @@\n \n   </div>\n \n-</div>\n\\ No newline at end of file\n+</div>\ndiff --git a/plone/app/viewletmanager/manage-viewlets.pt b/plone/app/viewletmanager/manage-viewlets.pt\nindex add7796..c7b3c6c 100644\n--- a/plone/app/viewletmanager/manage-viewlets.pt\n+++ b/plone/app/viewletmanager/manage-viewlets.pt\n@@ -6,32 +6,21 @@\n       metal:use-macro="here/main_template/macros/master"\n       i18n:domain="plone">\n \n-      <metal:javascript_head_slot fill-slot="javascript_head_slot">\n-          <script type="text/javascript" charset="utf-8">\n-              (function($) {\n-                  $(function() {\n-                      $(\'.managedViewlets\').on(\'click\', \'.up, .down, .hide, .show\', function (e) {\n-                            e.preventDefault();\n-                            var url = $(e.currentTarget).attr(\'href\'),\n-                                vm = $(e.delegateTarget);\n-                            $(vm).load(url + \' #\' + $(vm).attr(\'id\') + \'.managedViewlets > div\');\n-                      });\n-                  });\n-              })(jQuery);\n-          </script>\n-      </metal:javascript_head_slot>\n-\n <body>\n+\n <metal:main fill-slot="main">\n \n     <style type="text/css" media="screen">\n         #portal-top { margin-top: 1em; }\n         #portal-footer-wrapper { background-color: unset; color: unset; text-align: left; padding: 0; }\n-        #plone-toolbar { padding-top: 1em; }        \n+        #plone-toolbar { padding-top: 1em; }\n         #plone-toolbar .card-header { color: #000; }\n         #plone-toolbar .card-body { background-color: #333; }\n         #plone-toolbar .d-flex { display: block; }\n         #plone-toolbar .btn { margin: 5px 5px 0 0; }\n+        .hiddenViewlet .card {\n+            --bs-card-border-color: var(--bs-gray-300);\n+        }\n     </style>\n \n     <div class="xcontainer">\n@@ -63,7 +52,7 @@\n         </div>\n \n         <div tal:replace="structure provider:plone.belowcontentbody" />\n-    \n+\n     </div>\n \n </metal:main>\n'

