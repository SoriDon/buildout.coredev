Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2022-03-18T09:58:26+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/cf7b4e91f70b68cf56e01bbb7e2a57ba6c8dfc09

Compatibility with latest z3c.form

Files changed:
M plone/app/z3cform/tests/test_csrf.py
M setup.py

b"diff --git a/plone/app/z3cform/tests/test_csrf.py b/plone/app/z3cform/tests/test_csrf.py\nindex 0f95d3b..7824cf6 100644\n--- a/plone/app/z3cform/tests/test_csrf.py\n+++ b/plone/app/z3cform/tests/test_csrf.py\n@@ -25,9 +25,7 @@ def execute(self):\n         request = makerequest(Implicit()).REQUEST\n         request.form['_authenticator'] = createToken()\n         actions = AuthenticatedButtonActions(form, request, None)\n-        actions._data['foo'] = action = DummyAction()\n-        actions._data_keys = ['foo']\n-        actions._data_values = [action]\n+        actions['foo'] = action = DummyAction()\n \n         actions.execute()\n         # If we got here without raising Unauthorized, the test passed.\ndiff --git a/setup.py b/setup.py\nindex 14029da..d0684ca 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -60,7 +60,7 @@ def read(*rnames):\n         'Products.CMFPlone',\n         'setuptools',\n         'six',\n-        'z3c.form >= 3.0',\n+        'z3c.form >= 4.0',\n         'z3c.formwidget.query',\n         'zope.browserpage',\n         'zope.component',\n"

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2022-03-18T09:59:46+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/2644bfe7449289cc63de99873ad4c76e89bdf659

add changelog

Files changed:
A news/146.feature

b'diff --git a/news/146.feature b/news/146.feature\nnew file mode 100644\nindex 0000000..c0c015c\n--- /dev/null\n+++ b/news/146.feature\n@@ -0,0 +1,2 @@\n+Fixed for latest z3c.form\n+[petschki]\n'

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2022-03-18T10:29:30+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/c52e4c65739cfa1a645c2c8b9c69a57d3a51c882

remove unused var

Files changed:
M plone/app/z3cform/tests/test_csrf.py

b"diff --git a/plone/app/z3cform/tests/test_csrf.py b/plone/app/z3cform/tests/test_csrf.py\nindex 7824cf6..a9a1ffc 100644\n--- a/plone/app/z3cform/tests/test_csrf.py\n+++ b/plone/app/z3cform/tests/test_csrf.py\n@@ -25,7 +25,7 @@ def execute(self):\n         request = makerequest(Implicit()).REQUEST\n         request.form['_authenticator'] = createToken()\n         actions = AuthenticatedButtonActions(form, request, None)\n-        actions['foo'] = action = DummyAction()\n+        actions['foo'] = DummyAction()\n \n         actions.execute()\n         # If we got here without raising Unauthorized, the test passed.\n"

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2022-03-18T11:21:02+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/e867ab810075b9b25b7ff0160a2deaaf7a0a47a2

fix object_input.pt

Files changed:
M plone/app/z3cform/templates/object_input.pt

b'diff --git a/plone/app/z3cform/templates/object_input.pt b/plone/app/z3cform/templates/object_input.pt\nindex d5338fd..41d3799 100644\n--- a/plone/app/z3cform/templates/object_input.pt\n+++ b/plone/app/z3cform/templates/object_input.pt\n@@ -1,5 +1,5 @@\n <div i18n:domain="plone" class="object-widget" tal:attributes="class view/klass">\n-    <tal:block repeat="widget view/subform/widgets/values">\n+    <tal:block repeat="widget view/widgets/values">\n         <div tal:define="hidden python:widget.mode == \'hidden\';\n                          error widget/error;\n                          error_class python:error and \' error\' or \'\';\n'

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2022-03-21T13:25:11+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/ae947437a8e60d4586b853461200bbd397234d2f

explicit iteration over widgets

Files changed:
M plone/app/z3cform/templates/macros.pt
M plone/app/z3cform/templates/object_input.pt

b'diff --git a/plone/app/z3cform/templates/macros.pt b/plone/app/z3cform/templates/macros.pt\nindex 0dfce19..e8582f5 100644\n--- a/plone/app/z3cform/templates/macros.pt\n+++ b/plone/app/z3cform/templates/macros.pt\n@@ -100,7 +100,7 @@\n                                       tal:content="default_fieldset_label">Form name</legend>\n \n                               <metal:define define-macro="widget_rendering">\n-                                  <tal:widgets repeat="widget view/widgets/values">\n+                                  <tal:widgets repeat="widget python:view.widgets.values()">\n                                       <metal:field-slot define-slot="field">\n                                           <metal:field define-macro="field">\n                                               <tal:widget tal:replace="structure widget/@@ploneform-render-widget"/>\ndiff --git a/plone/app/z3cform/templates/object_input.pt b/plone/app/z3cform/templates/object_input.pt\nindex 41d3799..8211599 100644\n--- a/plone/app/z3cform/templates/object_input.pt\n+++ b/plone/app/z3cform/templates/object_input.pt\n@@ -1,5 +1,5 @@\n <div i18n:domain="plone" class="object-widget" tal:attributes="class view/klass">\n-    <tal:block repeat="widget view/widgets/values">\n+    <tal:block repeat="widget python:view.widgets.values()">\n         <div tal:define="hidden python:widget.mode == \'hidden\';\n                          error widget/error;\n                          error_class python:error and \' error\' or \'\';\n'

Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2022-03-22T13:38:56+01:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/cc1d8acddff3b0f653829348b3603bd8e05d54fd

Merge pull request #146 from plone/z3c-form-latest

Compatibility with latest z3c.form

Files changed:
A news/146.feature
M plone/app/z3cform/templates/macros.pt
M plone/app/z3cform/templates/object_input.pt
M plone/app/z3cform/tests/test_csrf.py
M setup.py

b'diff --git a/news/146.feature b/news/146.feature\nnew file mode 100644\nindex 0000000..c0c015c\n--- /dev/null\n+++ b/news/146.feature\n@@ -0,0 +1,2 @@\n+Fixed for latest z3c.form\n+[petschki]\ndiff --git a/plone/app/z3cform/templates/macros.pt b/plone/app/z3cform/templates/macros.pt\nindex 0dfce19..e8582f5 100644\n--- a/plone/app/z3cform/templates/macros.pt\n+++ b/plone/app/z3cform/templates/macros.pt\n@@ -100,7 +100,7 @@\n                                       tal:content="default_fieldset_label">Form name</legend>\n \n                               <metal:define define-macro="widget_rendering">\n-                                  <tal:widgets repeat="widget view/widgets/values">\n+                                  <tal:widgets repeat="widget python:view.widgets.values()">\n                                       <metal:field-slot define-slot="field">\n                                           <metal:field define-macro="field">\n                                               <tal:widget tal:replace="structure widget/@@ploneform-render-widget"/>\ndiff --git a/plone/app/z3cform/templates/object_input.pt b/plone/app/z3cform/templates/object_input.pt\nindex d5338fd..8211599 100644\n--- a/plone/app/z3cform/templates/object_input.pt\n+++ b/plone/app/z3cform/templates/object_input.pt\n@@ -1,5 +1,5 @@\n <div i18n:domain="plone" class="object-widget" tal:attributes="class view/klass">\n-    <tal:block repeat="widget view/subform/widgets/values">\n+    <tal:block repeat="widget python:view.widgets.values()">\n         <div tal:define="hidden python:widget.mode == \'hidden\';\n                          error widget/error;\n                          error_class python:error and \' error\' or \'\';\ndiff --git a/plone/app/z3cform/tests/test_csrf.py b/plone/app/z3cform/tests/test_csrf.py\nindex 0f95d3b..a9a1ffc 100644\n--- a/plone/app/z3cform/tests/test_csrf.py\n+++ b/plone/app/z3cform/tests/test_csrf.py\n@@ -25,9 +25,7 @@ def execute(self):\n         request = makerequest(Implicit()).REQUEST\n         request.form[\'_authenticator\'] = createToken()\n         actions = AuthenticatedButtonActions(form, request, None)\n-        actions._data[\'foo\'] = action = DummyAction()\n-        actions._data_keys = [\'foo\']\n-        actions._data_values = [action]\n+        actions[\'foo\'] = DummyAction()\n \n         actions.execute()\n         # If we got here without raising Unauthorized, the test passed.\ndiff --git a/setup.py b/setup.py\nindex 14029da..d0684ca 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -60,7 +60,7 @@ def read(*rnames):\n         \'Products.CMFPlone\',\n         \'setuptools\',\n         \'six\',\n-        \'z3c.form >= 3.0\',\n+        \'z3c.form >= 4.0\',\n         \'z3c.formwidget.query\',\n         \'zope.browserpage\',\n         \'zope.component\',\n'

