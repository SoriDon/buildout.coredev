Repository: plone.restapi


Branch: refs/heads/master
Date: 2023-02-05T13:28:19-03:00
Author: Ã‰rico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/fec2d7f917622665099995031574bcc514a44ff5

Implement IRuleAction and IRuleCondition schema serialization in @controlpanels/content-rules/ endpoint (#1580)

* Implement IRuleAction and IRuleCondition schema serialization in @controlpanels/content-rules/ endpoint

* Remove unused import

* Rename schema to @schema and add it also to the action or condition response

Files changed:
A news/1579.feature
M src/plone/restapi/controlpanels/rules.py
M src/plone/restapi/serializer/controlpanels/rules.py
M src/plone/restapi/tests/http-examples/controlpanels_get_rule.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_copy.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_logger.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_mail.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_move.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_notify.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_transition.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_versioning.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_fileextension.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_group.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_portaltype.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_role.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_tales.resp
M src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_workflowstate.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_copy.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_delete.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_logger.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_mail.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_move.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_notify.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_transition.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_versioning.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_fileextension.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_group.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_portaltype.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_role.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_tales.resp
M src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_workflowstate.resp

b'diff --git a/news/1579.feature b/news/1579.feature\nnew file mode 100644\nindex 000000000..6882ac619\n--- /dev/null\n+++ b/news/1579.feature\n@@ -0,0 +1 @@\n+Implement IRuleAction and IRuleCondition schema serialization in `@controlpanels/content-rules/` endpoint. [ericof]\ndiff --git a/src/plone/restapi/controlpanels/rules.py b/src/plone/restapi/controlpanels/rules.py\nindex 15fb8b6f5..0433024a8 100644\n--- a/src/plone/restapi/controlpanels/rules.py\n+++ b/src/plone/restapi/controlpanels/rules.py\n@@ -11,6 +11,7 @@\n from plone.restapi.controlpanels import RegistryConfigletPanel\n from plone.restapi.controlpanels.interfaces import IContentRulesControlpanel\n from plone.restapi.deserializer import json_body\n+from plone.restapi.serializer.controlpanels.rules import rule_schema_as_json\n import plone.protect.interfaces\n \n \n@@ -22,7 +23,6 @@ class ContentRulesControlpanel(RegistryConfigletPanel):\n     configlet_category_id = "plone-content"\n \n     def publishTraverse(self, request, name):\n-\n         return self.context.restrictedTraverse("++rule++" + name)\n \n     def add(self, names):\n@@ -81,16 +81,21 @@ def get(self, names):\n             return serializer(context)\n         else:\n             # the get is for a condition or action\n-            fields = {}\n-            rule = self.publishTraverse(self.request, name=names[0])\n-            extras = getattr(rule, names[1] + "s")\n+            rule_name = names[0]\n+            category = names[1]\n+            rule = self.publishTraverse(self.request, name=rule_name)\n+            extras = getattr(rule, f"{category}s")\n             idx = int(names[2])\n             extra_ob = extras[idx]\n             view = queryMultiAdapter((extra_ob, self.request), name="edit")\n+            base_url = f"{self.context.absolute_url()}/@controlpanels/content-rules"\n+            fields = {"@id": f"{base_url}/{rule_name}/{category}/{idx}"}\n             if view:\n                 view.form_instance.update()\n                 for field in view.form_instance.fields:\n                     fields[field] = getattr(extra_ob, field)\n+                schema = view.form.schema\n+                fields["@schema"] = rule_schema_as_json(schema, self.request)\n                 return fields\n \n     def update(self, names):\ndiff --git a/src/plone/restapi/serializer/controlpanels/rules.py b/src/plone/restapi/serializer/controlpanels/rules.py\nindex 055956bc2..387039b5f 100644\n--- a/src/plone/restapi/serializer/controlpanels/rules.py\n+++ b/src/plone/restapi/serializer/controlpanels/rules.py\n@@ -1,28 +1,82 @@\n-from plone.restapi.interfaces import ISerializeToJson\n+from plone.contentrules.rule.interfaces import IRuleAction\n+from plone.contentrules.rule.interfaces import IRuleCondition\n+from plone.dexterity.interfaces import IDexterityContent\n from plone.restapi.controlpanels.interfaces import IContentRulesControlpanel\n-from plone.restapi.serializer.controlpanels import SERVICE_ID\n+from plone.restapi.interfaces import ISerializeToJson\n from plone.restapi.serializer.controlpanels import ControlpanelSerializeToJson\n+from plone.restapi.serializer.controlpanels import SERVICE_ID\n+from plone.restapi.types import utils\n from zope.component import adapter\n-from zope.component.hooks import getSite\n+from zope.component import getAllUtilitiesRegisteredFor\n from zope.component import queryMultiAdapter\n+from zope.component.hooks import getSite\n from zope.interface import implementer\n \n \n+@implementer(IDexterityContent)\n+class FakeDXContext:\n+    """Fake DX content class, so we can re-use the DX field serializers"""\n+\n+\n+def rule_schema_as_json(schema, request):\n+    """Build a complete JSON schema for the given controlpanel."""\n+    context = FakeDXContext()\n+    fieldsets = utils.get_fieldsets(context, request, schema)\n+\n+    # Build JSON schema properties\n+    properties = utils.get_jsonschema_properties(context, request, fieldsets)\n+\n+    # Determine required fields\n+    required = []\n+    for field in utils.iter_fields(fieldsets):\n+        if field.field.required:\n+            required.append(field.field.getName())\n+\n+    # Include field modes\n+    for field in utils.iter_fields(fieldsets):\n+        if field.mode:\n+            properties[field.field.getName()]["mode"] = field.mode\n+\n+    return {\n+        "type": "object",\n+        "properties": properties,\n+        "required": required,\n+        "fieldsets": utils.get_fieldset_infos(fieldsets),\n+    }\n+\n+\n @implementer(ISerializeToJson)\n @adapter(IContentRulesControlpanel)\n class ContentRulesControlpanelSerializeToJson(ControlpanelSerializeToJson):\n+    def _serialize_schema(self, elements, interface):\n+        request = self.controlpanel.request\n+        all_utils = {\n+            util.title: util for util in getAllUtilitiesRegisteredFor(interface)\n+        }\n+        for element in elements:\n+            element["@schema"] = rule_schema_as_json(\n+                all_utils[element["title"]].schema, request\n+            )\n+        return elements\n+\n+    def addable_actions(self, manage_elements):\n+        addable_actions = manage_elements.addable_actions()\n+        return self._serialize_schema(addable_actions, IRuleAction)\n+\n+    def addable_conditions(self, manage_elements):\n+        addable_conditions = manage_elements.addable_conditions()\n+        return self._serialize_schema(addable_conditions, IRuleCondition)\n+\n     def serialize_item(self, proxy):\n         manage_elements = queryMultiAdapter(\n             (proxy, self.controlpanel.request), name="manage-elements"\n         )\n+        url = self.controlpanel.context.absolute_url()\n+        name = self.controlpanel.__name__\n+        proxy_name = proxy.__name__\n         return {\n-            "@id": "{}/{}/{}/{}".format(\n-                self.controlpanel.context.absolute_url(),\n-                SERVICE_ID,\n-                self.controlpanel.__name__,\n-                proxy.__name__,\n-            ),\n-            "id": proxy.__name__,\n+            "@id": f"{url}/{SERVICE_ID}/{name}/{proxy_name}",\n+            "id": proxy_name,\n             "title": proxy.title,\n             "description": proxy.description,\n             "group": self.controlpanel.group,\n@@ -31,9 +85,9 @@ def serialize_item(self, proxy):\n             "enabled": proxy.enabled,\n             "event": manage_elements.rule_event(),\n             "conditions": manage_elements.conditions(),\n-            "addable_conditions": manage_elements.addable_conditions(),\n+            "addable_conditions": self.addable_conditions(manage_elements),\n             "actions": manage_elements.actions(),\n-            "addable_actions": manage_elements.addable_actions(),\n+            "addable_actions": self.addable_actions(manage_elements),\n             "assignments": manage_elements.assignments(),\n         }\n \n@@ -53,9 +107,8 @@ def __call__(self, item=None):\n         registeredRules = cpanel.registeredRules()\n \n         for rule in registeredRules:\n-            rule["@id"] = "{}/@controlpanels/content-rules/{}".format(\n-                portal_url, rule["id"]\n-            )\n+            rule_id = rule["id"]\n+            rule["@id"] = f"{portal_url}/@controlpanels/content-rules/{rule_id}"\n         json["items"].append(registeredRules)\n \n         return json\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule.resp\nindex 943c31512..41a5ad1ec 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule.resp\n@@ -79,41 +79,309 @@ Content-Type: application/json\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "Caught &e at &c by &u",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -121,31 +389,219 @@ Content-Type: application/json\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_copy.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_copy.resp\nindex 230ed5fc1..7e328e071 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_copy.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_copy.resp\n@@ -2,5 +2,33 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/action/2",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "target_folder"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "target_folder": {\n+                "description": "As a path relative to the portal root.",\n+                "factory": "Choice",\n+                "title": "Target folder",\n+                "type": "string",\n+                "vocabulary": {\n+                    "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                }\n+            }\n+        },\n+        "required": [\n+            "target_folder"\n+        ],\n+        "type": "object"\n+    },\n     "target_folder": "/folder"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_logger.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_logger.resp\nindex ea4a0145c..7d4bd41cc 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_logger.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_logger.resp\n@@ -2,6 +2,50 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/action/0",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "loggingLevel": {\n+                "default": 20,\n+                "description": "",\n+                "factory": "Integer",\n+                "title": "Logging level",\n+                "type": "integer"\n+            },\n+            "message": {\n+                "default": "Caught &e at &c by &u",\n+                "description": "&e = the triggering event, &c = the context, &u = the user",\n+                "factory": "Text line (String)",\n+                "title": "Message",\n+                "type": "string"\n+            },\n+            "targetLogger": {\n+                "default": "Plone",\n+                "description": "",\n+                "factory": "Text line (String)",\n+                "title": "Logger name",\n+                "type": "string"\n+            }\n+        },\n+        "required": [\n+            "targetLogger",\n+            "loggingLevel",\n+            "message"\n+        ],\n+        "type": "object"\n+    },\n     "loggingLevel": "",\n     "message": "text_contentrules_logger_message",\n     "targetLogger": "Plone"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_mail.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_mail.resp\nindex f8752862f..e93f15c4d 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_mail.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_mail.resp\n@@ -2,6 +2,63 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/action/6",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "subject",\n+                    "source",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "exclude_actor": {\n+                "description": "Do not send the email to the user that did the action.",\n+                "factory": "Yes/No",\n+                "title": "Exclude actor from recipients",\n+                "type": "boolean"\n+            },\n+            "message": {\n+                "description": "The message that you want to mail.",\n+                "factory": "Text",\n+                "title": "Message",\n+                "type": "string",\n+                "widget": "textarea"\n+            },\n+            "recipients": {\n+                "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                "factory": "Text line (String)",\n+                "title": "Email recipients",\n+                "type": "string"\n+            },\n+            "source": {\n+                "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                "factory": "Text line (String)",\n+                "title": "Email source",\n+                "type": "string"\n+            },\n+            "subject": {\n+                "description": "Subject of the message",\n+                "factory": "Text line (String)",\n+                "title": "Subject",\n+                "type": "string"\n+            }\n+        },\n+        "required": [\n+            "subject",\n+            "recipients",\n+            "exclude_actor",\n+            "message"\n+        ],\n+        "type": "object"\n+    },\n     "exclude_actor": true,\n     "message": "And the message body",\n     "recipients": "test@somethingelse.com",\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_move.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_move.resp\nindex 230ed5fc1..c3e810574 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_move.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_move.resp\n@@ -2,5 +2,33 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/action/3",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "target_folder"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "target_folder": {\n+                "description": "As a path relative to the portal root.",\n+                "factory": "Choice",\n+                "title": "Target folder",\n+                "type": "string",\n+                "vocabulary": {\n+                    "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                }\n+            }\n+        },\n+        "required": [\n+            "target_folder"\n+        ],\n+        "type": "object"\n+    },\n     "target_folder": "/folder"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_notify.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_notify.resp\nindex 97af910df..f6f62033b 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_notify.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_notify.resp\n@@ -2,6 +2,67 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/action/1",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "message": {\n+                "description": "The message to send to the user.",\n+                "factory": "Text line (String)",\n+                "title": "Message",\n+                "type": "string"\n+            },\n+            "message_type": {\n+                "choices": [\n+                    [\n+                        "info",\n+                        null\n+                    ],\n+                    [\n+                        "warning",\n+                        null\n+                    ],\n+                    [\n+                        "error",\n+                        null\n+                    ]\n+                ],\n+                "default": "info",\n+                "description": "Select the type of message to display.",\n+                "enum": [\n+                    "info",\n+                    "warning",\n+                    "error"\n+                ],\n+                "enumNames": [\n+                    null,\n+                    null,\n+                    null\n+                ],\n+                "factory": "Choice",\n+                "title": "Message type",\n+                "type": "string",\n+                "vocabulary": {\n+                    "@id": "http://localhost:55001/plone/@sources/message_type"\n+                }\n+            }\n+        },\n+        "required": [\n+            "message",\n+            "message_type"\n+        ],\n+        "type": "object"\n+    },\n     "message": "Information",\n     "message_type": "info"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_transition.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_transition.resp\nindex 3ae843351..05b81feac 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_transition.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_transition.resp\n@@ -2,5 +2,33 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/action/5",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "transition"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "transition": {\n+                "description": "Select the workflow transition to attempt",\n+                "factory": "Choice",\n+                "title": "Transition",\n+                "type": "string",\n+                "vocabulary": {\n+                    "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                }\n+            }\n+        },\n+        "required": [\n+            "transition"\n+        ],\n+        "type": "object"\n+    },\n     "transition": "hide"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_versioning.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_versioning.resp\nindex 10c1a0442..393f11b7b 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_versioning.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_action_versioning.resp\n@@ -2,5 +2,28 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/action/7",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "comment"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "comment": {\n+                "description": "The comment added to the history while versioning the content.",\n+                "factory": "Text line (String)",\n+                "title": "Comment",\n+                "type": "string"\n+            }\n+        },\n+        "required": [],\n+        "type": "object"\n+    },\n     "comment": "Some comment"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_fileextension.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_fileextension.resp\nindex c3b82a882..bc00d77da 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_fileextension.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_fileextension.resp\n@@ -2,5 +2,30 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/condition/1",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "file_extension"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "file_extension": {\n+                "description": "The file extension to check for",\n+                "factory": "Text line (String)",\n+                "title": "File extension",\n+                "type": "string"\n+            }\n+        },\n+        "required": [\n+            "file_extension"\n+        ],\n+        "type": "object"\n+    },\n     "file_extension": "JPG"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_group.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_group.resp\nindex 2899cd3aa..1f2d182a1 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_group.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_group.resp\n@@ -2,6 +2,42 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/condition/3",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "group_names"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "group_names": {\n+                "additionalItems": true,\n+                "description": "The name of the group.",\n+                "factory": "Multiple Choice",\n+                "items": {\n+                    "description": "",\n+                    "factory": "Choice",\n+                    "title": "",\n+                    "type": "string",\n+                    "vocabulary": {\n+                        "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                    }\n+                },\n+                "title": "Group name",\n+                "type": "array",\n+                "uniqueItems": true\n+            }\n+        },\n+        "required": [\n+            "group_names"\n+        ],\n+        "type": "object"\n+    },\n     "group_names": [\n         "Administrators",\n         "Site Administrators"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_portaltype.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_portaltype.resp\nindex e81dee974..6ec5c49d8 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_portaltype.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_portaltype.resp\n@@ -2,6 +2,42 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/condition/0",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "check_types"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "check_types": {\n+                "additionalItems": true,\n+                "description": "The content type to check for.",\n+                "factory": "Multiple Choice",\n+                "items": {\n+                    "description": "",\n+                    "factory": "Choice",\n+                    "title": "",\n+                    "type": "string",\n+                    "vocabulary": {\n+                        "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                    }\n+                },\n+                "title": "Content type",\n+                "type": "array",\n+                "uniqueItems": true\n+            }\n+        },\n+        "required": [\n+            "check_types"\n+        ],\n+        "type": "object"\n+    },\n     "check_types": [\n         "Collection",\n         "Comment"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_role.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_role.resp\nindex 1bd894e0d..d56dd07b6 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_role.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_role.resp\n@@ -2,6 +2,42 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/condition/4",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "role_names"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "role_names": {\n+                "additionalItems": true,\n+                "description": "The roles to check for.",\n+                "factory": "Multiple Choice",\n+                "items": {\n+                    "description": "",\n+                    "factory": "Choice",\n+                    "title": "",\n+                    "type": "string",\n+                    "vocabulary": {\n+                        "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                    }\n+                },\n+                "title": "Roles",\n+                "type": "array",\n+                "uniqueItems": true\n+            }\n+        },\n+        "required": [\n+            "role_names"\n+        ],\n+        "type": "object"\n+    },\n     "role_names": [\n         "Anonymous",\n         "Authenticated"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_tales.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_tales.resp\nindex d06538a58..eb2bca278 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_tales.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_tales.resp\n@@ -2,5 +2,30 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/condition/5",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "tales_expression"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "tales_expression": {\n+                "description": "The TALES expression to check.",\n+                "factory": "Text line (String)",\n+                "title": "TALES expression",\n+                "type": "string"\n+            }\n+        },\n+        "required": [\n+            "tales_expression"\n+        ],\n+        "type": "object"\n+    },\n     "tales_expression": "<tal:block content=\'string:\' />"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_workflowstate.resp b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_workflowstate.resp\nindex 61e6cc076..0707c9723 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_workflowstate.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_get_rule_condition_workflowstate.resp\n@@ -2,6 +2,42 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n+    "@id": "http://localhost:55001/plone/@controlpanels/content-rules/rule-3/condition/2",\n+    "@schema": {\n+        "fieldsets": [\n+            {\n+                "behavior": "plone",\n+                "fields": [\n+                    "wf_states"\n+                ],\n+                "id": "default",\n+                "title": "Default"\n+            }\n+        ],\n+        "properties": {\n+            "wf_states": {\n+                "additionalItems": true,\n+                "description": "The workflow states to check for.",\n+                "factory": "Multiple Choice",\n+                "items": {\n+                    "description": "",\n+                    "factory": "Choice",\n+                    "title": "",\n+                    "type": "string",\n+                    "vocabulary": {\n+                        "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                    }\n+                },\n+                "title": "Workflow state",\n+                "type": "array",\n+                "uniqueItems": true\n+            }\n+        },\n+        "required": [\n+            "wf_states"\n+        ],\n+        "type": "object"\n+    },\n     "wf_states": [\n         "pending",\n         "private"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule.resp\nindex 09949916f..eec2e4808 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule.resp\n@@ -7,41 +7,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     "actions": [],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -49,31 +317,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_copy.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_copy.resp\nindex 11a69613c..14de2ae01 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_copy.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_copy.resp\n@@ -35,41 +35,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -77,31 +345,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_delete.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_delete.resp\nindex 99b2bbe8a..444dce2a0 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_delete.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_delete.resp\n@@ -53,41 +53,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -95,31 +363,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_logger.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_logger.resp\nindex 8099f8b50..860811cdf 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_logger.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_logger.resp\n@@ -17,41 +17,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -59,31 +327,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_mail.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_mail.resp\nindex ae1d1884f..6c3a0633d 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_mail.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_mail.resp\n@@ -71,41 +71,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -113,31 +381,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_move.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_move.resp\nindex 34a39e76f..2c2f41199 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_move.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_move.resp\n@@ -44,41 +44,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -86,31 +354,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_notify.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_notify.resp\nindex 57ae9df9f..478e53675 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_notify.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_notify.resp\n@@ -26,41 +26,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -68,31 +336,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_transition.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_transition.resp\nindex 60aee6683..86bc10106 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_transition.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_transition.resp\n@@ -62,41 +62,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -104,31 +372,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_versioning.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_versioning.resp\nindex 755670981..372406bc2 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_versioning.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_action_versioning.resp\n@@ -80,41 +80,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -122,31 +390,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_fileextension.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_fileextension.resp\nindex d124c5c9a..b7755cd84 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_fileextension.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_fileextension.resp\n@@ -7,41 +7,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     "actions": [],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -49,31 +317,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_group.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_group.resp\nindex 433c5c100..b0a740769 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_group.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_group.resp\n@@ -7,41 +7,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     "actions": [],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -49,31 +317,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_portaltype.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_portaltype.resp\nindex eb078be81..5137956df 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_portaltype.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_portaltype.resp\n@@ -7,41 +7,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     "actions": [],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -49,31 +317,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_role.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_role.resp\nindex d7f60e333..930d432e8 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_role.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_role.resp\n@@ -7,41 +7,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     "actions": [],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -49,31 +317,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_tales.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_tales.resp\nindex 2c9721ae8..677f59834 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_tales.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_tales.resp\n@@ -7,41 +7,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     "actions": [],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -49,31 +317,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\ndiff --git a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_workflowstate.resp b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_workflowstate.resp\nindex 9209a4f4b..1648c7684 100644\n--- a/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_workflowstate.resp\n+++ b/src/plone/restapi/tests/http-examples/controlpanels_post_rule_condition_workflowstate.resp\n@@ -7,41 +7,309 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     "actions": [],\n     "addable_actions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "targetLogger",\n+                            "loggingLevel",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "loggingLevel": {\n+                        "default": 20,\n+                        "description": "",\n+                        "factory": "Integer",\n+                        "title": "Logging level",\n+                        "type": "integer"\n+                    },\n+                    "message": {\n+                        "default": "text_contentrules_logger_message",\n+                        "description": "&e = the triggering event, &c = the context, &u = the user",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "targetLogger": {\n+                        "default": "Plone",\n+                        "description": "",\n+                        "factory": "Text line (String)",\n+                        "title": "Logger name",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "targetLogger",\n+                    "loggingLevel",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Logger",\n             "description": "Log a particular event",\n             "title": "Logger"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "message",\n+                            "message_type"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "message": {\n+                        "description": "The message to send to the user.",\n+                        "factory": "Text line (String)",\n+                        "title": "Message",\n+                        "type": "string"\n+                    },\n+                    "message_type": {\n+                        "choices": [\n+                            [\n+                                "info",\n+                                null\n+                            ],\n+                            [\n+                                "warning",\n+                                null\n+                            ],\n+                            [\n+                                "error",\n+                                null\n+                            ]\n+                        ],\n+                        "default": "info",\n+                        "description": "Select the type of message to display.",\n+                        "enum": [\n+                            "info",\n+                            "warning",\n+                            "error"\n+                        ],\n+                        "enumNames": [\n+                            null,\n+                            null,\n+                            null\n+                        ],\n+                        "factory": "Choice",\n+                        "title": "Message type",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/message_type"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "message",\n+                    "message_type"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Notify",\n             "description": "Return a portal message to the user",\n             "title": "Notify user"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Copy",\n             "description": "Copy the triggering item to a specific folder",\n             "title": "Copy to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "target_folder"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "target_folder": {\n+                        "description": "As a path relative to the portal root.",\n+                        "factory": "Choice",\n+                        "title": "Target folder",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@sources/target_folder"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "target_folder"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Move",\n             "description": "Move the triggering item to a specific folder",\n             "title": "Move to folder"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [],\n+                "properties": {},\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Delete",\n             "description": "Delete the triggering item",\n             "title": "Delete object"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "transition"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "transition": {\n+                        "description": "Select the workflow transition to attempt",\n+                        "factory": "Choice",\n+                        "title": "Transition",\n+                        "type": "string",\n+                        "vocabulary": {\n+                            "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowTransitions"\n+                        }\n+                    }\n+                },\n+                "required": [\n+                    "transition"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Workflow",\n             "description": "Perform a workflow transition on the triggering object",\n             "title": "Transition workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "subject",\n+                            "source",\n+                            "recipients",\n+                            "exclude_actor",\n+                            "message"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "exclude_actor": {\n+                        "description": "Do not send the email to the user that did the action.",\n+                        "factory": "Yes/No",\n+                        "title": "Exclude actor from recipients",\n+                        "type": "boolean"\n+                    },\n+                    "message": {\n+                        "description": "The message that you want to mail.",\n+                        "factory": "Text",\n+                        "title": "Message",\n+                        "type": "string",\n+                        "widget": "textarea"\n+                    },\n+                    "recipients": {\n+                        "description": "The email where you want to send this message. To send it to different email addresses, just separate them with ,",\n+                        "factory": "Text line (String)",\n+                        "title": "Email recipients",\n+                        "type": "string"\n+                    },\n+                    "source": {\n+                        "description": "The email address that sends the email. If no email is provided here, it will use the portal from address.",\n+                        "factory": "Text line (String)",\n+                        "title": "Email source",\n+                        "type": "string"\n+                    },\n+                    "subject": {\n+                        "description": "Subject of the message",\n+                        "factory": "Text line (String)",\n+                        "title": "Subject",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "subject",\n+                    "recipients",\n+                    "exclude_actor",\n+                    "message"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Mail",\n             "description": "Send an email on the triggering object",\n             "title": "Send email"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "comment"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "comment": {\n+                        "description": "The comment added to the history while versioning the content.",\n+                        "factory": "Text line (String)",\n+                        "title": "Comment",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [],\n+                "type": "object"\n+            },\n             "addview": "plone.actions.Versioning",\n             "description": "Store a new version of the object",\n             "title": "Version object"\n@@ -49,31 +317,219 @@ Location: http://localhost:55001/plone/@controlpanels/content-rules/rule-3\n     ],\n     "addable_conditions": [\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "check_types"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "check_types": {\n+                        "additionalItems": true,\n+                        "description": "The content type to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes"\n+                            }\n+                        },\n+                        "title": "Content type",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "check_types"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.PortalType",\n             "description": "Apply only when the current content object is of a particular type",\n             "title": "Content type"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "file_extension"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "file_extension": {\n+                        "description": "The file extension to check for",\n+                        "factory": "Text line (String)",\n+                        "title": "File extension",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "file_extension"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.FileExtension",\n             "description": "Apply only to a particular file extension",\n             "title": "File Extension"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "wf_states"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "wf_states": {\n+                        "additionalItems": true,\n+                        "description": "The workflow states to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.WorkflowStates"\n+                            }\n+                        },\n+                        "title": "Workflow state",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "wf_states"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.WorkflowState",\n             "description": "Apply only to a objects in a particular workflow state",\n             "title": "Workflow state"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "group_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "group_names": {\n+                        "additionalItems": true,\n+                        "description": "The name of the group.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Groups"\n+                            }\n+                        },\n+                        "title": "Group name",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "group_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Group",\n             "description": "Apply only when the current user is in the given group",\n             "title": "User\'s group"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "role_names"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "role_names": {\n+                        "additionalItems": true,\n+                        "description": "The roles to check for.",\n+                        "factory": "Multiple Choice",\n+                        "items": {\n+                            "description": "",\n+                            "factory": "Choice",\n+                            "title": "",\n+                            "type": "string",\n+                            "vocabulary": {\n+                                "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Roles"\n+                            }\n+                        },\n+                        "title": "Roles",\n+                        "type": "array",\n+                        "uniqueItems": true\n+                    }\n+                },\n+                "required": [\n+                    "role_names"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.Role",\n             "description": "Apply only when the current user has the given role",\n             "title": "User\'s role"\n         },\n         {\n+            "@schema": {\n+                "fieldsets": [\n+                    {\n+                        "behavior": "plone",\n+                        "fields": [\n+                            "tales_expression"\n+                        ],\n+                        "id": "default",\n+                        "title": "Default"\n+                    }\n+                ],\n+                "properties": {\n+                    "tales_expression": {\n+                        "description": "The TALES expression to check.",\n+                        "factory": "Text line (String)",\n+                        "title": "TALES expression",\n+                        "type": "string"\n+                    }\n+                },\n+                "required": [\n+                    "tales_expression"\n+                ],\n+                "type": "object"\n+            },\n             "addview": "plone.conditions.TalesExpression",\n             "description": "Apply only when the result of a TALES expression is True",\n             "title": "TALES expression"\n'

