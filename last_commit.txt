Repository: plone.app.layout


Branch: refs/heads/master
Date: 2019-02-23T10:40:03+01:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/a5693d54ef91f7a22b674b8848bbd4b4dfa10713

Provide a proper unique id and a review state class for the first level tabs

Fixes #184

Files changed:
A news/184.bugfix
M plone/app/layout/navigation/navtree.py

b'diff --git a/news/184.bugfix b/news/184.bugfix\nnew file mode 100644\nindex 00000000..940cdd3c\n--- /dev/null\n+++ b/news/184.bugfix\n@@ -0,0 +1,2 @@\n+Provide a proper unique id and a review state class for the first level tabs\n+[ale-rt]\ndiff --git a/plone/app/layout/navigation/navtree.py b/plone/app/layout/navigation/navtree.py\nindex bdce29b0..f6606d2d 100644\n--- a/plone/app/layout/navigation/navtree.py\n+++ b/plone/app/layout/navigation/navtree.py\n@@ -376,7 +376,6 @@ class NavTreeProvider(ContentProviderBase):\n     )\n     _item_markup_template = (\n         u\'<li class="{id}{has_sub_class}">\'\n-        u\'{opener}\'\n         u\'<a href="{url}" class="state-{review_state}"{aria_haspopup}>{title}</a>{opener}\'  # noqa: E 501\n         u\'{sub}\'\n         u\'</li>\'\n@@ -426,9 +425,10 @@ def navtree(self):\n             entry = tab.copy()\n             entry.update({\n                 \'path\': \'/\'.join((navtree_path, tab[\'id\'])),\n-                \'uid\': None,\n-                \'review_state\': None,\n+                \'uid\': tab[\'id\'],\n             })\n+            if \'review_state\' not in entry:\n+                entry[\'review_state\'] = None\n             if \'title\' not in entry:\n                 entry[\'title\'] = (\n                     tab.get(\'name\')\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2019-02-25T22:48:53+01:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/e1e95027faf713ee83ba1f91a85eaa11ad120dfe

Merge branch 'master' into 184-fix-tab-id-and-review-state

Files changed:
A news/181.bugfix
D news/181.fixed

b'diff --git a/news/181.fixed b/news/181.bugfix\nsimilarity index 100%\nrename from news/181.fixed\nrename to news/181.bugfix\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2019-02-27T17:42:33+01:00
Author: agitator (agitator) <agitator@users.noreply.github.com>
Commit: https://github.com/plone/plone.app.layout/commit/a9dfe56179d85b6614928d0b8cd2014077d4e7d4

Merge pull request #185 from plone/184-fix-tab-id-and-review-state

Provide a proper unique id and a review state class for the first levâ€¦

Files changed:
A news/184.bugfix
M plone/app/layout/navigation/navtree.py

b'diff --git a/news/184.bugfix b/news/184.bugfix\nnew file mode 100644\nindex 00000000..940cdd3c\n--- /dev/null\n+++ b/news/184.bugfix\n@@ -0,0 +1,2 @@\n+Provide a proper unique id and a review state class for the first level tabs\n+[ale-rt]\ndiff --git a/plone/app/layout/navigation/navtree.py b/plone/app/layout/navigation/navtree.py\nindex bdce29b0..f6606d2d 100644\n--- a/plone/app/layout/navigation/navtree.py\n+++ b/plone/app/layout/navigation/navtree.py\n@@ -376,7 +376,6 @@ class NavTreeProvider(ContentProviderBase):\n     )\n     _item_markup_template = (\n         u\'<li class="{id}{has_sub_class}">\'\n-        u\'{opener}\'\n         u\'<a href="{url}" class="state-{review_state}"{aria_haspopup}>{title}</a>{opener}\'  # noqa: E 501\n         u\'{sub}\'\n         u\'</li>\'\n@@ -426,9 +425,10 @@ def navtree(self):\n             entry = tab.copy()\n             entry.update({\n                 \'path\': \'/\'.join((navtree_path, tab[\'id\'])),\n-                \'uid\': None,\n-                \'review_state\': None,\n+                \'uid\': tab[\'id\'],\n             })\n+            if \'review_state\' not in entry:\n+                entry[\'review_state\'] = None\n             if \'title\' not in entry:\n                 entry[\'title\'] = (\n                     tab.get(\'name\')\n'

