Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-01-27T12:17:14+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/d6b4d813c2204d41132ae43cc569a058720a7cc7

Fixed linkintegrityrobot tests.

In the widget we need to go one level up before we can find the document to search for.

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/robot/test_linkintegrity.robot

diff --git a/CHANGES.rst b/CHANGES.rst
index 730df4d5f..be074e4dc 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -32,6 +32,8 @@ New Features:
 
 Bug Fixes:
 
+- Fixed linkintegrity robot tests.  [maurits]
+
 - Require AccessControl 4.0b1 so ``guarded_getitem`` is used.
   Part of PloneHotfix20171128.  [maurits]
 
diff --git a/Products/CMFPlone/tests/robot/test_linkintegrity.robot b/Products/CMFPlone/tests/robot/test_linkintegrity.robot
index 6b6b6090d..38f916f68 100644
--- a/Products/CMFPlone/tests/robot/test_linkintegrity.robot
+++ b/Products/CMFPlone/tests/robot/test_linkintegrity.robot
@@ -25,8 +25,6 @@ Test Teardown  Run keywords  Plone Test Teardown
 *** Test Cases ***************************************************************
 
 Scenario: When page is linked show warning
-  [Tags]  unstable
-  [Documentation]  This sometimes fails with: StaleElementReferenceException: Message: Element not found in the cache.
   Given a logged-in site administrator
     and a page to link to
     and a page to edit
@@ -35,8 +33,6 @@ Scenario: When page is linked show warning
 
 
 Scenario: After you fix linked page no longer show warning
-  [Tags]  unstable
-  [Documentation]  This sometimes fails with: StaleElementReferenceException: Message: Element not found in the cache.
   Given a logged-in site administrator
   a page to link to
     and a page to edit
@@ -47,9 +43,6 @@ Scenario: After you fix linked page no longer show warning
 
 
 Scenario: Show warning when deleting linked item from folder_contents
-  [Tags]  unstable
-  [Documentation]  This sometimes fails with: StaleElementReferenceException: Message: Element not found in the cache.
-  ...              This one seems to fail more often than the others.
   Given a logged-in site administrator
   a page to link to
     and a page to edit
@@ -86,6 +79,8 @@ a link in rich text
   Given patterns are loaded
   Wait until element is visible  css=.pat-relateditems .select2-input.select2-default
   Click Element  css=.pat-relateditems .select2-input.select2-default
+  Wait until element is visible  xpath=(//span[contains(., 'One level up')])
+  Click Element  xpath=(//span[contains(., 'One level up')])
   Wait until element is visible  xpath=(//span[contains(., 'Foo')])
   Click Element  xpath=(//span[contains(., 'Foo')])
   Wait until page contains  Foo


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-01-27T13:19:43+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/482b0c577a8dd86046da21d076237f159f9bef80

Merge branch 'master' into linkintegrity-robot-tests-fix-52

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/robot/test_controlpanel_actions.robot

diff --git a/CHANGES.rst b/CHANGES.rst
index be074e4dc..574bb9f9b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -34,6 +34,8 @@ Bug Fixes:
 
 - Fixed linkintegrity robot tests.  [maurits]
 
+- Fixed flaky actions controlpanel tests by waiting longer.  [maurits]
+
 - Require AccessControl 4.0b1 so ``guarded_getitem`` is used.
   Part of PloneHotfix20171128.  [maurits]
 
diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot
index d6a8157e9..1cd2e5f3f 100644
--- a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot
+++ b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot
@@ -18,34 +18,40 @@ Scenario: Modify an existing action in Actions Control Panel
   Given a logged-in administrator
     and the actions control panel
    When I modify an action title
+   Sleep  1
    Then anonymous users can see the new action title
 
 Scenario: Reorder in Actions Control Panel
   Given a logged-in administrator
     and the actions control panel
    When I change the actions order
+   Sleep  1
    Then anonymous users can see the actions new ordering
 
 Scenario: Create a new action in Actions Control Panel
   Given a logged-in administrator
     and the actions control panel
    When I add a new action
+   Sleep  1
    Then logged-in users can see the new action
 
 Scenario: Hide/show an action in Actions Control Panel
   Given a logged-in administrator
     and the actions control panel
    When I hide an action
+   Sleep  1
    Then anonymous users cannot see the action anymore
   Given a logged-in administrator
     and the actions control panel
    When I unhide the action
+   Sleep  1
    Then anonymous users can see the action again
 
 Scenario: Delete an action in Actions Control Panel
   Given a logged-in administrator
     and the actions control panel
    When I delete an action
+   Sleep  1
    Then anonymous users cannot see the action anymore
 
 *** Keywords *****************************************************************


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-01-27T13:20:02+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/bd2e4e17f90fe46ac63c36714fda9ff0ad0aa330

Merge pull request #2274 from plone/linkintegrity-robot-tests-fix-52

Fixed linkintegrity robot tests. [5.2]

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/robot/test_linkintegrity.robot

diff --git a/CHANGES.rst b/CHANGES.rst
index 9f6f121a0..574bb9f9b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -32,6 +32,8 @@ New Features:
 
 Bug Fixes:
 
+- Fixed linkintegrity robot tests.  [maurits]
+
 - Fixed flaky actions controlpanel tests by waiting longer.  [maurits]
 
 - Require AccessControl 4.0b1 so ``guarded_getitem`` is used.
diff --git a/Products/CMFPlone/tests/robot/test_linkintegrity.robot b/Products/CMFPlone/tests/robot/test_linkintegrity.robot
index 6b6b6090d..38f916f68 100644
--- a/Products/CMFPlone/tests/robot/test_linkintegrity.robot
+++ b/Products/CMFPlone/tests/robot/test_linkintegrity.robot
@@ -25,8 +25,6 @@ Test Teardown  Run keywords  Plone Test Teardown
 *** Test Cases ***************************************************************
 
 Scenario: When page is linked show warning
-  [Tags]  unstable
-  [Documentation]  This sometimes fails with: StaleElementReferenceException: Message: Element not found in the cache.
   Given a logged-in site administrator
     and a page to link to
     and a page to edit
@@ -35,8 +33,6 @@ Scenario: When page is linked show warning
 
 
 Scenario: After you fix linked page no longer show warning
-  [Tags]  unstable
-  [Documentation]  This sometimes fails with: StaleElementReferenceException: Message: Element not found in the cache.
   Given a logged-in site administrator
   a page to link to
     and a page to edit
@@ -47,9 +43,6 @@ Scenario: After you fix linked page no longer show warning
 
 
 Scenario: Show warning when deleting linked item from folder_contents
-  [Tags]  unstable
-  [Documentation]  This sometimes fails with: StaleElementReferenceException: Message: Element not found in the cache.
-  ...              This one seems to fail more often than the others.
   Given a logged-in site administrator
   a page to link to
     and a page to edit
@@ -86,6 +79,8 @@ a link in rich text
   Given patterns are loaded
   Wait until element is visible  css=.pat-relateditems .select2-input.select2-default
   Click Element  css=.pat-relateditems .select2-input.select2-default
+  Wait until element is visible  xpath=(//span[contains(., 'One level up')])
+  Click Element  xpath=(//span[contains(., 'One level up')])
   Wait until element is visible  xpath=(//span[contains(., 'Foo')])
   Click Element  xpath=(//span[contains(., 'Foo')])
   Wait until page contains  Foo


