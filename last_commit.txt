Repository: plone.restapi


Branch: refs/heads/master
Date: 2018-07-22T00:59:49+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.restapi/commit/7b46a55830549b6e488df5560429f5be9aa284c9

Make sure the default profile is installed on tiles profile installation.

Files changed:
A src/plone/restapi/profiles/tiles/metadata.xml
M CHANGES.rst
M src/plone/restapi/tests/test_profile_tiles.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex e23c4ec6..bbae86dd 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -4,12 +4,17 @@ Changelog\n 3.4.1 (unreleased)\n ------------------\n \n-- Nothing changed yet.\n+Bugfixes:\n+\n+- Make sure the default profile is installed on tiles profile installation.\n+  [timo]\n \n \n 3.4.0 (2018-07-21)\n ------------------\n \n+New Features:\n+\n - Add tiles profile.\n   [timo]\n \ndiff --git a/src/plone/restapi/profiles/tiles/metadata.xml b/src/plone/restapi/profiles/tiles/metadata.xml\nnew file mode 100644\nindex 00000000..2665db30\n--- /dev/null\n+++ b/src/plone/restapi/profiles/tiles/metadata.xml\n@@ -0,0 +1,7 @@\n+<?xml version="1.0"?>\n+<metadata>\n+  <version>0001</version>\n+  <dependencies>\n+    <dependency>profile-plone.restapi:default</dependency>\n+  </dependencies>\n+</metadata>\ndiff --git a/src/plone/restapi/tests/test_profile_tiles.py b/src/plone/restapi/tests/test_profile_tiles.py\nindex 22aae7cd..dbeccb14 100644\n--- a/src/plone/restapi/tests/test_profile_tiles.py\n+++ b/src/plone/restapi/tests/test_profile_tiles.py\n@@ -5,6 +5,7 @@\n from plone.app.testing import setRoles\n from plone.restapi.testing import PLONE_RESTAPI_TILES_INTEGRATION_TESTING\n from plone.restapi.behaviors import ITiles\n+from Products.CMFCore.utils import getToolByName\n \n import unittest\n \n@@ -27,3 +28,7 @@ def test_document_type_has_tiles_behavior_enabled(self):\n             title=\'Document with Tiles\'\n         )\n         ITiles.providedBy(self.portal[\'tileddoc\'])\n+\n+    def test_plone_restapi_base_profile_applied(self):\n+        uf = getToolByName(self.portal, \'acl_users\')\n+        self.assertTrue(\'jwt_auth\' in uf)\n'

