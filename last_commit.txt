Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-12-30T21:39:39+01:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/d1d27eb38e823717cf64554e55731fc5538c863d

Make contact form extensible. This fixes https://github.com/plone/Products.CMFPlone/issues/1879.

Files changed:
M CHANGES.rst
M Products/CMFPlone/browser/contact_info.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 55621b74..5647872 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -65,6 +65,9 @@ Breaking changes:
 
 New features:
 
+- Make contact form extensible. This fixes https://github.com/plone/Products.CMFPlone/issues/1879.
+  [timo]
+
 - Don't minify CSS or JavaScript resources if they end with ``.min.css`` resp. ``.min.js``.
   [thet]
 
@@ -241,9 +244,9 @@ Bug fixes:
 - Do not use unittest2 (superfluos since part of Python 2.7).
   [jensens]
 
-- Fix security test assertion: 
+- Fix security test assertion:
   TestAttackVectorsFunctional test_widget_traversal_2 assumed a 302 http return code when accessing some private API.
-  Meanwhile it changed to return a 404 on the URL. 
+  Meanwhile it changed to return a 404 on the URL.
   Reflect this in the test and expect a 404.
   [jensens]
 
diff --git a/Products/CMFPlone/browser/contact_info.py b/Products/CMFPlone/browser/contact_info.py
index dbc6440..3c21664 100644
--- a/Products/CMFPlone/browser/contact_info.py
+++ b/Products/CMFPlone/browser/contact_info.py
@@ -8,6 +8,7 @@
 from Products.statusmessages.interfaces import IStatusMessage
 from email.Header import Header
 from email.MIMEText import MIMEText
+from plone.autoform.form import AutoExtensibleForm
 from plone.registry.interfaces import IRegistry
 from smtplib import SMTPException
 from z3c.form import form, field, button
@@ -18,7 +19,7 @@
 log = logging.getLogger(__name__)
 
 
-class ContactForm(form.Form):
+class ContactForm(AutoExtensibleForm, form.Form):
 
     template = ViewPageTemplateFile('templates/contact-info.pt')
     template_mailview = '@@contact-info-email'


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-12-31T11:58:12+01:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/1383dbeff20490bfacf9989800b511c979f041de

Add schema class attribute to fix ContactForm.

Files changed:
M Products/CMFPlone/browser/contact_info.py

diff --git a/Products/CMFPlone/browser/contact_info.py b/Products/CMFPlone/browser/contact_info.py
index 3c21664..0d2513c 100644
--- a/Products/CMFPlone/browser/contact_info.py
+++ b/Products/CMFPlone/browser/contact_info.py
@@ -24,6 +24,7 @@ class ContactForm(AutoExtensibleForm, form.Form):
     template = ViewPageTemplateFile('templates/contact-info.pt')
     template_mailview = '@@contact-info-email'
 
+    schema = IContactForm
     fields = field.Fields(IContactForm)
     ignoreContext = True
     success = False


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-12-31T16:37:01+01:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/4b45adbfdb4d7d405bc02b7a7937107f7b6bd3b8

No need for fields in ContactForm class.

Files changed:
M Products/CMFPlone/browser/contact_info.py

diff --git a/Products/CMFPlone/browser/contact_info.py b/Products/CMFPlone/browser/contact_info.py
index 0d2513c..759e36e 100644
--- a/Products/CMFPlone/browser/contact_info.py
+++ b/Products/CMFPlone/browser/contact_info.py
@@ -25,7 +25,6 @@ class ContactForm(AutoExtensibleForm, form.Form):
     template_mailview = '@@contact-info-email'
 
     schema = IContactForm
-    fields = field.Fields(IContactForm)
     ignoreContext = True
     success = False
 


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-12-31T11:27:46-08:00
Author: David Glick (davisagli) <david.glick@plone.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/4836c453d5676b6caeebeb27a07b5eab9031fa55

Merge pull request #1888 from plone/tisto-fix-1879

Make contact form extensible.

Files changed:
M CHANGES.rst
M Products/CMFPlone/browser/contact_info.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 55621b74..5647872 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -65,6 +65,9 @@ Breaking changes:
 
 New features:
 
+- Make contact form extensible. This fixes https://github.com/plone/Products.CMFPlone/issues/1879.
+  [timo]
+
 - Don't minify CSS or JavaScript resources if they end with ``.min.css`` resp. ``.min.js``.
   [thet]
 
@@ -241,9 +244,9 @@ Bug fixes:
 - Do not use unittest2 (superfluos since part of Python 2.7).
   [jensens]
 
-- Fix security test assertion: 
+- Fix security test assertion:
   TestAttackVectorsFunctional test_widget_traversal_2 assumed a 302 http return code when accessing some private API.
-  Meanwhile it changed to return a 404 on the URL. 
+  Meanwhile it changed to return a 404 on the URL.
   Reflect this in the test and expect a 404.
   [jensens]
 
diff --git a/Products/CMFPlone/browser/contact_info.py b/Products/CMFPlone/browser/contact_info.py
index dbc6440..759e36e 100644
--- a/Products/CMFPlone/browser/contact_info.py
+++ b/Products/CMFPlone/browser/contact_info.py
@@ -8,6 +8,7 @@
 from Products.statusmessages.interfaces import IStatusMessage
 from email.Header import Header
 from email.MIMEText import MIMEText
+from plone.autoform.form import AutoExtensibleForm
 from plone.registry.interfaces import IRegistry
 from smtplib import SMTPException
 from z3c.form import form, field, button
@@ -18,12 +19,12 @@
 log = logging.getLogger(__name__)
 
 
-class ContactForm(form.Form):
+class ContactForm(AutoExtensibleForm, form.Form):
 
     template = ViewPageTemplateFile('templates/contact-info.pt')
     template_mailview = '@@contact-info-email'
 
-    fields = field.Fields(IContactForm)
+    schema = IContactForm
     ignoreContext = True
     success = False
 


