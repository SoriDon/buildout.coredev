Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2018-11-15T08:34:27-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.PlonePAS/commit/fe9a7a13ca7155e719a94f3f52afbb48e9153c42

Check for both `__self__` and `im_self` for Python 3 compatibility

Co-authored-by: Wildcard Corp. &lt;corporate@wildcardcorp.com&gt;

Files changed:
M src/Products/PlonePAS/plugins/local_role.py

b"diff --git a/src/Products/PlonePAS/plugins/local_role.py b/src/Products/PlonePAS/plugins/local_role.py\nindex 93e76b5..68822fb 100644\n--- a/src/Products/PlonePAS/plugins/local_role.py\n+++ b/src/Products/PlonePAS/plugins/local_role.py\n@@ -78,7 +78,8 @@ def getRolesInContext(self, user, object):\n                 object = parent\n                 continue\n \n-            new = getattr(object, 'im_self', None)\n+            new = (getattr(object, 'im_self', None) or\n+                   getattr(object, '__self__', None))\n \n             if new is not None:\n                 object = aq_inner(new)\n@@ -134,7 +135,8 @@ def checkLocalRolesAllowed(self, user, object, object_roles):\n                 inner_obj = parent\n                 continue\n \n-            new = getattr(inner_obj, 'im_self', None)\n+            new = (getattr(inner_obj, 'im_self', None) or\n+                   getattr(inner_obj, '__self__', None))\n \n             if new is not None:\n                 inner_obj = aq_inner(new)\n@@ -175,7 +177,8 @@ def getAllLocalRolesInContext(self, context):\n                 object = parent\n                 continue\n \n-            new = getattr(object, 'im_self', None)\n+            new = (getattr(object, 'im_self', None) or\n+                   getattr(object, '__self__', None))\n \n             if new is not None:\n                 object = aq_inner(new)\n"

Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2018-11-15T08:34:36-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.PlonePAS/commit/7e56cfe20d6fa87827658e81f17f0bd3b4e7fdce

add changelog

Co-authored-by: Wildcard Corp. &lt;corporate@wildcardcorp.com&gt;

Files changed:
A news/43.bugfix

b'diff --git a/news/43.bugfix b/news/43.bugfix\nnew file mode 100644\nindex 0000000..a00f554\n--- /dev/null\n+++ b/news/43.bugfix\n@@ -0,0 +1,2 @@\n+Check for both `__self__` and `im_self` for Python 3 compatibility\n+[vangheem]\n\\ No newline at end of file\n'

Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2018-11-15T08:52:47-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.PlonePAS/commit/ac6ec4e7642346ac7903270be43828814e20b2e7

just use `__self__`

Co-authored-by: Wildcard Corp. &lt;corporate@wildcardcorp.com&gt;

Files changed:
M news/43.bugfix
M src/Products/PlonePAS/plugins/local_role.py

b"diff --git a/news/43.bugfix b/news/43.bugfix\nindex a00f554..1b7b23e 100644\n--- a/news/43.bugfix\n+++ b/news/43.bugfix\n@@ -1,2 +1,2 @@\n-Check for both `__self__` and `im_self` for Python 3 compatibility\n+Change `im_self` to `__self__`\n [vangheem]\n\\ No newline at end of file\ndiff --git a/src/Products/PlonePAS/plugins/local_role.py b/src/Products/PlonePAS/plugins/local_role.py\nindex 68822fb..5397b30 100644\n--- a/src/Products/PlonePAS/plugins/local_role.py\n+++ b/src/Products/PlonePAS/plugins/local_role.py\n@@ -78,8 +78,7 @@ def getRolesInContext(self, user, object):\n                 object = parent\n                 continue\n \n-            new = (getattr(object, 'im_self', None) or\n-                   getattr(object, '__self__', None))\n+            new = getattr(object, '__self__', None)\n \n             if new is not None:\n                 object = aq_inner(new)\n@@ -135,8 +134,7 @@ def checkLocalRolesAllowed(self, user, object, object_roles):\n                 inner_obj = parent\n                 continue\n \n-            new = (getattr(inner_obj, 'im_self', None) or\n-                   getattr(inner_obj, '__self__', None))\n+            new = getattr(inner_obj, '__self__', None)\n \n             if new is not None:\n                 inner_obj = aq_inner(new)\n@@ -177,8 +175,7 @@ def getAllLocalRolesInContext(self, context):\n                 object = parent\n                 continue\n \n-            new = (getattr(object, 'im_self', None) or\n-                   getattr(object, '__self__', None))\n+            new = getattr(object, '__self__', None)\n \n             if new is not None:\n                 object = aq_inner(new)\n"

Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2018-11-16T11:17:09+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.PlonePAS/commit/c3f1ca1ac1b98cf056b68cd16f161a98e2427170

Merge pull request #43 from plone/py3-im-self

Check for both `__self__` and `im_self` for Python 3 compatibility

Files changed:
A news/43.bugfix
M src/Products/PlonePAS/plugins/local_role.py

b"diff --git a/news/43.bugfix b/news/43.bugfix\nnew file mode 100644\nindex 0000000..1b7b23e\n--- /dev/null\n+++ b/news/43.bugfix\n@@ -0,0 +1,2 @@\n+Change `im_self` to `__self__`\n+[vangheem]\n\\ No newline at end of file\ndiff --git a/src/Products/PlonePAS/plugins/local_role.py b/src/Products/PlonePAS/plugins/local_role.py\nindex 93e76b5..5397b30 100644\n--- a/src/Products/PlonePAS/plugins/local_role.py\n+++ b/src/Products/PlonePAS/plugins/local_role.py\n@@ -78,7 +78,7 @@ def getRolesInContext(self, user, object):\n                 object = parent\n                 continue\n \n-            new = getattr(object, 'im_self', None)\n+            new = getattr(object, '__self__', None)\n \n             if new is not None:\n                 object = aq_inner(new)\n@@ -134,7 +134,7 @@ def checkLocalRolesAllowed(self, user, object, object_roles):\n                 inner_obj = parent\n                 continue\n \n-            new = getattr(inner_obj, 'im_self', None)\n+            new = getattr(inner_obj, '__self__', None)\n \n             if new is not None:\n                 inner_obj = aq_inner(new)\n@@ -175,7 +175,7 @@ def getAllLocalRolesInContext(self, context):\n                 object = parent\n                 continue\n \n-            new = getattr(object, 'im_self', None)\n+            new = getattr(object, '__self__', None)\n \n             if new is not None:\n                 object = aq_inner(new)\n"

