Repository: plone.app.layout


Branch: refs/heads/master
Date: 2023-03-06T10:54:14+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.layout/commit/b48c4cad8761b9535fa267ee8eb68bc1e38b31bd

move INavigationRoot from plone.app.layout to plone.base.
add deprecated bbb import.
part two to fix  https://github.com/plone/Products.CMFPlone/issues/3731

Files changed:
A news/Plone-3731.bugfix
M plone/app/layout/navigation/interfaces.py
M setup.py

b'diff --git a/news/Plone-3731.bugfix b/news/Plone-3731.bugfix\nnew file mode 100644\nindex 00000000..5ee64af6\n--- /dev/null\n+++ b/news/Plone-3731.bugfix\n@@ -0,0 +1,2 @@\n+Move interface plone.app.layout.navigation.interfaces.INavigationRoot to plone.base.interfaces.siteroot and add a deprecated import to plone.app.layout.\n+[jensens, gforcarda]\n\\ No newline at end of file\ndiff --git a/plone/app/layout/navigation/interfaces.py b/plone/app/layout/navigation/interfaces.py\nindex f2ac6275..b03dea31 100644\n--- a/plone/app/layout/navigation/interfaces.py\n+++ b/plone/app/layout/navigation/interfaces.py\n@@ -1,9 +1,12 @@\n+from zope.deferredimport import deprecated\n from zope.interface import Attribute\n from zope.interface import Interface\n \n \n-class INavigationRoot(Interface):\n-    """A marker interface for signaling the navigation root."""\n+deprecated(\n+    "Import from plone.base.interfaces.siteroot instead (will be removed in Plone 7)",\n+    INavigationRoot="plone.base.interfaces.siteroot:INavigationRoot",\n+)\n \n \n class INavigationQueryBuilder(Interface):\ndiff --git a/setup.py b/setup.py\nindex dee33f7d..b2f4b4ad 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -40,7 +40,7 @@\n         "DateTime",\n         "plone.app.content",\n         "plone.app.viewletmanager >=1.2",\n-        "plone.base",\n+        "plone.base >1.0.3",\n         "plone.batching >1.0.999",\n         "plone.i18n",\n         "plone.memoize",\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2023-03-06T11:09:27+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.layout/commit/bebefce774cc7e3d36ada6237eb379f8d0a335d3

update INavigationRoot imports to import from plone.base.interfaces

Files changed:
M plone/app/layout/globals/context.py
M plone/app/layout/globals/tests/test_context.py
M plone/app/layout/globals/tests/test_layout.py
M plone/app/layout/globals/tests/test_portal.py
M plone/app/layout/navigation/root.py
M plone/app/layout/sitemap/configure.zcml
M plone/app/layout/sitemap/tests/test_sitemap.py
M plone/app/layout/viewlets/tests/test_common.py

b'diff --git a/plone/app/layout/globals/context.py b/plone/app/layout/globals/context.py\nindex e4fbb109..146d325d 100644\n--- a/plone/app/layout/globals/context.py\n+++ b/plone/app/layout/globals/context.py\n@@ -2,7 +2,7 @@\n from Acquisition import aq_base\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.base.utils import pretty_title_or_id\n from plone.memoize.view import memoize\n from plone.portlets.interfaces import ILocalPortletAssignable\ndiff --git a/plone/app/layout/globals/tests/test_context.py b/plone/app/layout/globals/tests/test_context.py\nindex 5b41e7e6..7bf39b30 100644\n--- a/plone/app/layout/globals/tests/test_context.py\n+++ b/plone/app/layout/globals/tests/test_context.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\ndiff --git a/plone/app/layout/globals/tests/test_layout.py b/plone/app/layout/globals/tests/test_layout.py\nindex ee86ecd9..5178fbf5 100644\n--- a/plone/app/layout/globals/tests/test_layout.py\n+++ b/plone/app/layout/globals/tests/test_layout.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\ndiff --git a/plone/app/layout/globals/tests/test_portal.py b/plone/app/layout/globals/tests/test_portal.py\nindex 33209c94..bebb172d 100644\n--- a/plone/app/layout/globals/tests/test_portal.py\n+++ b/plone/app/layout/globals/tests/test_portal.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.navigation.root import getNavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import setRoles\ndiff --git a/plone/app/layout/navigation/root.py b/plone/app/layout/navigation/root.py\nindex 4badee8b..0b7ca706 100644\n--- a/plone/app/layout/navigation/root.py\n+++ b/plone/app/layout/navigation/root.py\n@@ -1,7 +1,7 @@\n from Acquisition import aq_base\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.registry.interfaces import IRegistry\n from Products.CMFCore.utils import getToolByName\n from zope.component import getUtility\ndiff --git a/plone/app/layout/sitemap/configure.zcml b/plone/app/layout/sitemap/configure.zcml\nindex 992f5e8d..967dcb7b 100644\n--- a/plone/app/layout/sitemap/configure.zcml\n+++ b/plone/app/layout/sitemap/configure.zcml\n@@ -4,7 +4,7 @@\n \n   <browser:page\n       name="sitemap.xml.gz"\n-      for="plone.app.layout.navigation.interfaces.INavigationRoot"\n+      for="plone.base.interfaces.INavigationRoot"\n       class=".sitemap.SiteMapView"\n       permission="zope2.Public"\n      />\ndiff --git a/plone/app/layout/sitemap/tests/test_sitemap.py b/plone/app/layout/sitemap/tests/test_sitemap.py\nindex 113fbfed..9d3820b1 100644\n--- a/plone/app/layout/sitemap/tests/test_sitemap.py\n+++ b/plone/app/layout/sitemap/tests/test_sitemap.py\n@@ -1,7 +1,7 @@\n from DateTime import DateTime\n from gzip import GzipFile\n from io import BytesIO\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import login\n from plone.app.testing import logout\ndiff --git a/plone/app/layout/viewlets/tests/test_common.py b/plone/app/layout/viewlets/tests/test_common.py\nindex 8bcb5f9c..00e15bb5 100644\n--- a/plone/app/layout/viewlets/tests/test_common.py\n+++ b/plone/app/layout/viewlets/tests/test_common.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.viewlets.common import ContentViewsViewlet\n from plone.app.layout.viewlets.common import GlobalSectionsViewlet\n from plone.app.layout.viewlets.common import LogoViewlet\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2023-03-06T15:27:03+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/9c9d83fd786f3442a7f63d97cbd153073095b8a4

Merge pull request #333 from plone/fix-navigationroot-import

move INavigationRoot from plone.app.layout to plone.base.

Files changed:
A news/Plone-3731.bugfix
M plone/app/layout/globals/context.py
M plone/app/layout/globals/tests/test_context.py
M plone/app/layout/globals/tests/test_layout.py
M plone/app/layout/globals/tests/test_portal.py
M plone/app/layout/navigation/interfaces.py
M plone/app/layout/navigation/root.py
M plone/app/layout/sitemap/configure.zcml
M plone/app/layout/sitemap/tests/test_sitemap.py
M plone/app/layout/viewlets/tests/test_common.py
M setup.py

b'diff --git a/news/Plone-3731.bugfix b/news/Plone-3731.bugfix\nnew file mode 100644\nindex 00000000..5ee64af6\n--- /dev/null\n+++ b/news/Plone-3731.bugfix\n@@ -0,0 +1,2 @@\n+Move interface plone.app.layout.navigation.interfaces.INavigationRoot to plone.base.interfaces.siteroot and add a deprecated import to plone.app.layout.\n+[jensens, gforcarda]\n\\ No newline at end of file\ndiff --git a/plone/app/layout/globals/context.py b/plone/app/layout/globals/context.py\nindex e4fbb109..146d325d 100644\n--- a/plone/app/layout/globals/context.py\n+++ b/plone/app/layout/globals/context.py\n@@ -2,7 +2,7 @@\n from Acquisition import aq_base\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.base.utils import pretty_title_or_id\n from plone.memoize.view import memoize\n from plone.portlets.interfaces import ILocalPortletAssignable\ndiff --git a/plone/app/layout/globals/tests/test_context.py b/plone/app/layout/globals/tests/test_context.py\nindex 5b41e7e6..7bf39b30 100644\n--- a/plone/app/layout/globals/tests/test_context.py\n+++ b/plone/app/layout/globals/tests/test_context.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\ndiff --git a/plone/app/layout/globals/tests/test_layout.py b/plone/app/layout/globals/tests/test_layout.py\nindex ee86ecd9..5178fbf5 100644\n--- a/plone/app/layout/globals/tests/test_layout.py\n+++ b/plone/app/layout/globals/tests/test_layout.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\ndiff --git a/plone/app/layout/globals/tests/test_portal.py b/plone/app/layout/globals/tests/test_portal.py\nindex 33209c94..bebb172d 100644\n--- a/plone/app/layout/globals/tests/test_portal.py\n+++ b/plone/app/layout/globals/tests/test_portal.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.navigation.root import getNavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import setRoles\ndiff --git a/plone/app/layout/navigation/interfaces.py b/plone/app/layout/navigation/interfaces.py\nindex f2ac6275..b03dea31 100644\n--- a/plone/app/layout/navigation/interfaces.py\n+++ b/plone/app/layout/navigation/interfaces.py\n@@ -1,9 +1,12 @@\n+from zope.deferredimport import deprecated\n from zope.interface import Attribute\n from zope.interface import Interface\n \n \n-class INavigationRoot(Interface):\n-    """A marker interface for signaling the navigation root."""\n+deprecated(\n+    "Import from plone.base.interfaces.siteroot instead (will be removed in Plone 7)",\n+    INavigationRoot="plone.base.interfaces.siteroot:INavigationRoot",\n+)\n \n \n class INavigationQueryBuilder(Interface):\ndiff --git a/plone/app/layout/navigation/root.py b/plone/app/layout/navigation/root.py\nindex 4badee8b..0b7ca706 100644\n--- a/plone/app/layout/navigation/root.py\n+++ b/plone/app/layout/navigation/root.py\n@@ -1,7 +1,7 @@\n from Acquisition import aq_base\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.registry.interfaces import IRegistry\n from Products.CMFCore.utils import getToolByName\n from zope.component import getUtility\ndiff --git a/plone/app/layout/sitemap/configure.zcml b/plone/app/layout/sitemap/configure.zcml\nindex 992f5e8d..967dcb7b 100644\n--- a/plone/app/layout/sitemap/configure.zcml\n+++ b/plone/app/layout/sitemap/configure.zcml\n@@ -4,7 +4,7 @@\n \n   <browser:page\n       name="sitemap.xml.gz"\n-      for="plone.app.layout.navigation.interfaces.INavigationRoot"\n+      for="plone.base.interfaces.INavigationRoot"\n       class=".sitemap.SiteMapView"\n       permission="zope2.Public"\n      />\ndiff --git a/plone/app/layout/sitemap/tests/test_sitemap.py b/plone/app/layout/sitemap/tests/test_sitemap.py\nindex 113fbfed..9d3820b1 100644\n--- a/plone/app/layout/sitemap/tests/test_sitemap.py\n+++ b/plone/app/layout/sitemap/tests/test_sitemap.py\n@@ -1,7 +1,7 @@\n from DateTime import DateTime\n from gzip import GzipFile\n from io import BytesIO\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.testing import INTEGRATION_TESTING\n from plone.app.testing import login\n from plone.app.testing import logout\ndiff --git a/plone/app/layout/viewlets/tests/test_common.py b/plone/app/layout/viewlets/tests/test_common.py\nindex 8bcb5f9c..00e15bb5 100644\n--- a/plone/app/layout/viewlets/tests/test_common.py\n+++ b/plone/app/layout/viewlets/tests/test_common.py\n@@ -1,4 +1,4 @@\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n+from plone.base.interfaces import INavigationRoot\n from plone.app.layout.viewlets.common import ContentViewsViewlet\n from plone.app.layout.viewlets.common import GlobalSectionsViewlet\n from plone.app.layout.viewlets.common import LogoViewlet\ndiff --git a/setup.py b/setup.py\nindex dee33f7d..b2f4b4ad 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -40,7 +40,7 @@\n         "DateTime",\n         "plone.app.content",\n         "plone.app.viewletmanager >=1.2",\n-        "plone.base",\n+        "plone.base >1.0.3",\n         "plone.batching >1.0.999",\n         "plone.i18n",\n         "plone.memoize",\n'

