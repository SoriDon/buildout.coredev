Repository: plone.app.layout


Branch: refs/heads/master
Date: 2016-01-28T12:28:11+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/845da052d5afc320b94befcd61a3436fbcd353cf

Adapt to changed Zope 4 broser:view semantics. We either need a template ZCML argument or a __call__ method on the class.

Files changed:
M CHANGES.rst
M plone/app/layout/viewlets/content.py

diff --git a/CHANGES.rst b/CHANGES.rst
index a12afb1..26827e5 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -11,7 +11,8 @@ New:
 
 Fixes:
 
-- *add item here*
+- Adapt to changed Zope 4 ``broser:view`` semantics. We either need a ``template`` ZCML argument or a ``__call__`` method on the class.
+  [thet]
 
 
 2.5.17 (2015-11-26)
diff --git a/plone/app/layout/viewlets/content.py b/plone/app/layout/viewlets/content.py
index 615d78f..e9afc21 100644
--- a/plone/app/layout/viewlets/content.py
+++ b/plone/app/layout/viewlets/content.py
@@ -511,8 +511,9 @@ def toLocalizedTime(self, time, long_format=None, time_only=None):
 
 class ContentHistoryView(ContentHistoryViewlet):
 
-    index = ViewPageTemplateFile("content_history.pt")
-
     def __init__(self, context, request):
         super(ContentHistoryView, self).__init__(context, request, None, None)
         self.update()
+
+    def __call__(self):
+        return self.index()


Repository: plone.app.layout


Branch: refs/heads/master
Date: 2016-01-29T02:23:13+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/3961968cb836896a3eabd3341bc11afcce85c26c

Merge pull request #77 from plone/thet-zope4

Zope4

Files changed:
M CHANGES.rst
M plone/app/layout/viewlets/content.py

diff --git a/CHANGES.rst b/CHANGES.rst
index a12afb1..26827e5 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -11,7 +11,8 @@ New:
 
 Fixes:
 
-- *add item here*
+- Adapt to changed Zope 4 ``broser:view`` semantics. We either need a ``template`` ZCML argument or a ``__call__`` method on the class.
+  [thet]
 
 
 2.5.17 (2015-11-26)
diff --git a/plone/app/layout/viewlets/content.py b/plone/app/layout/viewlets/content.py
index 615d78f..e9afc21 100644
--- a/plone/app/layout/viewlets/content.py
+++ b/plone/app/layout/viewlets/content.py
@@ -511,8 +511,9 @@ def toLocalizedTime(self, time, long_format=None, time_only=None):
 
 class ContentHistoryView(ContentHistoryViewlet):
 
-    index = ViewPageTemplateFile("content_history.pt")
-
     def __init__(self, context, request):
         super(ContentHistoryView, self).__init__(context, request, None, None)
         self.update()
+
+    def __call__(self):
+        return self.index()


