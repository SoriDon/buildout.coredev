Repository: plone.app.layout


Branch: refs/heads/master
Date: 2019-10-13T10:53:51+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/66defc53c59426a45adde215f8d8c17e11c592db

Fix Home tab localization (closes #222)

Files changed:
A news/222.bugfix
M plone/app/layout/viewlets/common.py

b"diff --git a/news/222.bugfix b/news/222.bugfix\nnew file mode 100644\nindex 00000000..9a109832\n--- /dev/null\n+++ b/news/222.bugfix\n@@ -0,0 +1 @@\n+Fix Home tab localization [vincentfretin]\ndiff --git a/plone/app/layout/viewlets/common.py b/plone/app/layout/viewlets/common.py\nindex 79b9fbc0..daa4fc28 100644\n--- a/plone/app/layout/viewlets/common.py\n+++ b/plone/app/layout/viewlets/common.py\n@@ -281,12 +281,20 @@ def navtree(self):\n             })\n             if 'review_state' not in entry:\n                 entry['review_state'] = None\n+\n             if 'title' not in entry:\n                 entry['title'] = (\n                     tab.get('name')\n                     or tab.get('description')\n                     or tab['id']\n                 )\n+            else:\n+                # translate Home tab\n+                entry['title'] = translate(\n+                    entry['title'],\n+                    domain='plone',\n+                    context=self.request)\n+\n             entry['title'] = safe_unicode(entry['title'])\n             ret[navtree_path].append(entry)\n \n"

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2019-10-13T15:57:26+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/de6de20acde1a979d11fdd2e2799872484189100

Merge pull request #223 from plone/fix-i18n-home

Fix Home tab localization (closes #222)

Files changed:
A news/222.bugfix
M plone/app/layout/viewlets/common.py

b"diff --git a/news/222.bugfix b/news/222.bugfix\nnew file mode 100644\nindex 00000000..9a109832\n--- /dev/null\n+++ b/news/222.bugfix\n@@ -0,0 +1 @@\n+Fix Home tab localization [vincentfretin]\ndiff --git a/plone/app/layout/viewlets/common.py b/plone/app/layout/viewlets/common.py\nindex 79b9fbc0..daa4fc28 100644\n--- a/plone/app/layout/viewlets/common.py\n+++ b/plone/app/layout/viewlets/common.py\n@@ -281,12 +281,20 @@ def navtree(self):\n             })\n             if 'review_state' not in entry:\n                 entry['review_state'] = None\n+\n             if 'title' not in entry:\n                 entry['title'] = (\n                     tab.get('name')\n                     or tab.get('description')\n                     or tab['id']\n                 )\n+            else:\n+                # translate Home tab\n+                entry['title'] = translate(\n+                    entry['title'],\n+                    domain='plone',\n+                    context=self.request)\n+\n             entry['title'] = safe_unicode(entry['title'])\n             ret[navtree_path].append(entry)\n \n"

