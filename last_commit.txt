Repository: plone.restapi


Branch: refs/heads/master
Date: 2018-10-23T09:46:19+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/8eb55cd6c76df9dc7ed8fc706737f7b1b6da5bac

Fixed tests after German translation update.

This commit in plone.app.locales changes several German strings:
https://github.com/collective/plone.app.locales/commit/426adfc06bbc94eeddf350ba6d7c93059372c6fd
Reviewer was mostly called 'Redacteur', and is called simply 'Reviewer' now.
And in one case it had been translated as 'Ver√∂ffentlichen', which is what plone.restapi was testing,
but that one means 'make public', so it wasn't a good translation.

Updated the test to check for either of the two translations instead,
because the tests need to pass in other Plone versions as well.

Files changed:
M src/plone/restapi/tests/test_roles.py

b"diff --git a/src/plone/restapi/tests/test_roles.py b/src/plone/restapi/tests/test_roles.py\nindex 83d5becb..05291d40 100644\n--- a/src/plone/restapi/tests/test_roles.py\n+++ b/src/plone/restapi/tests/test_roles.py\n@@ -60,13 +60,19 @@ def test_roles_endpoint_lists_roles(self):\n     def test_roles_endpoint_translates_role_titles(self):\n         self.api_session.headers.update({'Accept-Language': 'de'})\n         response = self.api_session.get('/@roles')\n-\n+        # One of the roles has changed translation in German.\n+        # Reviewer used to be 'Ver\\xf6ffentlichen', but is now simply Reviewer.\n+        titles = {item['title'] for item in response.json()}\n+        options = {u'Ver\\xf6ffentlichen', u'Reviewer'}\n+        # One of the options must match:\n+        self.assertTrue(titles.intersection(options))\n+        # Discard them:\n+        titles = titles.difference(options)\n         self.assertEqual({\n             u'Hinzuf\\xfcgen',\n             u'Bearbeiten',\n             u'Benutzer',\n             u'Ansehen',\n-            u'Ver\\xf6ffentlichen',\n             u'Website-Administrator',\n             u'Verwalten'},\n-            {item['title'] for item in response.json()})\n+            titles)\n"

Repository: plone.restapi


Branch: refs/heads/master
Date: 2018-10-23T10:53:44+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/a4172321c0d6facb05ae844a17670e5f31bef4ba

Merge pull request #629 from plone/maurits-german-test-fix

Fixed tests after German translation update.

Files changed:
M src/plone/restapi/tests/test_roles.py

b"diff --git a/src/plone/restapi/tests/test_roles.py b/src/plone/restapi/tests/test_roles.py\nindex 83d5becb..05291d40 100644\n--- a/src/plone/restapi/tests/test_roles.py\n+++ b/src/plone/restapi/tests/test_roles.py\n@@ -60,13 +60,19 @@ def test_roles_endpoint_lists_roles(self):\n     def test_roles_endpoint_translates_role_titles(self):\n         self.api_session.headers.update({'Accept-Language': 'de'})\n         response = self.api_session.get('/@roles')\n-\n+        # One of the roles has changed translation in German.\n+        # Reviewer used to be 'Ver\\xf6ffentlichen', but is now simply Reviewer.\n+        titles = {item['title'] for item in response.json()}\n+        options = {u'Ver\\xf6ffentlichen', u'Reviewer'}\n+        # One of the options must match:\n+        self.assertTrue(titles.intersection(options))\n+        # Discard them:\n+        titles = titles.difference(options)\n         self.assertEqual({\n             u'Hinzuf\\xfcgen',\n             u'Bearbeiten',\n             u'Benutzer',\n             u'Ansehen',\n-            u'Ver\\xf6ffentlichen',\n             u'Website-Administrator',\n             u'Verwalten'},\n-            {item['title'] for item in response.json()})\n+            titles)\n"

