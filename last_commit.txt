Repository: mockup


Branch: refs/heads/master
Date: 2017-02-10T14:39:05+01:00
Author: Gagaro (Gagaro) <gagaro42@gmail.com>
Commit: https://github.com/plone/mockup/commit/4080f5fd2d0966eb4ef60ced225225687c1c3617

feat: add an option for the path operator in QueryHelper and tinymce pattern

Files changed:
M CHANGES.rst
M mockup/js/utils.js
M mockup/patterns/relateditems/pattern.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 186db76..86ddb0e 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -115,6 +115,9 @@ New:
 - Add ``defaultSortOn`` option in ``livesearch`` pattern.
   [Gagaro]
 
+- Add an option to set the path operator in QueryHelp and tinymce pattern.
+  [Gagaro]
+
 Fixes:
 
 - Change ``bool`` function in mockup-utils to allow for truthy values and match on falsy values.
diff --git a/mockup/js/utils.js b/mockup/js/utils.js
index 05f9426..039d904 100644
--- a/mockup/js/utils.js
+++ b/mockup/js/utils.js
@@ -19,6 +19,7 @@ define([
       pattern: null, // must be passed in
       vocabularyUrl: null,
       searchParam: 'SearchableText', // query string param to pass to search url
+      pathOperator: 'plone.app.querystring.operation.string.path',
       attributes: ['UID', 'Title', 'Description', 'getURL', 'portal_type'],
       batchSize: 10, // number of results to retrive
       baseCriteria: [],
@@ -102,13 +103,13 @@ define([
       if (searchOptions.searchPath) {
         criterias.push({
           i: 'path',
-          o: 'plone.app.querystring.operation.string.path',
+          o: self.options.pathOperator,
           v: searchOptions.searchPath + '::' + self.options.pathDepth
         });
       } else if (self.pattern.browsing) {
         criterias.push({
           i: 'path',
-          o: 'plone.app.querystring.operation.string.path',
+          o: self.options.pathOperator,
           v: self.getCurrentPath() + '::' + self.options.pathDepth
         });
       }
diff --git a/mockup/patterns/relateditems/pattern.js b/mockup/patterns/relateditems/pattern.js
index c35b786..7190a62 100644
--- a/mockup/patterns/relateditems/pattern.js
+++ b/mockup/patterns/relateditems/pattern.js
@@ -134,6 +134,7 @@ define([
       orderable: true,  // mockup-patterns-select2
       rootPath: '/',
       rootUrl: '',  // default to be relative.
+      pathOperator: 'plone.app.querystring.operation.string.path',
       selectableTypes: null, // null means everything is selectable, otherwise a list of strings to match types that are selectable
       separator: ',',
       tokenSeparators: [',', ' '],
@@ -191,7 +192,7 @@ define([
 
         baseCriteria.push({
           i: 'path',
-          o: 'plone.app.querystring.operation.string.path',
+          o: this.options.pathOperator,
           v: this.options.rootPath + this.currentPath
         });
 


Repository: mockup


Branch: refs/heads/master
Date: 2017-02-11T14:27:26+01:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/mockup/commit/56503d20b9d1db0890c2850ee7673748ecae0b59

Merge pull request #742 from plone/query-path-operator-option

feat: add an option for the path operator in QueryHelper and tinymce pattern

Files changed:
M CHANGES.rst
M mockup/js/utils.js
M mockup/patterns/relateditems/pattern.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 186db76..86ddb0e 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -115,6 +115,9 @@ New:
 - Add ``defaultSortOn`` option in ``livesearch`` pattern.
   [Gagaro]
 
+- Add an option to set the path operator in QueryHelp and tinymce pattern.
+  [Gagaro]
+
 Fixes:
 
 - Change ``bool`` function in mockup-utils to allow for truthy values and match on falsy values.
diff --git a/mockup/js/utils.js b/mockup/js/utils.js
index 05f9426..039d904 100644
--- a/mockup/js/utils.js
+++ b/mockup/js/utils.js
@@ -19,6 +19,7 @@ define([
       pattern: null, // must be passed in
       vocabularyUrl: null,
       searchParam: 'SearchableText', // query string param to pass to search url
+      pathOperator: 'plone.app.querystring.operation.string.path',
       attributes: ['UID', 'Title', 'Description', 'getURL', 'portal_type'],
       batchSize: 10, // number of results to retrive
       baseCriteria: [],
@@ -102,13 +103,13 @@ define([
       if (searchOptions.searchPath) {
         criterias.push({
           i: 'path',
-          o: 'plone.app.querystring.operation.string.path',
+          o: self.options.pathOperator,
           v: searchOptions.searchPath + '::' + self.options.pathDepth
         });
       } else if (self.pattern.browsing) {
         criterias.push({
           i: 'path',
-          o: 'plone.app.querystring.operation.string.path',
+          o: self.options.pathOperator,
           v: self.getCurrentPath() + '::' + self.options.pathDepth
         });
       }
diff --git a/mockup/patterns/relateditems/pattern.js b/mockup/patterns/relateditems/pattern.js
index c35b786..7190a62 100644
--- a/mockup/patterns/relateditems/pattern.js
+++ b/mockup/patterns/relateditems/pattern.js
@@ -134,6 +134,7 @@ define([
       orderable: true,  // mockup-patterns-select2
       rootPath: '/',
       rootUrl: '',  // default to be relative.
+      pathOperator: 'plone.app.querystring.operation.string.path',
       selectableTypes: null, // null means everything is selectable, otherwise a list of strings to match types that are selectable
       separator: ',',
       tokenSeparators: [',', ' '],
@@ -191,7 +192,7 @@ define([
 
         baseCriteria.push({
           i: 'path',
-          o: 'plone.app.querystring.operation.string.path',
+          o: this.options.pathOperator,
           v: this.options.rootPath + this.currentPath
         });
 


