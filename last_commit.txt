Repository: plone.app.content


Branch: refs/heads/master
Date: 2018-10-05T12:02:57+02:00
Author: Manuel Reinhardt (reinhardt) <reinhardt@syslab.com>
Commit: https://github.com/plone/plone.app.content/commit/738b89b10e51c05f7064126d1bdf710c2c59ec87

Replaced another usage of getObjSize.
https://github.com/plone/Products.CMFPlone/issues/1801

Files changed:
M plone/app/content/browser/content_status_history.py
M plone/app/content/browser/templates/content_status_history.pt

b"diff --git a/plone/app/content/browser/content_status_history.py b/plone/app/content/browser/content_status_history.py\nindex 14eacd2..6ce7bb7 100644\n--- a/plone/app/content/browser/content_status_history.py\n+++ b/plone/app/content/browser/content_status_history.py\n@@ -1,6 +1,7 @@\n # -*- coding: utf-8 -*-\n from Products.CMFCore.utils import getToolByName\n from Products.CMFPlone import PloneMessageFactory as _\n+from Products.CMFPlone.utils import human_readable_size\n from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile\n from z3c.form import field\n from z3c.form import form\n@@ -133,3 +134,6 @@ def redirect_to_referrer(self):\n         referer = self.request.get('HTTP_REFERER', '')\n         target_url = referer.split('?', 1)[0]\n         return self.request.RESPONSE.redirect(target_url)\n+\n+    def human_readable_size(self, size):\n+        return human_readable_size(size)\ndiff --git a/plone/app/content/browser/templates/content_status_history.pt b/plone/app/content/browser/templates/content_status_history.pt\nindex 8089871..113a382 100644\n--- a/plone/app/content/browser/templates/content_status_history.pt\n+++ b/plone/app/content/browser/templates/content_status_history.pt\n@@ -123,7 +123,7 @@\n                                            item_title_or_id     item/pretty_title_or_id;\n                                            item_description     item/Description;\n                                            item_type            item/portal_type;\n-                                           item_size            item/getObjSize;\n+                                           item_size            python:view.human_readable_size(item.get_size());\n                                            item_modified        item/ModificationDate;\n                                            item_type_class      python:'contenttype-' + normalizeString(item_type);\n                                            item_wf_state        item/review_state|python: wtool.getInfoFor(item, 'review_state', '');\n"

Repository: plone.app.content


Branch: refs/heads/master
Date: 2018-10-05T20:17:18+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.content/commit/6031badbeb74f56f7be6b3527603032a4f46d6b0

Merge pull request #169 from plone/1801-get-size-part-2

Replaced another usage of getObjSize

Files changed:
M plone/app/content/browser/content_status_history.py
M plone/app/content/browser/templates/content_status_history.pt

b"diff --git a/plone/app/content/browser/content_status_history.py b/plone/app/content/browser/content_status_history.py\nindex 14eacd2..6ce7bb7 100644\n--- a/plone/app/content/browser/content_status_history.py\n+++ b/plone/app/content/browser/content_status_history.py\n@@ -1,6 +1,7 @@\n # -*- coding: utf-8 -*-\n from Products.CMFCore.utils import getToolByName\n from Products.CMFPlone import PloneMessageFactory as _\n+from Products.CMFPlone.utils import human_readable_size\n from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile\n from z3c.form import field\n from z3c.form import form\n@@ -133,3 +134,6 @@ def redirect_to_referrer(self):\n         referer = self.request.get('HTTP_REFERER', '')\n         target_url = referer.split('?', 1)[0]\n         return self.request.RESPONSE.redirect(target_url)\n+\n+    def human_readable_size(self, size):\n+        return human_readable_size(size)\ndiff --git a/plone/app/content/browser/templates/content_status_history.pt b/plone/app/content/browser/templates/content_status_history.pt\nindex 8089871..113a382 100644\n--- a/plone/app/content/browser/templates/content_status_history.pt\n+++ b/plone/app/content/browser/templates/content_status_history.pt\n@@ -123,7 +123,7 @@\n                                            item_title_or_id     item/pretty_title_or_id;\n                                            item_description     item/Description;\n                                            item_type            item/portal_type;\n-                                           item_size            item/getObjSize;\n+                                           item_size            python:view.human_readable_size(item.get_size());\n                                            item_modified        item/ModificationDate;\n                                            item_type_class      python:'contenttype-' + normalizeString(item_type);\n                                            item_wf_state        item/review_state|python: wtool.getInfoFor(item, 'review_state', '');\n"

