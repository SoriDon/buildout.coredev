Repository: plone.volto


Branch: refs/heads/main
Date: 2021-12-07T10:40:02+01:00
Author: nzambello (nzambello) <nzambello@protonmail.com>
Commit: https://github.com/plone/plone.volto/commit/b18efca73398ec58fb212b37e36701d33c5a7d42

Add blocks behavior on Event and NewsItem

Files changed:
A src/plone/volto/profiles/default/types/Event.xml
A src/plone/volto/profiles/default/types/News_Item.xml
M CHANGES.rst
M src/plone/volto/profiles/default/metadata.xml
M src/plone/volto/profiles/default/types.xml
M src/plone/volto/upgrades.zcml

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 045e2a1..87fe2f9 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -4,6 +4,13 @@ Changelog\n 3.1.0a7 (unreleased)\n --------------------\n \n+New feature:\n+\n+- Add blocks behavior on Event and NewsItem\n+  [nzambello]\n+- Add preview_image to Event\n+  [nzambello]\n+\n Internal:\n \n - Test with Plone 6.0.0a2\ndiff --git a/src/plone/volto/profiles/default/metadata.xml b/src/plone/volto/profiles/default/metadata.xml\nindex 36539e9..41189c2 100644\n--- a/src/plone/volto/profiles/default/metadata.xml\n+++ b/src/plone/volto/profiles/default/metadata.xml\n@@ -1,6 +1,6 @@\n <?xml version="1.0" encoding="UTF-8"?>\n <metadata>\n-  <version>1012</version>\n+  <version>1013</version>\n   <dependencies>\n     <dependency>profile-collective.folderishtypes.dx:default</dependency>\n     <dependency>profile-plone.restapi:blocks</dependency>\ndiff --git a/src/plone/volto/profiles/default/types.xml b/src/plone/volto/profiles/default/types.xml\nindex fee4cc8..81e9537 100644\n--- a/src/plone/volto/profiles/default/types.xml\n+++ b/src/plone/volto/profiles/default/types.xml\n@@ -3,4 +3,6 @@\n   <object name="Plone Site" />\n   <object meta_type="Dexterity FTI" name="LRF" />\n   <object meta_type="Dexterity FTI" name="Document" />\n+  <object meta_type="Dexterity FTI" name="Event" />\n+  <object meta_type="Dexterity FTI" name="News Item" />\n </object>\ndiff --git a/src/plone/volto/profiles/default/types/Event.xml b/src/plone/volto/profiles/default/types/Event.xml\nnew file mode 100644\nindex 0000000..7201424\n--- /dev/null\n+++ b/src/plone/volto/profiles/default/types/Event.xml\n@@ -0,0 +1,14 @@\n+<?xml version="1.0"?>\n+<object\n+    i18n:domain="plone"\n+    meta_type="Dexterity FTI"\n+    name="Event"\n+    xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n+\n+  <!-- Enabled behaviors -->\n+  <property name="behaviors" purge="False">\n+    <element value="volto.blocks" />\n+    <element value="volto.preview_image" />\n+  </property>\n+\n+</object>\ndiff --git a/src/plone/volto/profiles/default/types/News_Item.xml b/src/plone/volto/profiles/default/types/News_Item.xml\nnew file mode 100644\nindex 0000000..06b8d48\n--- /dev/null\n+++ b/src/plone/volto/profiles/default/types/News_Item.xml\n@@ -0,0 +1,13 @@\n+<?xml version="1.0"?>\n+<object\n+    i18n:domain="plone"\n+    meta_type="Dexterity FTI"\n+    name="News Item"\n+    xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n+\n+  <!-- Enabled behaviors -->\n+  <property name="behaviors" purge="False">\n+    <element value="volto.blocks" />\n+  </property>\n+\n+</object>\ndiff --git a/src/plone/volto/upgrades.zcml b/src/plone/volto/upgrades.zcml\nindex 468b808..20052cb 100644\n--- a/src/plone/volto/upgrades.zcml\n+++ b/src/plone/volto/upgrades.zcml\n@@ -21,4 +21,12 @@\n       import_steps="catalog"\n       />\n \n+  <genericsetup:upgradeDepends\n+      title="Add blocks behavior to Event and News Item"\n+      profile="plone.volto:default"\n+      source="1012"\n+      destination="1013"\n+      import_steps="typeinfo"\n+      />\n+\n </configure>\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-12-13T08:42:23+01:00
Author: Timo Stollenwerk (tisto) <tisto@users.noreply.github.com>
Commit: https://github.com/plone/plone.volto/commit/dfa9e39c9129f1bb9e837ecdd278f44279ae8b7f

Merge branch 'main' into event_newsitem_blocks

Files changed:
A src/plone/volto/coresandbox/__init__.py
A src/plone/volto/coresandbox/configure.zcml
A src/plone/volto/coresandbox/example.py
A src/plone/volto/coresandbox/vocabularies.py
A src/plone/volto/profiles/coresandbox/diff_tool.xml
A src/plone/volto/profiles/coresandbox/metadata.xml
A src/plone/volto/profiles/coresandbox/repositorytool.xml
A src/plone/volto/profiles/coresandbox/types.xml
A src/plone/volto/profiles/coresandbox/types/example.xml
A src/plone/volto/tests/test_coresandbox.py
M CHANGES.rst
M plone-5.2.x.cfg
M setup.py
M src/plone/volto/configure.zcml
M src/plone/volto/setuphandlers.py
M src/plone/volto/testing.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 87fe2f9..c046eb7 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -1,7 +1,7 @@\n Changelog\n =========\n \n-3.1.0a7 (unreleased)\n+3.1.0a8 (unreleased)\n --------------------\n \n New feature:\n@@ -11,6 +11,15 @@ New feature:\n - Add preview_image to Event\n   [nzambello]\n \n+\n+3.1.0a7 (2021-12-11)\n+--------------------\n+\n+New Feature:\n+\n+- Added coresandbox fixture for Volto\'s cypress tests\n+  [sneridagh]\n+\n Internal:\n \n - Test with Plone 6.0.0a2\ndiff --git a/plone-5.2.x.cfg b/plone-5.2.x.cfg\nindex 876cba2..f0b45f7 100644\n--- a/plone-5.2.x.cfg\n+++ b/plone-5.2.x.cfg\n@@ -1,8 +1,7 @@\n [buildout]\n extends =\n     base.cfg\n-    http://dist.plone.org/release/5.2.5/versions.cfg\n-\n+    http://dist.plone.org/release/5.2.6/versions.cfg\n find-links += http://dist.plone.org/thirdparty/\n \n [versions]\n@@ -16,4 +15,4 @@ importlib-metadata = 1.7.0\n # Error: The requirement (\'importlib-metadata>=3.6\') is not allowed by your [versions] constraint (1.7.0)\n keyring = 22.0.1\n secretstorage = 3.3.1\n-jeepney = 0.7.1\n\\ No newline at end of file\n+jeepney = 0.7.1\ndiff --git a/setup.py b/setup.py\nindex 89e82f2..bb0f1aa 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -24,7 +24,7 @@ def readfile(name):\n \n setup(\n     name="plone.volto",\n-    version="3.1.0a7.dev0",\n+    version="3.1.0a8.dev0",\n     description="Volto integration add-on for Plone",\n     long_description=long_description,\n     # Get more from https://pypi.org/classifiers/\n@@ -58,6 +58,7 @@ def readfile(name):\n         "setuptools",\n         "plone.restapi>=8.13.0",\n         "collective.folderishtypes[dexterity]",\n+        "plone.app.vocabularies>=4.3.0",\n     ],\n     extras_require={\n         "test": [\n@@ -65,6 +66,7 @@ def readfile(name):\n             "plone.testing",\n             "plone.app.contenttypes",\n             "plone.app.robotframework[debug]",\n+            "collective.MockMailHost",\n         ]\n     },\n     entry_points="""\ndiff --git a/src/plone/volto/configure.zcml b/src/plone/volto/configure.zcml\nindex df6c21a..41793a9 100644\n--- a/src/plone/volto/configure.zcml\n+++ b/src/plone/volto/configure.zcml\n@@ -63,6 +63,17 @@\n       post_handler=".setuphandlers.create_demo_homepage"\n       />\n \n+  <!-- Fixture for coresandbox Cypress tests in Volto repo -->\n+  <genericsetup:registerProfile\n+      name="coresandbox"\n+      title="plone.volto coresandbox Cypress tests fixtures"\n+      description="Special test fixture for coresandbox use cases"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/coresandbox"\n+      post_handler=".setuphandlers.post_install_coresandbox"\n+      />\n+\n+  <!-- Fixture for multilingual Cypress tests in Volto repo -->\n   <genericsetup:registerProfile\n       name="multilingual"\n       title="plone.volto multilingual Cypress tests fixtures"\ndiff --git a/src/plone/volto/coresandbox/__init__.py b/src/plone/volto/coresandbox/__init__.py\nnew file mode 100644\nindex 0000000..e69de29\ndiff --git a/src/plone/volto/coresandbox/configure.zcml b/src/plone/volto/coresandbox/configure.zcml\nnew file mode 100644\nindex 0000000..d336e0b\n--- /dev/null\n+++ b/src/plone/volto/coresandbox/configure.zcml\n@@ -0,0 +1,19 @@\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n+    xmlns:i18n="http://namespaces.zope.org/i18n"\n+    xmlns:plone="http://namespaces.plone.org/plone"\n+    i18n_domain="plone.volto"\n+    >\n+\n+  <utility\n+      name="plone.volto.coresandbox.vocabularies.documents"\n+      component=".vocabularies.DocumentVocabularyFactory"\n+      />\n+\n+  <utility\n+      name="plone.volto.coresandbox.vocabularies.huge"\n+      component=".vocabularies.HugeVocabularyFactory"\n+      />\n+\n+</configure>\ndiff --git a/src/plone/volto/coresandbox/example.py b/src/plone/volto/coresandbox/example.py\nnew file mode 100644\nindex 0000000..ff94c0f\n--- /dev/null\n+++ b/src/plone/volto/coresandbox/example.py\n@@ -0,0 +1,872 @@\n+# -*- coding: utf-8 -*-\n+from plone.app.textfield import RichText\n+from plone.app.vocabularies.catalog import CatalogSource\n+from plone.app.vocabularies.catalog import StaticCatalogVocabulary\n+from plone.app.z3cform.widget import AjaxSelectFieldWidget\n+from plone.app.z3cform.widget import RelatedItemsFieldWidget\n+from plone.app.z3cform.widget import SelectFieldWidget\n+from plone.autoform import directives\n+from plone.dexterity.content import Container\n+\n+from plone.namedfile.field import NamedBlobFile\n+from plone.namedfile.field import NamedBlobImage\n+from plone.schema import Email\n+\n+# from plone.schema import (\n+#     Dict,\n+# )  # take Dict field from plone.schema to use the widget attribute\n+from plone.supermodel import model\n+from plone.supermodel.directives import fieldset\n+from plone.supermodel.directives import primary\n+\n+from z3c.form.browser.checkbox import CheckBoxFieldWidget\n+from z3c.form.browser.radio import RadioFieldWidget\n+\n+from z3c.relationfield.schema import RelationChoice\n+from z3c.relationfield.schema import RelationList\n+from zope import schema\n+from zope.interface import implementer\n+\n+from zope.i18nmessageid import MessageFactory\n+\n+_ = PloneMessageFactory = MessageFactory("plone")\n+\n+\n+class IExample(model.Schema):\n+    """Dexterity-Schema with all field-types."""\n+\n+    # The most used fields\n+    # textline, text, bool, richtext, email\n+\n+    fieldset(\n+        "numberfields",\n+        label=u"Number fields",\n+        fields=("int_field", "float_field"),\n+    )\n+\n+    fieldset(\n+        "datetimefields",\n+        label=u"Date and time fields",\n+        fields=(\n+            "datetime_field",\n+            "date_field",\n+            # "time_field", # Not supported by plone.restapi yet\n+            # "timedelta_field", # Not supported by plone.restapi yet\n+        ),\n+    )\n+\n+    fieldset(\n+        "choicefields",\n+        label=u"Choice and Multiple Choice fields",\n+        fields=(\n+            "choice_field",\n+            "choice_field_radio",\n+            "choice_field_select",\n+            "choice_field_voc",\n+            "list_field",\n+            "list_field_checkbox",\n+            "list_field_select",\n+            "list_field_voc_unconstrained",\n+            "list_field_voc_huge",\n+            "tuple_field",\n+            "set_field",\n+            "set_field_checkbox",\n+        ),\n+    )\n+\n+    fieldset(\n+        "relationfields",\n+        label=u"Relation fields",\n+        fields=(\n+            "relationchoice_field",\n+            "relationlist_field",\n+            "relationchoice_field_constrained",\n+            "relationlist_field_constrained",\n+            "relationlist_field_search_mode",\n+            "relationchoice_field_select",\n+            "relationchoice_field_radio",\n+            "relationlist_field_select",\n+            "relationlist_field_checkbox",\n+            # "relationchoice_field_ajax_select", # Not supported by plone.restapi yet\n+            # "relationlist_field_ajax_select", # Not supported by plone.restapi yet\n+        ),\n+    )\n+\n+    fieldset(\n+        "uuidrelationfields",\n+        label=u"Relation widgets with uuids",\n+        fields=(\n+            "uuid_choice_field",\n+            "uuid_list_field",\n+            "uuid_choice_field_constrained",\n+            "uuid_list_field_constrained",\n+            "uuid_list_field_search_mode",\n+            "uuid_choice_field_select",\n+            "uuid_choice_field_radio",\n+            "uuid_list_field_select",\n+            "uuid_list_field_checkbox",\n+            # "uuid_choice_field_ajax_select", # Not supported by plone.restapi yet\n+            # "uuid_list_field_ajax_select", # Not supported by plone.restapi yet\n+        ),\n+    )\n+\n+    fieldset(\n+        "filefields",\n+        label=u"File fields",\n+        fields=("file_field", "image_field"),\n+    )\n+\n+    fieldset(\n+        "otherfields",\n+        label=u"Other fields",\n+        fields=(\n+            "available_languages",\n+            "uri_field",\n+            "sourcetext_field",\n+            "ascii_field",\n+            "bytesline_field",\n+            "asciiline_field",\n+            "pythonidentifier_field",\n+            "dottedname_field",\n+            "dict_field",\n+            # "vocabularyterms_field", # Not supported by plone.restapi yet\n+            # "vocabularytermstranslation_field", # Not supported by plone.restapi yet\n+            "dict_field_with_choice",\n+        ),\n+    )\n+\n+    primary("title")\n+    title = schema.TextLine(\n+        title=u"Primary Field (Textline)",\n+        description=u"zope.schema.TextLine",\n+        required=True,\n+    )\n+\n+    description = schema.TextLine(\n+        title=u"Description (Textline)",\n+        description=u"zope.schema.TextLine",\n+        required=False,\n+    )\n+\n+    text_field = schema.Text(\n+        title=u"Text Field", description=u"zope.schema.Text", required=False\n+    )\n+\n+    textline_field = schema.TextLine(\n+        title=u"Textline field",\n+        description=u"A simple input field (schema.TextLine)",\n+        required=False,\n+    )\n+\n+    bool_field = schema.Bool(\n+        title=u"Boolean field",\n+        description=u"zope.schema.Bool",\n+        required=False,\n+    )\n+\n+    choice_field = schema.Choice(\n+        title=u"Choice field",\n+        description=u"zope.schema.Choice",\n+        values=[u"One", u"Two", u"Three"],\n+        required=False,\n+    )\n+\n+    directives.widget(choice_field_radio=RadioFieldWidget)\n+    choice_field_radio = schema.Choice(\n+        title=u"Choice field with radio boxes",\n+        description=u"zope.schema.Choice",\n+        values=[u"One", u"Two", u"Three"],\n+        required=False,\n+    )\n+\n+    choice_field_voc = schema.Choice(\n+        title=u"Choicefield with values from named vocabulary",\n+        description=u"zope.schema.Choice",\n+        vocabulary="plone.app.vocabularies.PortalTypes",\n+        required=False,\n+    )\n+\n+    directives.widget(choice_field_select=SelectFieldWidget)\n+    choice_field_select = schema.Choice(\n+        title=u"Choicefield with select2 widget",\n+        description=u"zope.schema.Choice",\n+        vocabulary="plone.app.vocabularies.PortalTypes",\n+        required=False,\n+    )\n+\n+    list_field = schema.List(\n+        title=u"List field",\n+        description=u"zope.schema.List",\n+        value_type=schema.Choice(\n+            values=[u"Beginner", u"Advanced", u"Professional"],\n+        ),\n+        required=False,\n+        missing_value=[],\n+        default=[],\n+    )\n+\n+    directives.widget(list_field_checkbox=CheckBoxFieldWidget)\n+    list_field_checkbox = schema.List(\n+        title=u"List field with checkboxes",\n+        description=u"zope.schema.List",\n+        value_type=schema.Choice(\n+            values=[u"Beginner", u"Advanced", u"Professional"],\n+        ),\n+        required=False,\n+        missing_value=[],\n+        default=[],\n+    )\n+\n+    directives.widget(list_field_select=SelectFieldWidget)\n+    list_field_select = schema.List(\n+        title=u"List field with select widget",\n+        description=u"zope.schema.List",\n+        value_type=schema.Choice(\n+            values=[u"Beginner", u"Advanced", u"Professional"],\n+        ),\n+        required=False,\n+        missing_value=[],\n+        default=[],\n+    )\n+\n+    list_field_voc_unconstrained = schema.List(\n+        title=u"List field with values from vocabulary but not constrained to them.",\n+        description=u"zope.schema.List",\n+        value_type=schema.TextLine(),\n+        required=False,\n+        missing_value=[],\n+        default=[],\n+    )\n+    directives.widget(\n+        "list_field_voc_unconstrained",\n+        AjaxSelectFieldWidget,\n+        vocabulary="plone.app.vocabularies.PortalTypes",\n+        pattern_options={\n+            "closeOnSelect": False,  # Select2 option to leave dropdown open for multiple selection\n+        },\n+    )\n+\n+    list_field_voc_huge = schema.List(\n+        title=u"List field with values from a huge vocabulary",\n+        description=u"zope.schema.List",\n+        value_type=schema.Choice(\n+            vocabulary="plone.volto.coresandbox.vocabularies.huge",\n+        ),\n+        required=False,\n+        missing_value=[],\n+        default=[],\n+    )\n+    directives.widget(\n+        "list_field_voc_huge",\n+        frontendOptions={"widget": "autocomplete", "widgetProps": {"prop1": "text"}},\n+    )\n+\n+    tuple_field = schema.Tuple(\n+        title=u"Tuple field",\n+        description=u"zope.schema.Tuple",\n+        value_type=schema.Choice(\n+            values=[u"Beginner", u"Advanced", u"Professional"],\n+        ),\n+        required=False,\n+        missing_value=(),\n+        default=(),\n+    )\n+\n+    set_field = schema.Set(\n+        title=u"Set field",\n+        description=u"zope.schema.Set",\n+        value_type=schema.Choice(\n+            values=[u"Beginner", u"Advanced", u"Professional"],\n+        ),\n+        required=False,\n+        missing_value={},\n+        default=set(),\n+    )\n+\n+    directives.widget(set_field_checkbox=CheckBoxFieldWidget)\n+    set_field_checkbox = schema.Set(\n+        title=u"Set field with checkboxes",\n+        description=u"zope.schema.Set",\n+        value_type=schema.Choice(\n+            values=[u"Beginner", u"Advanced", u"Professional"],\n+        ),\n+        required=False,\n+        missing_value={},\n+        default=set(),\n+    )\n+\n+    # File fields\n+    image_field = NamedBlobImage(\n+        title=u"Image field",\n+        description=u"A upload field for images (plone.namedfile.field.NamedBlobImage)",\n+        required=False,\n+    )\n+\n+    file_field = NamedBlobFile(\n+        title=u"File field",\n+        description=u"A upload field for files (plone.namedfile.field.NamedBlobFile)",\n+        required=False,\n+    )\n+\n+    # Date and Time fields\n+    datetime_field = schema.Datetime(\n+        title=u"Datetime field",\n+        description=u"Uses a date and time picker (zope.schema.Datetime)",\n+        required=False,\n+    )\n+\n+    date_field = schema.Date(\n+        title=u"Date field",\n+        description=u"Uses a date picker (zope.schema.Date)",\n+        required=False,\n+    )\n+\n+    # Not supported by plone.restapi yet\n+    # time_field = schema.Time(\n+    #     title=u"Time field",\n+    #     description=u"zope.schema.Time",\n+    #     required=False,\n+    # )\n+\n+    # Not supported by plone.restapi yet\n+    # timedelta_field = schema.Timedelta(\n+    #     title=u"Timedelta field",\n+    #     description=u"zope.schema.Timedelta",\n+    #     required=False,\n+    # )\n+\n+    # # Relation Fields\n+    relationchoice_field = RelationChoice(\n+        title=u"Relationchoice field",\n+        description=u"z3c.relationfield.schema.RelationChoice",\n+        vocabulary="plone.app.vocabularies.Catalog",\n+        required=False,\n+    )\n+\n+    relationlist_field = RelationList(\n+        title=u"Relationlist Field",\n+        description=u"z3c.relationfield.schema.RelationList",\n+        default=[],\n+        value_type=RelationChoice(vocabulary="plone.app.vocabularies.Catalog"),\n+        required=False,\n+        missing_value=[],\n+    )\n+\n+    relationchoice_field_constrained = RelationChoice(\n+        title=u"Relationchoice field (only allows Documents)",\n+        description=u"z3c.relationfield.schema.RelationChoice",\n+        vocabulary="plone.app.vocabularies.Catalog",\n+        required=False,\n+    )\n+    directives.widget(\n+        "relationchoice_field_constrained",\n+        RelatedItemsFieldWidget,\n+        pattern_options={"selectableTypes": ["Document"]},\n+    )\n+\n+    relationlist_field_constrained = RelationList(\n+        title=u"Relationlist Field (only allows Documents and Events)",\n+        description=u"z3c.relationfield.schema.RelationList",\n+        default=[],\n+        value_type=RelationChoice(vocabulary="plone.app.vocabularies.Catalog"),\n+        required=False,\n+        missing_value=[],\n+    )\n+    directives.widget(\n+        "relationlist_field_constrained",\n+        RelatedItemsFieldWidget,\n+        pattern_options={"selectableTypes": ["Document", "Event"]},\n+    )\n+\n+    relationlist_field_search_mode = RelationList(\n+        title=u"Relationlist Field in Search Mode (constrained to published Documents and Events)",\n+        description=u"z3c.relationfield.schema.RelationList",\n+        default=[],\n+        value_type=RelationChoice(\n+            source=CatalogSource(\n+                portal_type=["Document", "Event"], review_state="published"\n+            )\n+        ),\n+        required=False,\n+        missing_value=[],\n+    )\n+    directives.widget(\n+        "relationlist_field_search_mode",\n+        RelatedItemsFieldWidget,\n+        pattern_options={\n+            "baseCriteria": [  # This is a optimization that limits the catalog-query\n+                {\n+                    "i": "portal_type",\n+                    "o": "plone.app.querystring.operation.selection.any",\n+                    "v": ["Document", "Event"],\n+                },\n+                {\n+                    "i": "review_state",\n+                    "o": "plone.app.querystring.operation.selection.any",\n+                    "v": "published",\n+                },\n+            ],\n+            "mode": "search",\n+        },\n+    )\n+\n+    # From here on we use other widgets than the default RelatedItemsFieldWidget\n+\n+    # This one also works in Volto!\n+    # All other options use the default ObjectWidget in Volto so far.\n+    relationchoice_field_select = RelationChoice(\n+        title=u"RelationChoice with Select Widget",\n+        vocabulary=StaticCatalogVocabulary(\n+            {\n+                "portal_type": ["Document", "Event"],\n+                "review_state": "published",\n+            }\n+        ),\n+        required=False,\n+    )\n+    directives.widget(\n+        "relationchoice_field_select",\n+        SelectFieldWidget,\n+    )\n+\n+    relationchoice_field_radio = RelationChoice(\n+        title=u"RelationChoice with Radio Widget (and customized title-template)",\n+        vocabulary=StaticCatalogVocabulary(\n+            {\n+                "portal_type": ["Document", "Event"],\n+                "review_state": "published",\n+            },\n+            title_template="{brain.Title}",\n+        ),  # Set a custom vocabulary item title\n+        required=False,\n+    )\n+    directives.widget(\n+        "relationchoice_field_radio",\n+        RadioFieldWidget,\n+    )\n+\n+    relationlist_field_select = RelationList(\n+        title=u"RelationList with select widget with items from a named vocabulary",\n+        value_type=RelationChoice(\n+            vocabulary="plone.volto.coresandbox.vocabularies.documents",\n+        ),\n+        required=False,\n+    )\n+    directives.widget(\n+        "relationlist_field_select",\n+        SelectFieldWidget,\n+        pattern_options={\n+            "closeOnSelect": False,  # Select2 option to leave dropdown open for multiple selection\n+        },\n+    )\n+\n+    relationlist_field_checkbox = RelationList(\n+        title=u"RelationList with Checkboxes",\n+        value_type=RelationChoice(\n+            vocabulary="plone.volto.coresandbox.vocabularies.documents",\n+        ),\n+        required=False,\n+    )\n+    directives.widget(\n+        "relationlist_field_checkbox",\n+        CheckBoxFieldWidget,\n+    )\n+\n+    # Not supported by plone.restapi yet\n+    # relationchoice_field_ajax_select = RelationChoice(\n+    #     title=u"Relationchoice Field with AJAXSelect",\n+    #     description=u"z3c.relationfield.schema.RelationChoice",\n+    #     vocabulary=StaticCatalogVocabulary(\n+    #         {\n+    #             "portal_type": ["Document", "Event"],\n+    #         }\n+    #     ),\n+    #     required=False,\n+    # )\n+    # directives.widget(\n+    #     "relationchoice_field_ajax_select",\n+    #     AjaxSelectFieldWidget,\n+    #     vocabulary=StaticCatalogVocabulary(\n+    #         {\n+    #             "portal_type": ["Document", "Event"],\n+    #         }\n+    #     ),\n+    #     pattern_options={  # Options for Select2\n+    #         "minimumInputLength": 2,  # - Don\'t query until at least two characters have been typed\n+    #         "ajax": {"quietMillis": 500},  # - Wait 500ms after typing to make query\n+    #     },\n+    # )\n+\n+    # Not supported by plone.restapi yet\n+    # relationlist_field_ajax_select = RelationList(\n+    #     title=u"Relationlist Field with AJAXSelect",\n+    #     description=u"z3c.relationfield.schema.RelationList",\n+    #     value_type=RelationChoice(\n+    #         vocabulary=StaticCatalogVocabulary(\n+    #             {\n+    #                 "portal_type": ["Document", "Event"],\n+    #                 "review_state": "published",\n+    #             }\n+    #         )\n+    #     ),\n+    #     required=False,\n+    # )\n+    # directives.widget(\n+    #     "relationlist_field_ajax_select",\n+    #     AjaxSelectFieldWidget,\n+    #     vocabulary=StaticCatalogVocabulary(\n+    #         {\n+    #             "portal_type": ["Document", "Event", "Folder"],\n+    #         },\n+    #         title_template="{brain.Type}: {brain.Title} at {path}",\n+    #     ),  # Custom item rendering\n+    #     pattern_options={  # Options for Select2\n+    #         "minimumInputLength": 2,  # - Don\'t query until at least two characters have been typed\n+    #         "ajax": {"quietMillis": 500},  # - Wait 500ms after typing to make query\n+    #     },\n+    # )\n+\n+    # These look like relationsfields (see above) but only store the uuid(s) of the selected target\n+    # as a string in a the field instead of a RelationValue.\n+    # A good way to use these is in combination with a index that allows you to query these connenctions.\n+    uuid_choice_field = schema.Choice(\n+        title=u"Choice field with RelatedItems widget storing uuids",\n+        description=u"schema.Choice",\n+        vocabulary="plone.app.vocabularies.Catalog",\n+        required=False,\n+    )\n+    directives.widget("uuid_choice_field", RelatedItemsFieldWidget)\n+\n+    uuid_list_field = schema.List(\n+        title=u"List Field with RelatedItems widget storing uuids",\n+        description=u"schema.List",\n+        default=[],\n+        value_type=schema.Choice(vocabulary="plone.app.vocabularies.Catalog"),\n+        required=False,\n+        missing_value=[],\n+    )\n+    directives.widget("uuid_list_field", RelatedItemsFieldWidget)\n+\n+    uuid_choice_field_constrained = schema.Choice(\n+        title=u"Choice field with RelatedItems widget storing uuids (only allows Documents)",\n+        description=u"schema.Choice",\n+        vocabulary="plone.app.vocabularies.Catalog",\n+        required=False,\n+    )\n+    directives.widget(\n+        "uuid_choice_field_constrained",\n+        RelatedItemsFieldWidget,\n+        pattern_options={"selectableTypes": ["Document"]},\n+    )\n+\n+    uuid_list_field_constrained = schema.List(\n+        title=u"List Field with RelatedItems widget storing uuids (only allows Documents and Events)",\n+        description=u"schema.List",\n+        default=[],\n+        value_type=schema.Choice(vocabulary="plone.app.vocabularies.Catalog"),\n+        required=False,\n+        missing_value=[],\n+    )\n+    directives.widget(\n+        "uuid_list_field_constrained",\n+        RelatedItemsFieldWidget,\n+        pattern_options={"selectableTypes": ["Document", "Folder"]},\n+    )\n+\n+    uuid_list_field_search_mode = schema.List(\n+        title=u"List Field with RelatedItems widget in Search Mode storing uuids",\n+        description=u"schema.List",\n+        default=[],\n+        value_type=schema.Choice(\n+            source=CatalogSource(\n+                portal_type=["Document", "Event"], review_state="published"\n+            )\n+        ),\n+        required=False,\n+        missing_value=[],\n+    )\n+    directives.widget(\n+        "uuid_list_field_search_mode",\n+        RelatedItemsFieldWidget,\n+        pattern_options={\n+            "selectableTypes": ["Document", "Folder"],\n+            "basePath": "",  # Start the search at the portal root\n+            "mode": "search",\n+        },\n+    )\n+\n+    # From here on we use other widgets than the default RelatedItemsFieldWidget\n+\n+    uuid_choice_field_select = schema.Choice(\n+        title=u"UUID Choice with select widget storing uuids",\n+        vocabulary=StaticCatalogVocabulary(\n+            {\n+                "portal_type": ["Document", "Event"],\n+                "review_state": "published",\n+            }\n+        ),\n+        required=False,\n+    )\n+    directives.widget(\n+        "uuid_choice_field_select",\n+        SelectFieldWidget,\n+    )\n+\n+    uuid_choice_field_radio = schema.Choice(\n+        title=u"RelationChoice with Radio widget storing uuids",\n+        vocabulary=StaticCatalogVocabulary(\n+            {\n+                "portal_type": ["Document", "Event"],\n+                "review_state": "published",\n+            },\n+            title_template="{brain.Title}",\n+        ),  # Set a custom vocabulary item title\n+        required=False,\n+    )\n+    directives.widget(\n+        "uuid_choice_field_radio",\n+        RadioFieldWidget,\n+    )\n+\n+    uuid_list_field_select = schema.List(\n+        title=u"RelationList with select widget with items from a named vocabulary storing uuids",\n+        value_type=schema.Choice(\n+            vocabulary="plone.volto.coresandbox.vocabularies.documents",\n+        ),\n+        required=False,\n+    )\n+    directives.widget(\n+        "uuid_list_field_select",\n+        SelectFieldWidget,\n+        pattern_options={\n+            "closeOnSelect": False,  # Select2 option to leave dropdown open for multiple selection\n+        },\n+    )\n+\n+    uuid_list_field_checkbox = schema.List(\n+        title=u"RelationList with Checkboxes storing uuids",\n+        value_type=schema.Choice(\n+            vocabulary="plone.volto.coresandbox.vocabularies.documents",\n+        ),\n+        required=False,\n+    )\n+    directives.widget(\n+        "uuid_list_field_checkbox",\n+        CheckBoxFieldWidget,\n+    )\n+\n+    # Not supported by plone.restapi yet\n+    # uuid_choice_field_ajax_select = schema.Choice(\n+    #     title=u"Relationchoice Field with AJAXSelect storing uuids",\n+    #     description=u"z3c.relationfield.schema.RelationChoice",\n+    #     vocabulary=StaticCatalogVocabulary(\n+    #         {\n+    #             "portal_type": ["Document", "Event"],\n+    #         }\n+    #     ),\n+    #     required=False,\n+    # )\n+    # directives.widget(\n+    #     "uuid_choice_field_ajax_select",\n+    #     AjaxSelectFieldWidget,\n+    #     vocabulary=StaticCatalogVocabulary(\n+    #         {\n+    #             "portal_type": ["Document", "Event"],\n+    #         }\n+    #     ),\n+    #     pattern_options={  # Options for Select2\n+    #         "minimumInputLength": 2,  # - Don\'t query until at least two characters have been typed\n+    #         "ajax": {"quietMillis": 500},  # - Wait 500ms after typing to make query\n+    #     },\n+    # )\n+\n+    # Not supported by plone.restapi yet\n+    # uuid_list_field_ajax_select = schema.List(\n+    #     title=u"Relationlist Field with AJAXSelect storing uuids",\n+    #     description=u"z3c.relationfield.schema.RelationList",\n+    #     value_type=schema.Choice(\n+    #         vocabulary=StaticCatalogVocabulary(\n+    #             {\n+    #                 "portal_type": ["Document", "Event"],\n+    #                 "review_state": "published",\n+    #             }\n+    #         )\n+    #     ),\n+    #     required=False,\n+    # )\n+    # directives.widget(\n+    #     "uuid_list_field_ajax_select",\n+    #     AjaxSelectFieldWidget,\n+    #     vocabulary=StaticCatalogVocabulary(\n+    #         {\n+    #             "portal_type": ["Document", "Event"],\n+    #         },\n+    #         title_template="{brain.Type}: {brain.Title} at {path}",\n+    #     ),  # Custom item rendering\n+    #     pattern_options={  # Options for Select2\n+    #         "minimumInputLength": 2,  # - Don\'t query until at least two characters have been typed\n+    #         "ajax": {"quietMillis": 500},  # - Wait 500ms after typing to make query\n+    #         "closeOnSelect": False,  # - Leave dropdown open for multiple selection\n+    #     },\n+    # )\n+\n+    # Number fields\n+    int_field = schema.Int(\n+        title=u"Integer Field (e.g. 12)",\n+        description=u"zope.schema.Int",\n+        required=False,\n+    )\n+\n+    float_field = schema.Float(\n+        title=u"Float field, e.g. 12.7",\n+        description=u"zope.schema.Float",\n+        required=False,\n+    )\n+\n+    # Text fields\n+    email_field = Email(\n+        title=u"Email field",\n+        description=u"A simple input field for a email (plone.schema.email.Email)",\n+        required=False,\n+    )\n+\n+    uri_field = schema.URI(\n+        title=u"URI field",\n+        description=u"A simple input field for a URLs (zope.schema.URI)",\n+        required=False,\n+    )\n+\n+    richtext_field = RichText(\n+        title=u"RichText field",\n+        description=u"This uses a richtext editor. (plone.app.textfield.RichText)",\n+        max_length=2000,\n+        required=False,\n+    )\n+\n+    sourcetext_field = schema.SourceText(\n+        title=u"SourceText field",\n+        description=u"zope.schema.SourceText",\n+        required=False,\n+    )\n+\n+    ascii_field = schema.ASCII(\n+        title=u"ASCII field",\n+        description=u"zope.schema.ASCII",\n+        required=False,\n+    )\n+\n+    bytesline_field = schema.BytesLine(\n+        title=u"BytesLine field",\n+        description=u"zope.schema.BytesLine",\n+        required=False,\n+    )\n+\n+    asciiline_field = schema.ASCIILine(\n+        title=u"ASCIILine field",\n+        description=u"zope.schema.ASCIILine",\n+        required=False,\n+    )\n+\n+    pythonidentifier_field = schema.PythonIdentifier(\n+        title=u"PythonIdentifier field",\n+        description=u"zope.schema.PythonIdentifier",\n+        required=False,\n+    )\n+\n+    dottedname_field = schema.DottedName(\n+        title=u"DottedName field",\n+        description=u"zope.schema.DottedName",\n+        required=False,\n+    )\n+\n+    dict_field = schema.Dict(\n+        title=u"Dict field",\n+        description=u"zope.schema.Dict",\n+        required=False,\n+        key_type=schema.TextLine(\n+            title=u"Key",\n+            required=False,\n+        ),\n+        value_type=schema.TextLine(\n+            title=u"Value",\n+            required=False,\n+        ),\n+    )\n+\n+    # Special (control panel) fields\n+    available_languages = schema.List(\n+        title=_(u"heading_available_languages", default=u"Available languages"),\n+        description=_(\n+            u"description_available_languages",\n+            default=u"The languages in which the site should be " u"translatable.",\n+        ),\n+        required=True,\n+        default=["en"],\n+        missing_value=[],\n+        value_type=schema.Choice(\n+            vocabulary="plone.app.vocabularies.AvailableContentLanguages"\n+        ),\n+    )\n+\n+    # vocabularyterms_field = Dict(  # we use the plone.schema field Dict not zope.schema field to use the attribute \'widget\'\n+    #     title=u"Vocabulary terms field",\n+    #     description=u"plone.schema.Dict field with value_type schema.TextLine and frontend widget \'VocabularyTermsWidget\'",\n+    #     required=False,\n+    #     key_type=schema.TextLine(\n+    #         title=u"Key",\n+    #         required=False,\n+    #     ),\n+    #     value_type=schema.TextLine(\n+    #         title=u"Value",\n+    #         required=False,\n+    #     ),\n+    #     widget="vocabularyterms",  # we use the widget attribute to apply the frontend widget VocabularyWidget\n+    # )\n+\n+    # vocabularytermstranslation_field = Dict(  # we use the plone.schema field Dict not zope.schema field to use the attribute \'widget\'\n+    #     title=u"Vocabulary terms field with translations",\n+    #     description=u"plone.schema.Dict field with value_type Dict and frontend widget \'VocabularyTermsWidget\'",\n+    #     required=False,\n+    #     key_type=schema.TextLine(\n+    #         title=u"Key",\n+    #         required=False,\n+    #     ),\n+    #     value_type=Dict(  # we use the plone.schema field Dict not zope.schema field to use the attribute \'widget\'\n+    #         title=u"Term translation",\n+    #         description=u"plone.schema.Dict field for translations of vocabulary term",\n+    #         required=True,\n+    #         key_type=schema.TextLine(\n+    #             title=u"Key",\n+    #             required=False,\n+    #         ),\n+    #         value_type=schema.TextLine(\n+    #             title=u"Value",\n+    #             required=False,\n+    #         ),\n+    #     ),\n+    #     widget="vocabularyterms",  # we use the widget attribute to apply the frontend widget VocabularyWidget\n+    # )\n+\n+    dict_field_with_choice = schema.Dict(\n+        title=u"Dict field with key and value as choice",\n+        description=u"zope.schema.Dict",\n+        required=False,\n+        key_type=schema.Choice(\n+            title=u"Key",\n+            values=[u"One", u"Two", u"Three"],\n+            required=False,\n+        ),\n+        value_type=schema.Set(\n+            title=u"Value",\n+            value_type=schema.Choice(\n+                values=[u"Beginner", u"Advanced", u"Professional"],\n+            ),\n+            required=False,\n+            missing_value={},\n+        ),\n+    )\n+\n+\n+@implementer(IExample)\n+class Example(Container):\n+    """Example instance class"""\ndiff --git a/src/plone/volto/coresandbox/vocabularies.py b/src/plone/volto/coresandbox/vocabularies.py\nnew file mode 100644\nindex 0000000..bf79e5e\n--- /dev/null\n+++ b/src/plone/volto/coresandbox/vocabularies.py\n@@ -0,0 +1,25 @@\n+from plone.app.vocabularies.catalog import StaticCatalogVocabulary\n+from zope.interface import provider\n+from zope.schema.interfaces import IVocabularyFactory\n+from zope.schema.vocabulary import SimpleVocabulary\n+\n+\n+@provider(IVocabularyFactory)\n+def DocumentVocabularyFactory(context=None):\n+    return StaticCatalogVocabulary(\n+        {\n+            "portal_type": ["Document", "News Item"],\n+            "sort_on": "sortable_title",\n+        }\n+    )\n+\n+\n+@provider(IVocabularyFactory)\n+def HugeVocabularyFactory(context=None):\n+    terms = []\n+    for a in range(1000):\n+        terms.append(\n+            SimpleVocabulary.createTerm(f"option{a}", f"option{a}", f"Option {a}")\n+        )\n+\n+    return SimpleVocabulary(sorted(terms, key=lambda term: term.title))\ndiff --git a/src/plone/volto/profiles/coresandbox/diff_tool.xml b/src/plone/volto/profiles/coresandbox/diff_tool.xml\nnew file mode 100644\nindex 0000000..fd83ec9\n--- /dev/null\n+++ b/src/plone/volto/profiles/coresandbox/diff_tool.xml\n@@ -0,0 +1,8 @@\n+<?xml version="1.0"?>\n+<object>\n+  <difftypes>\n+    <type portal_type="example">\n+      <field name="any" difftype="Compound Diff for Dexterity types"/>\n+    </type>\n+  </difftypes>\n+</object>\n\\ No newline at end of file\ndiff --git a/src/plone/volto/profiles/coresandbox/metadata.xml b/src/plone/volto/profiles/coresandbox/metadata.xml\nnew file mode 100644\nindex 0000000..cae22a3\n--- /dev/null\n+++ b/src/plone/volto/profiles/coresandbox/metadata.xml\n@@ -0,0 +1,6 @@\n+<metadata>\n+ <version>1000</version>\n+ <dependencies>\n+   <dependency>profile-plone.volto:default</dependency>\n+ </dependencies>\n+</metadata>\ndiff --git a/src/plone/volto/profiles/coresandbox/repositorytool.xml b/src/plone/volto/profiles/coresandbox/repositorytool.xml\nnew file mode 100644\nindex 0000000..5889d93\n--- /dev/null\n+++ b/src/plone/volto/profiles/coresandbox/repositorytool.xml\n@@ -0,0 +1,10 @@\n+<?xml version="1.0"?>\n+<repositorytool>\n+  <policymap>\n+    <type name="example">\n+      <policy name="at_edit_autoversion"/>\n+      <policy name="version_on_revert"/>\n+    </type>\n+  </policymap>\n+</repositorytool>\n+\ndiff --git a/src/plone/volto/profiles/coresandbox/types.xml b/src/plone/volto/profiles/coresandbox/types.xml\nnew file mode 100644\nindex 0000000..d7f2fba\n--- /dev/null\n+++ b/src/plone/volto/profiles/coresandbox/types.xml\n@@ -0,0 +1,4 @@\n+<?xml version="1.0"?>\n+<object name="portal_types" meta_type="Plone Types Tool">\n+ <object name="example" meta_type="Dexterity FTI"/>\n+</object>\ndiff --git a/src/plone/volto/profiles/coresandbox/types/example.xml b/src/plone/volto/profiles/coresandbox/types/example.xml\nnew file mode 100644\nindex 0000000..630ea2b\n--- /dev/null\n+++ b/src/plone/volto/profiles/coresandbox/types/example.xml\n@@ -0,0 +1,49 @@\n+<?xml version="1.0"?>\n+<object name="example" meta_type="Dexterity FTI" i18n:domain="plone"\n+   xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n+ <property name="title" i18n:translate="">Example</property>\n+ <property name="description" i18n:translate=""></property>\n+ <property name="icon_expr"></property>\n+ <property name="factory">example</property>\n+ <property name="add_view_expr">string:${folder_url}/++add++example</property>\n+ <property name="link_target"></property>\n+ <property name="immediate_view">view</property>\n+ <property name="global_allow">True</property>\n+ <property name="filter_content_types">False</property>\n+ <property name="allowed_content_types" />\n+ <property name="allow_discussion">False</property>\n+ <property name="default_view">view</property>\n+ <property name="view_methods">\n+  <element value="view"/>\n+ </property>\n+ <property name="default_view_fallback">False</property>\n+ <property name="add_permission">cmf.AddPortalContent</property>\n+ <property name="klass">plone.volto.coresandbox.example.Example</property>\n+ <property name="schema">plone.volto.coresandbox.example.IExample</property>\n+ <property name="behaviors">\n+  <element value="plone.namefromtitle" />\n+  <element value="plone.allowdiscussion" />\n+  <element value="plone.excludefromnavigation" />\n+  <element value="plone.shortname" />\n+  <element value="plone.versioning" />\n+  <element value="plone.tableofcontents" />\n+  <element value="plone.locking" />\n+ </property>\n+ <property name="model_source"></property>\n+ <property name="model_file"></property>\n+ <property name="schema_policy">dexterity</property>\n+ <alias from="(Default)" to="(dynamic view)"/>\n+ <alias from="edit" to="@@edit"/>\n+ <alias from="sharing" to="@@sharing"/>\n+ <alias from="view" to="(selected layout)"/>\n+ <action title="View" action_id="view" category="object" condition_expr=""\n+    description="" icon_expr="" link_target="" url_expr="string:${object_url}"\n+    visible="True">\n+  <permission value="View"/>\n+ </action>\n+ <action title="Edit" action_id="edit" category="object" condition_expr=""\n+    description="" icon_expr="" link_target=""\n+    url_expr="string:${object_url}/edit" visible="True">\n+  <permission value="Modify portal content"/>\n+ </action>\n+</object>\ndiff --git a/src/plone/volto/setuphandlers.py b/src/plone/volto/setuphandlers.py\nindex c5f5d9a..8568fee 100644\n--- a/src/plone/volto/setuphandlers.py\n+++ b/src/plone/volto/setuphandlers.py\n@@ -42,6 +42,10 @@ def uninstall(context):\n     # Do something at the end of the uninstallation of this package.\n \n \n+def post_install_coresandbox(context):\n+    """Post install script for multilingual fixture"""\n+\n+\n def post_install_multilingual(context):\n     """Post install script for multilingual fixture"""\n     enable_pam(context)\ndiff --git a/src/plone/volto/testing.py b/src/plone/volto/testing.py\nindex ac84d62..8565585 100644\n--- a/src/plone/volto/testing.py\n+++ b/src/plone/volto/testing.py\n@@ -14,6 +14,7 @@\n from plone.testing import z2\n \n import plone.volto\n+import plone.volto.coresandbox\n \n \n class PloneVoltoCoreLayer(PloneSandboxLayer):\n@@ -54,3 +55,49 @@ def setUpPloneSite(self, portal):\n     bases=(PLONE_VOLTO_CORE_FIXTURE, REMOTE_LIBRARY_BUNDLE_FIXTURE, z2.ZSERVER_FIXTURE),\n     name="PloneVoltoCoreLayer:AcceptanceTesting",\n )\n+\n+\n+class PloneVoltoCoreSandboxLayer(PloneSandboxLayer):\n+\n+    defaultBases = (PLONE_APP_CONTENTTYPES_FIXTURE,)\n+\n+    def setUpZope(self, app, configurationContext):\n+        # Load any other ZCML that is required for your tests.\n+        # The z3c.autoinclude feature is disabled in the Plone fixture base\n+        # layer.\n+        self.loadZCML(package=plone.volto)\n+        self.loadZCML(package=plone.volto.coresandbox)\n+\n+    def setUpPloneSite(self, portal):\n+        setRoles(portal, TEST_USER_ID, ["Manager"])\n+        login(portal, TEST_USER_NAME)\n+        api.content.create(\n+            type="Document", id="front-page", title="Welcome", container=portal\n+        )\n+        logout()\n+        applyProfile(portal, "plone.volto:coresandbox")\n+\n+\n+PLONE_VOLTO_CORESANDBOX_FIXTURE = PloneVoltoCoreSandboxLayer()\n+\n+\n+PLONE_VOLTO_CORESANDBOX_INTEGRATION_TESTING = IntegrationTesting(\n+    bases=(PLONE_VOLTO_CORESANDBOX_FIXTURE,),\n+    name="PloneVoltoCoreSandboxLayer:IntegrationTesting",\n+)\n+\n+\n+PLONE_VOLTO_CORESANDBOX_FUNCTIONAL_TESTING = FunctionalTesting(\n+    bases=(PLONE_VOLTO_CORESANDBOX_FIXTURE, z2.ZSERVER_FIXTURE),\n+    name="PloneVoltoCoreSandboxLayer:FunctionalTesting",\n+)\n+\n+\n+PLONE_VOLTO_CORESANDBOX_ACCEPTANCE_TESTING = FunctionalTesting(\n+    bases=(\n+        PLONE_VOLTO_CORESANDBOX_FIXTURE,\n+        REMOTE_LIBRARY_BUNDLE_FIXTURE,\n+        z2.ZSERVER_FIXTURE,\n+    ),\n+    name="PloneVoltoCoreSandboxLayer:AcceptanceTesting",\n+)\ndiff --git a/src/plone/volto/tests/test_coresandbox.py b/src/plone/volto/tests/test_coresandbox.py\nnew file mode 100644\nindex 0000000..2dd4143\n--- /dev/null\n+++ b/src/plone/volto/tests/test_coresandbox.py\n@@ -0,0 +1,37 @@\n+# -*- coding: utf-8 -*-\n+from plone.volto.testing import PLONE_VOLTO_CORESANDBOX_FUNCTIONAL_TESTING\n+\n+# from plone import api\n+from plone.app.testing import setRoles\n+from plone.app.testing import SITE_OWNER_NAME\n+from plone.app.testing import SITE_OWNER_PASSWORD\n+from plone.app.testing import TEST_USER_ID\n+from plone.restapi.testing import RelativeSession\n+\n+# import transaction\n+import unittest\n+\n+\n+class TestCoresandbox(unittest.TestCase):\n+\n+    layer = PLONE_VOLTO_CORESANDBOX_FUNCTIONAL_TESTING\n+\n+    def setUp(self):\n+        self.app = self.layer["app"]\n+        self.portal = self.layer["portal"]\n+        self.portal_url = self.portal.absolute_url()\n+        setRoles(self.portal, TEST_USER_ID, ["Manager"])\n+\n+        self.api_session = RelativeSession(self.portal_url)\n+        self.api_session.headers.update({"Accept": "application/json"})\n+        self.api_session.auth = (SITE_OWNER_NAME, SITE_OWNER_PASSWORD)\n+\n+        # transaction.commit()\n+\n+    def tearDown(self):\n+        self.api_session.close()\n+\n+    def test_coresandbox_example_content_schema_endpoint(self):\n+        response = self.api_session.get("/@types/example")\n+\n+        self.assertEqual(response.status_code, 200)\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2022-01-20T11:24:56+01:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/b14e102485281ffb97679694b80db4fb52becbdc

Merge branch 'main' into event_newsitem_blocks

* main: (22 commits)
  Remove c.folderishtypes dependency. (#36)
  Fix test for Plone 5
  Programatically setup Plone site FTI
  Code cleanup, add 'volto.blocks' behavior to Plone Site GS types info. Remove 'Collection' from types in GS. Remove 'plone.richtext' behavior from Plone Site, Document, News Item, Events.
  Make zprettier happy
  Changelog
  Organize the data for the default roots on its own folder
  Demo page for Plone 6 updated to slate
  Documentation about default-homepage-drafjs profile
  Add LFR default content
  Slate by default in main DX root.
  Add mr.developer
  DraftJS part implemented
  Back to development: 3.1.0a10
  Preparing release 3.1.0a9
  Prepare changelog
  New field with huge vocabulary defined in the widget options (#38)
  Back to development: 3.1.0a9
  Preparing release 3.1.0a8
  Fix computed dates in content for demo pages
  ...

Files changed:
A src/plone/volto/content.py
A src/plone/volto/default_homepage/__init__.py
A src/plone/volto/default_homepage/default.py
A src/plone/volto/default_homepage/demo.py
A src/plone/volto/default_homepage/lrf.py
A src/plone/volto/locales/es/LC_MESSAGES/plone.volto.po
A src/plone/volto/locales/eu/LC_MESSAGES/plone.volto.po
A src/plone/volto/profiles.zcml
A src/plone/volto/profiles/default/types/Collection.xml
M .gitignore
M CHANGES.rst
M README.rst
M base.cfg
M setup.py
M src/plone/volto/configure.zcml
M src/plone/volto/coresandbox/example.py
M src/plone/volto/dependencies.zcml
M src/plone/volto/interfaces.py
M src/plone/volto/patches.py
M src/plone/volto/profiles/default/metadata.xml
M src/plone/volto/profiles/default/types.xml
M src/plone/volto/profiles/default/types/Document.xml
M src/plone/volto/profiles/default/types/Event.xml
M src/plone/volto/profiles/default/types/News_Item.xml
M src/plone/volto/setuphandlers.py
M src/plone/volto/tests/test_setup.py
M src/plone/volto/upgrades.py
M src/plone/volto/upgrades.zcml
M src/plone/volto/vocabularies/subject.py
D src/plone/volto/profiles/default/types/Plone_Site.xml

b'diff --git a/.gitignore b/.gitignore\nindex 35c8189..84b425a 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -35,3 +35,4 @@ report.html\n !.gitkeep\n !.travis.yml\n pyvenv.cfg\n+extras\ndiff --git a/CHANGES.rst b/CHANGES.rst\nindex c046eb7..e6531b0 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -1,16 +1,49 @@\n Changelog\n =========\n \n-3.1.0a8 (unreleased)\n---------------------\n+3.1.0a10 (unreleased)\n+---------------------\n+\n+- Use by default Slate blocks for the default pages\n+  [sneridagh]\n \n-New feature:\n+- Code cleanup, remove some outdated and unused helpers in ``setuptools.py``\n+  [sneridagh]\n+\n+- Add ``volto.blocks`` behavior to Plone Site GS types info.\n+  [sneridagh]\n+\n+- Remove ``Collection`` from types in GS types info.\n+  [sneridagh]\n+\n+- Remove ``plone.richtext`` behavior from Plone Site, Document, News Item, Events\n+  [sneridagh]\n \n - Add blocks behavior on Event and NewsItem\n   [nzambello]\n+\n - Add preview_image to Event\n   [nzambello]\n \n+3.1.0a9 (2022-01-15)\n+--------------------\n+\n+Breaking:\n+\n+- Remove c.folderishtypes dependency\n+\n+New Feature:\n+\n+- Add new field in the coresandbox: not constrained by vocabulary field but the vocabulary defined in the widget.\n+  [sneridagh]\n+\n+\n+3.1.0a8 (2022-01-12)\n+--------------------\n+\n+- Computed copyright dates for content demo pages\n+  [sneridagh]\n+\n \n 3.1.0a7 (2021-12-11)\n --------------------\n@@ -31,6 +64,9 @@ Internal:\n \n New Feature:\n \n+- Add Basque and Spanish translations\n+  [erral]\n+\n - Add Italian translations\n   [cekk]\n \ndiff --git a/README.rst b/README.rst\nindex d263e7f..0b995d0 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -20,7 +20,7 @@ Install plone.volto by adding it to your buildout::\n \n     [buildout]\n     ...\n-    \n+\n     [instance]\n     ...\n \n@@ -95,7 +95,7 @@ plone.volto enables the new Volto Blocks editor on ``Document``, ``Language Root\n Multilingual Support\n --------------------\n \n-plone.volto supports multilingual websites. \n+plone.volto supports multilingual websites.\n Install PAM before installing this package and demo homepages will be created in each enabled language.\n Currently only support for EN/DE.\n \n@@ -103,7 +103,7 @@ Currently only support for EN/DE.\n Volto Blocks for Plone Site Root\n --------------------------------\n \n-plone.volto contains a hack to make the Plone site Volto blocks-enabled with some demo content. \n+plone.volto contains a hack to make the Plone site Volto blocks-enabled with some demo content.\n You can take only the hack to enable the blocks on your site.\n \n You can see it in action in the Volto demo: https://6.demo.plone.org\n@@ -121,6 +121,10 @@ e.g. in your GS ``metadata.xml`` along with your other dependencies::\n   </dependencies>\n   </metadata>\n \n+**NOTE**: From ``plone.volto`` above version 4.0.0, the default block for creating the\n+default content in the root (or corresponding Language Root Folders) is "slate". If you\n+want still to create draftJS blocks, you need to use the ``default-homepage-drafjs`` profile.\n+\n \n Document Content Type\n ---------------------\ndiff --git a/base.cfg b/base.cfg\nindex 9c13caf..8482906 100644\n--- a/base.cfg\n+++ b/base.cfg\n@@ -7,9 +7,18 @@ parts =\n     dependencies\n     zpretty\n     test\n+    omelette\n     update-translations\n     find-untranslated\n develop = .\n+sources-dir = extras\n+\n+extensions = mr.developer\n+auto-checkout =\n+always-checkout = force\n+\n+[sources]\n+plone.restapi = git git://github.com/plone/plone.restapi.git pushurl=git@github.com:plone/plone.restapi.git branch=master\n \n [instance]\n recipe = plone.recipe.zope2instance\n@@ -46,6 +55,10 @@ upgrade-portal = False\n upgrade-all-profiles = False\n site-replace = True\n \n+[omelette]\n+recipe = collective.recipe.omelette\n+eggs = ${instance:eggs}\n+\n [test]\n recipe = collective.xmltestreport\n eggs = ${instance:eggs}\n@@ -114,4 +127,4 @@ input = inline:\n     #!/bin/sh\n     bin/i18ndude find-untranslated `find -L src/plone/volto -regex ".*\\.[cz]?pt"`\n output = ${buildout:directory}/bin/find-untranslated\n-mode = 755\n\\ No newline at end of file\n+mode = 755\ndiff --git a/setup.py b/setup.py\nindex bb0f1aa..942ff00 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -24,7 +24,7 @@ def readfile(name):\n \n setup(\n     name="plone.volto",\n-    version="3.1.0a8.dev0",\n+    version="3.1.0a10.dev0",\n     description="Volto integration add-on for Plone",\n     long_description=long_description,\n     # Get more from https://pypi.org/classifiers/\n@@ -57,7 +57,6 @@ def readfile(name):\n         "Products.GenericSetup",\n         "setuptools",\n         "plone.restapi>=8.13.0",\n-        "collective.folderishtypes[dexterity]",\n         "plone.app.vocabularies>=4.3.0",\n     ],\n     extras_require={\ndiff --git a/src/plone/volto/configure.zcml b/src/plone/volto/configure.zcml\nindex 41793a9..b2d065f 100644\n--- a/src/plone/volto/configure.zcml\n+++ b/src/plone/volto/configure.zcml\n@@ -16,10 +16,10 @@\n   <include package=".behaviors" />\n   <include package=".browser" />\n \n+  <include file="profiles.zcml" />\n   <include file="patches.zcml" />\n   <include file="upgrades.zcml" />\n \n-\n   <browser:page\n       name="blocksuuidfixer"\n       for="Products.CMFPlone.interfaces.IPloneSiteRoot"\n@@ -27,75 +27,6 @@\n       permission="cmf.ManagePortal"\n       />\n \n-  <genericsetup:registerProfile\n-      name="default"\n-      title="Plone 6 Frontend (plone.volto)"\n-      description="Configures the Plone backend to work with Volto, the new default frontend for Plone 6."\n-      provides="Products.GenericSetup.interfaces.EXTENSION"\n-      directory="profiles/default"\n-      post_handler=".setuphandlers.post_install"\n-      />\n-\n-  <genericsetup:registerProfile\n-      name="uninstall"\n-      title="Plone 6 Frontend (plone.volto): uninstall"\n-      description="Uninstalls the plone.volto add-on."\n-      provides="Products.GenericSetup.interfaces.EXTENSION"\n-      directory="profiles/uninstall"\n-      post_handler=".setuphandlers.uninstall"\n-      />\n-\n-  <genericsetup:registerProfile\n-      name="default-homepage"\n-      title="Plone 6 Frontend (Default content on homepage)"\n-      description="Creates a default page for the site"\n-      provides="Products.GenericSetup.interfaces.EXTENSION"\n-      directory="profiles/homepage"\n-      post_handler=".setuphandlers.create_default_homepage"\n-      />\n-\n-  <genericsetup:registerProfile\n-      name="demo"\n-      title="plone.volto demo special requirements"\n-      description="Special requirements and setup for demo site"\n-      provides="Products.GenericSetup.interfaces.EXTENSION"\n-      directory="profiles/demo"\n-      post_handler=".setuphandlers.create_demo_homepage"\n-      />\n-\n-  <!-- Fixture for coresandbox Cypress tests in Volto repo -->\n-  <genericsetup:registerProfile\n-      name="coresandbox"\n-      title="plone.volto coresandbox Cypress tests fixtures"\n-      description="Special test fixture for coresandbox use cases"\n-      provides="Products.GenericSetup.interfaces.EXTENSION"\n-      directory="profiles/coresandbox"\n-      post_handler=".setuphandlers.post_install_coresandbox"\n-      />\n-\n-  <!-- Fixture for multilingual Cypress tests in Volto repo -->\n-  <genericsetup:registerProfile\n-      name="multilingual"\n-      title="plone.volto multilingual Cypress tests fixtures"\n-      description="Special test fixture for multilingual use case"\n-      provides="Products.GenericSetup.interfaces.EXTENSION"\n-      directory="profiles/multilingual"\n-      post_handler=".setuphandlers.post_install_multilingual"\n-      />\n-\n-  <genericsetup:registerProfile\n-      name="richtext"\n-      title="plone.volto p51 profile"\n-      description="Specific profile for re-adding the richtext behavior"\n-      provides="Products.GenericSetup.interfaces.EXTENSION"\n-      directory="profiles/richtext"\n-      />\n-\n-  <utility\n-      factory=".setuphandlers.HiddenProfiles"\n-      name="plone.volto-hiddenprofiles"\n-      />\n-\n   <browser:page\n       name="volto_settings"\n       for="Products.CMFPlone.interfaces.IPloneSiteRoot"\ndiff --git a/src/plone/volto/content.py b/src/plone/volto/content.py\nnew file mode 100644\nindex 0000000..2e67e18\n--- /dev/null\n+++ b/src/plone/volto/content.py\n@@ -0,0 +1,24 @@\n+# -*- coding: utf-8 -*-\n+from plone.volto.interfaces import IFolderishDocument\n+from plone.volto.interfaces import IFolderishEvent\n+from plone.volto.interfaces import IFolderishNewsItem\n+from plone.app.contenttypes.interfaces import IDocument\n+from plone.app.contenttypes.interfaces import IEvent\n+from plone.app.contenttypes.interfaces import INewsItem\n+from plone.dexterity.content import Container\n+from zope.interface import implementer\n+\n+\n+@implementer(IDocument, IFolderishDocument)\n+class FolderishDocument(Container):\n+    pass\n+\n+\n+@implementer(IEvent, IFolderishEvent)\n+class FolderishEvent(Container):\n+    pass\n+\n+\n+@implementer(INewsItem, IFolderishNewsItem)\n+class FolderishNewsItem(Container):\n+    pass\ndiff --git a/src/plone/volto/coresandbox/example.py b/src/plone/volto/coresandbox/example.py\nindex ff94c0f..33a0d9e 100644\n--- a/src/plone/volto/coresandbox/example.py\n+++ b/src/plone/volto/coresandbox/example.py\n@@ -68,6 +68,7 @@ class IExample(model.Schema):\n             "list_field_select",\n             "list_field_voc_unconstrained",\n             "list_field_voc_huge",\n+            "list_field_voc_huge_unconstrained",\n             "tuple_field",\n             "set_field",\n             "set_field_checkbox",\n@@ -261,6 +262,20 @@ class IExample(model.Schema):\n         frontendOptions={"widget": "autocomplete", "widgetProps": {"prop1": "text"}},\n     )\n \n+    list_field_voc_huge_unconstrained = schema.List(\n+        title=u"List field with values from a huge vocabulary but unconstrained",\n+        description=u"zope.schema.List",\n+        value_type=schema.TextLine(),\n+        required=False,\n+        missing_value=[],\n+        default=[],\n+    )\n+    directives.widget(\n+        "list_field_voc_huge_unconstrained",\n+        vocabulary="plone.volto.coresandbox.vocabularies.huge",\n+        frontendOptions={"widget": "autocomplete", "widgetProps": {"prop1": "text"}},\n+    )\n+\n     tuple_field = schema.Tuple(\n         title=u"Tuple field",\n         description=u"zope.schema.Tuple",\ndiff --git a/src/plone/volto/default_homepage/__init__.py b/src/plone/volto/default_homepage/__init__.py\nnew file mode 100644\nindex 0000000..e69de29\ndiff --git a/src/plone/volto/default_homepage/default.py b/src/plone/volto/default_homepage/default.py\nnew file mode 100644\nindex 0000000..dba86e9\n--- /dev/null\n+++ b/src/plone/volto/default_homepage/default.py\n@@ -0,0 +1,484 @@\n+from datetime import datetime\n+\n+default_home = {\n+    "draftJS": {\n+        "title": "Welcome to Volto!",\n+        "description": "The React powered content management system",\n+        "blocks": {\n+            "0358abe2-b4f1-463d-a279-a63ea80daf19": {"@type": "description"},\n+            "07c273fc-8bfc-4e7d-a327-d513e5a945bb": {"@type": "title"},\n+            "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 10, "offset": 0, "style": "BOLD"}\n+                            ],\n+                            "key": "6470b",\n+                            "text": "Disclaimer: This instance is reset every night, so all changes will be lost afterwards.",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "3c881f51-f75b-4959-834a-6e1d5edc32ae": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 5, "offset": 6, "style": "BOLD"}\n+                            ],\n+                            "key": "ekn3l",\n+                            "text": "user: admin",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [\n+                                {"key": 0, "length": 5, "offset": 0},\n+                                {"key": 1, "length": 8, "offset": 455},\n+                            ],\n+                            "inlineStyleRanges": [],\n+                            "key": "behki",\n+                            "text": "Plone is a CMS built on Python with over 19 years of experience. Plone has very interesting features that appeal to developers and users alike, such as customizable content types, hierarchical URL object traversing and a sophisticated content workflow powered by a granular permissions model. This allows you to build anything from simple websites to enterprise-grade intranets. Volto exposes all these features and communicates with Plone via its mature REST API. Volto can be esily themed and is highly customizable.",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {\n+                        "0": {\n+                            "data": {\n+                                "href": "https://plone.org",\n+                                "rel": "nofollow",\n+                                "url": "https://plone.org/",\n+                            },\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        },\n+                        "1": {\n+                            "data": {\n+                                "href": "https://github.com/plone/plone.restapi",\n+                                "url": "https://github.com/plone/plone.restapi",\n+                            },\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        },\n+                    },\n+                },\n+            },\n+            "61cc1bc0-d4f5-4e2b-9152-79512045a4dd": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "9qsa4",\n+                            "text": "Demo",\n+                            "type": "header-two",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "874049e7-629e-489a-b46c-1adf35ad40ee": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "9pnjr",\n+                            "text": "Happy hacking!",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "942b6530-2407-420f-9c24-597adda6b2ce": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [{"key": 0, "length": 36, "offset": 39}],\n+                            "inlineStyleRanges": [],\n+                            "key": "6a248",\n+                            "text": "Last but not least, it also supports a Volto Nodejs-based backend reference API implementation that demos how other systems could also use Volto to display and create content through it.",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {\n+                        "0": {\n+                            "data": {\n+                                "href": "https://github.com/plone/volto-reference-backend",\n+                                "url": "https://github.com/plone/volto-reference-backend",\n+                            },\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        }\n+                    },\n+                },\n+            },\n+            "9a976b8e-72ba-468a-bea8-b37a31bb386b": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 12, "offset": 51, "style": "BOLD"}\n+                            ],\n+                            "key": "94arl",\n+                            "text": "You can log in and use it as admin user using these credentials:",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "b3717238-448f-406e-b06f-57a9715c3326": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [{"key": 0, "length": 5, "offset": 0}],\n+                            "inlineStyleRanges": [],\n+                            "key": "1bnna",\n+                            "text": "Volto is a React-based frontend for content management systems, currently supporting three backend implementations: Plone, Guillotina and a NodeJS reference implementation.",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {\n+                        "0": {\n+                            "data": {\n+                                "href": "https://github.com/plone/volto",\n+                                "url": "https://github.com/plone/volto",\n+                            },\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        }\n+                    },\n+                },\n+            },\n+            "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "55n44",\n+                            "text": "You can use this site to test Volto. It runs on the master branch of Volto using latest Plone 5.2 Backend running on Python 3.",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 5, "offset": 10, "style": "BOLD"}\n+                            ],\n+                            "key": "buncq",\n+                            "text": "password: admin",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "f0prj",\n+                            "text": f"{datetime.now().year} - Volto Team - Plone Foundation",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "effbdcdc-253c-41a7-841e-5edb3b56ce32": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [{"key": 0, "length": 10, "offset": 36}],\n+                            "inlineStyleRanges": [],\n+                            "key": "68rve",\n+                            "text": "Volto also supports other APIs like Guillotina, a Python resource management system, inspired by Plone and using the same basic concepts like traversal, content types and permissions model.",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {\n+                        "0": {\n+                            "data": {\n+                                "href": "https://guillotina.io/",\n+                                "rel": "nofollow",\n+                                "url": "https://guillotina.io/",\n+                            },\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        }\n+                    },\n+                },\n+            },\n+        },\n+        "blocks_layout": {\n+            "items": [\n+                "07c273fc-8bfc-4e7d-a327-d513e5a945bb",\n+                "0358abe2-b4f1-463d-a279-a63ea80daf19",\n+                "b3717238-448f-406e-b06f-57a9715c3326",\n+                "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4",\n+                "effbdcdc-253c-41a7-841e-5edb3b56ce32",\n+                "942b6530-2407-420f-9c24-597adda6b2ce",\n+                "61cc1bc0-d4f5-4e2b-9152-79512045a4dd",\n+                "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28",\n+                "9a976b8e-72ba-468a-bea8-b37a31bb386b",\n+                "3c881f51-f75b-4959-834a-6e1d5edc32ae",\n+                "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c",\n+                "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226",\n+                "874049e7-629e-489a-b46c-1adf35ad40ee",\n+                "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6",\n+            ]\n+        },\n+    },\n+    "slate": {\n+        "title": "Welcome to Volto!",\n+        "description": "The React powered content management system",\n+        "blocks": {\n+            "0358abe2-b4f1-463d-a279-a63ea80daf19": {"@type": "description"},\n+            "07c273fc-8bfc-4e7d-a327-d513e5a945bb": {"@type": "title"},\n+            "16f63011-a6ec-4f1c-8f78-4c5166dfff2c": {\n+                "@type": "slate",\n+                "plaintext": "You can log in and use it as admin user using these credentials :",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {\n+                                "text": "You can log in and use it as admin user using these "\n+                            },\n+                            {"children": [{"text": "credentials"}], "type": "strong"},\n+                            {"text": ":"},\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "237b0f68-d700-47ec-9356-77a54c8d5237": {\n+                "@type": "slate",\n+                "plaintext": "Demo",\n+                "value": [{"children": [{"text": "Demo"}], "type": "h2"}],\n+            },\n+            "259ad2e9-a5f7-4e0c-a37b-b8d3a9da1a0d": {\n+                "@type": "slate",\n+                "plaintext": "password: admin ",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {"text": "password: "},\n+                            {"children": [{"text": "admin"}], "type": "strong"},\n+                            {"text": ""},\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "26d7d965-80f3-4312-9dc6-5166d00260a5": {\n+                "@type": "slate",\n+                "plaintext": "user: admin ",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {"text": "user: "},\n+                            {"children": [{"text": "admin"}], "type": "strong"},\n+                            {"text": ""},\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "38ff6b46-4cbd-4933-a462-251c3e963b7a": {\n+                "@type": "slate",\n+                "plaintext": " Plone is a CMS built on Python with over 21 years of experience. Plone has very interesting features that appeal to developers and users alike, such as customizable content types, hierarchical URL object traversing and a sophisticated content workflow powered by a granular permissions model. This allows you to build anything from simple websites to enterprise-grade intranets. Volto exposes all these features and communicates with Plone via its mature REST API . Volto can be esily themed and is highly customizable.",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {"text": ""},\n+                            {\n+                                "children": [{"text": "Plone"}],\n+                                "data": {"url": "https://plone.org/"},\n+                                "type": "link",\n+                            },\n+                            {\n+                                "text": " is a CMS built on Python with over 21 years of experience. Plone has very interesting features that appeal to developers and users alike, such as customizable content types, hierarchical URL object traversing and a sophisticated content workflow powered by a granular permissions model. This allows you to build anything from simple websites to enterprise-grade intranets. Volto exposes all these features and communicates with Plone via its mature "\n+                            },\n+                            {\n+                                "children": [{"text": "REST API"}],\n+                                "data": {\n+                                    "url": "https://github.com/plone/plone.restapi"\n+                                },\n+                                "type": "link",\n+                            },\n+                            {\n+                                "text": ". Volto can be esily themed and is highly customizable."\n+                            },\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "58cb10e2-49a5-4a87-9f5b-479c34bc5d36": {\n+                "@type": "slate",\n+                "plaintext": "You can use this site to test Volto. It runs on the master branch of Volto using latest Plone 5.2 Backend running on Python 3.",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {\n+                                "text": "You can use this site to test Volto. It runs on the master branch of Volto using latest Plone 5.2 Backend running on Python 3."\n+                            }\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "59f1e88e-bc2b-4aeb-95e7-26e0850fec0f": {\n+                "@type": "slate",\n+                "plaintext": f"{datetime.now().year} - Volto Team - Plone Foundation",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {\n+                                "text": f"{datetime.now().year} - Volto Team - Plone Foundation"\n+                            }\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "712fb2c2-865e-4a21-bc74-b044a411deff": {\n+                "@type": "slate",\n+                "plaintext": "Volto also supports other APIs like Guillotina , a Python resource management system, inspired by Plone and using the same basic concepts like traversal, content types and permissions model.",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {"text": "Volto also supports other APIs like "},\n+                            {\n+                                "children": [{"text": "Guillotina"}],\n+                                "data": {"url": "https://guillotina.io/"},\n+                                "type": "link",\n+                            },\n+                            {\n+                                "text": ", a Python resource management system, inspired by Plone and using the same basic concepts like traversal, content types and permissions model."\n+                            },\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "78ff07d8-dc59-4af9-a669-1d551953ef34": {\n+                "@type": "slate",\n+                "plaintext": " Volto is a React-based frontend for content management systems, currently supporting three backend implementations: Plone, Guillotina and a NodeJS reference implementation.",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {"text": ""},\n+                            {\n+                                "children": [{"text": "Volto"}],\n+                                "data": {"url": "https://github.com/plone/volto"},\n+                                "type": "link",\n+                            },\n+                            {\n+                                "text": " is a React-based frontend for content management systems, currently supporting three backend implementations: Plone, Guillotina and a NodeJS reference implementation."\n+                            },\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+            "ddc9926a-03d3-4c64-87a1-2b941aa08ebe": {\n+                "@type": "slate",\n+                "plaintext": "Happy hacking!",\n+                "value": [{"children": [{"text": "Happy hacking!"}], "type": "p"}],\n+            },\n+            "fe6a8835-78d6-4026-ac2e-55ed26de14c3": {\n+                "@type": "slate",\n+                "plaintext": " Disclaimer : This instance is reset every night, so all changes will be lost afterwards.",\n+                "value": [\n+                    {\n+                        "children": [\n+                            {"text": ""},\n+                            {"children": [{"text": "Disclaimer"}], "type": "strong"},\n+                            {\n+                                "text": ": This instance is reset every night, so all changes will be lost afterwards."\n+                            },\n+                        ],\n+                        "type": "p",\n+                    }\n+                ],\n+            },\n+        },\n+        "blocks_layout": {\n+            "items": [\n+                "07c273fc-8bfc-4e7d-a327-d513e5a945bb",\n+                "0358abe2-b4f1-463d-a279-a63ea80daf19",\n+                "78ff07d8-dc59-4af9-a669-1d551953ef34",\n+                "38ff6b46-4cbd-4933-a462-251c3e963b7a",\n+                "712fb2c2-865e-4a21-bc74-b044a411deff",\n+                "237b0f68-d700-47ec-9356-77a54c8d5237",\n+                "58cb10e2-49a5-4a87-9f5b-479c34bc5d36",\n+                "16f63011-a6ec-4f1c-8f78-4c5166dfff2c",\n+                "26d7d965-80f3-4312-9dc6-5166d00260a5",\n+                "259ad2e9-a5f7-4e0c-a37b-b8d3a9da1a0d",\n+                "fe6a8835-78d6-4026-ac2e-55ed26de14c3",\n+                "ddc9926a-03d3-4c64-87a1-2b941aa08ebe",\n+                "59f1e88e-bc2b-4aeb-95e7-26e0850fec0f",\n+            ]\n+        },\n+    },\n+}\ndiff --git a/src/plone/volto/default_homepage/demo.py b/src/plone/volto/default_homepage/demo.py\nnew file mode 100644\nindex 0000000..bc7ff09\n--- /dev/null\n+++ b/src/plone/volto/default_homepage/demo.py\n@@ -0,0 +1,639 @@\n+from datetime import datetime\n+\n+demo_home_page = {\n+    "draftJS": {\n+        "title": "Welcome to Plone 6!",\n+        "description": "Congratulations! You have successfully installed Plone.",\n+        "blocks": {\n+            "0358abe2-b4f1-463d-a279-a63ea80daf19": {"@type": "description"},\n+            "07c273fc-8bfc-4e7d-a327-d513e5a945bb": {"@type": "title"},\n+            "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 10, "offset": 0, "style": "BOLD"}\n+                            ],\n+                            "key": "6470b",\n+                            "text": "Disclaimer: This instance is reset every night, so all changes will be lost afterwards.",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "3c881f51-f75b-4959-834a-6e1d5edc32ae": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 5, "offset": 6, "style": "BOLD"}\n+                            ],\n+                            "key": "ekn3l",\n+                            "text": "user: admin",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "behki",\n+                            "text": "Plone is a powerful content management system built on a rock-solid application stack written using the Python programming language. More about these technologies:",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "5f7e6846-e27c-48c4-8c9a-f0d93eadb185": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "75pke",\n+                            "text": "\\u2026protects and promotes Plone.",\n+                            "type": "unordered-list-item",\n+                        },\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "2mo73",\n+                            "text": "\\u2026is a registered 501(c)(3) charitable organization.",\n+                            "type": "unordered-list-item",\n+                        },\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "9qhkg",\n+                            "text": "\\u2026donations are tax-deductible.",\n+                            "type": "unordered-list-item",\n+                        },\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [{"key": 0, "length": 50, "offset": 0}],\n+                            "inlineStyleRanges": [],\n+                            "key": "5528b",\n+                            "text": "Support the Foundation and help make Plone better!",\n+                            "type": "unordered-list-item",\n+                        },\n+                    ],\n+                    "entityMap": {\n+                        "0": {\n+                            "data": {"url": "https://plone.org/sponsors/be-a-hero"},\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        }\n+                    },\n+                },\n+            },\n+            "61cc1bc0-d4f5-4e2b-9152-79512045a4dd": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "9qsa4",\n+                            "text": "Demo",\n+                            "type": "header-two",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "874049e7-629e-489a-b46c-1adf35ad40ee": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "9pnjr",\n+                            "text": "Happy hacking!",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "8bba235c-7a52-4ce2-bde1-c505e5746dce": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "692gs",\n+                            "text": "Plone is made possible only through the efforts of thousands of dedicated individuals and hundreds of companies. The Plone Foundation:",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "942b6530-2407-420f-9c24-597adda6b2ce": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "6a248",\n+                            "text": "Support the Plone Foundation",\n+                            "type": "header-two",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "9a976b8e-72ba-468a-bea8-b37a31bb386b": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 12, "offset": 51, "style": "BOLD"}\n+                            ],\n+                            "key": "94arl",\n+                            "text": "You can log in and use it as admin user using these credentials:",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "b3717238-448f-406e-b06f-57a9715c3326": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "1bnna",\n+                            "text": "Find out more about Plone",\n+                            "type": "header-two",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "55n44",\n+                            "text": "You can use this site to test Plone 6. These are the versions used in this demo:",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [\n+                                {"length": 5, "offset": 10, "style": "BOLD"}\n+                            ],\n+                            "key": "buncq",\n+                            "text": "password: admin",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [],\n+                            "inlineStyleRanges": [],\n+                            "key": "f0prj",\n+                            "text": f"{datetime.now().year} - Plone Foundation",\n+                            "type": "unstyled",\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+            "effbdcdc-253c-41a7-841e-5edb3b56ce32": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [{"key": 0, "length": 43, "offset": 4}],\n+                            "inlineStyleRanges": [],\n+                            "key": "68rve",\n+                            "text": "The Plone open source Content Management System web site for evaluators and decision makers.",\n+                            "type": "unordered-list-item",\n+                        },\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [{"key": 1, "length": 16, "offset": 4}],\n+                            "inlineStyleRanges": [],\n+                            "key": "4ec08",\n+                            "text": "The Plone community web site for developers.",\n+                            "type": "unordered-list-item",\n+                        },\n+                        {\n+                            "data": {},\n+                            "depth": 0,\n+                            "entityRanges": [{"key": 2, "length": 27, "offset": 4}],\n+                            "inlineStyleRanges": [],\n+                            "key": "4q5m2",\n+                            "text": "The Python programming language web site.",\n+                            "type": "unordered-list-item",\n+                        },\n+                    ],\n+                    "entityMap": {\n+                        "0": {\n+                            "data": {"url": "https://plone.com/"},\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        },\n+                        "1": {\n+                            "data": {"url": "https://plone.org/"},\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        },\n+                        "2": {\n+                            "data": {"url": "https://www.python.org/"},\n+                            "mutability": "MUTABLE",\n+                            "type": "LINK",\n+                        },\n+                    },\n+                },\n+            },\n+            "3b5ac7a5-2d98-423e-807c-5eebc0bf0054": {"@type": "system"},\n+        },\n+        "blocks_layout": {\n+            "items": [\n+                "07c273fc-8bfc-4e7d-a327-d513e5a945bb",\n+                "0358abe2-b4f1-463d-a279-a63ea80daf19",\n+                "b3717238-448f-406e-b06f-57a9715c3326",\n+                "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4",\n+                "effbdcdc-253c-41a7-841e-5edb3b56ce32",\n+                "942b6530-2407-420f-9c24-597adda6b2ce",\n+                "8bba235c-7a52-4ce2-bde1-c505e5746dce",\n+                "5f7e6846-e27c-48c4-8c9a-f0d93eadb185",\n+                "61cc1bc0-d4f5-4e2b-9152-79512045a4dd",\n+                "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28",\n+                "3b5ac7a5-2d98-423e-807c-5eebc0bf0054",\n+                "9a976b8e-72ba-468a-bea8-b37a31bb386b",\n+                "3c881f51-f75b-4959-834a-6e1d5edc32ae",\n+                "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c",\n+                "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226",\n+                "874049e7-629e-489a-b46c-1adf35ad40ee",\n+                "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6",\n+            ]\n+        },\n+    },\n+    "slate": {\n+        "title": "Welcome to Plone 6!",\n+        "description": "Congratulations! You have successfully installed Plone.",\n+        "blocks": {\n+            "0358abe2-b4f1-463d-a279-a63ea80daf19": {"@type": "description"},\n+            "07c273fc-8bfc-4e7d-a327-d513e5a945bb": {"@type": "title"},\n+            "3b5ac7a5-2d98-423e-807c-5eebc0bf0054": {"@type": "system"},\n+            "bedf0ed6-3237-46ac-8c91-994826b1cf05": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "h2",\n+                        "children": [{"text": "Find out more about Plone"}],\n+                    }\n+                ],\n+                "plaintext": "Find out more about Plone",\n+            },\n+            "577b38a2-84ed-4911-9644-72b73b79bf9b": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {\n+                                "text": "Plone is a powerful content management system built on a rock-solid application stack written using the Python programming language. More about these technologies:"\n+                            }\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "Plone is a powerful content management system built on a rock-solid application stack written using the Python programming language. More about these technologies:",\n+            },\n+            "539b7bb6-23e1-425c-8d93-70c03d52806e": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "ul",\n+                        "children": [\n+                            {\n+                                "type": "li",\n+                                "children": [\n+                                    {"text": "The "},\n+                                    {\n+                                        "type": "link",\n+                                        "data": {"url": "https://plone.com/"},\n+                                        "children": [\n+                                            {\n+                                                "text": "Plone open source Content Management System"\n+                                            }\n+                                        ],\n+                                    },\n+                                    {\n+                                        "text": " web site for evaluators and decision makers."\n+                                    },\n+                                ],\n+                            },\n+                            {\n+                                "type": "li",\n+                                "children": [\n+                                    {"text": "The "},\n+                                    {\n+                                        "type": "link",\n+                                        "data": {"url": "https://plone.org/"},\n+                                        "children": [{"text": "Plone community "}],\n+                                    },\n+                                    {"text": "web site for developers."},\n+                                ],\n+                            },\n+                            {\n+                                "type": "li",\n+                                "children": [\n+                                    {"text": "The "},\n+                                    {\n+                                        "type": "link",\n+                                        "data": {"url": "https://www.python.org/"},\n+                                        "children": [\n+                                            {"text": "Python programming language"}\n+                                        ],\n+                                    },\n+                                    {"text": " web site."},\n+                                ],\n+                            },\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "The Plone open source Content Management System web site for evaluators and decision makers. The Plone community web site for developers. The Python programming language web site.",\n+            },\n+            "5d166d4b-195b-4dc2-ac11-8d283673ee8d": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "h2",\n+                        "children": [{"text": "Support the Plone Foundation"}],\n+                    }\n+                ],\n+                "plaintext": "Support the Plone Foundation",\n+            },\n+            "8696b042-7119-4700-9e7f-2b22e8982a7b": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {\n+                                "text": "Plone is made possible only through the efforts of thousands of dedicated individuals and hundreds of companies. The Plone Foundation:"\n+                            }\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "Plone is made possible only through the efforts of thousands of dedicated individuals and hundreds of companies. The Plone Foundation:",\n+            },\n+            "7ab29abe-b38c-406b-94d7-b270e544a998": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "ul",\n+                        "children": [\n+                            {\n+                                "type": "li",\n+                                "children": [\n+                                    {"text": "\\u2026protects and promotes Plone."}\n+                                ],\n+                            },\n+                            {\n+                                "type": "li",\n+                                "children": [\n+                                    {\n+                                        "text": "\\u2026is a registered 501(c)(3) charitable organization."\n+                                    }\n+                                ],\n+                            },\n+                            {\n+                                "type": "li",\n+                                "children": [\n+                                    {"text": "\\u2026donations are tax-deductible."}\n+                                ],\n+                            },\n+                            {\n+                                "type": "li",\n+                                "children": [\n+                                    {"text": ""},\n+                                    {\n+                                        "type": "link",\n+                                        "data": {\n+                                            "url": "https://plone.org/sponsors/be-a-hero"\n+                                        },\n+                                        "children": [\n+                                            {\n+                                                "text": "Support the Foundation and help make Plone better!"\n+                                            }\n+                                        ],\n+                                    },\n+                                    {"text": ""},\n+                                    {\n+                                        "type": "link",\n+                                        "data": {\n+                                            "url": "https://plone.org/sponsors/be-a-hero"\n+                                        },\n+                                        "children": [{"text": ""}],\n+                                    },\n+                                    {"text": ""},\n+                                ],\n+                            },\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "\\u2026protects and promotes Plone. \\u2026is a registered 501(c)(3) charitable organization. \\u2026donations are tax-deductible.  Support the Foundation and help make Plone better!   ",\n+            },\n+            "e1220183-552c-45d9-a661-5ad0854615ac": {\n+                "@type": "slate",\n+                "value": [{"type": "h2", "children": [{"text": "Demo"}]}],\n+                "plaintext": "Demo",\n+            },\n+            "9509e96d-5718-4687-95c1-f9d3db115b92": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {\n+                                "text": "You can use this site to test Plone 6. These are the versions used in this demo:"\n+                            }\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "You can use this site to test Plone 6. These are the versions used in this demo:",\n+            },\n+            "2c68bdda-7dd3-4599-9111-db5ffb2230f9": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {\n+                                "text": "You can log in and use it as admin user using these "\n+                            },\n+                            {\n+                                "type": "strong",\n+                                "children": [{"text": "credentials"}],\n+                            },\n+                            {"text": ":"},\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "You can log in and use it as admin user using these credentials :",\n+            },\n+            "93dd5f95-b3e3-4a47-9121-cde08ca07203": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {"text": "user: "},\n+                            {"type": "strong", "children": [{"text": "admin"}]},\n+                            {"text": ""},\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "user: admin ",\n+            },\n+            "3ed49dc1-caf0-41ff-bb41-9153eeaa45da": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {"text": "password: "},\n+                            {"type": "strong", "children": [{"text": "admin"}]},\n+                            {"text": ""},\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "password: admin ",\n+            },\n+            "4b2cd280-3c87-431b-a0fe-d7ec56587bde": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {"text": ""},\n+                            {\n+                                "type": "strong",\n+                                "children": [{"text": "Disclaimer"}],\n+                            },\n+                            {\n+                                "text": ": This instance is reset every night, so all changes will be lost afterwards."\n+                            },\n+                        ],\n+                    }\n+                ],\n+                "plaintext": " Disclaimer : This instance is reset every night, so all changes will be lost afterwards.",\n+            },\n+            "b1d7da87-11d6-4dd2-81f2-0069826ffbd6": {\n+                "@type": "slate",\n+                "value": [{"type": "p", "children": [{"text": "Happy hacking!"}]}],\n+                "plaintext": "Happy hacking!",\n+            },\n+            "a7889552-ad4e-4afb-bbbd-2911661e8cbe": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {"text": f"{datetime.now().year} - Plone Foundation"}\n+                        ],\n+                    }\n+                ],\n+                "plaintext": f"{datetime.now().year} - Plone Foundation",\n+            },\n+        },\n+        "blocks_layout": {\n+            "items": [\n+                "07c273fc-8bfc-4e7d-a327-d513e5a945bb",\n+                "0358abe2-b4f1-463d-a279-a63ea80daf19",\n+                "bedf0ed6-3237-46ac-8c91-994826b1cf05",\n+                "577b38a2-84ed-4911-9644-72b73b79bf9b",\n+                "539b7bb6-23e1-425c-8d93-70c03d52806e",\n+                "5d166d4b-195b-4dc2-ac11-8d283673ee8d",\n+                "8696b042-7119-4700-9e7f-2b22e8982a7b",\n+                "7ab29abe-b38c-406b-94d7-b270e544a998",\n+                "e1220183-552c-45d9-a661-5ad0854615ac",\n+                "9509e96d-5718-4687-95c1-f9d3db115b92",\n+                "3b5ac7a5-2d98-423e-807c-5eebc0bf0054",\n+                "2c68bdda-7dd3-4599-9111-db5ffb2230f9",\n+                "93dd5f95-b3e3-4a47-9121-cde08ca07203",\n+                "3ed49dc1-caf0-41ff-bb41-9153eeaa45da",\n+                "4b2cd280-3c87-431b-a0fe-d7ec56587bde",\n+                "b1d7da87-11d6-4dd2-81f2-0069826ffbd6",\n+                "a7889552-ad4e-4afb-bbbd-2911661e8cbe",\n+            ]\n+        },\n+    },\n+}\ndiff --git a/src/plone/volto/default_homepage/lrf.py b/src/plone/volto/default_homepage/lrf.py\nnew file mode 100644\nindex 0000000..ff997de\n--- /dev/null\n+++ b/src/plone/volto/default_homepage/lrf.py\n@@ -0,0 +1,55 @@\n+default_lrf_home = {\n+    "draftJS": {\n+        "blocks": {\n+            "15068807-cfc9-444a-97db-8c736809ff52": {"@type": "title"},\n+            "59d41d8a-ef05-4e21-8820-2a64f5878092": {\n+                "@type": "text",\n+                "text": {\n+                    "blocks": [\n+                        {\n+                            "key": "618bl",\n+                            "text": "Nulla porttitor accumsan tincidunt. Sed porttitor lectus nibh. Praesent sapien massa, convallis a pellentesque nec, egestas non nisi. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Vestibulum ac diam sit amet quam vehicula elementum sed sit amet dui. Sed porttitor lectus nibh. Pellentesque in ipsum id orci porta dapibus.",\n+                            "type": "unstyled",\n+                            "depth": 0,\n+                            "inlineStyleRanges": [],\n+                            "entityRanges": [],\n+                            "data": {},\n+                        }\n+                    ],\n+                    "entityMap": {},\n+                },\n+            },\n+        },\n+        "blocks_layout": {\n+            "items": [\n+                "15068807-cfc9-444a-97db-8c736809ff52",\n+                "59d41d8a-ef05-4e21-8820-2a64f5878092",\n+            ]\n+        },\n+    },\n+    "slate": {\n+        "blocks": {\n+            "15068807-cfc9-444a-97db-8c736809ff52": {"@type": "title"},\n+            "59d41d8a-ef05-4e21-8820-2a64f5878092": {\n+                "@type": "slate",\n+                "value": [\n+                    {\n+                        "type": "p",\n+                        "children": [\n+                            {\n+                                "text": "Nulla porttitor accumsan tincidunt. Sed porttitor lectus nibh. Praesent sapien massa, convallis a pellentesque nec, egestas non nisi. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Vestibulum ac diam sit amet quam vehicula elementum sed sit amet dui. Sed porttitor lectus nibh. Pellentesque in ipsum id orci porta dapibus."\n+                            }\n+                        ],\n+                    }\n+                ],\n+                "plaintext": "Nulla porttitor accumsan tincidunt. Sed porttitor lectus nibh. Praesent sapien massa, convallis a pellentesque nec, egestas non nisi. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Vestibulum ac diam sit amet quam vehicula elementum sed sit amet dui. Sed porttitor lectus nibh. Pellentesque in ipsum id orci porta dapibus.",\n+            },\n+        },\n+        "blocks_layout": {\n+            "items": [\n+                "15068807-cfc9-444a-97db-8c736809ff52",\n+                "59d41d8a-ef05-4e21-8820-2a64f5878092",\n+            ]\n+        },\n+    },\n+}\ndiff --git a/src/plone/volto/dependencies.zcml b/src/plone/volto/dependencies.zcml\nindex d34667f..bd61c7d 100644\n--- a/src/plone/volto/dependencies.zcml\n+++ b/src/plone/volto/dependencies.zcml\n@@ -18,6 +18,5 @@\n       />\n   <include package="plone.restapi" />\n   <include package="plone.api" />\n-  <include package="collective.folderishtypes" />\n \n </configure>\ndiff --git a/src/plone/volto/interfaces.py b/src/plone/volto/interfaces.py\nindex 41701c5..9938251 100644\n--- a/src/plone/volto/interfaces.py\n+++ b/src/plone/volto/interfaces.py\n@@ -9,6 +9,10 @@ class IPloneVoltoCoreLayer(IDefaultBrowserLayer):\n     """Marker interface that defines a browser layer."""\n \n \n+class IThemeSpecific(IPloneVoltoCoreLayer):\n+    """bbb for collective.folderishtypes browser interface."""\n+\n+\n class IVoltoSettings(Interface):\n     """Volto settings necessary to store in the backend"""\n \n@@ -17,3 +21,19 @@ class IVoltoSettings(Interface):\n         description=u"Used for rewriting URL\'s sent in the password reset e-mail by Plone.",\n         default="http://localhost:3000",\n     )\n+\n+\n+class IFolderishType(Interface):\n+    """Marker interface"""\n+\n+\n+class IFolderishDocument(IFolderishType):\n+    """Marker interface"""\n+\n+\n+class IFolderishEvent(IFolderishType):\n+    """Marker interface"""\n+\n+\n+class IFolderishNewsItem(IFolderishType):\n+    """Marker interface"""\ndiff --git a/src/plone/volto/locales/es/LC_MESSAGES/plone.volto.po b/src/plone/volto/locales/es/LC_MESSAGES/plone.volto.po\nnew file mode 100644\nindex 0000000..30df2b3\n--- /dev/null\n+++ b/src/plone/volto/locales/es/LC_MESSAGES/plone.volto.po\n@@ -0,0 +1,114 @@\n+# --- PLEASE EDIT THE LINES BELOW CORRECTLY ---\n+# SOME DESCRIPTIVE TITLE.\n+# Mikel Larreategi <mlarreategi@codesyntax.com>, 2021.\n+msgid ""\n+msgstr ""\n+"Project-Id-Version: \\n"\n+"POT-Creation-Date: 2021-11-18 08:27+0000\\n"\n+"PO-Revision-Date: 2021-11-21 16:58+0100\\n"\n+"MIME-Version: 1.0\\n"\n+"Content-Type: text/plain; charset=utf-8\\n"\n+"Content-Transfer-Encoding: 8bit\\n"\n+"Plural-Forms: nplurals=1; plural=0;\\n"\n+"Language-Code: es\\n"\n+"Language-Name: Spanish\\n"\n+"Preferred-Encodings: utf-8 latin1\\n"\n+"Domain: plone.volto\\n"\n+"Last-Translator: \\n"\n+"Language-Team: \\n"\n+"Language: es\\n"\n+"X-Generator: Poedit 2.3\\n"\n+\n+#: plone/volto/behaviors/configure.zcml:31\n+msgid "Adds Head title field"\n+msgstr "A\xc3\xb1ade el campo de t\xc3\xadtulo de cabecera"\n+\n+#: plone/volto/configure.zcml:37\n+msgid "Configures the Plone backend to work with Volto, the new default frontend for Plone 6."\n+msgstr "Configura Plone para funcionar con Volto, el nuevo frontal de Plone 6."\n+\n+#: plone/volto/configure.zcml:55\n+msgid "Creates a default page for the site"\n+msgstr "Crea la p\xc3\xa1gina por defecto del sitio"\n+\n+#: plone/volto/behaviors/configure.zcml:31\n+msgid "Head title field"\n+msgstr "Campo de t\xc3\xadtulo de cabecera"\n+\n+#: plone/volto/behaviors/headtitle.py:13\n+msgid "Header title"\n+msgstr "T\xc3\xadtulo de cabecera"\n+\n+#: plone/volto/behaviors/headtitle.py:15\n+msgid "Header title should consist of year and number of the report"\n+msgstr "El t\xc3\xadtulo de cabecera deber\xc3\xada tener el a\xc3\xb1o y n\xc3\xbamero de informe"\n+\n+#: plone/volto/behaviors/configure.zcml:24 plone/volto/behaviors/navtitle.py:12\n+msgid "Navigation title"\n+msgstr "T\xc3\xadtulo de la navegaci\xc3\xb3n"\n+\n+#: plone/volto/behaviors/configure.zcml:24\n+msgid "Navigation title used in sections, menus and doormats"\n+msgstr "T\xc3\xadtulo de la navegaci\xc3\xb3n utilizado en secciones, men\xc3\xbas y acordeones"\n+\n+#: plone/volto/configure.zcml:55\n+msgid "Plone 6 Frontend (Default content on homepage)"\n+msgstr "Frontal Plone 6 (contenido por defecto en la portada)"\n+\n+#: plone/volto/configure.zcml:37\n+msgid "Plone 6 Frontend (plone.volto)"\n+msgstr "Frontal Plone 6 (plone.volto)"\n+\n+#: plone/volto/configure.zcml:46\n+msgid "Plone 6 Frontend (plone.volto): uninstall"\n+msgstr "Frontal Plone 6 (plone.volto): desinstalar"\n+\n+#: plone/volto/behaviors/configure.zcml:17\n+msgid "Preview Image"\n+msgstr "Imagen"\n+\n+#: plone/volto/behaviors/preview.py:23\n+msgid "Preview image caption"\n+msgstr "Preview image caption"\n+\n+#: plone/volto/behaviors/configure.zcml:17\n+msgid "Preview image for listings"\n+msgstr "Imagen para listados"\n+\n+#: plone/volto/configure.zcml:64\n+msgid "Special requirements and setup for demo site"\n+msgstr "Configuraci\xc3\xb3n especial para instalar el sitio de demo"\n+\n+#: plone/volto/configure.zcml:73\n+msgid "Special test fixture for multilingual use case"\n+msgstr "Perfil especial para configurar los tests de un sitio multiling\xc3\xbce"\n+\n+#: plone/volto/configure.zcml:81\n+msgid "Specific profile for re-adding the richtext behavior"\n+msgstr "Perfil espec\xc3\xadfico para a\xc3\xb1adir otra vez el comportamiento de texto"\n+\n+#: plone/volto/configure.zcml:46\n+msgid "Uninstalls the plone.volto add-on."\n+msgstr "Desinstalar plone.volto"\n+\n+#. Default: "Insert an image that will be used in listing and teaser blocks."\n+#: plone/volto/behaviors/preview.py:15\n+msgid "help_previewimage"\n+msgstr "Introduzca la imagen que se utilizar\xc3\xa1 en los listados y otros bloques"\n+\n+#. Default: "Preview image"\n+#: plone/volto/behaviors/preview.py:14\n+msgid "label_previewimage"\n+msgstr "Imagen"\n+\n+#: plone/volto/configure.zcml:64\n+msgid "plone.volto demo special requirements"\n+msgstr "Requisitos especiales de la demo de plone.volto"\n+\n+#: plone/volto/configure.zcml:73\n+msgid "plone.volto multilingual Cypress tests fixtures"\n+msgstr "Tests de plone.volto multiling\xc3\xbce"\n+\n+#: plone/volto/configure.zcml:81\n+msgid "plone.volto p51 profile"\n+msgstr "Perfil plone.volto p51"\ndiff --git a/src/plone/volto/locales/eu/LC_MESSAGES/plone.volto.po b/src/plone/volto/locales/eu/LC_MESSAGES/plone.volto.po\nnew file mode 100644\nindex 0000000..2d307f5\n--- /dev/null\n+++ b/src/plone/volto/locales/eu/LC_MESSAGES/plone.volto.po\n@@ -0,0 +1,114 @@\n+# --- PLEASE EDIT THE LINES BELOW CORRECTLY ---\n+# SOME DESCRIPTIVE TITLE.\n+# Mikel Larreategi <mlarreategi@codesyntax.com>, 2021\n+msgid ""\n+msgstr ""\n+"Project-Id-Version: \\n"\n+"POT-Creation-Date: 2021-11-18 08:27+0000\\n"\n+"PO-Revision-Date: 2021-11-21 16:50+0100\\n"\n+"MIME-Version: 1.0\\n"\n+"Content-Type: text/plain; charset=utf-8\\n"\n+"Content-Transfer-Encoding: 8bit\\n"\n+"Plural-Forms: nplurals=1; plural=0;\\n"\n+"Language-Code: eu\\n"\n+"Language-Name: Basque\\n"\n+"Preferred-Encodings: utf-8 latin1\\n"\n+"Domain: plone.volto\\n"\n+"Last-Translator: \\n"\n+"Language-Team: \\n"\n+"Language: eu\\n"\n+"X-Generator: Poedit 2.3\\n"\n+\n+#: plone/volto/behaviors/configure.zcml:31\n+msgid "Adds Head title field"\n+msgstr "Goiburuko izenburua gehitu"\n+\n+#: plone/volto/configure.zcml:37\n+msgid "Configures the Plone backend to work with Volto, the new default frontend for Plone 6."\n+msgstr "Plone Voltorekin funtzionatzeko konfiguratzen du, Plone 6rako Frontend berria."\n+\n+#: plone/volto/configure.zcml:55\n+msgid "Creates a default page for the site"\n+msgstr "Atariaren defektuzko orri berria sortzen du"\n+\n+#: plone/volto/behaviors/configure.zcml:31\n+msgid "Head title field"\n+msgstr "Goiburuko izenburuaren eremua"\n+\n+#: plone/volto/behaviors/headtitle.py:13\n+msgid "Header title"\n+msgstr "Goiburuko izenburua"\n+\n+#: plone/volto/behaviors/headtitle.py:15\n+msgid "Header title should consist of year and number of the report"\n+msgstr "Goiburukoan erabiliko den izenburua"\n+\n+#: plone/volto/behaviors/configure.zcml:24 plone/volto/behaviors/navtitle.py:12\n+msgid "Navigation title"\n+msgstr "Nabigazioaren izenburua"\n+\n+#: plone/volto/behaviors/configure.zcml:24\n+msgid "Navigation title used in sections, menus and doormats"\n+msgstr "Atal, menu eta akordeoietan erabiliko den nabigazioaren izenburua"\n+\n+#: plone/volto/configure.zcml:55\n+msgid "Plone 6 Frontend (Default content on homepage)"\n+msgstr "Plone 6 Frontenda (hasiera orria defektuzko edukiarekin)"\n+\n+#: plone/volto/configure.zcml:37\n+msgid "Plone 6 Frontend (plone.volto)"\n+msgstr "Plone 6 Frontenda (plone.volto)"\n+\n+#: plone/volto/configure.zcml:46\n+msgid "Plone 6 Frontend (plone.volto): uninstall"\n+msgstr "Plone 6 Frontenda (plone.volto): kendu"\n+\n+#: plone/volto/behaviors/configure.zcml:17\n+msgid "Preview Image"\n+msgstr "Irudia"\n+\n+#: plone/volto/behaviors/preview.py:23\n+msgid "Preview image caption"\n+msgstr "Irudi-oina"\n+\n+#: plone/volto/behaviors/configure.zcml:17\n+msgid "Preview image for listings"\n+msgstr "Zerrendetan erabiliko den irudia"\n+\n+#: plone/volto/configure.zcml:64\n+msgid "Special requirements and setup for demo site"\n+msgstr "Demo webgunea konfiguratzeko profil berezia"\n+\n+#: plone/volto/configure.zcml:73\n+msgid "Special test fixture for multilingual use case"\n+msgstr "Webgune eleanitzetan erabiltzeko profila"\n+\n+#: plone/volto/configure.zcml:81\n+msgid "Specific profile for re-adding the richtext behavior"\n+msgstr "Testu aberatseko portaera gehitzeko profila"\n+\n+#: plone/volto/configure.zcml:46\n+msgid "Uninstalls the plone.volto add-on."\n+msgstr "plone.volto kendu"\n+\n+#. Default: "Insert an image that will be used in listing and teaser blocks."\n+#: plone/volto/behaviors/preview.py:15\n+msgid "help_previewimage"\n+msgstr "Kargatu zerrendetan eta destakatuen blokeetan defektuz erabiliko den irudia"\n+\n+#. Default: "Preview image"\n+#: plone/volto/behaviors/preview.py:14\n+msgid "label_previewimage"\n+msgstr "Irudia"\n+\n+#: plone/volto/configure.zcml:64\n+msgid "plone.volto demo special requirements"\n+msgstr "plone.volto demoren konfigurazio berezia"\n+\n+#: plone/volto/configure.zcml:73\n+msgid "plone.volto multilingual Cypress tests fixtures"\n+msgstr "plone.volto eleanitzaren Cypress testen konfigurazioa"\n+\n+#: plone/volto/configure.zcml:81\n+msgid "plone.volto p51 profile"\n+msgstr "plone.volto p51 profila"\ndiff --git a/src/plone/volto/patches.py b/src/plone/volto/patches.py\nindex bfd8dba..333356e 100644\n--- a/src/plone/volto/patches.py\n+++ b/src/plone/volto/patches.py\n@@ -1,3 +1,7 @@\n+from plone.app.upgrade.utils import alias_module\n+from plone.volto import logger\n+from plone.volto import content\n+from plone.volto import interfaces\n from plone.volto.interfaces import IVoltoSettings\n from plone.registry.interfaces import IRegistry\n from plone.rest.interfaces import IAPIRequest\n@@ -12,6 +16,15 @@\n LOG = logging.getLogger("Zope.SiteErrorLog")\n \n \n+try:\n+    from collective.folderishtypes.dx import content  # noqa F401\n+except ImportError:\n+    logger.info("Aliasing collective.folderish classes to plone.volto classes.")\n+    alias_module("collective.folderishtypes.dx.content", content)\n+    alias_module("collective.folderishtypes.dx.interfaces", interfaces)\n+    alias_module("collective.folderishtypes.interfaces", interfaces)\n+\n+\n def _do_copy_to_zlog(self, now, strtype, entry_id, url, tb_text):\n     when = _rate_restrict_pool.get(strtype, 0)\n     if now > when:\ndiff --git a/src/plone/volto/profiles.zcml b/src/plone/volto/profiles.zcml\nnew file mode 100644\nindex 0000000..99f116f\n--- /dev/null\n+++ b/src/plone/volto/profiles.zcml\n@@ -0,0 +1,86 @@\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n+    xmlns:i18n="http://namespaces.zope.org/i18n"\n+    i18n_domain="plone.volto"\n+    >\n+\n+  <genericsetup:registerProfile\n+      name="default"\n+      title="Plone 6 Frontend (plone.volto)"\n+      description="Configures the Plone backend to work with Volto, the new default frontend for Plone 6."\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/default"\n+      post_handler=".setuphandlers.post_install"\n+      />\n+\n+  <genericsetup:registerProfile\n+      name="uninstall"\n+      title="Plone 6 Frontend (plone.volto): uninstall"\n+      description="Uninstalls the plone.volto add-on."\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/uninstall"\n+      post_handler=".setuphandlers.uninstall"\n+      />\n+\n+  <genericsetup:registerProfile\n+      name="default-homepage"\n+      title="Plone 6 Frontend (Default content on homepage)"\n+      description="Creates a default page for the site"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/homepage"\n+      post_handler=".setuphandlers.create_default_homepage"\n+      />\n+\n+  <genericsetup:registerProfile\n+      name="default-homepage-drafjs"\n+      title="Plone 6 Frontend (Default content on homepage with draftJS blocks)"\n+      description="Creates a default page for the site using (legacy) draftJS blocks"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/homepage"\n+      post_handler=".setuphandlers.create_default_homepage_draftjs"\n+      />\n+\n+  <genericsetup:registerProfile\n+      name="demo"\n+      title="plone.volto demo special requirements"\n+      description="Special requirements and setup for demo site"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/demo"\n+      post_handler=".setuphandlers.create_demo_homepage"\n+      />\n+\n+  <!-- Fixture for coresandbox Cypress tests in Volto repo -->\n+  <genericsetup:registerProfile\n+      name="coresandbox"\n+      title="plone.volto coresandbox Cypress tests fixtures"\n+      description="Special test fixture for coresandbox use cases"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/coresandbox"\n+      post_handler=".setuphandlers.post_install_coresandbox"\n+      />\n+\n+  <!-- Fixture for multilingual Cypress tests in Volto repo -->\n+  <genericsetup:registerProfile\n+      name="multilingual"\n+      title="plone.volto multilingual Cypress tests fixtures"\n+      description="Special test fixture for multilingual use case"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/multilingual"\n+      post_handler=".setuphandlers.post_install_multilingual"\n+      />\n+\n+  <genericsetup:registerProfile\n+      name="richtext"\n+      title="plone.volto p51 profile"\n+      description="Specific profile for re-adding the richtext behavior"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/richtext"\n+      />\n+\n+  <utility\n+      factory=".setuphandlers.HiddenProfiles"\n+      name="plone.volto-hiddenprofiles"\n+      />\n+\n+</configure>\ndiff --git a/src/plone/volto/profiles/default/metadata.xml b/src/plone/volto/profiles/default/metadata.xml\nindex 41189c2..f746bae 100644\n--- a/src/plone/volto/profiles/default/metadata.xml\n+++ b/src/plone/volto/profiles/default/metadata.xml\n@@ -1,8 +1,7 @@\n <?xml version="1.0" encoding="UTF-8"?>\n <metadata>\n-  <version>1013</version>\n+  <version>1016</version>\n   <dependencies>\n-    <dependency>profile-collective.folderishtypes.dx:default</dependency>\n     <dependency>profile-plone.restapi:blocks</dependency>\n   </dependencies>\n </metadata>\ndiff --git a/src/plone/volto/profiles/default/types.xml b/src/plone/volto/profiles/default/types.xml\nindex 81e9537..7c70ee9 100644\n--- a/src/plone/volto/profiles/default/types.xml\n+++ b/src/plone/volto/profiles/default/types.xml\n@@ -5,4 +5,5 @@\n   <object meta_type="Dexterity FTI" name="Document" />\n   <object meta_type="Dexterity FTI" name="Event" />\n   <object meta_type="Dexterity FTI" name="News Item" />\n+  <object meta_type="Dexterity FTI" name="Collection" />\n </object>\ndiff --git a/src/plone/volto/profiles/default/types/Collection.xml b/src/plone/volto/profiles/default/types/Collection.xml\nnew file mode 100644\nindex 0000000..c7299d5\n--- /dev/null\n+++ b/src/plone/volto/profiles/default/types/Collection.xml\n@@ -0,0 +1,8 @@\n+<?xml version="1.0"?>\n+<object name="Collection" meta_type="Dexterity FTI" i18n:domain="plone"\n+   xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n+\n+  <!-- Collections in Volto are disabled by default -->\n+  <property name="global_allow">False</property>\n+\n+</object>\ndiff --git a/src/plone/volto/profiles/default/types/Document.xml b/src/plone/volto/profiles/default/types/Document.xml\nindex 88e2284..9fd8222 100644\n--- a/src/plone/volto/profiles/default/types/Document.xml\n+++ b/src/plone/volto/profiles/default/types/Document.xml\n@@ -5,8 +5,12 @@\n     name="Document"\n     xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n \n+  <property name="filter_content_types">False</property>\n+  <property name="klass">plone.volto.content.FolderishDocument</property>\n+\n   <!-- Enabled behaviors -->\n   <property name="behaviors">\n+    <element value="plone.constraintypes"/>\n     <element value="plone.namefromtitle" />\n     <element value="plone.allowdiscussion" />\n     <element value="plone.excludefromnavigation" />\ndiff --git a/src/plone/volto/profiles/default/types/Event.xml b/src/plone/volto/profiles/default/types/Event.xml\nindex 7201424..54317cd 100644\n--- a/src/plone/volto/profiles/default/types/Event.xml\n+++ b/src/plone/volto/profiles/default/types/Event.xml\n@@ -1,14 +1,11 @@\n <?xml version="1.0"?>\n-<object\n-    i18n:domain="plone"\n-    meta_type="Dexterity FTI"\n-    name="Event"\n+<object name="Event" meta_type="Dexterity FTI" i18n:domain="plone"\n     xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n-\n-  <!-- Enabled behaviors -->\n-  <property name="behaviors" purge="False">\n+  <property name="filter_content_types">False</property>\n+  <property name="klass">plone.volto.content.FolderishEvent</property>\n+  <property name="behaviors" purge="false">\n+    <element value="plone.constraintypes"/>\n     <element value="volto.blocks" />\n     <element value="volto.preview_image" />\n   </property>\n-\n </object>\ndiff --git a/src/plone/volto/profiles/default/types/News_Item.xml b/src/plone/volto/profiles/default/types/News_Item.xml\nindex 06b8d48..66066c3 100644\n--- a/src/plone/volto/profiles/default/types/News_Item.xml\n+++ b/src/plone/volto/profiles/default/types/News_Item.xml\n@@ -1,13 +1,10 @@\n <?xml version="1.0"?>\n-<object\n-    i18n:domain="plone"\n-    meta_type="Dexterity FTI"\n-    name="News Item"\n+<object name="News Item" meta_type="Dexterity FTI" i18n:domain="plone"\n     xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n-\n-  <!-- Enabled behaviors -->\n-  <property name="behaviors" purge="False">\n+  <property name="filter_content_types">False</property>\n+  <property name="klass">plone.volto.content.FolderishNewsItem</property>\n+  <property name="behaviors" purge="false">\n+    <element value="plone.constraintypes"/>\n     <element value="volto.blocks" />\n   </property>\n-\n </object>\ndiff --git a/src/plone/volto/profiles/default/types/Plone_Site.xml b/src/plone/volto/profiles/default/types/Plone_Site.xml\ndeleted file mode 100644\nindex db7de5d..0000000\n--- a/src/plone/volto/profiles/default/types/Plone_Site.xml\n+++ /dev/null\n@@ -1,14 +0,0 @@\n-<?xml version="1.0"?>\n-<object name="Plone Site"\n-   i18n:domain="plone" xmlns:i18n="http://xml.zope.org/namespaces/i18n">\n- <action\n-    action_id="edit"\n-    category="object"\n-    condition_expr=""\n-    i18n:attributes="title"\n-    title="Edit"\n-    url_expr="string:${object_url}/edit"\n-    visible="True">\n-  <permission value="Manage portal"/>\n- </action>\n-</object>\ndiff --git a/src/plone/volto/setuphandlers.py b/src/plone/volto/setuphandlers.py\nindex 8568fee..ea36cbd 100644\n--- a/src/plone/volto/setuphandlers.py\n+++ b/src/plone/volto/setuphandlers.py\n@@ -2,27 +2,39 @@\n from plone import api\n from plone.app.multilingual.browser.setup import SetupMultilingualSite\n from plone.app.multilingual.setuphandlers import enable_translatable_behavior\n-from plone.app.portlets.utils import assignment_mapping_from_key\n from plone.dexterity.interfaces import IDexterityFTI\n-from plone.portlets.constants import CONTEXT_CATEGORY\n-from plone.portlets.interfaces import IPortletAssignmentMapping\n-from plone.portlets.interfaces import IPortletManager\n+from plone.volto.default_homepage.default import default_home\n+from plone.volto.default_homepage.demo import demo_home_page\n+from plone.volto.default_homepage.lrf import default_lrf_home\n from Products.CMFCore.utils import getToolByName\n from Products.CMFPlone.interfaces import INonInstallable\n from Products.CMFPlone.utils import get_installer\n-from zope.component import getMultiAdapter\n-from zope.component import getUtility\n from zope.component import queryUtility\n-from zope.component.interfaces import IFactory\n-from zope.container.interfaces import INameChooser\n from zope.interface import implementer\n \n import json\n import logging\n import transaction\n \n+\n+try:\n+    from Products.CMFPlone.factory import PLONE60MARKER\n+\n+    PLONE60MARKER  # pyflakes\n+except ImportError:\n+    PLONE_6 = False\n+else:\n+    PLONE_6 = True\n+\n logger = logging.getLogger("plone.volto")\n \n+NO_RICHTEXT_BEHAVIOR_CONTENT_TYPES = [\n+    "Plone Site",\n+    "Document",\n+    "News Item",\n+    "Event",\n+]\n+\n \n @implementer(INonInstallable)\n class HiddenProfiles(object):\n@@ -33,8 +45,15 @@ def getNonInstallableProfiles(self):\n \n def post_install(context):\n     """Post install script"""\n-    # portal = api.portal.get()\n-    # create_default_homepage()\n+    # For Plone 6, make sure the blocks behavior is enabled in the root\n+    if PLONE_6:\n+        add_behavior("Plone Site", "volto.blocks")\n+    else:\n+        set_edit_action_in_plone_site_for_plone5(context)\n+\n+    # Remove plone.richtext from content types with blocks enabled\n+    for type_ in NO_RICHTEXT_BEHAVIOR_CONTENT_TYPES:\n+        remove_behavior(type_, "plone.richtext")\n \n \n def uninstall(context):\n@@ -49,7 +68,7 @@ def post_install_coresandbox(context):\n def post_install_multilingual(context):\n     """Post install script for multilingual fixture"""\n     enable_pam(context)\n-    create_default_homepage(context)\n+    create_default_homepage(context, block_type="slate")\n \n \n def enable_pam(portal):\n@@ -133,97 +152,74 @@ def add_catalog_indexes(context, wanted=None):\n \n def add_behavior(portal_type, behavior):\n     fti = queryUtility(IDexterityFTI, name=portal_type)\n-    new = [\n-        currentbehavior\n-        for currentbehavior in fti.behaviors\n-        if currentbehavior != behavior\n-    ]\n-    new.append(behavior)\n-    fti.behaviors = tuple(new)\n-\n-\n-def setupNavigationPortlet(\n-    context,\n-    name="",\n-    root=None,\n-    includeTop=False,\n-    currentFolderOnly=False,\n-    bottomLevel=0,\n-    topLevel=0,\n-):\n-    """\n-    setupNavigationPortlet(portal[\'vereinigungen\'][\'fachliche-vereinigungen\'][\'sektion-materie-und-kosmos\'][\'gravitation-und-relativitaetstheorie\']) # noqa\n-    """\n-    from plone.app.portlets.portlets.navigation import (\n-        Assignment as NavAssignment,\n-    )  # noqa\n-\n-    target_manager = queryUtility(\n-        IPortletManager, name="plone.leftcolumn", context=context\n-    )\n-    target_manager_assignments = getMultiAdapter(\n-        (context, target_manager), IPortletAssignmentMapping\n-    )\n-\n-    navtree = NavAssignment(\n-        includeTop=includeTop,\n-        currentFolderOnly=currentFolderOnly,\n-        bottomLevel=bottomLevel,\n-        topLevel=topLevel,\n-    )\n+    if fti is not None:\n+        # This prevents to add the behavior twice\n+        new = [\n+            currentbehavior\n+            for currentbehavior in fti.behaviors\n+            if currentbehavior != behavior\n+        ]\n+        new.append(behavior)\n+        fti.behaviors = tuple(new)\n \n-    if "navigation" not in target_manager_assignments.keys():\n-        target_manager_assignments["navigation"] = navtree\n \n+def remove_behavior(portal_type, behavior):\n+    fti = queryUtility(IDexterityFTI, name=portal_type)\n+    if fti is not None:\n+        new = [\n+            currentbehavior\n+            for currentbehavior in fti.behaviors\n+            if currentbehavior != behavior\n+        ]\n+        fti.behaviors = tuple(new)\n+\n+\n+def set_edit_action_in_plone_site_for_plone5(context):\n+    pt = api.portal.get_tool("portal_types")\n+    fti = pt.getTypeInfo("Plone Site")\n+\n+    # Plone site Edit action properties\n+    action_id = "edit"\n+    category = "object"\n+    condition = ""\n+    title = "Edit"\n+    action = "string:${object_url}/edit"\n+    visible = "True"\n+    permissions = ["Modify portal content"]\n+    icon_expr = ""\n+    link_target = ""\n+\n+    action_obj = fti.getActionObject(category + "/" + action_id)\n+\n+    if action_obj is None:\n+        fti.addAction(\n+            action_id,\n+            title,\n+            action,\n+            condition,\n+            tuple(permissions),\n+            category,\n+            visible,\n+            icon_expr=icon_expr,\n+            link_target=link_target,\n+        )\n+    else:\n+        action_obj.edit(\n+            title=title,\n+            action=action,\n+            icon_expr=icon_expr,\n+            condition=condition,\n+            permissions=tuple(permissions),\n+            visible=visible,\n+            link_target=link_target,\n+        )\n \n-def setupPortletAt(portal, portlet_type, manager, path, name="", **kw):\n-    """\n-    setupPortletAt(portal, \'portlets.Events\', \'plone.rightcolumn\', \'/vereinigungen/fachliche-vereinigungen/sektion-kondensierte-materie/halbleiterphysik\') # noqa\n-    """\n-    portlet_factory = getUtility(IFactory, name=portlet_type)\n-    assignment = portlet_factory(**kw)\n-    mapping = assignment_mapping_from_key(\n-        portal, manager, CONTEXT_CATEGORY, path, create=True\n-    )\n \n-    if not name:\n-        chooser = INameChooser(mapping)\n-        name = chooser.chooseName(None, assignment)\n-\n-    mapping[name] = assignment\n-\n-\n-default_lrf_home = {\n-    "blocks": {\n-        "15068807-cfc9-444a-97db-8c736809ff52": {"@type": "title"},\n-        "59d41d8a-ef05-4e21-8820-2a64f5878092": {\n-            "@type": "text",\n-            "text": {\n-                "blocks": [\n-                    {\n-                        "key": "618bl",\n-                        "text": "Nulla porttitor accumsan tincidunt. Sed porttitor lectus nibh. Praesent sapien massa, convallis a pellentesque nec, egestas non nisi. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Nulla porttitor accumsan tincidunt. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Vestibulum ac diam sit amet quam vehicula elementum sed sit amet dui. Sed porttitor lectus nibh. Pellentesque in ipsum id orci porta dapibus.",\n-                        "type": "unstyled",\n-                        "depth": 0,\n-                        "inlineStyleRanges": [],\n-                        "entityRanges": [],\n-                        "data": {},\n-                    }\n-                ],\n-                "entityMap": {},\n-            },\n-        },\n-    },\n-    "blocks_layout": {\n-        "items": [\n-            "15068807-cfc9-444a-97db-8c736809ff52",\n-            "59d41d8a-ef05-4e21-8820-2a64f5878092",\n-        ]\n-    },\n-}\n+def create_default_homepage_draftjs(context):\n+    create_default_homepage(context, block_type="draftJS")\n \n \n-def create_default_homepage(context, default_home=default_lrf_home):\n+def create_default_homepage(context, default_home=default_lrf_home, block_type=None):\n     """This method allows to pass a dict with the homepage blocks and blocks_layout keys"""\n     portal = api.portal.get()\n     # Test for PAM installed\n@@ -240,6 +236,12 @@ def create_default_homepage(context, default_home=default_lrf_home):\n         # Make sure that the LRFs have the blocks enabled\n         add_behavior("LRF", "volto.blocks")\n \n+        if block_type and block_type in default_home:\n+            home_data = default_home[block_type]\n+        else:\n+            # Default to slate\n+            home_data = default_home["slate"]\n+\n         for lang in api.portal.get_registry_record("plone.available_languages"):\n             # Do not write them if there are blocks set already\n             # Get the attr first, in case it\'s not there yet (error in docker image)\n@@ -250,14 +252,14 @@ def create_default_homepage(context, default_home=default_lrf_home):\n                 logger.info(\n                     "Creating default homepage for {} - PAM enabled".format(lang)\n                 )\n-                portal[lang].blocks = default_home["blocks"]\n-                portal[lang].blocks_layout = default_home["blocks_layout"]\n+                portal[lang].blocks = home_data["blocks"]\n+                portal[lang].blocks_layout = home_data["blocks_layout"]\n \n     else:\n-        create_root_homepage(context)\n+        create_root_homepage(context, block_type)\n \n \n-def create_root_homepage(context, default_home=None):\n+def create_root_homepage(context, block_type=None, default_home=default_home):\n     """It takes a default object:\n     {\n         "title": "The title",\n@@ -266,663 +268,41 @@ def create_root_homepage(context, default_home=None):\n         "blocks_layout": [...]\n     }\n     and sets it as default page in the Plone root object.\n-    """\n \n+    Takes into account block_type.\n+    """\n     portal = api.portal.get()\n \n-    if default_home:\n-        blocks = default_home["blocks"]\n-        blocks_layout = default_home["blocks_layout"]\n-        portal.setTitle(default_home["title"])\n-        portal.setDescription(default_home["description"])\n+    if block_type and block_type in default_home:\n+        home_data = default_home[block_type]\n+    else:\n+        # Default to slate\n+        home_data = default_home["slate"]\n \n-        logger.info(\n-            "Creating custom default homepage in Plone site root - not PAM enabled"\n-        )\n+    logger.info(\n+        f"Creating default homepage in Plone {\'6\' if PLONE_6 else \'\'} site root with {block_type} blocks - not PAM enabled"\n+    )\n+\n+    if PLONE_6:\n+        portal.blocks = home_data["blocks"]\n+        portal.blocks_layout = home_data["blocks_layout"]\n+        portal.title = home_data["title"]\n+        portal.description = home_data["description"]\n     else:\n-        blocks = {\n-            "0358abe2-b4f1-463d-a279-a63ea80daf19": {"@type": "description"},\n-            "07c273fc-8bfc-4e7d-a327-d513e5a945bb": {"@type": "title"},\n-            "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 10, "offset": 0, "style": "BOLD"}\n-                            ],\n-                            "key": "6470b",\n-                            "text": "Disclaimer: This instance is reset every night, so all changes will be lost afterwards.",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "3c881f51-f75b-4959-834a-6e1d5edc32ae": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 5, "offset": 6, "style": "BOLD"}\n-                            ],\n-                            "key": "ekn3l",\n-                            "text": "user: admin",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [\n-                                {"key": 0, "length": 5, "offset": 0},\n-                                {"key": 1, "length": 8, "offset": 455},\n-                            ],\n-                            "inlineStyleRanges": [],\n-                            "key": "behki",\n-                            "text": "Plone is a CMS built on Python with over 19 years of experience. Plone has very interesting features that appeal to developers and users alike, such as customizable content types, hierarchical URL object traversing and a sophisticated content workflow powered by a granular permissions model. This allows you to build anything from simple websites to enterprise-grade intranets. Volto exposes all these features and communicates with Plone via its mature REST API. Volto can be esily themed and is highly customizable.",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {\n-                        "0": {\n-                            "data": {\n-                                "href": "https://plone.org",\n-                                "rel": "nofollow",\n-                                "url": "https://plone.org/",\n-                            },\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        },\n-                        "1": {\n-                            "data": {\n-                                "href": "https://github.com/plone/plone.restapi",\n-                                "url": "https://github.com/plone/plone.restapi",\n-                            },\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        },\n-                    },\n-                },\n-            },\n-            "61cc1bc0-d4f5-4e2b-9152-79512045a4dd": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "9qsa4",\n-                            "text": "Demo",\n-                            "type": "header-two",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "874049e7-629e-489a-b46c-1adf35ad40ee": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "9pnjr",\n-                            "text": "Happy hacking!",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "942b6530-2407-420f-9c24-597adda6b2ce": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [{"key": 0, "length": 36, "offset": 39}],\n-                            "inlineStyleRanges": [],\n-                            "key": "6a248",\n-                            "text": "Last but not least, it also supports a Volto Nodejs-based backend reference API implementation that demos how other systems could also use Volto to display and create content through it.",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {\n-                        "0": {\n-                            "data": {\n-                                "href": "https://github.com/plone/volto-reference-backend",\n-                                "url": "https://github.com/plone/volto-reference-backend",\n-                            },\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        }\n-                    },\n-                },\n-            },\n-            "9a976b8e-72ba-468a-bea8-b37a31bb386b": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 12, "offset": 51, "style": "BOLD"}\n-                            ],\n-                            "key": "94arl",\n-                            "text": "You can log in and use it as admin user using these credentials:",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "b3717238-448f-406e-b06f-57a9715c3326": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [{"key": 0, "length": 5, "offset": 0}],\n-                            "inlineStyleRanges": [],\n-                            "key": "1bnna",\n-                            "text": "Volto is a React-based frontend for content management systems, currently supporting three backend implementations: Plone, Guillotina and a NodeJS reference implementation.",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {\n-                        "0": {\n-                            "data": {\n-                                "href": "https://github.com/plone/volto",\n-                                "url": "https://github.com/plone/volto",\n-                            },\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        }\n-                    },\n-                },\n-            },\n-            "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "55n44",\n-                            "text": "You can use this site to test Volto. It runs on the master branch of Volto using latest Plone 5.2 Backend running on Python 3.",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 5, "offset": 10, "style": "BOLD"}\n-                            ],\n-                            "key": "buncq",\n-                            "text": "password: admin",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "f0prj",\n-                            "text": "2020 - Volto Team - Plone Foundation",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "effbdcdc-253c-41a7-841e-5edb3b56ce32": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [{"key": 0, "length": 10, "offset": 36}],\n-                            "inlineStyleRanges": [],\n-                            "key": "68rve",\n-                            "text": "Volto also supports other APIs like Guillotina, a Python resource management system, inspired by Plone and using the same basic concepts like traversal, content types and permissions model.",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {\n-                        "0": {\n-                            "data": {\n-                                "href": "https://guillotina.io/",\n-                                "rel": "nofollow",\n-                                "url": "https://guillotina.io/",\n-                            },\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        }\n-                    },\n-                },\n-            },\n-        }\n-\n-        blocks_layout = {\n-            "items": [\n-                "07c273fc-8bfc-4e7d-a327-d513e5a945bb",\n-                "0358abe2-b4f1-463d-a279-a63ea80daf19",\n-                "b3717238-448f-406e-b06f-57a9715c3326",\n-                "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4",\n-                "effbdcdc-253c-41a7-841e-5edb3b56ce32",\n-                "942b6530-2407-420f-9c24-597adda6b2ce",\n-                "61cc1bc0-d4f5-4e2b-9152-79512045a4dd",\n-                "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28",\n-                "9a976b8e-72ba-468a-bea8-b37a31bb386b",\n-                "3c881f51-f75b-4959-834a-6e1d5edc32ae",\n-                "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c",\n-                "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226",\n-                "874049e7-629e-489a-b46c-1adf35ad40ee",\n-                "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6",\n-            ]\n-        }\n-\n-        portal.setTitle("Welcome to Volto!")\n-        portal.setDescription("The React powered content management system")\n-\n-        logger.info("Creating default homepage in Plone site root - not PAM enabled")\n-\n-    # Common part\n-    if not getattr(portal, "blocks", False):\n-        portal.manage_addProperty("blocks", json.dumps(blocks), "string")\n-\n-    if not getattr(portal, "blocks_layout", False):\n-        portal.manage_addProperty(\n-            "blocks_layout", json.dumps(blocks_layout), "string"\n-        )  # noqa\n+        blocks = home_data["blocks"]\n+        blocks_layout = home_data["blocks_layout"]\n+        portal.setTitle(home_data["title"])\n+        portal.setDescription(home_data["description"])\n \n+        # Use the hack for setting the home page in Plone Site object\n+        if not getattr(portal, "blocks", False):\n+            portal.manage_addProperty("blocks", json.dumps(blocks), "string")\n \n-def create_demo_homepage(context):\n-    demo_home_page = {\n-        "title": "Welcome to Plone 6!",\n-        "description": "Congratulations! You have successfully installed Plone.",\n-        "blocks": {\n-            "0358abe2-b4f1-463d-a279-a63ea80daf19": {"@type": "description"},\n-            "07c273fc-8bfc-4e7d-a327-d513e5a945bb": {"@type": "title"},\n-            "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 10, "offset": 0, "style": "BOLD"}\n-                            ],\n-                            "key": "6470b",\n-                            "text": "Disclaimer: This instance is reset every night, so all changes will be lost afterwards.",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "3c881f51-f75b-4959-834a-6e1d5edc32ae": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 5, "offset": 6, "style": "BOLD"}\n-                            ],\n-                            "key": "ekn3l",\n-                            "text": "user: admin",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "behki",\n-                            "text": "Plone is a powerful content management system built on a rock-solid application stack written using the Python programming language. More about these technologies:",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "5f7e6846-e27c-48c4-8c9a-f0d93eadb185": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "75pke",\n-                            "text": "\\u2026protects and promotes Plone.",\n-                            "type": "unordered-list-item",\n-                        },\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "2mo73",\n-                            "text": "\\u2026is a registered 501(c)(3) charitable organization.",\n-                            "type": "unordered-list-item",\n-                        },\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "9qhkg",\n-                            "text": "\\u2026donations are tax-deductible.",\n-                            "type": "unordered-list-item",\n-                        },\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [{"key": 0, "length": 50, "offset": 0}],\n-                            "inlineStyleRanges": [],\n-                            "key": "5528b",\n-                            "text": "Support the Foundation and help make Plone better!",\n-                            "type": "unordered-list-item",\n-                        },\n-                    ],\n-                    "entityMap": {\n-                        "0": {\n-                            "data": {"url": "https://plone.org/sponsors/be-a-hero"},\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        }\n-                    },\n-                },\n-            },\n-            "61cc1bc0-d4f5-4e2b-9152-79512045a4dd": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "9qsa4",\n-                            "text": "Demo",\n-                            "type": "header-two",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "874049e7-629e-489a-b46c-1adf35ad40ee": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "9pnjr",\n-                            "text": "Happy hacking!",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "8bba235c-7a52-4ce2-bde1-c505e5746dce": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "692gs",\n-                            "text": "Plone is made possible only through the efforts of thousands of dedicated individuals and hundreds of companies. The Plone Foundation:",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "942b6530-2407-420f-9c24-597adda6b2ce": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "6a248",\n-                            "text": "Support the Plone Foundation",\n-                            "type": "header-two",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "9a976b8e-72ba-468a-bea8-b37a31bb386b": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 12, "offset": 51, "style": "BOLD"}\n-                            ],\n-                            "key": "94arl",\n-                            "text": "You can log in and use it as admin user using these credentials:",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "b3717238-448f-406e-b06f-57a9715c3326": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "1bnna",\n-                            "text": "Find out more about Plone",\n-                            "type": "header-two",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "55n44",\n-                            "text": "You can use this site to test Plone 6. These are the versions used in this demo:",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [\n-                                {"length": 5, "offset": 10, "style": "BOLD"}\n-                            ],\n-                            "key": "buncq",\n-                            "text": "password: admin",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [],\n-                            "inlineStyleRanges": [],\n-                            "key": "f0prj",\n-                            "text": "2021 - Plone Foundation",\n-                            "type": "unstyled",\n-                        }\n-                    ],\n-                    "entityMap": {},\n-                },\n-            },\n-            "effbdcdc-253c-41a7-841e-5edb3b56ce32": {\n-                "@type": "text",\n-                "text": {\n-                    "blocks": [\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [{"key": 0, "length": 43, "offset": 4}],\n-                            "inlineStyleRanges": [],\n-                            "key": "68rve",\n-                            "text": "The Plone open source Content Management System web site for evaluators and decision makers.",\n-                            "type": "unordered-list-item",\n-                        },\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [{"key": 1, "length": 16, "offset": 4}],\n-                            "inlineStyleRanges": [],\n-                            "key": "4ec08",\n-                            "text": "The Plone community web site for developers.",\n-                            "type": "unordered-list-item",\n-                        },\n-                        {\n-                            "data": {},\n-                            "depth": 0,\n-                            "entityRanges": [{"key": 2, "length": 27, "offset": 4}],\n-                            "inlineStyleRanges": [],\n-                            "key": "4q5m2",\n-                            "text": "The Python programming language web site.",\n-                            "type": "unordered-list-item",\n-                        },\n-                    ],\n-                    "entityMap": {\n-                        "0": {\n-                            "data": {"url": "https://plone.com/"},\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        },\n-                        "1": {\n-                            "data": {"url": "https://plone.org/"},\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        },\n-                        "2": {\n-                            "data": {"url": "https://www.python.org/"},\n-                            "mutability": "MUTABLE",\n-                            "type": "LINK",\n-                        },\n-                    },\n-                },\n-            },\n-            "3b5ac7a5-2d98-423e-807c-5eebc0bf0054": {"@type": "system"},\n-        },\n-        "blocks_layout": {\n-            "items": [\n-                "07c273fc-8bfc-4e7d-a327-d513e5a945bb",\n-                "0358abe2-b4f1-463d-a279-a63ea80daf19",\n-                "b3717238-448f-406e-b06f-57a9715c3326",\n-                "5e1c30b1-ec6c-4dc0-9483-9768c3c416e4",\n-                "effbdcdc-253c-41a7-841e-5edb3b56ce32",\n-                "942b6530-2407-420f-9c24-597adda6b2ce",\n-                "8bba235c-7a52-4ce2-bde1-c505e5746dce",\n-                "5f7e6846-e27c-48c4-8c9a-f0d93eadb185",\n-                "61cc1bc0-d4f5-4e2b-9152-79512045a4dd",\n-                "c049ff8b-3e5a-4cfb-bca6-e4a6cca9be28",\n-                "3b5ac7a5-2d98-423e-807c-5eebc0bf0054",\n-                "9a976b8e-72ba-468a-bea8-b37a31bb386b",\n-                "3c881f51-f75b-4959-834a-6e1d5edc32ae",\n-                "c91f0fe9-f2e9-4a17-84a5-8e4f2678ed3c",\n-                "2dfe8e4c-5bf6-43f1-93e1-6c320ede7226",\n-                "874049e7-629e-489a-b46c-1adf35ad40ee",\n-                "e0ca2fbc-7800-4b9b-afe5-8e42af9f5dd6",\n-            ]\n-        },\n-    }\n+        if not getattr(portal, "blocks_layout", False):\n+            portal.manage_addProperty(\n+                "blocks_layout", json.dumps(blocks_layout), "string"\n+            )  # noqa\n \n+\n+def create_demo_homepage(context):\n     create_root_homepage(context, default_home=demo_home_page)\ndiff --git a/src/plone/volto/tests/test_setup.py b/src/plone/volto/tests/test_setup.py\nindex 4682038..bc4d0aa 100644\n--- a/src/plone/volto/tests/test_setup.py\n+++ b/src/plone/volto/tests/test_setup.py\n@@ -12,6 +12,15 @@\n \n import unittest\n \n+try:\n+    from Products.CMFPlone.factory import PLONE60MARKER\n+\n+    PLONE60MARKER  # pyflakes\n+except ImportError:\n+    PLONE_6 = False\n+else:\n+    PLONE_6 = True\n+\n \n class TestSetup(unittest.TestCase):\n     """Test that plone.volto is properly installed."""\n@@ -40,6 +49,24 @@ def test_browserlayer(self):\n \n         self.assertIn(IPloneVoltoCoreLayer, utils.registered_layers())\n \n+    @unittest.skipIf(\n+        not PLONE_6,\n+        "This test is only intended to run for Plone 6",\n+    )\n+    def test_plone_site_has_blocks_behavior(self):\n+        pt = api.portal.get_tool("portal_types")\n+        fti = pt.getTypeInfo("Plone Site")\n+\n+        self.assertTrue("volto.blocks" in fti.behaviors)\n+\n+    def test_plone_site_has_edit_action_setup(self):\n+        pt = api.portal.get_tool("portal_types")\n+        fti = pt.getTypeInfo("Plone Site")\n+\n+        action_obj = fti.getActionObject("object/edit")\n+        self.assertIsNotNone(action_obj)\n+        self.assertTrue("Modify portal content" in action_obj.permissions)\n+\n \n class TestUninstall(unittest.TestCase):\n \ndiff --git a/src/plone/volto/upgrades.py b/src/plone/volto/upgrades.py\nindex 7e1d695..26ad4f8 100644\n--- a/src/plone/volto/upgrades.py\n+++ b/src/plone/volto/upgrades.py\n@@ -1,6 +1,42 @@\n from copy import deepcopy\n from plone import api\n from plone.restapi.behaviors import IBlocks\n+from plone.volto import content\n+from plone.volto import logger\n+from plone.volto.setuphandlers import NO_RICHTEXT_BEHAVIOR_CONTENT_TYPES\n+from plone.volto.setuphandlers import remove_behavior\n+\n+\n+MIGRATION = {\n+    "Document": content.FolderishDocument,\n+    "Event": content.FolderishEvent,\n+    "News Item": content.FolderishNewsItem,\n+}\n+\n+\n+def migrate_content_classes(context):\n+    """Migrate content created with collective.folderishtypes to plone.volto."""\n+    interface = "collective.folderishtypes.interfaces.IFolderishType"\n+    idxs = [\n+        "object_provides",\n+    ]\n+    brains = api.content.find(object_provides=interface)\n+    total_brains = len(brains)\n+    logger.info(f"Migration: {total_brains} contents to be migrated.")\n+    for idx, brain in enumerate(brains):\n+        content = brain.getObject()\n+        content_id = content.getId()\n+        content.__class__ = MIGRATION[content.portal_type]\n+        parent = content.aq_parent\n+        parent._delOb(content_id)\n+        parent._setOb(content_id, content)\n+        content = parent[content_id]\n+        content.reindexObject(idxs=idxs)\n+\n+        if idx and idx % 100 == 0:\n+            logger.info(f"Migration: {idx + 1} / {total_brains}")\n+\n+    logger.info("Migration from collective.folderishtypes to plone.volto complete")\n \n \n def from12to13_migrate_listings(context):\n@@ -62,3 +98,8 @@ def migrate_listing(originBlocks):\n     for brain in pc.unrestrictedSearchResults(object_provides=IBlocks.__identifier__):\n         obj = brain.getObject()\n         obj.blocks = migrate_listing(obj.blocks)\n+\n+\n+def remove_plone_richtext_behavior(context):\n+    for type_ in NO_RICHTEXT_BEHAVIOR_CONTENT_TYPES:\n+        remove_behavior(type_, "plone.richtext")\ndiff --git a/src/plone/volto/upgrades.zcml b/src/plone/volto/upgrades.zcml\nindex 20052cb..c63d169 100644\n--- a/src/plone/volto/upgrades.zcml\n+++ b/src/plone/volto/upgrades.zcml\n@@ -22,11 +22,41 @@\n       />\n \n   <genericsetup:upgradeDepends\n-      title="Add blocks behavior to Event and News Item"\n+      title="Move from c.folderishtypes to local"\n       profile="plone.volto:default"\n       source="1012"\n       destination="1013"\n       import_steps="typeinfo"\n       />\n \n+  <genericsetup:upgradeStep\n+      title="Migrate existing content classes from old c.folderishtypes to local"\n+      profile="plone.volto:default"\n+      source="1013"\n+      destination="1014"\n+      handler=".upgrades.migrate_content_classes"\n+      />\n+\n+  <genericsetup:upgradeSteps\n+      profile="plone.volto:default"\n+      source="1014"\n+      destination="1015"\n+      >\n+    <genericsetup:upgradeDepends\n+        title="Update types info for Plone Site"\n+        import_steps="typeinfo"\n+        />\n+    <genericsetup:upgradeStep\n+        title="remove plone.richtext from Plone Site, Document, News Item, Event"\n+        handler=".upgrades.remove_plone_richtext_behavior"\n+        />\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeDepends\n+      title="Add blocks behavior to Event and News Item"\n+      profile="plone.volto:default"\n+      source="1015"\n+      destination="1016"\n+      import_steps="typeinfo"\n+  />\n </configure>\ndiff --git a/src/plone/volto/vocabularies/subject.py b/src/plone/volto/vocabularies/subject.py\nindex d6dfab6..862e892 100644\n--- a/src/plone/volto/vocabularies/subject.py\n+++ b/src/plone/volto/vocabularies/subject.py\n@@ -8,7 +8,7 @@\n from plone.app.layout.navigation.root import getNavigationRootObject\n from plone.app.vocabularies.terms import safe_encode\n from plone.registry.interfaces import IRegistry\n-from zope.site.hooks import getSite\n+from zope.component.hooks import getSite\n \n from BTrees.IIBTree import intersection\n from Products.CMFCore.utils import getToolByName\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2022-01-20T11:26:00+01:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/cbaa42fbe8855ca97fb1a4ed43e339dfd8885a55

Zpretty

Files changed:
M src/plone/volto/upgrades.zcml

b'diff --git a/src/plone/volto/upgrades.zcml b/src/plone/volto/upgrades.zcml\nindex c63d169..8348277 100644\n--- a/src/plone/volto/upgrades.zcml\n+++ b/src/plone/volto/upgrades.zcml\n@@ -58,5 +58,5 @@\n       source="1015"\n       destination="1016"\n       import_steps="typeinfo"\n-  />\n+      />\n </configure>\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2022-01-20T17:02:21+01:00
Author: Víctor Fernández de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/1b7739846ae5991a98d11f5af42581c5262edff4

Merge pull request #35 from plone/event_newsitem_blocks

Add blocks behavior on Event and NewsItem

Files changed:
M CHANGES.rst
M src/plone/volto/profiles/default/metadata.xml
M src/plone/volto/profiles/default/types.xml
M src/plone/volto/profiles/default/types/Event.xml
M src/plone/volto/profiles/default/types/News_Item.xml
M src/plone/volto/upgrades.zcml

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex a66917d..e6531b0 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -19,6 +19,12 @@ Changelog\n - Remove ``plone.richtext`` behavior from Plone Site, Document, News Item, Events\n   [sneridagh]\n \n+- Add blocks behavior on Event and NewsItem\n+  [nzambello]\n+\n+- Add preview_image to Event\n+  [nzambello]\n+\n 3.1.0a9 (2022-01-15)\n --------------------\n \ndiff --git a/src/plone/volto/profiles/default/metadata.xml b/src/plone/volto/profiles/default/metadata.xml\nindex 05c4a65..f746bae 100644\n--- a/src/plone/volto/profiles/default/metadata.xml\n+++ b/src/plone/volto/profiles/default/metadata.xml\n@@ -1,6 +1,6 @@\n <?xml version="1.0" encoding="UTF-8"?>\n <metadata>\n-  <version>1015</version>\n+  <version>1016</version>\n   <dependencies>\n     <dependency>profile-plone.restapi:blocks</dependency>\n   </dependencies>\ndiff --git a/src/plone/volto/profiles/default/types.xml b/src/plone/volto/profiles/default/types.xml\nindex 0120511..7c70ee9 100644\n--- a/src/plone/volto/profiles/default/types.xml\n+++ b/src/plone/volto/profiles/default/types.xml\n@@ -3,7 +3,7 @@\n   <object name="Plone Site" />\n   <object meta_type="Dexterity FTI" name="LRF" />\n   <object meta_type="Dexterity FTI" name="Document" />\n-  <object meta_type="Dexterity FTI" name="Collection" />\n-  <object meta_type="Dexterity FTI" name="News Item" />\n   <object meta_type="Dexterity FTI" name="Event" />\n+  <object meta_type="Dexterity FTI" name="News Item" />\n+  <object meta_type="Dexterity FTI" name="Collection" />\n </object>\ndiff --git a/src/plone/volto/profiles/default/types/Event.xml b/src/plone/volto/profiles/default/types/Event.xml\nindex b4bbde2..54317cd 100644\n--- a/src/plone/volto/profiles/default/types/Event.xml\n+++ b/src/plone/volto/profiles/default/types/Event.xml\n@@ -5,5 +5,7 @@\n   <property name="klass">plone.volto.content.FolderishEvent</property>\n   <property name="behaviors" purge="false">\n     <element value="plone.constraintypes"/>\n+    <element value="volto.blocks" />\n+    <element value="volto.preview_image" />\n   </property>\n </object>\ndiff --git a/src/plone/volto/profiles/default/types/News_Item.xml b/src/plone/volto/profiles/default/types/News_Item.xml\nindex f3dc922..66066c3 100644\n--- a/src/plone/volto/profiles/default/types/News_Item.xml\n+++ b/src/plone/volto/profiles/default/types/News_Item.xml\n@@ -5,5 +5,6 @@\n   <property name="klass">plone.volto.content.FolderishNewsItem</property>\n   <property name="behaviors" purge="false">\n     <element value="plone.constraintypes"/>\n+    <element value="volto.blocks" />\n   </property>\n </object>\ndiff --git a/src/plone/volto/upgrades.zcml b/src/plone/volto/upgrades.zcml\nindex 45eff5a..8348277 100644\n--- a/src/plone/volto/upgrades.zcml\n+++ b/src/plone/volto/upgrades.zcml\n@@ -51,4 +51,12 @@\n         handler=".upgrades.remove_plone_richtext_behavior"\n         />\n   </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeDepends\n+      title="Add blocks behavior to Event and News Item"\n+      profile="plone.volto:default"\n+      source="1015"\n+      destination="1016"\n+      import_steps="typeinfo"\n+      />\n </configure>\n'

