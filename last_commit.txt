Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-09-29T23:18:53+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/c1a41178b500c3cad6108a2ad075b68a0335f9a1

fix retrieving of portal object in setuphandlers

Files changed:
M plone/app/contenttypes/setuphandlers.py

diff --git a/plone/app/contenttypes/setuphandlers.py b/plone/app/contenttypes/setuphandlers.py
index 6b80966b..deb9320f 100644
--- a/plone/app/contenttypes/setuphandlers.py
+++ b/plone/app/contenttypes/setuphandlers.py
@@ -326,7 +326,7 @@ def configure_members_folder(portal, target_language):
 
 def step_import_content(context):
     """Create default content."""
-    portal = context.__parent__
+    portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
     create_frontpage(portal, target_language)
     create_news_topic(portal, target_language)
@@ -335,7 +335,7 @@ def step_import_content(context):
 
 
 def step_setup_various(context):
-    portal = context.__parent__
+    portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
     _setup_calendar(portal, locale)
     _setup_visible_ids(portal, target_language, locale)


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-09-30T09:24:30+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.contenttypes/commit/ed7bc5bfe77fb71f153cbf683e74a7e6262a3746

Merge pull request #430 from plone/thet-fixgetportal

fix retrieving of portal object in setuphandlers

Files changed:
M plone/app/contenttypes/setuphandlers.py

diff --git a/plone/app/contenttypes/setuphandlers.py b/plone/app/contenttypes/setuphandlers.py
index 6b80966b..deb9320f 100644
--- a/plone/app/contenttypes/setuphandlers.py
+++ b/plone/app/contenttypes/setuphandlers.py
@@ -326,7 +326,7 @@ def configure_members_folder(portal, target_language):
 
 def step_import_content(context):
     """Create default content."""
-    portal = context.__parent__
+    portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
     create_frontpage(portal, target_language)
     create_news_topic(portal, target_language)
@@ -335,7 +335,7 @@ def step_import_content(context):
 
 
 def step_setup_various(context):
-    portal = context.__parent__
+    portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
     _setup_calendar(portal, locale)
     _setup_visible_ids(portal, target_language, locale)


