Repository: plone.app.testing


Branch: refs/heads/master
Date: 2018-02-01T23:24:49+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.testing/commit/180f302dd2e45308ee725bc0f6fff23090febd49

Install and load zcml of CMFQuickInstallerTool only when importable.

It is on the way out.

Files changed:
M CHANGES.rst
M plone/app/testing/layers.py

diff --git a/CHANGES.rst b/CHANGES.rst
index c898fc1..2057fee 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,6 +10,9 @@ Breaking changes:
 
 New features:
 
+- Install and load zcml of CMFQuickInstallerTool only when importable.
+  [maurits]
+
 - Load negotiator from plone.i18n (PTS removed).
   [jensens, ksuess]
 
diff --git a/plone/app/testing/layers.py b/plone/app/testing/layers.py
index 0ee0e4e..fee631d 100644
--- a/plone/app/testing/layers.py
+++ b/plone/app/testing/layers.py
@@ -51,7 +51,6 @@ class PloneFixture(Layer):
         ('Products.PluginRegistry',              {'loadZCML': True}, ),
         ('Products.PlonePAS',                    {'loadZCML': True}, ),
 
-        ('Products.CMFQuickInstallerTool',       {'loadZCML': True}, ),
         ('Products.CMFFormController',           {'loadZCML': True}, ),
         ('Products.CMFDynamicViewFTI',           {'loadZCML': True}, ),
         ('Products.CMFPlacefulWorkflow',         {'loadZCML': True}, ),
@@ -85,6 +84,12 @@ class PloneFixture(Layer):
             ('Products.PasswordResetTool', {'loadZCML': True}, ),)
     except ImportError:
         pass
+    try:
+        import Products.CMFQuickInstallerTool  # noqa
+        products = products + (
+            ('Products.CMFQuickInstallerTool', {'loadZCML': True}, ),)
+    except ImportError:
+        pass
 
     # Extension profiles to be installed with site setup
     extensionProfiles = (


Repository: plone.app.testing


Branch: refs/heads/master
Date: 2018-02-06T10:46:45+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.testing/commit/bb25ef495e7ae249de198503e4c584f6d47a47fc

Merge pull request #47 from plone/load-qi-conditionally

Install and load zcml of CMFQuickInstallerTool only when importable.

Files changed:
M CHANGES.rst
M plone/app/testing/layers.py

diff --git a/CHANGES.rst b/CHANGES.rst
index c898fc1..2057fee 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,6 +10,9 @@ Breaking changes:
 
 New features:
 
+- Install and load zcml of CMFQuickInstallerTool only when importable.
+  [maurits]
+
 - Load negotiator from plone.i18n (PTS removed).
   [jensens, ksuess]
 
diff --git a/plone/app/testing/layers.py b/plone/app/testing/layers.py
index 0ee0e4e..fee631d 100644
--- a/plone/app/testing/layers.py
+++ b/plone/app/testing/layers.py
@@ -51,7 +51,6 @@ class PloneFixture(Layer):
         ('Products.PluginRegistry',              {'loadZCML': True}, ),
         ('Products.PlonePAS',                    {'loadZCML': True}, ),
 
-        ('Products.CMFQuickInstallerTool',       {'loadZCML': True}, ),
         ('Products.CMFFormController',           {'loadZCML': True}, ),
         ('Products.CMFDynamicViewFTI',           {'loadZCML': True}, ),
         ('Products.CMFPlacefulWorkflow',         {'loadZCML': True}, ),
@@ -85,6 +84,12 @@ class PloneFixture(Layer):
             ('Products.PasswordResetTool', {'loadZCML': True}, ),)
     except ImportError:
         pass
+    try:
+        import Products.CMFQuickInstallerTool  # noqa
+        products = products + (
+            ('Products.CMFQuickInstallerTool', {'loadZCML': True}, ),)
+    except ImportError:
+        pass
 
     # Extension profiles to be installed with site setup
     extensionProfiles = (


