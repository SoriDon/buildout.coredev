Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:38:31+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/52415239c6303f78a10c1de2823acb2492c4169c

Configuring with plone/meta

Files changed:
A .editorconfig
A .meta.toml
A .pre-commit-config.yaml
A news/3333c742.internal
A tox.ini
M pyproject.toml
M setup.cfg

b'diff --git a/.editorconfig b/.editorconfig\nnew file mode 100644\nindex 00000000..b4158b89\n--- /dev/null\n+++ b/.editorconfig\n@@ -0,0 +1,39 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+#\n+# EditorConfig Configuration file, for more details see:\n+# http://EditorConfig.org\n+# EditorConfig is a convention description, that could be interpreted\n+# by multiple editors to enforce common coding conventions for specific\n+# file types\n+\n+# top-most EditorConfig file:\n+# Will ignore other EditorConfig files in Home directory or upper tree level.\n+root = true\n+\n+\n+[*]  # For All Files\n+# Unix-style newlines with a newline ending every file\n+end_of_line = lf\n+insert_final_newline = true\n+trim_trailing_whitespace = true\n+# Set default charset\n+charset = utf-8\n+# Indent style default\n+indent_style = space\n+# Max Line Length - a hard line wrap, should be disabled\n+max_line_length = off\n+\n+[*.{py,cfg,ini}]\n+# 4 space indentation\n+indent_size = 4\n+\n+[*.{yml,zpt,pt,dtml,zcml}]\n+# 2 space indentation\n+indent_size = 2\n+\n+[{Makefile,.gitmodules}]\n+# Tab indentation (no size specified, but view as 4 spaces)\n+indent_style = tab\n+indent_size = unset\n+tab_width = unset\ndiff --git a/.meta.toml b/.meta.toml\nnew file mode 100644\nindex 00000000..d915ae98\n--- /dev/null\n+++ b/.meta.toml\n@@ -0,0 +1,5 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+[meta]\n+template = "default"\n+commit-id = "3333c742"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 00000000..fdafec1c\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,42 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.3.1\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.12.0\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 23.3.0\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.0.3\n+    hooks:\n+    -   id: zpretty\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 6.0.0\n+    hooks:\n+    -   id: flake8\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.4\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\ndiff --git a/news/3333c742.internal b/news/3333c742.internal\nnew file mode 100644\nindex 00000000..c08f5399\n--- /dev/null\n+++ b/news/3333c742.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615de..9eb73f3c 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,3 +1,5 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [tool.towncrier]\n filename = "CHANGES.rst"\n directory = "news/"\n@@ -18,3 +20,43 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+[tool.isort]\n+profile = "plone"\n+\n+[tool.black]\n+target-version = ["py38"]\n+\n+[tool.dependencychecker]\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # Zope dependencies\n+  \'Acquisition\', \'DateTime\', \'transaction\', \'zExceptions\', \'ZODB\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.deferredimport\', \'zope.event\',\n+  \'zope.exceptions\', \'zope.globalrequest\', \'zope.i18n\', \'zope.i18nmessageid\',\n+  \'zope.interface\', \'zope.lifecycleevent\', \'zope.location\', \'zope.publisher\',\n+  \'zope.schema\', \'zope.security\', \'zope.site\', \'zope.traversing\', \'AccessControl\',\n+]\n+\'plone.base\' = [\n+  \'AccessControl\', \'Products.BTreeFolder2\', \'Products.CMFCore\',\n+  \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n+]\n+python-dateutil = [\'dateutil\']\ndiff --git a/setup.cfg b/setup.cfg\nindex 965bc82c..0da8f8fb 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -1,9 +1,23 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [bdist_wheel]\n universal = 0\n \n-[isort]\n-# black compatible isort rules:\n-profile = black\n-force_alphabetical_sort = True\n-force_single_line = True\n-lines_after_imports = 2\n+[flake8]\n+doctests = 1\n+ignore =\n+    # black takes care of line length\n+    E501,\n+    # black takes care of where to break lines\n+    W503,\n+    # black takes care of spaces within slicing (list[:])\n+    E203,\n+    # black takes care of spaces after commas\n+    E231,\n+\n+[check-manifest]\n+ignore =\n+    .editorconfig\n+    .meta.toml\n+    .pre-commit-config.yaml\n+    tox.ini\ndiff --git a/tox.ini b/tox.ini\nnew file mode 100644\nindex 00000000..d9b6af75\n--- /dev/null\n+++ b/tox.ini\n@@ -0,0 +1,68 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+[tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n+envlist =\n+    format\n+    lint\n+    test\n+\n+[testenv]\n+allowlist_externals =\n+    sh\n+\n+[testenv:format]\n+description = automatically reformat code\n+skip_install = true\n+deps =\n+    pre-commit\n+commands =\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n+\n+[testenv:lint]\n+description = run linters that will help improve the code style\n+skip_install = true\n+deps =\n+    pre-commit\n+commands =\n+    pre-commit run -a\n+\n+[testenv:dependencies]\n+description = check if the package defines all its dependencies and generate a graph out of them\n+deps =\n+    z3c.dependencychecker==2.11\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n+commands =\n+    dependencychecker\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+\n+[testenv:test]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    zope-testrunner --all --test-path={toxinidir} -s Products.CMFEditions {posargs}\n+extras =\n+    test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s Products.CMFEditions {posargs}\n+    coverage report -m --format markdown\n+extras =\n+    test\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:39:27+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/a1d597d860332ee4000a1b8abe1cc45e3a782107

chore: pyupgrade

Files changed:
M Products/CMFEditions/browser/policies.py

b'diff --git a/Products/CMFEditions/browser/policies.py b/Products/CMFEditions/browser/policies.py\nindex be4af48..3daf624 100644\n--- a/Products/CMFEditions/browser/policies.py\n+++ b/Products/CMFEditions/browser/policies.py\n@@ -36,7 +36,7 @@ def __call__(self):\n             "url"\n         ]\n         if obj_type_view_url != "/":\n-            view_url = "%s/%s" % (self.context.absolute_url(), obj_type_view_url)\n+            view_url = f"{self.context.absolute_url()}/{obj_type_view_url}"\n         else:\n             view_url = self.context.absolute_url()\n \n@@ -44,7 +44,7 @@ def __call__(self):\n             try:\n                 commit_msg = translate(\n                     _(\n-                        u"Reverted to revision ${version}",\n+                        "Reverted to revision ${version}",\n                         mapping={"version": version_id},\n                     ),\n                     context=self.request,\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:39:39+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/488670528664476d2c718713379020607fb886fc

chore: isort

Files changed:
M Products/CMFEditions/CopyModifyMergeRepositoryTool.py
M Products/CMFEditions/tests/test_ContentTypes.py
M Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py

b'diff --git a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\nindex 3405a9a..57f2c7a 100644\n--- a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n+++ b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n@@ -31,6 +31,7 @@\n from Acquisition import ImplicitAcquisitionWrapper\n from BTrees.OOBTree import OOBTree\n from OFS.SimpleItem import SimpleItem\n+from plone.locking.interfaces import ILockable\n from Products.CMFCore.utils import _checkPermission\n from Products.CMFCore.utils import getToolByName\n from Products.CMFCore.utils import UniqueObject\n@@ -55,7 +56,6 @@\n from Products.CMFEditions.VersionPolicies import VersionPolicy\n from ZODB.broken import Broken\n from zope.interface import implementer\n-from plone.locking.interfaces import ILockable\n \n import logging\n import time\ndiff --git a/Products/CMFEditions/tests/test_ContentTypes.py b/Products/CMFEditions/tests/test_ContentTypes.py\nindex df7e158..c0e05c1 100644\n--- a/Products/CMFEditions/tests/test_ContentTypes.py\n+++ b/Products/CMFEditions/tests/test_ContentTypes.py\n@@ -1,9 +1,9 @@\n from plone.app.textfield.value import RichTextValue\n+from plone.base.utils import unrestricted_construct_instance\n from plone.namedfile.file import NamedBlobFile\n from plone.namedfile.file import NamedBlobImage\n from Products.CMFEditions import PACKAGE_HOME\n from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase\n-from plone.base.utils import unrestricted_construct_instance\n \n import os\n \ndiff --git a/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py b/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py\nindex 14b3775..4009245 100644\n--- a/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py\n+++ b/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py\n@@ -25,6 +25,8 @@\n \n from .DummyTools import DummyArchivist\n from .DummyTools import notifyModified\n+from plone.locking.interfaces import ILockable\n+from plone.locking.interfaces import ITTWLockable\n from Products.CMFEditions.interfaces.IRepository import IContentTypeVersionPolicySupport\n from Products.CMFEditions.interfaces.IRepository import ICopyModifyMergeRepository\n from Products.CMFEditions.interfaces.IRepository import IPurgeSupport\n@@ -32,10 +34,8 @@\n from Products.CMFEditions.interfaces.IRepository import RepositoryPurgeError\n from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase\n from Products.CMFEditions.VersionPolicies import VersionPolicy\n-from zope.interface.verify import verifyObject\n from zope.interface import alsoProvides\n-from plone.locking.interfaces import ILockable\n-from plone.locking.interfaces import ITTWLockable\n+from zope.interface.verify import verifyObject\n \n import transaction\n \n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:39:57+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/3a035fe8c833ad02ef60f893ca19a8753f1a4ae4

chore: black

Files changed:
M Products/CMFEditions/ArchivistTool.py
M Products/CMFEditions/CopyModifyMergeRepositoryTool.py
M Products/CMFEditions/StandardModifiers.py
M Products/CMFEditions/browser/diff.py
M Products/CMFEditions/browser/views.py
M Products/CMFEditions/testing.py

b'diff --git a/Products/CMFEditions/ArchivistTool.py b/Products/CMFEditions/ArchivistTool.py\nindex eb4029e..3725cd7 100644\n--- a/Products/CMFEditions/ArchivistTool.py\n+++ b/Products/CMFEditions/ArchivistTool.py\n@@ -445,7 +445,6 @@ def __init__(\n         is_registered,\n         approxSize,\n     ):\n-\n         # parent reference (register the parent with the unique id handler)\n         # register with sys_metadata as there is no other possibility\n         obj = original.object\ndiff --git a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\nindex 57f2c7a..d46be66 100644\n--- a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n+++ b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n@@ -724,6 +724,7 @@ def _unlock(self, obj):\n         if lockable:\n             lockable.unlock()\n \n+\n @implementer(IVersionData)\n class VersionData:\n     """ """\ndiff --git a/Products/CMFEditions/StandardModifiers.py b/Products/CMFEditions/StandardModifiers.py\nindex d196164..f1878ff 100644\n--- a/Products/CMFEditions/StandardModifiers.py\n+++ b/Products/CMFEditions/StandardModifiers.py\n@@ -650,7 +650,6 @@ def getReferencedAttributes(self, obj):\n         return {"data": getattr(aq_base(obj), "data", None)}\n \n     def reattachReferencedAttributes(self, obj, attrs_dict):\n-\n         obj = aq_base(obj)\n         for name, attr_value in attrs_dict.items():\n             setattr(obj, name, attr_value)\ndiff --git a/Products/CMFEditions/browser/diff.py b/Products/CMFEditions/browser/diff.py\nindex 7143434..d96ae43 100644\n--- a/Products/CMFEditions/browser/diff.py\n+++ b/Products/CMFEditions/browser/diff.py\n@@ -6,7 +6,6 @@\n \n \n class DiffView(BrowserView):\n-\n     def __init__(self, *args):\n         super().__init__(*args)\n         self.repo_tool = getToolByName(self.context, "portal_repository")\ndiff --git a/Products/CMFEditions/browser/views.py b/Products/CMFEditions/browser/views.py\nindex 0fa4fb3..0d4c9c3 100644\n--- a/Products/CMFEditions/browser/views.py\n+++ b/Products/CMFEditions/browser/views.py\n@@ -19,7 +19,6 @@\n )\n \n \n-\n class UpdateVersionOnEditView(BrowserView):\n     def success(self):\n         self.request.response.redirect("view")\ndiff --git a/Products/CMFEditions/testing.py b/Products/CMFEditions/testing.py\nindex 3bdab1f..7e8c29f 100644\n--- a/Products/CMFEditions/testing.py\n+++ b/Products/CMFEditions/testing.py\n@@ -10,7 +10,6 @@\n \n \n class ProductsCmfeditionsLayer(PloneSandboxLayer):\n-\n     defaultBases = (PLONE_APP_CONTENTTYPES_FIXTURE,)\n \n     def setUpZope(self, app, configurationContext):\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:40:22+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/918bfe78f2b421c9fdb7abfad3180da11c532b7b

chore: zpretty ZXML/XML

Files changed:
M Products/CMFEditions/browser/configure.zcml
M Products/CMFEditions/configure.zcml
M Products/CMFEditions/exportimport/configure.zcml
M Products/CMFEditions/permissions.zcml
M Products/CMFEditions/profiles.zcml
M Products/CMFEditions/profiles/default/catalog.xml
M Products/CMFEditions/profiles/default/componentregistry.xml
M Products/CMFEditions/profiles/default/metadata.xml
M Products/CMFEditions/profiles/default/repositorytool.xml
M Products/CMFEditions/profiles/default/rolemap.xml
M Products/CMFEditions/profiles/default/toolset.xml

b'diff --git a/Products/CMFEditions/browser/configure.zcml b/Products/CMFEditions/browser/configure.zcml\nindex ffe9c05..76c65e4 100644\n--- a/Products/CMFEditions/browser/configure.zcml\n+++ b/Products/CMFEditions/browser/configure.zcml\n@@ -1,100 +1,101 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n-    xmlns:browser="http://namespaces.zope.org/browser">\n+    xmlns:browser="http://namespaces.zope.org/browser"\n+    >\n \n-    <browser:page\n-        for="*"\n-        name="history"\n-        class=".diff.DiffView"\n-        template="templates/diff.pt"\n-        permission="CMFEditions.AccessPreviousVersions"\n-        />\n+  <browser:page\n+      name="history"\n+      for="*"\n+      class=".diff.DiffView"\n+      template="templates/diff.pt"\n+      permission="CMFEditions.AccessPreviousVersions"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="get_macros"\n-        class=".utils.GetMacros"\n-        attribute="get_macros"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="get_macros"\n+      for="*"\n+      class=".utils.GetMacros"\n+      attribute="get_macros"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="update_version_on_edit"\n-        class=".views.UpdateVersionOnEditView"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="update_version_on_edit"\n+      for="*"\n+      class=".views.UpdateVersionOnEditView"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="update_version_before_edit"\n-        class=".views.UpdateVersionBeforeEditView"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="update_version_before_edit"\n+      for="*"\n+      class=".views.UpdateVersionBeforeEditView"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="version_file_view"\n-        template="templates/version_file_view.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="version_file_view"\n+      for="*"\n+      template="templates/version_file_view.pt"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="version_image_view"\n-        template="templates/version_image_view.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="version_image_view"\n+      for="*"\n+      template="templates/version_image_view.pt"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="version_metadata_view"\n-        template="templates/version_metadata_view.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="version_metadata_view"\n+      for="*"\n+      template="templates/version_metadata_view.pt"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="saveasnewversion"\n-        class=".policies.SaveAsNewVersion"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="saveasnewversion"\n+      for="*"\n+      class=".policies.SaveAsNewVersion"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="revertversion"\n-        class=".policies.RevertVersion"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="revertversion"\n+      for="*"\n+      class=".policies.RevertVersion"\n+      permission="zope2.View"\n+      />\n \n-    <!-- Note: this is also used by plone.app.iterate -->\n-    <browser:page\n-        for="*"\n-        name="diff_legend"\n-        template="templates/diff_legend.pt"\n-        permission="zope2.View"\n-        />\n+  <!-- Note: this is also used by plone.app.iterate -->\n+  <browser:page\n+      name="diff_legend"\n+      for="*"\n+      template="templates/diff_legend.pt"\n+      permission="zope2.View"\n+      />\n \n-    <!-- Note: this is roughly the same as @@historyview in plone.app.layout\n+  <!-- Note: this is roughly the same as @@historyview in plone.app.layout\n          which is a small wrapper around @@contenthistory in plone.app.layout,\n          which is a viewlet turned into a view.  Their version looks nicer.\n          But our versions_history_form has a preview (which contenthistory points to)\n          and a form to add a new version, if the policy is manual. -->\n-    <browser:page\n-        for="*"\n-        name="versions_history_form"\n-        class=".views.VersionsHistoryForm"\n-        template="templates/versions_history_form.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="versions_history_form"\n+      for="*"\n+      class=".views.VersionsHistoryForm"\n+      template="templates/versions_history_form.pt"\n+      permission="zope2.View"\n+      />\n \n-    <!-- We could make this a resource, but then we need to change plone.app.iterate as well.\n+  <!-- We could make this a resource, but then we need to change plone.app.iterate as well.\n          So for now make it a browser view. -->\n-    <browser:page\n-        for="*"\n-        name="compare.css"\n-        class=".views.CompareCSS"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="compare.css"\n+      for="*"\n+      class=".views.CompareCSS"\n+      permission="zope2.View"\n+      />\n \n </configure>\ndiff --git a/Products/CMFEditions/configure.zcml b/Products/CMFEditions/configure.zcml\nindex f208b02..8d51698 100644\n--- a/Products/CMFEditions/configure.zcml\n+++ b/Products/CMFEditions/configure.zcml\n@@ -1,8 +1,10 @@\n-<configure xmlns="http://namespaces.zope.org/zope"\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n     xmlns:i18n="http://namespaces.zope.org/i18n"\n-    i18n_domain="cmfeditions">\n+    i18n_domain="cmfeditions"\n+    >\n \n-  <include file="permissions.zcml"/>\n+  <include file="permissions.zcml" />\n \n   <include package="Products.CMFUid" />\n   <!-- provides hooks for zope.copy -->\n@@ -10,15 +12,19 @@\n   <include package=".browser" />\n   <include package=".exportimport" />\n \n-  <include file="profiles.zcml"/>\n+  <include file="profiles.zcml" />\n \n \n-  <subscriber for=".interfaces.IVersioned\n-                   zope.lifecycleevent.interfaces.IObjectCopiedEvent"\n-              handler=".ArchivistTool.object_copied" />\n+  <subscriber\n+      for=".interfaces.IVersioned\n+           zope.lifecycleevent.interfaces.IObjectCopiedEvent"\n+      handler=".ArchivistTool.object_copied"\n+      />\n \n-  <subscriber for="*\n-                   zope.lifecycleevent.interfaces.IObjectRemovedEvent"\n-              handler=".subscriber.object_removed" />\n+  <subscriber\n+      for="*\n+           zope.lifecycleevent.interfaces.IObjectRemovedEvent"\n+      handler=".subscriber.object_removed"\n+      />\n \n </configure>\ndiff --git a/Products/CMFEditions/exportimport/configure.zcml b/Products/CMFEditions/exportimport/configure.zcml\nindex 170fd8b..88f4028 100644\n--- a/Products/CMFEditions/exportimport/configure.zcml\n+++ b/Products/CMFEditions/exportimport/configure.zcml\n@@ -1,12 +1,15 @@\n-<configure xmlns="http://namespaces.zope.org/zope"\n-           xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n-           i18n_domain="cmfeditions">\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n+    i18n_domain="cmfeditions"\n+    >\n \n   <genericsetup:importStep\n       name="cmfeditions_various"\n-      handler="Products.CMFEditions.setuphandlers.importVarious"\n       title="Various CMFEditions Settings"\n-      description="CMFEditions specific settings">\n+      description="CMFEditions specific settings"\n+      handler="Products.CMFEditions.setuphandlers.importVarious"\n+      >\n     <depends name="toolset" />\n     <depends name="typeinfo" />\n   </genericsetup:importStep>\n@@ -23,7 +26,8 @@\n       name="repositorytool"\n       title="CMFEditions Repository Tool"\n       description="Import repository tool\'s settings."\n-      handler=".repository.importRepositoryTool">\n+      handler=".repository.importRepositoryTool"\n+      >\n     <depends name="toolset" />\n     <depends name="typeinfo" />\n     <depends name="cmfeditions_various" />\ndiff --git a/Products/CMFEditions/permissions.zcml b/Products/CMFEditions/permissions.zcml\nindex da6e951..5ce3c86 100644\n--- a/Products/CMFEditions/permissions.zcml\n+++ b/Products/CMFEditions/permissions.zcml\n@@ -6,31 +6,30 @@\n   <permission\n       id="CMFEditions.AccessPreviousVersions"\n       title="CMFEditions: Access previous versions"\n-  />\n+      />\n   <permission\n       id="CMFEditions.RevertToPreviousVersions"\n       title="CMFEditions: Revert to previous versions"\n-  />\n+      />\n   <permission\n       id="CMFEditions.ApplyVersionControl"\n       title="CMFEditions: Apply version control"\n-  />\n+      />\n   <permission\n       id="CMFEditions.SaveNewVersion"\n       title="CMFEditions: Save new version"\n-  />\n+      />\n   <permission\n       id="CMFEditions.PurgeVersion"\n       title="CMFEditions: Purge version"\n-  />\n+      />\n   <permission\n       id="CMFEditions.CheckoutToLocation"\n       title="CMFEditions: Checkout to location"\n-  />\n+      />\n   <permission\n       id="CMFEditions.ManagVersioningPolicies"\n       title="CMFEditions: Manage versioning policies"\n-  />\n+      />\n \n </configure>\n-\ndiff --git a/Products/CMFEditions/profiles.zcml b/Products/CMFEditions/profiles.zcml\nindex bafc103..ac118d6 100644\n--- a/Products/CMFEditions/profiles.zcml\n+++ b/Products/CMFEditions/profiles.zcml\n@@ -1,53 +1,61 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n-    i18n_domain="cmfeditions">\n+    i18n_domain="cmfeditions"\n+    >\n \n   <genericsetup:registerProfile\n       name="CMFEditions"\n       title="CMFEditions"\n-      directory="profiles/default"\n       description="Extension profile for default CMFEditions setup."\n       provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/default"\n       />\n \n-    <genericsetup:upgradeSteps\n-        source="2.0"\n-        destination="3"\n-        profile="Products.CMFEditions:CMFEditions">\n-\n-        <genericsetup:upgradeDepends\n-           title="Fix portal_historyidhandler"\n-           import_steps="toolset"\n-          />\n-\n-    </genericsetup:upgradeSteps>\n-\n-    <genericsetup:upgradeSteps\n-        source="3"\n-        destination="4"\n-        profile="Products.CMFEditions:CMFEditions">\n-        <genericsetup:upgradeStep\n-           title="Install the component registry bases modifier."\n-           handler=".setuphandlers.installSkipRegistryBasesPointersModifier" />\n-    </genericsetup:upgradeSteps>\n-\n-    <genericsetup:upgradeSteps\n-        source="4"\n-        destination="10"\n-        profile="Products.CMFEditions:CMFEditions">\n-        <genericsetup:upgradeStep\n-           title="Remove old broken Archetypes modifiers."\n-           handler=".setuphandlers.removeBrokenModifiers" />\n-    </genericsetup:upgradeSteps>\n-\n-    <genericsetup:upgradeSteps\n-        source="10"\n-        destination="11"\n-        profile="Products.CMFEditions:CMFEditions">\n-        <genericsetup:upgradeStep\n-           title="Remove CMFEditions skin layer"\n-           handler=".setuphandlers.removeSkinLayer" />\n-    </genericsetup:upgradeSteps>\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="2.0"\n+      destination="3"\n+      >\n+\n+    <genericsetup:upgradeDepends\n+        title="Fix portal_historyidhandler"\n+        import_steps="toolset"\n+        />\n+\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="3"\n+      destination="4"\n+      >\n+    <genericsetup:upgradeStep\n+        title="Install the component registry bases modifier."\n+        handler=".setuphandlers.installSkipRegistryBasesPointersModifier"\n+        />\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="4"\n+      destination="10"\n+      >\n+    <genericsetup:upgradeStep\n+        title="Remove old broken Archetypes modifiers."\n+        handler=".setuphandlers.removeBrokenModifiers"\n+        />\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="10"\n+      destination="11"\n+      >\n+    <genericsetup:upgradeStep\n+        title="Remove CMFEditions skin layer"\n+        handler=".setuphandlers.removeSkinLayer"\n+        />\n+  </genericsetup:upgradeSteps>\n \n </configure>\ndiff --git a/Products/CMFEditions/profiles/default/catalog.xml b/Products/CMFEditions/profiles/default/catalog.xml\nindex 292ec23..6da5cc0 100644\n--- a/Products/CMFEditions/profiles/default/catalog.xml\n+++ b/Products/CMFEditions/profiles/default/catalog.xml\n@@ -1,7 +1,11 @@\n-<?xml version="1.0"?>\n-<object name="portal_catalog" meta_type="CMF Catalog">\n- <index name="cmf_uid" meta_type="FieldIndex">\n-  <indexed_attr value="cmf_uid"/>\n- </index>\n- <column value="cmf_uid"/>\n+<?xml version="1.0" encoding="utf-8"?>\n+<object meta_type="CMF Catalog"\n+        name="portal_catalog"\n+>\n+  <index meta_type="FieldIndex"\n+         name="cmf_uid"\n+  >\n+    <indexed_attr value="cmf_uid" />\n+  </index>\n+  <column value="cmf_uid" />\n </object>\ndiff --git a/Products/CMFEditions/profiles/default/componentregistry.xml b/Products/CMFEditions/profiles/default/componentregistry.xml\nindex 8d48b6e..751c1d8 100644\n--- a/Products/CMFEditions/profiles/default/componentregistry.xml\n+++ b/Products/CMFEditions/profiles/default/componentregistry.xml\n@@ -1,12 +1,12 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <componentregistry>\n- <adapters/>\n- <utilities>\n-  <utility\n-     interface="Products.CMFUid.interfaces.IUniqueIdAnnotationManagement"\n-     object="portal_uidannotation"/>\n-  <utility\n-     interface="Products.CMFUid.interfaces.IUniqueIdGenerator"\n-     object="portal_uidgenerator"/>\n- </utilities>\n+  <adapters />\n+  <utilities>\n+    <utility interface="Products.CMFUid.interfaces.IUniqueIdAnnotationManagement"\n+             object="portal_uidannotation"\n+    />\n+    <utility interface="Products.CMFUid.interfaces.IUniqueIdGenerator"\n+             object="portal_uidgenerator"\n+    />\n+  </utilities>\n </componentregistry>\ndiff --git a/Products/CMFEditions/profiles/default/metadata.xml b/Products/CMFEditions/profiles/default/metadata.xml\nindex 295a9a2..8ecf4ba 100644\n--- a/Products/CMFEditions/profiles/default/metadata.xml\n+++ b/Products/CMFEditions/profiles/default/metadata.xml\n@@ -1,4 +1,4 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <metadata>\n   <version>11</version>\n </metadata>\ndiff --git a/Products/CMFEditions/profiles/default/repositorytool.xml b/Products/CMFEditions/profiles/default/repositorytool.xml\nindex 9b65952..08130c9 100644\n--- a/Products/CMFEditions/profiles/default/repositorytool.xml\n+++ b/Products/CMFEditions/profiles/default/repositorytool.xml\n@@ -1,27 +1,30 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <repositorytool>\n- <policies purge="true">\n-  <policy name="at_edit_autoversion"\n-     title="Create version on edit (AT objects only)"\n-     class="Products.CMFEditions.VersionPolicies.ATVersionOnEditPolicy"/>\n-  <policy name="version_on_revert" title="Create version on version revert"/>\n- </policies>\n- <policymap purge="true">\n-  <type name="Document">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n-  <type name="Event">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n-  <type name="Link">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n-  <type name="News Item">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n- </policymap>\n+  <policies purge="true">\n+    <policy class="Products.CMFEditions.VersionPolicies.ATVersionOnEditPolicy"\n+            name="at_edit_autoversion"\n+            title="Create version on edit (AT objects only)"\n+    />\n+    <policy name="version_on_revert"\n+            title="Create version on version revert"\n+    />\n+  </policies>\n+  <policymap purge="true">\n+    <type name="Document">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+    <type name="Event">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+    <type name="Link">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+    <type name="News Item">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+  </policymap>\n </repositorytool>\ndiff --git a/Products/CMFEditions/profiles/default/rolemap.xml b/Products/CMFEditions/profiles/default/rolemap.xml\nindex 0db2272..1c59796 100644\n--- a/Products/CMFEditions/profiles/default/rolemap.xml\n+++ b/Products/CMFEditions/profiles/default/rolemap.xml\n@@ -1,47 +1,52 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <rolemap>\n   <permissions>\n-    <permission name="CMFEditions: Access previous versions"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Access previous versions"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n       <role name="Contributor" />\n     </permission>\n-    <permission name="CMFEditions: Apply version control"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Apply version control"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n       <role name="Contributor" />\n     </permission>\n-    <permission name="CMFEditions: Checkout to location"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Checkout to location"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n     </permission>\n-    <permission name="CMFEditions: Revert to previous versions"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Revert to previous versions"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n     </permission>\n-    <permission name="CMFEditions: Save new version"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Save new version"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n       <role name="Contributor" />\n     </permission>\n   </permissions>\ndiff --git a/Products/CMFEditions/profiles/default/toolset.xml b/Products/CMFEditions/profiles/default/toolset.xml\nindex 30f7017..d5943be 100644\n--- a/Products/CMFEditions/profiles/default/toolset.xml\n+++ b/Products/CMFEditions/profiles/default/toolset.xml\n@@ -1,23 +1,33 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <tool-setup>\n- <required tool_id="portal_archivist"\n-           class="Products.CMFEditions.ArchivistTool.ArchivistTool"/>\n- <required tool_id="portal_repository"\n-           class="Products.CMFEditions.CopyModifyMergeRepositoryTool.CopyModifyMergeRepositoryTool"/>\n- <required tool_id="portal_historyidhandler"\n-           class="Products.CMFEditions.historyidhandlertool.HistoryIdHandlerTool"/>\n- <required tool_id="portal_purgepolicy"\n-           class="Products.CMFEditions.KeepLastNVersionsTool.KeepLastNVersionsTool"/>\n- <required tool_id="portal_modifier"\n-           class="Products.CMFEditions.ModifierRegistryTool.ModifierRegistryTool"/>\n- <required tool_id="portal_referencefactories"\n-           class="Products.CMFEditions.ReferenceFactoriesTool.ReferenceFactoriesTool"/>\n- <required tool_id="portal_historiesstorage"\n-           class="Products.CMFEditions.ZVCStorageTool.ZVCStorageTool"/>\n- <required tool_id="portal_uidannotation"\n-           class="Products.CMFUid.UniqueIdAnnotationTool.UniqueIdAnnotationTool"/>\n- <required tool_id="portal_uidgenerator"\n-           class="Products.CMFUid.UniqueIdGeneratorTool.UniqueIdGeneratorTool"/>\n- <required tool_id="portal_uidhandler"\n-           class="Products.CMFUid.UniqueIdHandlerTool.UniqueIdHandlerTool"/>\n+  <required class="Products.CMFEditions.ArchivistTool.ArchivistTool"\n+            tool_id="portal_archivist"\n+  />\n+  <required class="Products.CMFEditions.CopyModifyMergeRepositoryTool.CopyModifyMergeRepositoryTool"\n+            tool_id="portal_repository"\n+  />\n+  <required class="Products.CMFEditions.historyidhandlertool.HistoryIdHandlerTool"\n+            tool_id="portal_historyidhandler"\n+  />\n+  <required class="Products.CMFEditions.KeepLastNVersionsTool.KeepLastNVersionsTool"\n+            tool_id="portal_purgepolicy"\n+  />\n+  <required class="Products.CMFEditions.ModifierRegistryTool.ModifierRegistryTool"\n+            tool_id="portal_modifier"\n+  />\n+  <required class="Products.CMFEditions.ReferenceFactoriesTool.ReferenceFactoriesTool"\n+            tool_id="portal_referencefactories"\n+  />\n+  <required class="Products.CMFEditions.ZVCStorageTool.ZVCStorageTool"\n+            tool_id="portal_historiesstorage"\n+  />\n+  <required class="Products.CMFUid.UniqueIdAnnotationTool.UniqueIdAnnotationTool"\n+            tool_id="portal_uidannotation"\n+  />\n+  <required class="Products.CMFUid.UniqueIdGeneratorTool.UniqueIdGeneratorTool"\n+            tool_id="portal_uidgenerator"\n+  />\n+  <required class="Products.CMFUid.UniqueIdHandlerTool.UniqueIdHandlerTool"\n+            tool_id="portal_uidhandler"\n+  />\n </tool-setup>\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:43:10+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/3ce2670d015319d3fd50b0a6d6b3faf9bbe6da7f

chore: zpretty PT

Files changed:
M Products/CMFEditions/browser/templates/diff.pt
M Products/CMFEditions/browser/templates/diff_legend.pt
M Products/CMFEditions/browser/templates/version_file_view.pt
M Products/CMFEditions/browser/templates/version_image_view.pt
M Products/CMFEditions/browser/templates/version_metadata_view.pt
M Products/CMFEditions/browser/templates/versions_history_form.pt
M Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt
M Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt
M Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt
M Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt
M Products/CMFEditions/www/RetainUIDsModifierAddForm.pt
M Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt
M Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt
M Products/CMFEditions/www/SillyDemoRetrieveModifier.pt
M Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt
M Products/CMFEditions/www/SkipParentPointersAddForm.pt
M Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt
M Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt
M Products/CMFEditions/www/Skip_z3c_blobfile.pt
M Products/CMFEditions/www/fieldModifierEditForm.pt
M Products/CMFEditions/www/modifierAddForm.pt
M Products/CMFEditions/www/modifierEditForm.pt
M Products/CMFEditions/www/storageStatistics.pt
M Products/CMFEditions/www/talesModifierEditForm.pt
M doc/DevelDoc.html

b'diff --git a/Products/CMFEditions/browser/templates/diff.pt b/Products/CMFEditions/browser/templates/diff.pt\nindex e91edb3..5f2ba8e 100644\n--- a/Products/CMFEditions/browser/templates/diff.pt\n+++ b/Products/CMFEditions/browser/templates/diff.pt\n@@ -1,16 +1,23 @@\n <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"\n          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n <html xmlns="http://www.w3.org/1999/xhtml"\n-      xmlns:tal="http://xml.zope.org/namespaces/tal"\n-      xmlns:metal="http://xml.zope.org/namespaces/metal"\n       xmlns:i18n="http://xml.zope.org/namespaces/i18n"\n-      xml:lang="en" lang="en"\n+      xmlns:metal="http://xml.zope.org/namespaces/metal"\n+      xmlns:tal="http://xml.zope.org/namespaces/tal"\n+      lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="cmfeditions">\n+      xml:lang="en"\n+      i18n:domain="cmfeditions"\n+>\n \n   <tal:block metal:fill-slot="head_slot">\n-    <link rel="stylesheet" type="text/css" href="compare.css"\n-          tal:attributes="href string:${portal_url}/compare.css"/>\n+    <link href="compare.css"\n+          rel="stylesheet"\n+          type="text/css"\n+          tal:attributes="\n+            href string:${portal_url}/compare.css;\n+          "\n+    />\n   </tal:block>\n \n   <tal:block metal:fill-slot="javascript_head_slot">\n@@ -40,7 +47,7 @@\n       });\n     })(jQuery);\n \n-</script>\n+    </script>\n   </tal:block>\n \n   <body>\n@@ -50,140 +57,248 @@\n       </h1>\n \n       <div id="content-core">\n-          <p class="text-muted" tal:condition="not:view/history" i18n:translate="no_history">\n+        <p class="text-muted"\n+           tal:condition="not:view/history"\n+           i18n:translate="no_history"\n+        >\n             This object has no revision information.\n+        </p>\n+\n+        <tal:block condition="view/history">\n+          <form id="versionSelector"\n+                action="#"\n+                tal:define="\n+                  toLocalizedTime nocall:context/@@plone/toLocalizedTime;\n+                "\n+                tal:attributes="\n+                  action string:${context/absolute_url}/@@history;\n+                "\n+          >\n+            <fieldset>\n+              <legend i18n:translate="legend_revisions">Revisions</legend>\n+\n+              <div class="form-floating">\n+                <select class="form-select"\n+                        id="two"\n+                        name="two"\n+                        tal:define="\n+                          rev request/two|string:current;\n+                        "\n+                >\n+                  <option value="current"\n+                          tal:attributes="\n+                            selected python:rev==\'current\' and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_current"\n+                  >Current</option>\n+                  <option tal:repeat="version view/history"\n+                          tal:attributes="\n+                            value version/version_id;\n+                            selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_history_version"\n+                  ><tal:version content="version/version_id"\n+                                 i18n:name="version"\n+                    >1</tal:version>\n+                    (<tal:date content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])"\n+                              i18n:name="date"\n+                    >1975-12-24</tal:date>)</option>\n+                </select>\n+                <label for="two"\n+                       i18n:translate=""\n+                >First revision</label>\n+              </div>\n+\n+              <div class="form-floating">\n+                <select class="form-select"\n+                        id="one"\n+                        name="one"\n+                        tal:define="\n+                          rev request/one|string:current;\n+                        "\n+                >\n+                  <option value="current"\n+                          tal:attributes="\n+                            selected python:rev==\'current\' and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_current"\n+                  >Current</option>\n+                  <option tal:repeat="version view/history"\n+                          tal:attributes="\n+                            value version/version_id;\n+                            selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_history_version"\n+                  ><tal:version content="version/version_id"\n+                                 i18n:name="version"\n+                    >1</tal:version>\n+                    (<tal:date content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])"\n+                              i18n:name="date"\n+                    >1975-12-24</tal:date>)</option>\n+                </select>\n+                <label for="one"\n+                       i18n:translate=""\n+                >Second revision</label>\n+              </div>\n+            </fieldset>\n+\n+            <noscript>\n+              <input type="submit"\n+                     value="Update"\n+                     i18n:attributes="value label_update"\n+              />\n+            </noscript>\n+          </form>\n+\n+          <div metal:use-macro="context/@@diff_legend/macros/diff_legend"></div>\n+\n+          <p tal:condition="not:view/changes"\n+             i18n:translate=""\n+          >\n+              There are no changes between the selected revisions.\n           </p>\n \n-          <tal:block condition="view/history">\n-            <form id="versionSelector"\n-                  action="#"\n-                  tal:attributes="action string:${context/absolute_url}/@@history"\n-                  tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime">\n-              <fieldset>\n-                <legend i18n:translate="legend_revisions">Revisions</legend>\n-\n-                <div class="form-floating">\n-                  <select class="form-select" id="two" name="two" tal:define="rev request/two|string:current">\n-                    <option i18n:translate="label_current" value="current" tal:attributes="selected python:rev==\'current\' and \'yes\' or None">Current</option>\n-                    <option tal:repeat="version view/history"\n-                            tal:attributes="value version/version_id; selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None"\n-                            i18n:translate="label_history_version"><tal:version i18n:name="version" content="version/version_id">1</tal:version>\n-                            (<tal:date i18n:name="date" content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])">1975-12-24</tal:date>)</option>\n-                  </select>\n-                  <label for="two" i18n:translate="">First revision</label>\n-                </div>\n-\n-                <div class="form-floating">\n-                  <select class="form-select" id="one" name="one" tal:define="rev request/one|string:current">\n-                    <option i18n:translate="label_current" value="current" tal:attributes="selected python:rev==\'current\' and \'yes\' or None">Current</option>\n-                    <option tal:repeat="version view/history"\n-                            tal:attributes="value version/version_id; selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None"\n-                            i18n:translate="label_history_version"><tal:version i18n:name="version" content="version/version_id">1</tal:version>\n-                            (<tal:date i18n:name="date" content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])">1975-12-24</tal:date>)</option>\n-                  </select>\n-                  <label for="one" i18n:translate="">Second revision</label>\n-                </div>\n-              </fieldset>\n-\n-              <noscript>\n-                <input type="submit" i18n:attributes="value label_update" value="Update"/>\n-              </noscript>\n+          <tal:changes condition="view/changes">\n+            <form class="mt-3"\n+                  id="diffTypeSelector"\n+                  action=""\n+                  method="post"\n+            >\n+              <label class="jsOnly"\n+                     for="diffstyle"\n+                     style="display: none"\n+                     i18n:translate=""\n+              >Show differences</label>\n+              <div class="form-check">\n+                <input class="form-check-input"\n+                       id="diffstylevisual"\n+                       checked="checked"\n+                       name="diffstyle"\n+                       type="radio"\n+                       value="visual"\n+                />\n+                <label class="form-check-label"\n+                       for="diffstylevisual"\n+                       i18n:translate=""\n+                >inline</label>\n+              </div>\n+              <div class="form-check">\n+                <input class="form-check-input"\n+                       id="diffstylecode"\n+                       name="diffstyle"\n+                       type="radio"\n+                       value="code"\n+                />\n+                <label class="form-check-label"\n+                       for="diffstylecode"\n+                       i18n:translate=""\n+                >as code</label>\n+              </div>\n             </form>\n \n-            <div metal:use-macro="context/@@diff_legend/macros/diff_legend" />\n+            <fieldset class="mt-3 bg-light border border-dark p-3"\n+                      tal:repeat="diff view/changes"\n+            >\n+              <legend tal:content="diff/label">Body text</legend>\n \n-            <p tal:condition="not:view/changes" i18n:translate="">\n-              There are no changes between the selected revisions.\n-            </p>\n-\n-            <tal:changes condition="view/changes">\n-              <form id="diffTypeSelector" method="post" action="" class="mt-3">\n-                <label for="diffstyle" class="jsOnly" style="display: none" i18n:translate="">Show differences</label>\n-                <div class="form-check">\n-                  <input class="form-check-input" id="diffstylevisual" type="radio" name="diffstyle" value="visual" checked="checked" />\n-                  <label class="form-check-label" for="diffstylevisual" i18n:translate="">inline</label>\n-                </div>\n-                <div class="form-check">\n-                  <input class="form-check-input" id="diffstylecode" type="radio" name="diffstyle" value="code" />\n-                  <label class="form-check-label" for="diffstylecode" i18n:translate="">as code</label>\n-                </div>\n-              </form>\n-\n-              <fieldset class="mt-3 bg-light border border-dark p-3" tal:repeat="diff view/changes">\n-                <legend tal:content="diff/label">Body text</legend>\n-\n-                <div class="fieldDiff inline-diff" tal:condition="exists:diff/inline_diff"\n-                     tal:content="structure python:diff.inline_diff()">\n+              <div class="fieldDiff inline-diff"\n+                   tal:condition="exists:diff/inline_diff"\n+                   tal:content="structure python:diff.inline_diff()"\n+              >\n                   Inline changes\n-                </div>\n+              </div>\n \n-                <p class="fieldDiff inline-diff" tal:condition="not:exists:diff/inline_diff" i18n:translate="">\n+              <p class="fieldDiff inline-diff"\n+                 tal:condition="not:exists:diff/inline_diff"\n+                 i18n:translate=""\n+              >\n                   This field has no inline difference view.\n-                </p>\n+              </p>\n \n-                <div class="fieldDiff code-diff"\n-                     style="display: none"\n-                     tal:define="exists_html_diff exists:diff/html_diff;\n-                                 html_diff python:diff.html_diff(wrapcolumn=80) if exists_html_diff else \'\';\n-                                 has_html_diff python:bool(html_diff)">\n-                  <pre tal:condition="has_html_diff"\n-                       tal:content="structure html_diff">\n+              <div class="fieldDiff code-diff"\n+                   style="display: none"\n+                   tal:define="\n+                     exists_html_diff exists:diff/html_diff;\n+                     html_diff python:diff.html_diff(wrapcolumn=80) if exists_html_diff else \'\';\n+                     has_html_diff python:bool(html_diff);\n+                   "\n+              >\n+                <pre tal:condition="has_html_diff"\n+                     tal:content="structure html_diff"\n+                >\n                     HTML formatted differences\n                   </pre>\n \n-                  <tal:block condition="not:has_html_diff">\n-                    <tal:block define="exists_ndiff exists:diff/ndiff;\n-                                       ndiff python:diff.ndiff() if exists_ndiff else \'\';\n-                                       has_ndiff python:bool(ndiff)">\n-                      <pre class="fieldDiff code-diff"\n-                           tal:condition="has_ndiff"\n-                           tal:content="ndiff">\n+                <tal:block condition="not:has_html_diff">\n+                  <tal:block define="\n+                               exists_ndiff exists:diff/ndiff;\n+                               ndiff python:diff.ndiff() if exists_ndiff else \'\';\n+                               has_ndiff python:bool(ndiff);\n+                             ">\n+                    <pre class="fieldDiff code-diff"\n+                         tal:condition="has_ndiff"\n+                         tal:content="ndiff"\n+                    >\n                         ndiff formatted differences\n                       </pre>\n-                      <p class="fieldDiff"\n-                         tal:condition="not:has_ndiff">\n+                    <p class="fieldDiff"\n+                       tal:condition="not:has_ndiff"\n+                    >\n                         This field has no code difference view.\n-                      </p>\n-                    </tal:block>\n+                    </p>\n                   </tal:block>\n-                </div>\n-              </fieldset>\n+                </tal:block>\n+              </div>\n+            </fieldset>\n \n-              <tal:block tal:condition="view/changeset/recursive">\n+            <tal:block tal:condition="view/changeset/recursive">\n \n \n-                <tal:changed define="subdiffs view/changeset/getSubDiffs;\n-                                     subdiffs python:[c for c in subdiffs if not c.same if c.id];"\n-                             condition="subdiffs">\n+              <tal:changed define="\n+                             subdiffs view/changeset/getSubDiffs;\n+                             subdiffs python:[c for c in subdiffs if not c.same if c.id];\n+                           "\n+                           condition="subdiffs"\n+              >\n \n-                  <h2>Changed files</h2>\n+                <h2>Changed files</h2>\n \n-                  <ul tal:condition="subdiffs">\n-                    <li tal:repeat="cs subdiffs">\n-                      <a tal:content="cs/id" tal:attributes="href cs/id">[filename]</a>\n-                    </li>\n-                  </ul>\n+                <ul tal:condition="subdiffs">\n+                  <li tal:repeat="cs subdiffs">\n+                    <a tal:content="cs/id"\n+                       tal:attributes="\n+                         href cs/id;\n+                       "\n+                    >[filename]</a>\n+                  </li>\n+                </ul>\n \n-                </tal:changed>\n+              </tal:changed>\n \n-                <tal:changed condition="view/changeset/getRemovedItems">\n-                  <h2>Removed files</h2>\n-                  <ul>\n-                    <li tal:repeat="id view/changeset/getRemovedItems" tal:content="id">[filename]</li>\n-                  </ul>\n-                </tal:changed>\n+              <tal:changed condition="view/changeset/getRemovedItems">\n+                <h2>Removed files</h2>\n+                <ul>\n+                  <li tal:repeat="id view/changeset/getRemovedItems"\n+                      tal:content="id"\n+                  >[filename]</li>\n+                </ul>\n+              </tal:changed>\n \n-                <tal:changed condition="view/changeset/getAddedItems">\n-                  <h2>Added files</h2>\n-                  <ul tal:condition="view/changeset/getAddedItems">\n-                    <li tal:repeat="id view/changeset/getAddedItems"><a tal:content="id" tal:attributes="href id">[filename]</a></li>\n-                  </ul>\n-                </tal:changed>\n+              <tal:changed condition="view/changeset/getAddedItems">\n+                <h2>Added files</h2>\n+                <ul tal:condition="view/changeset/getAddedItems">\n+                  <li tal:repeat="id view/changeset/getAddedItems"><a tal:content="id"\n+                       tal:attributes="\n+                         href id;\n+                       "\n+                    >[filename]</a></li>\n+                </ul>\n+              </tal:changed>\n \n-              </tal:block>\n+            </tal:block>\n \n-            </tal:changes>\n-          </tal:block>\n+          </tal:changes>\n+        </tal:block>\n       </div>\n     </metal:main>\n   </body>\ndiff --git a/Products/CMFEditions/browser/templates/diff_legend.pt b/Products/CMFEditions/browser/templates/diff_legend.pt\nindex d2b3c83..7a4b6a8 100644\n--- a/Products/CMFEditions/browser/templates/diff_legend.pt\n+++ b/Products/CMFEditions/browser/templates/diff_legend.pt\n@@ -1,16 +1,36 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"\n-    i18n:domain="cmfeditions">\n+<html xmlns="http://www.w3.org/1999/xhtml"\n+      lang="en-US"\n+      xml:lang="en-US"\n+      i18n:domain="cmfeditions"\n+>\n \n-<body>\n-    <div id="diff-legend" metal:define-macro="diff_legend">\n-      <table id="diff-table" cellpadding="2" summary="DiffLegend">\n-            <tr><th class="diff-legend-label" i18n:translate="label_diff_legend">Legend</th>\n-                <td class="diff_add" i18n:translate="label_diff_added">(+) Added</td>\n-                <td class="diff_sub" i18n:translate="label_diff_deleted">(-) Deleted</td></tr>\n-            <tr><td class="diff_chg" i18n:translate="label_diff_changed">Changed</td>\n-                <td class="tagInsert" i18n:translate="label_diff_tag_added">Tag Added</td>\n-                <td class="tagDelete" i18n:translate="label_diff_tag_deleted">Tag Deleted</td></tr>\n+  <body>\n+    <div id="diff-legend"\n+         metal:define-macro="diff_legend"\n+    >\n+      <table id="diff-table"\n+             cellpadding="2"\n+             summary="DiffLegend"\n+      >\n+        <tr><th class="diff-legend-label"\n+              i18n:translate="label_diff_legend"\n+          >Legend</th>\n+          <td class="diff_add"\n+              i18n:translate="label_diff_added"\n+          >(+) Added</td>\n+          <td class="diff_sub"\n+              i18n:translate="label_diff_deleted"\n+          >(-) Deleted</td></tr>\n+        <tr><td class="diff_chg"\n+              i18n:translate="label_diff_changed"\n+          >Changed</td>\n+          <td class="tagInsert"\n+              i18n:translate="label_diff_tag_added"\n+          >Tag Added</td>\n+          <td class="tagDelete"\n+              i18n:translate="label_diff_tag_deleted"\n+          >Tag Deleted</td></tr>\n       </table>\n     </div>\n-</body>\n+  </body>\n </html>\ndiff --git a/Products/CMFEditions/browser/templates/version_file_view.pt b/Products/CMFEditions/browser/templates/version_file_view.pt\nindex 42039c9..53e77c6 100644\n--- a/Products/CMFEditions/browser/templates/version_file_view.pt\n+++ b/Products/CMFEditions/browser/templates/version_file_view.pt\n@@ -1,71 +1,93 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"\n+<html xmlns="http://www.w3.org/1999/xhtml"\n       lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="cmfeditions">\n+      xml:lang="en"\n+      i18n:domain="cmfeditions"\n+>\n \n-<body>\n+  <body>\n \n-<metal:main fill-slot="main">\n-    <tal:main-macro metal:define-macro="main"\n-           tal:define="size_value context/get_size;\n-                       size_label python:size_value and view.human_readable_size(size_value) or None;\n-                       content_type context/get_content_type|context/Format;\n-                      ">\n+    <metal:main fill-slot="main">\n+      <tal:main-macro metal:define-macro="main"\n+                      tal:define="\n+                        size_value context/get_size;\n+                        size_label python:size_value and view.human_readable_size(size_value) or None;\n+                        content_type context/get_content_type|context/Format;\n+                      "\n+      >\n \n         <div id="content-core">\n-            <p tal:condition="size_value">\n-                <a href=""\n-                   tal:define="here_url context/absolute_url"\n-                   tal:attributes="href string:$here_url/file_download_version?version_id=${version_id}">\n-                    <img src="" tal:attributes="src string:${portal_url}/file_icon.gif" alt="" />\n-                    <tal:block i18n:translate="label_click_to_get_file">\n+          <p tal:condition="size_value">\n+            <a href=""\n+               tal:define="\n+                 here_url context/absolute_url;\n+               "\n+               tal:attributes="\n+                 href string:$here_url/file_download_version?version_id=${version_id};\n+               "\n+            >\n+              <img alt=""\n+                   src=""\n+                   tal:attributes="\n+                     src string:${portal_url}/file_icon.gif;\n+                   "\n+              />\n+              <tal:block i18n:translate="label_click_to_get_file">\n                     Click here to get the file\n-                    </tal:block>\n-                </a>\n-            </p>\n+              </tal:block>\n+            </a>\n+          </p>\n \n-            <small class="discreet">\n+          <small class="discreet">\n \n-              <span tal:condition="not:size_value" i18n:translate="no_file_uploaded">\n+            <span tal:condition="not:size_value"\n+                  i18n:translate="no_file_uploaded"\n+            >\n                   (No file has been uploaded yet)\n-              </span>\n+            </span>\n \n-              <tal:fileinfo condition="size_value">\n-                <span i18n:translate="label_size" i18n:domain="plone">\n+            <tal:fileinfo condition="size_value">\n+              <span i18n:domain="plone"\n+                    i18n:translate="label_size"\n+              >\n                 Size\n-                </span>\n+              </span>\n \n-                <span tal:condition="size_value"\n-                    tal:content="size_label">\n+              <span tal:condition="size_value"\n+                    tal:content="size_label"\n+              >\n                 257 KB\n-                </span>\n+              </span>\n \n                 -\n \n-                <span i18n:translate="label_file_type">\n+              <span i18n:translate="label_file_type">\n                 File type\n-                </span>\n+              </span>\n \n-                <span tal:content="content_type">\n+              <span tal:content="content_type">\n                 Content type\n-                </span>\n-              </tal:fileinfo>\n-            </small>\n+              </span>\n+            </tal:fileinfo>\n+          </small>\n \n-            <div class="row"\n-                 tal:condition="python:test(size_value and content_type.find(\'text\')>-1, 1,0)">\n+          <div class="row"\n+               tal:condition="python:test(size_value and content_type.find(\'text\')&gt;-1, 1,0)"\n+          >\n \n-                    <h2 i18n:translate="heading_file_contents" i18n:domain="plone">File contents</h2>\n+            <h2 i18n:domain="plone"\n+                i18n:translate="heading_file_contents"\n+            >File contents</h2>\n \n-                    <pre tal:content="context/get_data|context/data|nothing">\n+            <pre tal:content="context/get_data|context/data|nothing">\n                     </pre>\n \n-            </div>\n+          </div>\n         </div>\n \n-    </tal:main-macro>\n-</metal:main>\n+      </tal:main-macro>\n+    </metal:main>\n \n-</body>\n+  </body>\n \n </html>\ndiff --git a/Products/CMFEditions/browser/templates/version_image_view.pt b/Products/CMFEditions/browser/templates/version_image_view.pt\nindex 5ca0425..c4167ff 100644\n--- a/Products/CMFEditions/browser/templates/version_image_view.pt\n+++ b/Products/CMFEditions/browser/templates/version_image_view.pt\n@@ -1,43 +1,57 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"\n+<html xmlns="http://www.w3.org/1999/xhtml"\n       lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="plone">\n+      xml:lang="en"\n+      i18n:domain="plone"\n+>\n \n-<body>\n+  <body>\n \n-<metal:main fill-slot="main">\n-    <tal:main-macro metal:define-macro="main"\n-                    tal:define="plone_view here/@@plone;\n-                                size python:plone_view.human_readable_size(here.get_size());\n-                                here_url context/absolute_url;">\n+    <metal:main fill-slot="main">\n+      <tal:main-macro metal:define-macro="main"\n+                      tal:define="\n+                        plone_view here/@@plone;\n+                        size python:plone_view.human_readable_size(here.get_size());\n+                        here_url context/absolute_url;\n+                      "\n+      >\n \n         <div id="content-core">\n-            <a href=""\n-               class="discreet"\n-               tal:attributes="href string:$here_url/file_download_version?version_id=${request/version_id}">\n-                <tal:block condition="size" replace="structure python: here.version_image_tag(here_url, version_id)" />\n-                <br />\n-                <span class="visualNoPrint">\n-                    <img src="" alt="" tal:replace="structure here/search_icon.png" />\n-                    <span i18n:translate="label_click_to_view_full_image">Click to view full-size image&hellip;</span>\n-                </span>\n-            </a>\n-\n-            <span class="discreet visualNoPrint">\n+          <a class="discreet"\n+             href=""\n+             tal:attributes="\n+               href string:$here_url/file_download_version?version_id=${request/version_id};\n+             "\n+          >\n+            <tal:block condition="size"\n+                       replace="structure python: here.version_image_tag(here_url, version_id)"\n+            />\n+            <br />\n+            <span class="visualNoPrint">\n+              <img alt=""\n+                   src=""\n+                   tal:replace="structure here/search_icon.png"\n+              />\n+              <span i18n:translate="label_click_to_view_full_image">Click to view full-size image&hellip;</span>\n+            </span>\n+          </a>\n+\n+          <span class="discreet visualNoPrint">\n             &mdash;\n-                <span i18n:translate="label_size">Size</span>:\n+            <span i18n:translate="label_size">Size</span>:\n                 ${size}\n-                <span tal:condition="python:test(size, 0, 1)"\n-                      i18n:translate="no_image_uploaded">\n+            <span tal:condition="python:test(size, 0, 1)"\n+                  i18n:translate="no_image_uploaded"\n+            >\n                     (No image has been uploaded yet)\n-                </span>\n             </span>\n+          </span>\n         </div>\n \n-    </tal:main-macro>\n+      </tal:main-macro>\n \n-</metal:main>\n+    </metal:main>\n \n-</body>\n+  </body>\n \n </html>\ndiff --git a/Products/CMFEditions/browser/templates/version_metadata_view.pt b/Products/CMFEditions/browser/templates/version_metadata_view.pt\nindex 7b77da0..252dfc5 100644\n--- a/Products/CMFEditions/browser/templates/version_metadata_view.pt\n+++ b/Products/CMFEditions/browser/templates/version_metadata_view.pt\n@@ -1,102 +1,121 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"\n+<html xmlns="http://www.w3.org/1999/xhtml"\n       lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="plone">\n+      xml:lang="en"\n+      i18n:domain="plone"\n+>\n \n-<body>\n+  <body>\n \n-<metal:main fill-slot="main">\n-    <tal:main-macro metal:define-macro="main">\n+    <metal:main fill-slot="main">\n+      <tal:main-macro metal:define-macro="main">\n \n         <metal:metadata define-macro="metadata">\n \n-            <h1 class="documentFirstHeading">\n+          <h1 class="documentFirstHeading">\n                 Metadata\n-            </h1>\n-            <div id="content-core">\n-                <ul>\n-\n-                    <li>\n-                        <label for="predefined_subjects"\n-                              i18n:translate="label_existing_categories">\n+          </h1>\n+          <div id="content-core">\n+            <ul>\n+\n+              <li>\n+                <label for="predefined_subjects"\n+                       i18n:translate="label_existing_categories"\n+                >\n                           Existing categories\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="python: \', \'.join(here.Subject())"\n-                              tal:on-error="nothing">Keywords</span>\n-                    </li>\n+                <span tal:content="python: \', \'.join(here.Subject())"\n+                      tal:on-error="nothing"\n+                >Keywords</span>\n+              </li>\n \n-                    <li>\n-                      <label for="format"\n-                            i18n:translate="label_format">\n+              <li>\n+                <label for="format"\n+                       i18n:translate="label_format"\n+                >\n                         Format\n-                      </label>:\n+                </label>:\n \n-                      <span tal:content="here/Format">text/plain</span>\n-                    </li>\n+                <span tal:content="here/Format">text/plain</span>\n+              </li>\n \n-                    <li>\n-                        <label for="effective_date"\n-                              i18n:translate="label_effective_date">\n+              <li>\n+                <label for="effective_date"\n+                       i18n:translate="label_effective_date"\n+                >\n                           Effective Date\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="python:here.toLocalizedTime(here.EffectiveDate())"\n-                              tal:on-error="nothing">2005/01/01</span>\n-                    </li>\n+                <span tal:content="python:here.toLocalizedTime(here.EffectiveDate())"\n+                      tal:on-error="nothing"\n+                >2005/01/01</span>\n+              </li>\n \n-                    <li>\n-                        <label for="expiration_date"\n-                            i18n:translate="label_expiration_date">\n+              <li>\n+                <label for="expiration_date"\n+                       i18n:translate="label_expiration_date"\n+                >\n                           Expiration Date\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="python:here.toLocalizedTime(here.ExpirationDate())"\n-                              tal:on-error="nothing">2005/01/01</span>\n-                    </li>\n+                <span tal:content="python:here.toLocalizedTime(here.ExpirationDate())"\n+                      tal:on-error="nothing"\n+                >2005/01/01</span>\n+              </li>\n \n-                    <li>\n-                        <label for="language"\n-                              i18n:translate="label_language">\n+              <li>\n+                <label for="language"\n+                       i18n:translate="label_language"\n+                >\n                           Language\n-                        </label>:\n-\n-                        <span tal:define="language python:[name for (id,name) in here.availableLanguages() if id == here.Language()][0]"\n-                              tal:content="language"\n-                              tal:on-error="nothing">English</span>\n-                    </li>\n-\n-                    <li>\n-                        <label for="description"\n-                              i18n:translate="label_description">\n+                </label>:\n+\n+                <span tal:define="\n+                        language python:[name for (id,name) in here.availableLanguages() if id == here.Language()][0];\n+                      "\n+                      tal:content="language"\n+                      tal:on-error="nothing"\n+                >English</span>\n+              </li>\n+\n+              <li>\n+                <label for="description"\n+                       i18n:translate="label_description"\n+                >\n                           Description\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="here/Description"\n-                              tal:on-error="string: "></span>\n-                    </li>\n+                <span tal:content="here/Description"\n+                      tal:on-error="string: "\n+                ></span>\n+              </li>\n \n-                    <li>\n-                        <label for="rights"\n-                              i18n:translate="label_copyrights">\n+              <li>\n+                <label for="rights"\n+                       i18n:translate="label_copyrights"\n+                >\n                           Copyrights\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="here/Rights"\n-                              tal:on-error="nothing"></span>\n-                    </li>\n+                <span tal:content="here/Rights"\n+                      tal:on-error="nothing"\n+                ></span>\n+              </li>\n \n-                    <li>\n-                        <label for="contributors"\n-                              i18n:translate="label_contributors">\n+              <li>\n+                <label for="contributors"\n+                       i18n:translate="label_contributors"\n+                >\n                           Contributors\n-                        </label>:\n-\n-                        <span tal:content="python:\',\'.join(here.Contributors())"\n-                              tal:on-error="nothing"></span>\n-                    </li>\n-                </ul>\n-            </div>\n+                </label>:\n+\n+                <span tal:content="python:\',\'.join(here.Contributors())"\n+                      tal:on-error="nothing"\n+                ></span>\n+              </li>\n+            </ul>\n+          </div>\n \n         </metal:metadata>\n \ndiff --git a/Products/CMFEditions/browser/templates/versions_history_form.pt b/Products/CMFEditions/browser/templates/versions_history_form.pt\nindex 397b338..866f584 100644\n--- a/Products/CMFEditions/browser/templates/versions_history_form.pt\n+++ b/Products/CMFEditions/browser/templates/versions_history_form.pt\n@@ -1,236 +1,323 @@\n-<html metal:use-macro="context/main_template/macros/master" i18n:domain="cmfeditions">\n+<html metal:use-macro="context/main_template/macros/master"\n+      i18n:domain="cmfeditions"\n+>\n \n   <tal:block metal:fill-slot="head_slot">\n-        <link rel="stylesheet" type="text/css" href="compare.css" />\n+    <link href="compare.css"\n+          rel="stylesheet"\n+          type="text/css"\n+    />\n   </tal:block>\n \n   <metal:main fill-slot="main"\n-       tal:define="pr nocall:context/portal_repository;\n-                   version_id python:request.get(\'version_id\', None);\n-                   history python:pr.getHistoryMetadata(context);\n-                   revisions python:history and history.getLength(countPurged=False) or 0;\n-                   histrange python:range(revisions-1, -1, -1);\n-                   here_url context/absolute_url;\n-                   can_diff view/can_diff;\n-                   checkPermission nocall:context/portal_membership/checkPermission;\n-                   canRevertToPrevious python:checkPermission(\'CMFEditions: Revert to previous versions\', context);"\n-                   tal:condition="python: pr.isVersionable(context)">\n-\n-    <div tal:replace="structure provider:plone.abovecontenttitle" />\n+              tal:define="\n+                pr nocall:context/portal_repository;\n+                version_id python:request.get(\'version_id\', None);\n+                history python:pr.getHistoryMetadata(context);\n+                revisions python:history and history.getLength(countPurged=False) or 0;\n+                histrange python:range(revisions-1, -1, -1);\n+                here_url context/absolute_url;\n+                can_diff view/can_diff;\n+                checkPermission nocall:context/portal_membership/checkPermission;\n+                canRevertToPrevious python:checkPermission(\'CMFEditions: Revert to previous versions\', context);\n+              "\n+              tal:condition="python: pr.isVersionable(context)"\n+  >\n+\n+    <div tal:replace="structure provider:plone.abovecontenttitle"></div>\n \n     <h1 class="documentFirstHeading"\n-        i18n:translate="versions_of_title">Revisions of\n-          "<span i18n:name="title" tal:replace="context/title_or_id">title</span>"\n+        i18n:translate="versions_of_title"\n+    >Revisions of\n+      "<span tal:replace="context/title_or_id"\n+            i18n:name="title"\n+      >title</span>"\n     </h1>\n \n-    <div tal:replace="structure provider:plone.belowcontenttitle" />\n+    <div tal:replace="structure provider:plone.belowcontenttitle"></div>\n \n     <div id="content-core">\n-        <table id="sortable"\n-            class="listing"\n-            summary="Content history"\n-            cellpadding="0" cellspacing="0"\n-            tal:condition="history"\n-            tal:define="current python:view.checkUpToDate(history)">\n-            <thead>\n-                <tr>\n-                  <th><tal:title i18n:translate="listingheader_key"\n-                      >Revision</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_performed_by"\n-                      >Performed by</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_date_and_time"\n-                  >Date and Time</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_comment"\n-                      >Comment</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_actions"\n-                      >Actions</tal:title></th>\n-                </tr>\n-            </thead>\n-\n-            <tbody tal:define="isModified current/isModified;\n-                               reverted_vid current/reverted_vid;\n-                               isReverted current/isReverted">\n-                <tr class="CurrentVersion odd"\n-                    tal:condition="isModified">\n-                  <td class="VersionId"\n-                      tal:define="id current/version_id;">\n-                    <span i18n:translate="">Current revision</span>\n-                  </td>\n-                  <td class="VersionUser">\n-                    <span tal:replace="context/Creator">user</span>\n-                  </td>\n-                  <td class="VersionDate">\n-                    <span tal:replace="python:context.toLocalizedTime(context.ModificationDate(),long_format=1)">2004/10/21 03:15 PM</span>\n-                  </td>\n-                  <td class="VersionComment">\n-                    <span i18n:translate="label_modifications_from_revision">\n+      <table class="listing"\n+             id="sortable"\n+             cellpadding="0"\n+             cellspacing="0"\n+             summary="Content history"\n+             tal:define="\n+               current python:view.checkUpToDate(history);\n+             "\n+             tal:condition="history"\n+      >\n+        <thead>\n+          <tr>\n+            <th><tal:title i18n:translate="listingheader_key">Revision</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_performed_by">Performed by</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_date_and_time">Date and Time</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_comment">Comment</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_actions">Actions</tal:title></th>\n+          </tr>\n+        </thead>\n+\n+        <tbody tal:define="\n+                 isModified current/isModified;\n+                 reverted_vid current/reverted_vid;\n+                 isReverted current/isReverted;\n+               ">\n+          <tr class="CurrentVersion odd"\n+              tal:condition="isModified"\n+          >\n+            <td class="VersionId"\n+                tal:define="\n+                  id current/version_id;\n+                "\n+            >\n+              <span i18n:translate="">Current revision</span>\n+            </td>\n+            <td class="VersionUser">\n+              <span tal:replace="context/Creator">user</span>\n+            </td>\n+            <td class="VersionDate">\n+              <span tal:replace="python:context.toLocalizedTime(context.ModificationDate(),long_format=1)">2004/10/21 03:15 PM</span>\n+            </td>\n+            <td class="VersionComment">\n+              <span i18n:translate="label_modifications_from_revision">\n                       modifications from revision\n-                      <span tal:replace="reverted_vid" i18n:name="version_id" />\n-                    </span>\n-                    <span tal:condition="isReverted"\n-                           i18n:translate="label_previously_reverted">\n+                <span tal:replace="reverted_vid"\n+                      i18n:name="version_id"\n+                ></span>\n+              </span>\n+              <span tal:condition="isReverted"\n+                    i18n:translate="label_previously_reverted"\n+              >\n                       (previously reverted)\n-                    </span>\n-                  </td>\n-                  <td class="VersionActions">\n-                    <ul>\n-                        <li tal:condition="can_diff">\n-                            <a href=""\n-                               style="text-decoration: none"\n-                               tal:attributes="href string:${here_url}/@@history?one=current&amp;two=${reverted_vid}">\n-                              <span tal:condition="isReverted"\n-                                    i18n:translate="label_compare_to_revision">\n+              </span>\n+            </td>\n+            <td class="VersionActions">\n+              <ul>\n+                <li tal:condition="can_diff">\n+                  <a href=""\n+                     style="text-decoration: none"\n+                     tal:attributes="\n+                       href string:${here_url}/@@history?one=current&amp;two=${reverted_vid};\n+                     "\n+                  >\n+                    <span tal:condition="isReverted"\n+                          i18n:translate="label_compare_to_revision"\n+                    >\n                                 Compare to revision\n-                                <span tal:replace="reverted_vid"\n-                                      i18n:name="version_id" />\n-                              </span>\n-                              <span tal:condition="not:isReverted"\n-                                    i18n:translate="label_compare_to_previous_revision">\n+                      <span tal:replace="reverted_vid"\n+                            i18n:name="version_id"\n+                      ></span>\n+                    </span>\n+                    <span tal:condition="not:isReverted"\n+                          i18n:translate="label_compare_to_previous_revision"\n+                    >\n                                 Compare to previous revision\n-                              </span>\n-                            </a>\n-                        </li>\n-                    </ul>\n-                  </td>\n-                </tr>\n-                <tal:block repeat="vdatai histrange">\n-                <tr tal:define="id     vdatai;\n-                                vdatafull   python:history.retrieve(vdatai, countPurged=False);\n-                                vdata       vdatafull/metadata;\n-                                current_version python:not current[\'isModified\'] and current[\'version_id\']==vdatai;\n-                                even repeat/vdatai/even;"\n-                    tal:attributes="class python:(current_version and \'CurrentVersion\' or \'\') + (even and \' even\' or \'\')">\n-                  <td class="VersionId">\n-                    <span tal:condition="current_version" i18n:translate="">Current revision</span>\n-                    <span tal:condition="not:current_version" tal:content="id">1</span>\n-                    <a href="#"\n-                       class="version-table-version"\n-                       tal:attributes="href string:${here_url}/versions_history_form?version_id=${id}#version_preview"\n-                       tal:condition="python:version_id!=id and not current_version"\n-                       i18n:translate="label_preview_version_link">(preview)</a>\n-                    <a href="#"\n-                       class="version-table-version"\n-                       tal:attributes="href string:${here_url}/versions_history_form?version_id=${id}#version_preview"\n-                       tal:condition="python:version_id==id"\n-                       i18n:translate="label_preview_version_below">(jump down)</a>\n-                  </td>\n-                  <td class="VersionUser">\n-                    <span tal:content="vdata/sys_metadata/principal">francesco</span>\n-                  </td>\n-                  <td class="VersionDate">\n-                    <span tal:content="python:context.toLocalizedTime(vdata[\'sys_metadata\'][\'timestamp\'],long_format=1)">2004/10/21 03:15 PM</span>\n-                  </td>\n-                  <td class="VersionComment">\n-                    <span tal:content="vdata/sys_metadata/comment" i18n:translate="">Draft version ready for comments from the group.</span>\n-                  </td>\n-                  <td class="VersionActions">\n-                    <ul>\n-                        <tal:diffs condition="can_diff">\n-                        <li tal:condition="not:current_version">\n-                            <a href=""\n-                               style="text-decoration: none"\n-                               tal:attributes="href string:${here_url}/@@history?one=current&amp;two=${id}"\n-                               i18n:translate="label_compare_current">\n+                    </span>\n+                  </a>\n+                </li>\n+              </ul>\n+            </td>\n+          </tr>\n+          <tal:block repeat="vdatai histrange">\n+            <tr tal:define="\n+                  id     vdatai;\n+                  vdatafull   python:history.retrieve(vdatai, countPurged=False);\n+                  vdata       vdatafull/metadata;\n+                  current_version python:not current[\'isModified\'] and current[\'version_id\']==vdatai;\n+                  even repeat/vdatai/even;\n+                "\n+                tal:attributes="\n+                  class python:(current_version and \'CurrentVersion\' or \'\') + (even and \' even\' or \'\');\n+                "\n+            >\n+              <td class="VersionId">\n+                <span tal:condition="current_version"\n+                      i18n:translate=""\n+                >Current revision</span>\n+                <span tal:condition="not:current_version"\n+                      tal:content="id"\n+                >1</span>\n+                <a class="version-table-version"\n+                   href="#"\n+                   tal:condition="python:version_id!=id and not current_version"\n+                   tal:attributes="\n+                     href string:${here_url}/versions_history_form?version_id=${id}#version_preview;\n+                   "\n+                   i18n:translate="label_preview_version_link"\n+                >(preview)</a>\n+                <a class="version-table-version"\n+                   href="#"\n+                   tal:condition="python:version_id==id"\n+                   tal:attributes="\n+                     href string:${here_url}/versions_history_form?version_id=${id}#version_preview;\n+                   "\n+                   i18n:translate="label_preview_version_below"\n+                >(jump down)</a>\n+              </td>\n+              <td class="VersionUser">\n+                <span tal:content="vdata/sys_metadata/principal">francesco</span>\n+              </td>\n+              <td class="VersionDate">\n+                <span tal:content="python:context.toLocalizedTime(vdata[\'sys_metadata\'][\'timestamp\'],long_format=1)">2004/10/21 03:15 PM</span>\n+              </td>\n+              <td class="VersionComment">\n+                <span tal:content="vdata/sys_metadata/comment"\n+                      i18n:translate=""\n+                >Draft version ready for comments from the group.</span>\n+              </td>\n+              <td class="VersionActions">\n+                <ul>\n+                  <tal:diffs condition="can_diff">\n+                    <li tal:condition="not:current_version">\n+                      <a href=""\n+                         style="text-decoration: none"\n+                         tal:attributes="\n+                           href string:${here_url}/@@history?one=current&amp;two=${id};\n+                         "\n+                         i18n:translate="label_compare_current"\n+                      >\n                             Compare to current revision\n-                            </a>\n-                        </li>\n-                        <li tal:condition="not:repeat/vdatai/end">\n-                            <a href=""\n-                               style="text-decoration: none"\n-                               tal:define="prev_ver python:str(int(id)-1)"\n-                               tal:attributes="href string:${here_url}/@@history?one=${id}&amp;two=${prev_ver}"\n-                               i18n:translate="label_compare_previous">\n+                      </a>\n+                    </li>\n+                    <li tal:condition="not:repeat/vdatai/end">\n+                      <a href=""\n+                         style="text-decoration: none"\n+                         tal:define="\n+                           prev_ver python:str(int(id)-1);\n+                         "\n+                         tal:attributes="\n+                           href string:${here_url}/@@history?one=${id}&amp;two=${prev_ver};\n+                         "\n+                         i18n:translate="label_compare_previous"\n+                      >\n                             Compare to previous revision\n-                            </a>\n-                        </li>\n-                        </tal:diffs>\n-                        <li tal:condition="python: (not current_version) and canRevertToPrevious">\n-\n-                            <form action="" method="post"\n-                                  tal:attributes="action string:$here_url/@@revertversion">\n-                              <input type="hidden" name="version_id" value="" tal:attributes="value id" />\n-                              <input class="standalone" type="submit"\n-                                     i18n:attributes="value label_revert"\n-                                     value="Revert to this revision" /></form>\n-                        </li>\n-                    </ul>\n-                  </td>\n-                </tr>\n-                </tal:block>\n-            </tbody>\n-          </table>\n-\n-    <form action="#"\n-        method="post"\n-        tal:define="here_url context/absolute_url"\n-        tal:attributes="action string:${here_url}/@@saveasnewversion"\n-        tal:condition="not: python:pr.supportsPolicy(context, \'at_edit_autoversion\')">\n+                      </a>\n+                    </li>\n+                  </tal:diffs>\n+                  <li tal:condition="python: (not current_version) and canRevertToPrevious">\n+\n+                    <form action=""\n+                          method="post"\n+                          tal:attributes="\n+                            action string:$here_url/@@revertversion;\n+                          "\n+                    >\n+                      <input name="version_id"\n+                             type="hidden"\n+                             value=""\n+                             tal:attributes="\n+                               value id;\n+                             "\n+                      />\n+                      <input class="standalone"\n+                             type="submit"\n+                             value="Revert to this revision"\n+                             i18n:attributes="value label_revert"\n+                      /></form>\n+                  </li>\n+                </ul>\n+              </td>\n+            </tr>\n+          </tal:block>\n+        </tbody>\n+      </table>\n+\n+      <form action="#"\n+            method="post"\n+            tal:define="\n+              here_url context/absolute_url;\n+            "\n+            tal:condition="not: python:pr.supportsPolicy(context, \'at_edit_autoversion\')"\n+            tal:attributes="\n+              action string:${here_url}/@@saveasnewversion;\n+            "\n+      >\n \n         <fieldset>\n \n-            <div class="field">\n-              <label for="description"\n-                    i18n:translate="label_newversion">New version</label>\n+          <div class="field">\n+            <label for="description"\n+                   i18n:translate="label_newversion"\n+            >New version</label>\n \n-              <div class="formHelp" i18n:translate="help_versioncomment">\n+            <div class="formHelp"\n+                 i18n:translate="help_versioncomment"\n+            >\n                 At any moment you can save the content you just edited as a new revision. Enter below a comment to identify the version and hit the "Save as new revision" button.\n-              </div>\n-              <textarea cols="60"\n-                        rows="3"\n-                        id="versioncomment"\n-                        name="versioncomment"\n-                        ></textarea>\n             </div>\n+            <textarea id="versioncomment"\n+                      cols="60"\n+                      name="versioncomment"\n+                      rows="3"\n+            ></textarea>\n+          </div>\n \n-            <input class="context"\n-                        type="submit"\n-                        name="saveversion"\n-                        value="Save as new revision"\n-                        i18n:attributes="value button_save_as_new_version"\n-                        />\n+          <input class="context"\n+                 name="saveversion"\n+                 type="submit"\n+                 value="Save as new revision"\n+                 i18n:attributes="value button_save_as_new_version"\n+          />\n \n         </fieldset>\n \n-    </form>\n+      </form>\n \n-    <a name="version_preview">\n-      <label for="description"\n-             tal:condition="version_id"\n-             i18n:translate="label_preview_version">\n-        Preview of Revision <span i18n:name="version_id" tal:replace="version_id">0</span>\n-      </label>\n-    </a>\n-    <div style="border:solid 1px gray"\n-         tal:condition="version_id">\n-      <tal:block define="vdata python:pr.retrieve(context, version_id);\n-                         context nocall:vdata/object;\n-                         portal_type python:context.getPortalTypeName().lower().replace(\' \', \'_\');\n-                         object_title context/Title;\n-                         suppress_preview python:True;\n-                         version_view context/@@version-view|nothing;">\n+      <a name="version_preview">\n+        <label for="description"\n+               tal:condition="version_id"\n+               i18n:translate="label_preview_version"\n+        >\n+        Preview of Revision\n+          <span tal:replace="version_id"\n+                i18n:name="version_id"\n+          >0</span>\n+        </label>\n+      </a>\n+      <div style="border:solid 1px gray"\n+           tal:condition="version_id"\n+      >\n+        <tal:block define="\n+                     vdata python:pr.retrieve(context, version_id);\n+                     context nocall:vdata/object;\n+                     portal_type python:context.getPortalTypeName().lower().replace(\' \', \'_\');\n+                     object_title context/Title;\n+                     suppress_preview python:True;\n+                     version_view context/@@version-view|nothing;\n+                   ">\n \n-        <div tal:replace="structure provider:plone.belowcontenttitle" />\n+          <div tal:replace="structure provider:plone.belowcontenttitle"></div>\n \n-        <h1 class="documentFirstHeading" tal:content="vdata/object/Title"/>\n-        <div class="documentDescription" tal:content="vdata/object/Description"></div>\n+          <h1 class="documentFirstHeading"\n+              tal:content="vdata/object/Title"\n+          ></h1>\n+          <div class="documentDescription"\n+               tal:content="vdata/object/Description"\n+          ></div>\n \n-        <div tal:condition="version_view" tal:replace="structure version_view" />\n+          <div tal:condition="version_view"\n+               tal:replace="structure version_view"\n+          ></div>\n \n-        <tal:noversionview\n-          condition="not:version_view"\n-          define="version_view_macro python:context.restrictedTraverse(\'@@get_macros\')(vdata);">\n+          <tal:noversionview define="\n+                               version_view_macro python:context.restrictedTraverse(\'@@get_macros\')(vdata);\n+                             "\n+                             condition="not:version_view"\n+          >\n \n-          <tal:viewmacro condition="version_view_macro">\n-            <metal:use_body use-macro="version_view_macro" />\n-          </tal:viewmacro>\n+            <tal:viewmacro condition="version_view_macro">\n+              <metal:use_body use-macro="version_view_macro" />\n+            </tal:viewmacro>\n \n-          <div tal:condition="not:version_view_macro" i18n:translate="">Preview is not available.</div>\n+            <div tal:condition="not:version_view_macro"\n+                 i18n:translate=""\n+            >Preview is not available.</div>\n \n-        </tal:noversionview>\n+          </tal:noversionview>\n \n-      </tal:block>\n+        </tal:block>\n \n+      </div>\n     </div>\n-  </div>\n   </metal:main>\n </html>\ndiff --git a/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt b/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt\nindex 69fcd32..34ee7c8 100644\n--- a/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt\n+++ b/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Abort Versioning of Large Files and Images Modifier</h2>\n \n-<form action="manage_addAbortVersioningOfLargeFilesAndImages" method="post">\n+<form action="manage_addAbortVersioningOfLargeFilesAndImages"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt b/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt\nindex b088e2b..31c099a 100644\n--- a/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt\n+++ b/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add OMInsideChildrens Modifier</h2>\n \n-<form action="manage_addOMInsideChildrensModifier" method="post">\n+<form action="manage_addOMInsideChildrensModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt b/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt\nindex ddc1db5..8ea7704 100644\n--- a/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt\n+++ b/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add OMOutsideChildrens Modifier</h2>\n \n-<form action="manage_addOMInsideChildrensModifier" method="post">\n+<form action="manage_addOMInsideChildrensModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt b/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt\nindex e934f5a..17d9386 100644\n--- a/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt\n+++ b/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add RetainPermissionsSettings Modifier</h2>\n \n-<form action="manage_addRetainPermissionsSettings" method="post">\n+<form action="manage_addRetainPermissionsSettings"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt b/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt\nindex a01495a..1aa780d 100644\n--- a/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt\n+++ b/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add RetainUIDs Modifier</h2>\n \n-<form action="manage_addRetainUIDs" method="post">\n+<form action="manage_addRetainUIDs"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt b/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt\nindex 1e6947b..957ecc5 100644\n--- a/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt\n+++ b/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add RetainWorkflowStateAndHistory Modifier</h2>\n \n-<form action="manage_addRetainWorkflowStateAndHistory" method="post">\n+<form action="manage_addRetainWorkflowStateAndHistory"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt b/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt\nindex 89a61c2..947ae85 100644\n--- a/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt\n+++ b/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add SaveFileDataInFileTypeByReference Modifier</h2>\n \n-<form action="manage_addSaveFileDataInFileTypeByReference" method="post">\n+<form action="manage_addSaveFileDataInFileTypeByReference"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt b/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt\nindex 5360376..a1536df 100644\n--- a/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt\n+++ b/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Silly Modifier For Demos Only</h2>\n \n-<form action="manage_addSillyDemoRetrieveModifier" method="post">\n+<form action="manage_addSillyDemoRetrieveModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt b/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\nindex 4deec27..4508a8c 100644\n--- a/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\n+++ b/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Silly Retrive Modifier For Demos</h2>\n \n-<form action="manage_addSillyDemoRetrieveModifier" method="post">\n+<form action="manage_addSillyDemoRetrieveModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SkipParentPointersAddForm.pt b/Products/CMFEditions/www/SkipParentPointersAddForm.pt\nindex 2524697..60c07c9 100644\n--- a/Products/CMFEditions/www/SkipParentPointersAddForm.pt\n+++ b/Products/CMFEditions/www/SkipParentPointersAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip Versioning of Parent Pointers Modifier</h2>\n \n-<form action="manage_addSkipParentPointers" method="post">\n+<form action="manage_addSkipParentPointers"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt b/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt\nindex ac288ab..e8c0072 100644\n--- a/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt\n+++ b/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip Versioning of Component Registry Bases Modifier</h2>\n \n-<form action="manage_addSkipRegistryBasesPointers" method="post">\n+<form action="manage_addSkipRegistryBasesPointers"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt b/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt\nindex 077867a..39196d0 100644\n--- a/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt\n+++ b/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip Versioning of Large Files and Images Modifier</h2>\n \n-<form action="manage_addSkipVersioningOfLargeFilesAndImages" method="post">\n+<form action="manage_addSkipVersioningOfLargeFilesAndImages"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/Skip_z3c_blobfile.pt b/Products/CMFEditions/www/Skip_z3c_blobfile.pt\nindex 9ca5824..a59d3d0 100644\n--- a/Products/CMFEditions/www/Skip_z3c_blobfile.pt\n+++ b/Products/CMFEditions/www/Skip_z3c_blobfile.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip z3c.blobfile Modifier</h2>\n \n-<form action="manage_addSkip_z3c_blobfile" method="post">\n+<form action="manage_addSkip_z3c_blobfile"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/fieldModifierEditForm.pt b/Products/CMFEditions/www/fieldModifierEditForm.pt\nindex 05f9bfa..d71adfe 100644\n--- a/Products/CMFEditions/www/fieldModifierEditForm.pt\n+++ b/Products/CMFEditions/www/fieldModifierEditForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Edit Modifier</h2>\n \n-<form action="edit" method="post">\n+<form action="edit"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,60 +19,95 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40" tal:attributes="value here/title" />\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/title;\n+               "\n+        />\n       </td>\n     </tr>\n \n-      <tr>\n-        <th>\n+    <tr>\n+      <th>\n           Enabled\n-        </th>\n-        <td>\n-          <input type="checkbox" name="enabled" value="True" tal:attributes="checked here/isEnabled" />\n-        </td>\n-      </tr>\n+      </th>\n+      <td>\n+        <input name="enabled"\n+               type="checkbox"\n+               value="True"\n+               tal:attributes="\n+                 checked here/isEnabled;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n+    <tr>\n+      <th>\n             Condition\n-          </th>\n-          <td>\n-            <input type="text" name="condition" value="" size="80" tal:attributes="value here/getTalesCondition" />\n-          </td>\n-        </tr>\n+      </th>\n+      <td>\n+        <input name="condition"\n+               size="80"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/getTalesCondition;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n+    <tr>\n+      <th>\n             Field names to check\n-          </th>\n-          <td>\n-            <textarea name="field_names" value="" rows="4" cols="25"\n-                      tal:content="here/getFieldNames">\n-            </textarea>\n-          </td>\n-        </tr>\n+      </th>\n+      <td>\n+        <textarea cols="25"\n+                  name="field_names"\n+                  rows="4"\n+                  value=""\n+                  tal:content="here/getFieldNames"\n+        >\n+        </textarea>\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n-            Maximum file size in bytes <br />\n+    <tr>\n+      <th>\n+            Maximum file size in bytes\n+        <br />\n             (should not be set larger than 32768000)\n-          </th>\n-          <td>\n-            <input type="text" name="max_size" value=""\n-                   tal:attributes="value here/max_size" />\n-          </td>\n-        </tr>\n+      </th>\n+      <td>\n+        <input name="max_size"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/max_size;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n-          </th>\n-          <td colspan="2">\n-            <input type="submit" name="submit" value="Save" />\n-          </td>\n-        </tr>\n+    <tr>\n+      <th>\n+      </th>\n+      <td colspan="2">\n+        <input name="submit"\n+               type="submit"\n+               value="Save"\n+        />\n+      </td>\n+    </tr>\n \n-    </table>\n+  </table>\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/modifierAddForm.pt b/Products/CMFEditions/www/modifierAddForm.pt\nindex 568d7fd..9403453 100644\n--- a/Products/CMFEditions/www/modifierAddForm.pt\n+++ b/Products/CMFEditions/www/modifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Modifier</h2>\n \n-<form action="add" method="post">\n+<form action="add"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n     <tr>\n@@ -21,12 +31,19 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n <tal:block content="structure request" />\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/modifierEditForm.pt b/Products/CMFEditions/www/modifierEditForm.pt\nindex 990ead3..ade7f49 100644\n--- a/Products/CMFEditions/www/modifierEditForm.pt\n+++ b/Products/CMFEditions/www/modifierEditForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Edit Modifier</h2>\n \n-<form action="edit" method="post">\n+<form action="edit"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,14 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40" tal:attributes="value here/title"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/title;\n+               "\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +35,22 @@\n         Enabled\n       </th>\n       <td>\n-        <input type="checkbox" name="enabled" value="True" tal:attributes="checked here/isEnabled"/>\n+        <input name="enabled"\n+               type="checkbox"\n+               value="True"\n+               tal:attributes="\n+                 checked here/isEnabled;\n+               "\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Save"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Save"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +58,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/storageStatistics.pt b/Products/CMFEditions/www/storageStatistics.pt\nindex a839533..dc630e9 100644\n--- a/Products/CMFEditions/www/storageStatistics.pt\n+++ b/Products/CMFEditions/www/storageStatistics.pt\n@@ -1,79 +1,98 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n-<tal:block define="statistics here/zmi_getStorageStatistics;\n-                   existing statistics/existing;\n-                   deleted statistics/deleted;\n-                   summaries statistics/summaries;\n-                   ">\n-<h2>Storage Statistics</h2>\n+<tal:block define="\n+             statistics here/zmi_getStorageStatistics;\n+             existing statistics/existing;\n+             deleted statistics/deleted;\n+             summaries statistics/summaries;\n+           ">\n+  <h2>Storage Statistics</h2>\n \n-<p>Calculating the statistics took <span tal:replace="summaries/time" /> seconds.</p>\n+  <p>Calculating the statistics took\n+    <span tal:replace="summaries/time"></span>\n+    seconds.</p>\n \n-<table border="0" cellspacing="0" tal:condition="existing">\n-  <tr>\n-    <th colspan="2" align="left">Number of Histories:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/totalHistories"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of existing items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/existingHistories"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of deleted items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/deletedHistories"></td>\n-  </tr>\n-  <tr>\n-    <th colspan="4"></th>\n-  </tr>\n-  <tr>\n-    <th colspan="2" align="left">Number of Versions:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/totalVersions"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of existing items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/existingVersions"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of deleted items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/deletedVersions"></td>\n-  </tr>\n-  <tr>\n-    <th colspan="4"></th>\n-  </tr>\n-  <tr>\n-    <th colspan="2" align="left">Average Versions per History:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/totalAverage"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of existing items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/existingAverage"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of deleted items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/deletedAverage"></td>\n-  </tr>\n-</table>\n+  <table border="0"\n+         cellspacing="0"\n+         tal:condition="existing"\n+  >\n+    <tr>\n+      <th align="left"\n+          colspan="2"\n+      >Number of Histories:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/totalHistories"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of existing items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/existingHistories"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of deleted items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/deletedHistories"></td>\n+    </tr>\n+    <tr>\n+      <th colspan="4"></th>\n+    </tr>\n+    <tr>\n+      <th align="left"\n+          colspan="2"\n+      >Number of Versions:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/totalVersions"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of existing items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/existingVersions"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of deleted items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/deletedVersions"></td>\n+    </tr>\n+    <tr>\n+      <th colspan="4"></th>\n+    </tr>\n+    <tr>\n+      <th align="left"\n+          colspan="2"\n+      >Average Versions per History:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/totalAverage"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of existing items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/existingAverage"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of deleted items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/deletedAverage"></td>\n+    </tr>\n+  </table>\n \n-<h3>Existing Working Copies</h3>\n+  <h3>Existing Working Copies</h3>\n \n   <p tal:condition="not:existing">None</p>\n-  <table border="1" cellspacing="0" tal:condition="existing">\n+  <table border="1"\n+         cellspacing="0"\n+         tal:condition="existing"\n+  >\n \n     <tr>\n       <th align="left">\n@@ -99,19 +118,29 @@\n     <tr tal:repeat="histData existing">\n       <td tal:content="histData/history_id">history id</td>\n       <td tal:content="histData/length">length</td>\n-      <td align="right" tal:content="histData/size">size</td>\n-      <td align="right" tal:content="histData/sizeState">size state</td>\n+      <td align="right"\n+          tal:content="histData/size"\n+      >size</td>\n+      <td align="right"\n+          tal:content="histData/sizeState"\n+      >size state</td>\n       <td tal:content="histData/portal_type">portal type</td>\n-      <td><a tal:attributes="href histData/url"\n-             tal:content="histData/path">current path</a></td>\n+      <td><a tal:content="histData/path"\n+           tal:attributes="\n+             href histData/url;\n+           "\n+        >current path</a></td>\n     </tr>\n \n   </table>\n \n-<h3>Deleted Working Copies</h3>\n+  <h3>Deleted Working Copies</h3>\n \n   <p tal:condition="not:deleted">None</p>\n-  <table border="1" cellspacing="0" tal:condition="deleted">\n+  <table border="1"\n+         cellspacing="0"\n+         tal:condition="deleted"\n+  >\n \n     <tr>\n       <th align="left">\n@@ -134,8 +163,12 @@\n     <tr tal:repeat="histData deleted">\n       <td tal:content="histData/history_id">history id</td>\n       <td tal:content="histData/length">length</td>\n-      <td align="right" tal:content="histData/size">size</td>\n-      <td align="right" tal:content="histData/sizeState">size state</td>\n+      <td align="right"\n+          tal:content="histData/size"\n+      >size</td>\n+      <td align="right"\n+          tal:content="histData/sizeState"\n+      >size state</td>\n       <td tal:content="histData/portal_type">portal type</td>\n     </tr>\n \n@@ -143,4 +176,6 @@\n \n </tal:block>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/talesModifierEditForm.pt b/Products/CMFEditions/www/talesModifierEditForm.pt\nindex f22d212..f0c7802 100644\n--- a/Products/CMFEditions/www/talesModifierEditForm.pt\n+++ b/Products/CMFEditions/www/talesModifierEditForm.pt\n@@ -1,9 +1,15 @@\n-<p tal:replace="structure context/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure context/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure context/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure context/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n <h2>Edit Modifier</h2>\n \n-<form action="edit" method="post">\n+<form action="edit"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -12,36 +18,61 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40" tal:attributes="value context/title"/>\n-        </td>\n-      </tr>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value context/title;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-      <tr>\n-        <th>\n+    <tr>\n+      <th>\n           Enabled\n-        </th>\n-        <td>\n-          <input type="checkbox" name="enabled" value="True" tal:attributes="checked context/isEnabled"/>\n-          </td>\n-        </tr>\n-\n-        <tr>\n-          <th>\n+      </th>\n+      <td>\n+        <input name="enabled"\n+               type="checkbox"\n+               value="True"\n+               tal:attributes="\n+                 checked context/isEnabled;\n+               "\n+        />\n+      </td>\n+    </tr>\n+\n+    <tr>\n+      <th>\n             Condition\n-          </th>\n-          <td>\n-            <input type="text" name="condition" value="" size="80" tal:attributes="value context/getTalesCondition"/>\n-            </td>\n-      </tr>\n+      </th>\n+      <td>\n+        <input name="condition"\n+               size="80"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value context/getTalesCondition;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-      <tr>\n-        <td colspan="2">\n-          <input type="submit" name="submit" value="Save"/>\n-          </td>\n-        </tr>\n+    <tr>\n+      <td colspan="2">\n+        <input name="submit"\n+               type="submit"\n+               value="Save"\n+        />\n+      </td>\n+    </tr>\n \n-    </table>\n+  </table>\n \n </form>\n \n-<p tal:replace="structure context/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure context/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/doc/DevelDoc.html b/doc/DevelDoc.html\nindex 0d5a2bd..4e15fe7 100644\n--- a/doc/DevelDoc.html\n+++ b/doc/DevelDoc.html\n@@ -1,119 +1,199 @@\n <?xml version="1.0" encoding="UTF-8" ?>\n <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n-<head>\n-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n-<meta name="generator" content="Docutils 0.3.7: http://docutils.sourceforge.net/" />\n-<title>CMFEditions: Versioning in Plone</title>\n-<meta name="author" content="Gr\xc3\xa9goire Weber (gregweb)" />\n-<meta name="author" content="... (please fill in your name here)" />\n-<meta name="date" content="2005-03-22" />\n-<meta name="copyright" content="Gr\xc3\xa9goire Weber" />\n-</head>\n-<body>\n-<div class="document" id="cmfeditions-versioning-in-plone">\n-<h1 class="title">CMFEditions: Versioning in Plone</h1>\n-<h2 class="subtitle" id="developer-documentation">Developer Documentation</h2>\n-<table class="docinfo" frame="void" rules="none">\n-<col class="docinfo-name" />\n-<col class="docinfo-content" />\n-<tbody valign="top">\n-<tr><th class="docinfo-name">Author:</th>\n-<td>Gr\xc3\xa9goire Weber (gregweb)</td></tr>\n-<tr><th class="docinfo-name">Author:</th>\n-<td>... (please fill in your name here)</td></tr>\n-<tr><th class="docinfo-name">Contact:</th>\n-<td><a class="first last reference" href="mailto:gregweb&#64;incept.ch">gregweb&#64;incept.ch</a></td></tr>\n-<tr><th class="docinfo-name">Date:</th>\n-<td>2005-03-22</td></tr>\n-<tr><th class="docinfo-name">Revision:</th>\n-<td>1.4</td></tr>\n-<tr><th class="docinfo-name">Copyright:</th>\n-<td>Gr\xc3\xa9goire Weber</td></tr>\n-<tr class="field"><th class="docinfo-name">License:</th><td class="field-body">GNU Free Documentation License</td>\n-</tr>\n-<tr><th class="docinfo-name">Status:</th>\n-<td>Draft</td></tr>\n-<tr class="field"><th class="docinfo-name">Audience:</th><td class="field-body">Developers</td>\n-</tr>\n-</tbody>\n-</table>\n-<div class="abstract topic">\n-<p class="topic-title first">Abstract</p>\n-<p>The CMFEditions architecture looks like beeing overly complex.\n+<html xmlns="http://www.w3.org/1999/xhtml"\n+      lang="en"\n+      xml:lang="en"\n+>\n+  <head>\n+    <meta http-equiv="Content-Type"\n+          content="text/html; charset=UTF-8"\n+    />\n+    <meta name="generator"\n+          content="Docutils 0.3.7: http://docutils.sourceforge.net/"\n+    />\n+    <title>CMFEditions: Versioning in Plone</title>\n+    <meta name="author"\n+          content="Gr\xc3\xa9goire Weber (gregweb)"\n+    />\n+    <meta name="author"\n+          content="... (please fill in your name here)"\n+    />\n+    <meta name="date"\n+          content="2005-03-22"\n+    />\n+    <meta name="copyright"\n+          content="Gr\xc3\xa9goire Weber"\n+    />\n+  </head>\n+  <body>\n+    <div class="document"\n+         id="cmfeditions-versioning-in-plone"\n+    >\n+      <h1 class="title">CMFEditions: Versioning in Plone</h1>\n+      <h2 class="subtitle"\n+          id="developer-documentation"\n+      >Developer Documentation</h2>\n+      <table class="docinfo"\n+             frame="void"\n+             rules="none"\n+      >\n+        <col class="docinfo-name" />\n+        <col class="docinfo-content" />\n+        <tbody valign="top">\n+          <tr><th class="docinfo-name">Author:</th>\n+            <td>Gr&eacute;goire Weber (gregweb)</td></tr>\n+          <tr><th class="docinfo-name">Author:</th>\n+            <td>... (please fill in your name here)</td></tr>\n+          <tr><th class="docinfo-name">Contact:</th>\n+            <td><a class="first last reference"\n+                 href="mailto:gregweb&#64;incept.ch"\n+              >gregweb&#64;incept.ch</a></td></tr>\n+          <tr><th class="docinfo-name">Date:</th>\n+            <td>2005-03-22</td></tr>\n+          <tr><th class="docinfo-name">Revision:</th>\n+            <td>1.4</td></tr>\n+          <tr><th class="docinfo-name">Copyright:</th>\n+            <td>Gr&eacute;goire Weber</td></tr>\n+          <tr class="field"><th class="docinfo-name">License:</th><td class="field-body">GNU Free Documentation License</td>\n+          </tr>\n+          <tr><th class="docinfo-name">Status:</th>\n+            <td>Draft</td></tr>\n+          <tr class="field"><th class="docinfo-name">Audience:</th><td class="field-body">Developers</td>\n+          </tr>\n+        </tbody>\n+      </table>\n+      <div class="abstract topic">\n+        <p class="topic-title first">Abstract</p>\n+        <p>The CMFEditions architecture looks like beeing overly complex.\n The complexity has it\'s reasons in Python itself but also in the goal\n of CMFEditions not to rely on specific behaviour of content objects.\n This document shall help developers to grok the architecture and ideas\n behind CMFEditions by unfolding one aspect after the other.</p>\n-<p>This document emerged from the notes for a presentation for PyCon 2005\n+        <p>This document emerged from the notes for a presentation for PyCon 2005\n I (gregweb) couldn\'t hold because of a flu.</p>\n-</div>\n-<div class="contents topic" id="table-of-contents">\n-<p class="topic-title first"><a name="table-of-contents">Table of Contents</a></p>\n-<ul class="simple">\n-<li><a class="reference" href="#about-versioning" id="id7" name="id7">About Versioning</a></li>\n-<li><a class="reference" href="#what-is-a-python-object" id="id8" name="id8">What is a Python Object?</a></li>\n-<li><a class="reference" href="#folderish-objects-folder" id="id9" name="id9">Folderish Objects: Folder</a></li>\n-<li><a class="reference" href="#folderish-objects-f-a-q-page" id="id10" name="id10">Folderish Objects: F.A.Q.-Page</a></li>\n-<li><a class="reference" href="#object-attributes-and-inside-and-outside-references" id="id11" name="id11">Object Attributes and Inside and Outside References</a></li>\n-<li><a class="reference" href="#the-copy-mechanism" id="id12" name="id12">The Copy Mechanism</a><ul>\n-<li><a class="reference" href="#modifers" id="id13" name="id13">Modifers</a></li>\n-</ul>\n-</li>\n-<li><a class="reference" href="#overwiew-over-the-architecture" id="id14" name="id14">Overwiew over the Architecture</a></li>\n-<li><a class="reference" href="#further-reading" id="id15" name="id15">Further Reading</a></li>\n-</ul>\n-</div>\n-<div class="section" id="about-versioning">\n-<h1><a class="toc-backref" href="#id7" name="about-versioning">About Versioning</a></h1>\n-<p>Just some words about what we talk about when we\'re saying &quot;versioning&quot;.</p>\n-<blockquote>\n-<p>Versioning essentially means:</p>\n-<ul class="simple">\n-<li>save the state of an object for later retrieval</li>\n-<li>retrieve a former state of an object</li>\n-<li>do some management stuff like showing the history, if an object is up\n+      </div>\n+      <div class="contents topic"\n+           id="table-of-contents"\n+      >\n+        <p class="topic-title first"><a name="table-of-contents">Table of Contents</a></p>\n+        <ul class="simple">\n+          <li><a class="reference"\n+               id="id7"\n+               href="#about-versioning"\n+               name="id7"\n+            >About Versioning</a></li>\n+          <li><a class="reference"\n+               id="id8"\n+               href="#what-is-a-python-object"\n+               name="id8"\n+            >What is a Python Object?</a></li>\n+          <li><a class="reference"\n+               id="id9"\n+               href="#folderish-objects-folder"\n+               name="id9"\n+            >Folderish Objects: Folder</a></li>\n+          <li><a class="reference"\n+               id="id10"\n+               href="#folderish-objects-f-a-q-page"\n+               name="id10"\n+            >Folderish Objects: F.A.Q.-Page</a></li>\n+          <li><a class="reference"\n+               id="id11"\n+               href="#object-attributes-and-inside-and-outside-references"\n+               name="id11"\n+            >Object Attributes and Inside and Outside References</a></li>\n+          <li><a class="reference"\n+               id="id12"\n+               href="#the-copy-mechanism"\n+               name="id12"\n+            >The Copy Mechanism</a><ul>\n+              <li><a class="reference"\n+                   id="id13"\n+                   href="#modifers"\n+                   name="id13"\n+                >Modifers</a></li>\n+            </ul>\n+          </li>\n+          <li><a class="reference"\n+               id="id14"\n+               href="#overwiew-over-the-architecture"\n+               name="id14"\n+            >Overwiew over the Architecture</a></li>\n+          <li><a class="reference"\n+               id="id15"\n+               href="#further-reading"\n+               name="id15"\n+            >Further Reading</a></li>\n+        </ul>\n+      </div>\n+      <div class="section"\n+           id="about-versioning"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id7"\n+             name="about-versioning"\n+          >About Versioning</a></h1>\n+        <p>Just some words about what we talk about when we\'re saying &quot;versioning&quot;.</p>\n+        <blockquote>\n+          <p>Versioning essentially means:</p>\n+          <ul class="simple">\n+            <li>save the state of an object for later retrieval</li>\n+            <li>retrieve a former state of an object</li>\n+            <li>do some management stuff like showing the history, if an object is up\n to date, etc.</li>\n-</ul>\n-</blockquote>\n-<p>In this document we concentrate on the first two points (<em>save</em> and\n-<em>retreive</em> the state of something). But what does save <em>save the current\n-state</em> mean?</p>\n-<p>Imagine you don\'t have access to a CVS or SVN repository but you\'re writing\n+          </ul>\n+        </blockquote>\n+        <p>In this document we concentrate on the first two points (<em>save</em>\n+           and\n+          <em>retreive</em>\n+          the state of something). But what does save\n+          <em>save the current\n+state</em>\n+          mean?</p>\n+        <p>Imagine you don\'t have access to a CVS or SVN repository but you\'re writing\n an article. What are you usually doing to preserve important milestones of\n your article? From time to time you make a copy of your document\n (article.rst), append a number to it (article_003.rst) and move it\n-to an <tt class="docutils literal"><span class="pre">old_versions</span></tt> folder.</p>\n-<p>Versioning just means that! The copy operation above is a deep copy as you\n+to an\n+          <tt class="docutils literal"><span class="pre">old_versions</span></tt>\n+          folder.</p>\n+        <p>Versioning just means that! The copy operation above is a deep copy as you\n like to have preserved the whole state to be able to retrieve it entirely\n later.</p>\n-</div>\n-<div class="section" id="what-is-a-python-object">\n-<h1><a class="toc-backref" href="#id8" name="what-is-a-python-object">What is a Python Object?</a></h1>\n-<p>First let\'s start with something well known:</p>\n-<p>A python object is a dictionary:</p>\n-<pre class="literal-block">\n+      </div>\n+      <div class="section"\n+           id="what-is-a-python-object"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id8"\n+             name="what-is-a-python-object"\n+          >What is a Python Object?</a></h1>\n+        <p>First let\'s start with something well known:</p>\n+        <p>A python object is a dictionary:</p>\n+        <pre class="literal-block">\n &gt;&gt;&gt; class A: pass\n ...\n &gt;&gt;&gt; a = A()\n &gt;&gt;&gt; a.__dict__\n {}\n </pre>\n-<p>The data the object carries need not be soley set by code of the class\n+        <p>The data the object carries need not be soley set by code of the class\n implementation:</p>\n-<pre class="literal-block">\n+        <pre class="literal-block">\n &gt;&gt;&gt; a.x=5\n &gt;&gt;&gt; a.__dict__\n {\'x\': 5}\n &gt;&gt;&gt;\n </pre>\n-<p>So there is in fact no control over who stores what for information in the\n+        <p>So there is in fact no control over who stores what for information in the\n object. In Zope setting attributes at &quot;foreign&quot; objects is quite normal.\n A versioning solution has to handle that (by simply saving away a copy of\n-the <tt class="docutils literal"><span class="pre">__dict__</span></tt>).</p>\n-<p>So let\'s have a look at real Zope (2.x) object. As expected, every data\n-the object carries is found in the objects <tt class="docutils literal"><span class="pre">__dict__</span></tt>:</p>\n-<pre class="literal-block">\n+the\n+          <tt class="docutils literal"><span class="pre">__dict__</span></tt>).</p>\n+        <p>So let\'s have a look at real Zope (2.x) object. As expected, every data\n+the object carries is found in the objects\n+          <tt class="docutils literal"><span class="pre">__dict__</span></tt>:</p>\n+        <pre class="literal-block">\n &gt;&gt;&gt; PrettyPrinter().pprint(doc.__dict__)\n {\n   \'_Access_contents_information_Permission\': [\'Anonymous\',\n@@ -146,13 +226,19 @@ <h1><a class="toc-backref" href="#id8" name="what-is-a-python-object">What is a\n     \'time\': DateTime(\'2005/02/14 20:03:37.250 GMT+1\')},)}\n }\n </pre>\n-<p>Looks quite meaningfull! To store a version just make a (deep) copy of\n-<tt class="docutils literal"><span class="pre">doc</span></tt> and store the copy away for later retrieval.</p>\n-</div>\n-<div class="section" id="folderish-objects-folder">\n-<h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish Objects: Folder</a></h1>\n-<p>No let us have a look at a folderish object:</p>\n-<pre class="literal-block">\n+        <p>Looks quite meaningfull! To store a version just make a (deep) copy of\n+          <tt class="docutils literal"><span class="pre">doc</span></tt>\n+          and store the copy away for later retrieval.</p>\n+      </div>\n+      <div class="section"\n+           id="folderish-objects-folder"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id9"\n+             name="folderish-objects-folder"\n+          >Folderish Objects: Folder</a></h1>\n+        <p>No let us have a look at a folderish object:</p>\n+        <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder.__dict__)\n {\n@@ -185,10 +271,10 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n     \'time\': DateTime(\'2005/02/14 20:03:37.187 GMT+1\')},)}\n }\n </pre>\n-<p>It looks a little unclear what some of the stuff here is for! Ok as Zope\n+        <p>It looks a little unclear what some of the stuff here is for! Ok as Zope\n geek you know what\'s interesting and what isn\'t. Let\'s just strip away the\n unimportant stuff:</p>\n-<pre class="literal-block">\n+        <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder.__dict__)\n {\n@@ -200,32 +286,54 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n   ...\n }\n </pre>\n-<p>From the <tt class="docutils literal"><span class="pre">_objects</span></tt> attribute we conclude it is an ObjectManager (the\n+        <p>From the\n+          <tt class="docutils literal"><span class="pre">_objects</span></tt>\n+           attribute we conclude it is an ObjectManager (the\n Zope base class for folderish content types).</p>\n-<p>So lets just make a deep copy of everything. <strong>Stop!</strong> What if a folder\n+        <p>So lets just make a deep copy of everything.\n+          <strong>Stop!</strong>\n+           What if a folder\n would conaitn another folder and this subfolder will contain a whole site\n with hundreds of folders?</p>\n-<p>We just would version the whole subtree! Ok, we have to copy deeply but\n+        <p>We just would version the whole subtree! Ok, we have to copy deeply but\n have to stop at some point!</p>\n-<p>Ok, it looks like the <tt class="docutils literal"><span class="pre">_objects</span></tt> contains the ids of the subobjects of\n+        <p>Ok, it looks like the\n+          <tt class="docutils literal"><span class="pre">_objects</span></tt>\n+           contains the ids of the subobjects of\n the folder. So let\'s write down what has to be done:</p>\n-<ul class="simple">\n-<li>deep copy all the stuff except the <tt class="docutils literal"><span class="pre">doc1</span></tt> and the <tt class="docutils literal"><span class="pre">doc2</span></tt> attribute.</li>\n-<li>recurse into the subobjects and version them separately.\n-<strong>Stop!</strong> The same problem as before arrises. We just version the whole\n+        <ul class="simple">\n+          <li>deep copy all the stuff except the\n+            <tt class="docutils literal"><span class="pre">doc1</span></tt>\n+            and the\n+            <tt class="docutils literal"><span class="pre">doc2</span></tt>\n+            attribute.</li>\n+          <li>recurse into the subobjects and version them separately.\n+            <strong>Stop!</strong>\n+             The same problem as before arrises. We just version the whole\n subtree!</li>\n-<li>And we forgot to think about how to track the subobjects from the\n+          <li>And we forgot to think about how to track the subobjects from the\n viewpoint of the folder.</li>\n-</ul>\n-<p>Ok, the solution is:</p>\n-<ol class="arabic">\n-<li><p class="first">Replace the hard python references to the subobjects\n-(<tt class="docutils literal"><span class="pre">&lt;Document</span> <span class="pre">at</span> <span class="pre">doc1&gt;</span></tt> and <tt class="docutils literal"><span class="pre">&lt;Document</span> <span class="pre">at</span> <span class="pre">doc2&gt;</span></tt>) by a version aware\n-week reference. In CMFEditions this is done by replacing the <tt class="docutils literal"><span class="pre">doc1</span></tt>\n-resp. the <tt class="docutils literal"><span class="pre">doc2</span></tt> attribute by an object holding the so called\n-<tt class="docutils literal"><span class="pre">history_id</span></tt> (a unique id within at least the portal) and\n-<tt class="docutils literal"><span class="pre">version_id</span></tt> (another unique id within the subobjects history):</p>\n-<pre class="literal-block">\n+        </ul>\n+        <p>Ok, the solution is:</p>\n+        <ol class="arabic">\n+          <li><p class="first">Replace the hard python references to the subobjects\n+(<tt class="docutils literal"><span class="pre">&lt;Document</span>\n+                <span class="pre">at</span>\n+                <span class="pre">doc1&gt;</span></tt>\n+              and\n+              <tt class="docutils literal"><span class="pre">&lt;Document</span>\n+                <span class="pre">at</span>\n+                <span class="pre">doc2&gt;</span></tt>) by a version aware\n+week reference. In CMFEditions this is done by replacing the\n+              <tt class="docutils literal"><span class="pre">doc1</span></tt>\n+resp. the\n+              <tt class="docutils literal"><span class="pre">doc2</span></tt>\n+               attribute by an object holding the so called\n+              <tt class="docutils literal"><span class="pre">history_id</span></tt>\n+               (a unique id within at least the portal) and\n+              <tt class="docutils literal"><span class="pre">version_id</span></tt>\n+              (another unique id within the subobjects history):</p>\n+            <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder.__dict__)\n {\n@@ -237,11 +345,13 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n   ...\n }\n </pre>\n-</li>\n-<li><p class="first">We just assume the subobjects got already versioned before. For the\n-moment let us assume that just to make life simpler. So <tt class="docutils literal"><span class="pre">doc1</span></tt> looks\n+          </li>\n+          <li><p class="first">We just assume the subobjects got already versioned before. For the\n+moment let us assume that just to make life simpler. So\n+              <tt class="docutils literal"><span class="pre">doc1</span></tt>\n+               looks\n like this:</p>\n-<pre class="literal-block">\n+            <pre class="literal-block">\n &gt;&gt;&gt; PrettyPrinter().pprint(doc1.__dict__)\n {\n   \'title\': &quot;Document 1&quot;,\n@@ -250,105 +360,201 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n   ...\n }\n </pre>\n-</li>\n-<li><p class="first">Save the object.</p>\n-</li>\n-</ol>\n-<p>Ok, that\'s quite right but not 100%. There is a problem remaining:</p>\n-<ul class="simple">\n-<li>We can not replace the python references to the subobjects on the\n+          </li>\n+          <li><p class="first">Save the object.</p>\n+          </li>\n+        </ol>\n+        <p>Ok, that\'s quite right but not 100%. There is a problem remaining:</p>\n+        <ul class="simple">\n+          <li>We can not replace the python references to the subobjects on the\n original (and changing the working copy in the Zope tree).</li>\n-<li>But we can\'t first copy and then replace the subobjects neither.</li>\n-</ul>\n-<p>The solution:</p>\n-<ul class="simple">\n-<li>Replace the python reference to the subobjects during the copy\n-mechanism. Let\'s have a look at this later at <a class="reference" href="#the-copy-mechanism">The Copy Mechanism</a>.</li>\n-</ul>\n-</div>\n-<div class="section" id="folderish-objects-f-a-q-page">\n-<h1><a class="toc-backref" href="#id10" name="folderish-objects-f-a-q-page">Folderish Objects: F.A.Q.-Page</a></h1>\n-<p>Now let\'s assume we customized the <tt class="docutils literal"><span class="pre">Folder</span></tt> content type in a way we\n+          <li>But we can\'t first copy and then replace the subobjects neither.</li>\n+        </ul>\n+        <p>The solution:</p>\n+        <ul class="simple">\n+          <li>Replace the python reference to the subobjects during the copy\n+mechanism. Let\'s have a look at this later at\n+            <a class="reference"\n+               href="#the-copy-mechanism"\n+            >The Copy Mechanism</a>.</li>\n+        </ul>\n+      </div>\n+      <div class="section"\n+           id="folderish-objects-f-a-q-page"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id10"\n+             name="folderish-objects-f-a-q-page"\n+          >Folderish Objects: F.A.Q.-Page</a></h1>\n+        <p>Now let\'s assume we customized the\n+          <tt class="docutils literal"><span class="pre">Folder</span></tt>\n+           content type in a way we\n can use it for F.A.Q.-Page (this is a commonly used pattern in CMF/Plone\n-sites, it\'s just done by defining that the <tt class="docutils literal"><span class="pre">title</span></tt> and the\n-<tt class="docutils literal"><span class="pre">description</span></tt> of a document are the question part and the <tt class="docutils literal"><span class="pre">body</span></tt> is\n-the answer part. Additionaly a template <tt class="docutils literal"><span class="pre">faq_view</span></tt> showing all\n+sites, it\'s just done by defining that the\n+          <tt class="docutils literal"><span class="pre">title</span></tt>\n+           and the\n+          <tt class="docutils literal"><span class="pre">description</span></tt>\n+          of a document are the question part and the\n+          <tt class="docutils literal"><span class="pre">body</span></tt>\n+           is\n+the answer part. Additionaly a template\n+          <tt class="docutils literal"><span class="pre">faq_view</span></tt>\n+           showing all\n questions at once has to be added).</p>\n-<p>In step 2. above we assumed the subobjects don\'t get saved on a save\n+        <p>In step 2. above we assumed the subobjects don\'t get saved on a save\n operation of the folder. This assumption is now wrong for the F.A.Q.-Page.\n We wan\'t the subobjects be saved in case we save the whole F.A.Q.-Page.\n But how to distinguish the F.A.Q.-Page form a normal folder? The\n-F.A.Q.-Page uses the same underlying code as the <tt class="docutils literal"><span class="pre">Folder</span></tt>. Ok, the\n-<tt class="docutils literal"><span class="pre">portal_type</span></tt> attribute has a different value (e.g. <tt class="docutils literal"><span class="pre">FAQPage</span></tt>), so\n+F.A.Q.-Page uses the same underlying code as the\n+          <tt class="docutils literal"><span class="pre">Folder</span></tt>. Ok, the\n+          <tt class="docutils literal"><span class="pre">portal_type</span></tt>\n+          attribute has a different value (e.g.\n+          <tt class="docutils literal"><span class="pre">FAQPage</span></tt>), so\n the F.A.Q.-Page is distinguishable from a normal folder by the\n versioning system.</p>\n-</div>\n-<div class="section" id="object-attributes-and-inside-and-outside-references">\n-<h1><a class="toc-backref" href="#id11" name="object-attributes-and-inside-and-outside-references">Object Attributes and Inside and Outside References</a></h1>\n-<p>In CMFEditions there are three &quot;areas&quot; where information may live in\n+      </div>\n+      <div class="section"\n+           id="object-attributes-and-inside-and-outside-references"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id11"\n+             name="object-attributes-and-inside-and-outside-references"\n+          >Object Attributes and Inside and Outside References</a></h1>\n+        <p>In CMFEditions there are three &quot;areas&quot; where information may live in\n an object:</p>\n-<ol class="loweralpha simple">\n-<li>in the <em>core</em> of the object like e.g. the <tt class="docutils literal"><span class="pre">title</span></tt> attributes\n+        <ol class="loweralpha simple">\n+          <li>in the\n+            <em>core</em>\n+            of the object like e.g. the\n+            <tt class="docutils literal"><span class="pre">title</span></tt>\n+             attributes\n (usually everything except content objects)</li>\n-<li>outside of the core of the object but nevertheless <em>closely related</em>\n-to the object. We gave them the name <em>inside references</em>. In the\n+          <li>outside of the core of the object but nevertheless\n+            <em>closely related</em>\n+to the object. We gave them the name\n+            <em>inside references</em>. In the\n examples above the document subobjects in a F.A.Q.-Page are of such\n type.</li>\n-<li>outside of the core of the object and <em>loosely related</em> to the object.\n-We gave them the name <em>outside references</em>. In the examples\n+          <li>outside of the core of the object and\n+            <em>loosely related</em>\n+             to the object.\n+We gave them the name\n+            <em>outside references</em>. In the examples\n above the document subobjects in a folder are of such type.</li>\n-</ol>\n-<div class="image"><img alt="The different areas where information can live." height="132" src="img/areas.gif" width="138" /></div>\n-<p>We didn\'t talk about the criterias that decide to what onionskin an\n-attribute belongs. See <a class="reference" href="#modifers">Modifers</a> for this.</p>\n-</div>\n-<div class="section" id="the-copy-mechanism">\n-<h1><a class="toc-backref" href="#id12" name="the-copy-mechanism">The Copy Mechanism</a></h1>\n-<p>Just to remember:</p>\n-<blockquote>\n+        </ol>\n+        <div class="image"><img alt="The different areas where information can live."\n+               height="132"\n+               src="img/areas.gif"\n+               width="138"\n+          /></div>\n+        <p>We didn\'t talk about the criterias that decide to what onionskin an\n+attribute belongs. See\n+          <a class="reference"\n+             href="#modifers"\n+          >Modifers</a>\n+          for this.</p>\n+      </div>\n+      <div class="section"\n+           id="the-copy-mechanism"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id12"\n+             name="the-copy-mechanism"\n+          >The Copy Mechanism</a></h1>\n+        <p>Just to remember:</p>\n+        <blockquote>\n We can not deeply copy an object and then cut at the necessary places as\n the deepcopy operation could be very costy (probably cloning a whole\n subsite). We can\'t cut before the copy operation neither as this would\n change the original.</blockquote>\n-<p>So we need to intercept the copy mechanism!</p>\n-<p>This can be done by using one of Pythons serializer: <tt class="docutils literal"><span class="pre">pickle</span></tt></p>\n-<p>Before continueing please read the <a class="reference" href="http://python.org/doc/2.4/lib/module-pickle.html">chapter about pickling</a> in the python\n+        <p>So we need to intercept the copy mechanism!</p>\n+        <p>This can be done by using one of Pythons serializer:\n+          <tt class="docutils literal"><span class="pre">pickle</span></tt></p>\n+        <p>Before continueing please read the\n+          <a class="reference"\n+             href="http://python.org/doc/2.4/lib/module-pickle.html"\n+          >chapter about pickling</a>\n+           in the python\n documentation. For those who like to have a look at the &quot;real code&quot; see\n-<tt class="docutils literal"><span class="pre">class</span> <span class="pre">OMBaseModifier</span></tt> in <a class="reference" href="http://cvs.sourceforge.net/viewcvs.py/collective/CMFEditions/StandardModifiers.py?rev=1.4&amp;view=auto">StandardModifier.py</a>.</p>\n-<p>Just a short resume about pickling:</p>\n-<ul class="simple">\n-<li>There is a hook called <tt class="docutils literal"><span class="pre">persistent_id</span></tt> that get\'s called upon every\n+          <tt class="docutils literal"><span class="pre">class</span>\n+            <span class="pre">OMBaseModifier</span></tt>\n+          in\n+          <a class="reference"\n+             href="http://cvs.sourceforge.net/viewcvs.py/collective/CMFEditions/StandardModifiers.py?rev=1.4&amp;view=auto"\n+          >StandardModifier.py</a>.</p>\n+        <p>Just a short resume about pickling:</p>\n+        <ul class="simple">\n+          <li>There is a hook called\n+            <tt class="docutils literal"><span class="pre">persistent_id</span></tt>\n+             that get\'s called upon every\n object during the serialization process.</li>\n-<li>In this hook you can decide if the object just has to be serialized as\n+          <li>In this hook you can decide if the object just has to be serialized as\n usual or you may return your own serialization of it.</li>\n-<li>There is another hook <tt class="docutils literal"><span class="pre">persistent_load</span></tt> that get\'s called upon every\n+          <li>There is another hook\n+            <tt class="docutils literal"><span class="pre">persistent_load</span></tt>\n+             that get\'s called upon every\n custom serialized object during the deserialization process.</li>\n-</ul>\n-<p>In case of a folder we know which of the attributes are the subobjects.\n-We just keep their python id <a class="footnote-reference" href="#id3" id="id1" name="id1">[1]</a> in &quot;mind&quot;. In the <tt class="docutils literal"><span class="pre">persistent_id</span></tt> hook\n-the currently passed objects <tt class="docutils literal"><span class="pre">id</span></tt> get checked if it is one of the\n-memorized <tt class="docutils literal"><span class="pre">id</span></tt>s. In that case just nothing get\'s serialized and all the\n+        </ul>\n+        <p>In case of a folder we know which of the attributes are the subobjects.\n+We just keep their python id\n+          <a class="footnote-reference"\n+             id="id1"\n+             href="#id3"\n+             name="id1"\n+          >[1]</a>\n+          in &quot;mind&quot;. In the\n+          <tt class="docutils literal"><span class="pre">persistent_id</span></tt>\n+           hook\n+the currently passed objects\n+          <tt class="docutils literal"><span class="pre">id</span></tt>\n+           get checked if it is one of the\n+memorized\n+          <tt class="docutils literal"><span class="pre">id</span></tt>s. In that case just nothing get\'s serialized and all the\n subobjects information will be lost (which is by intention).</p>\n-<p>During the deserializing process the <tt class="docutils literal"><span class="pre">persistent_load</span></tt> hook get\'s called\n+        <p>During the deserializing process the\n+          <tt class="docutils literal"><span class="pre">persistent_load</span></tt>\n+           hook get\'s called\n upon every subobject. We just return an empty version aware weak reference\n-that will be initialized correctly later <a class="footnote-reference" href="#id4" id="id2" name="id2">[2]</a>.</p>\n-<table class="docutils footnote" frame="void" id="id3" rules="none">\n-<colgroup><col class="label" /><col /></colgroup>\n-<tbody valign="top">\n-<tr><td class="label"><a class="fn-backref" href="#id1" name="id3">[1]</a></td><td><tt class="docutils literal"><span class="pre">id(&lt;object&gt;)</span></tt> returns the python identity of <tt class="docutils literal"><span class="pre">&lt;object&gt;</span></tt>.\n-<tt class="docutils literal"><span class="pre">id()</span></tt> had to be used as types like dicts can not be used as hash keys.</td></tr>\n-</tbody>\n-</table>\n-<table class="docutils footnote" frame="void" id="id4" rules="none">\n-<colgroup><col class="label" /><col /></colgroup>\n-<tbody valign="top">\n-<tr><td class="label"><a class="fn-backref" href="#id2" name="id4">[2]</a></td><td>this is actually an implementation detail and isn\'t of any\n+that will be initialized correctly later\n+          <a class="footnote-reference"\n+             id="id2"\n+             href="#id4"\n+             name="id2"\n+          >[2]</a>.</p>\n+        <table class="docutils footnote"\n+               id="id3"\n+               frame="void"\n+               rules="none"\n+        >\n+          <colgroup><col class="label" /><col /></colgroup>\n+          <tbody valign="top">\n+            <tr><td class="label"><a class="fn-backref"\n+                   href="#id1"\n+                   name="id3"\n+                >[1]</a></td><td><tt class="docutils literal"><span class="pre">id(&lt;object&gt;)</span></tt>\n+                returns the python identity of\n+                <tt class="docutils literal"><span class="pre">&lt;object&gt;</span></tt>.\n+                <tt class="docutils literal"><span class="pre">id()</span></tt>\n+                had to be used as types like dicts can not be used as hash keys.</td></tr>\n+          </tbody>\n+        </table>\n+        <table class="docutils footnote"\n+               id="id4"\n+               frame="void"\n+               rules="none"\n+        >\n+          <colgroup><col class="label" /><col /></colgroup>\n+          <tbody valign="top">\n+            <tr><td class="label"><a class="fn-backref"\n+                   href="#id2"\n+                   name="id4"\n+                >[2]</a></td><td>this is actually an implementation detail and isn\'t of any\n importance here.</td></tr>\n-</tbody>\n-</table>\n-<p>As a result the original object and the clone object look the following\n+          </tbody>\n+        </table>\n+        <p>As a result the original object and the clone object look the following\n (non interesting parts are just removed):</p>\n-<pre class="literal-block">\n+        <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder_original.__dict__)\n {\n@@ -369,67 +575,146 @@ <h1><a class="toc-backref" href="#id12" name="the-copy-mechanism">The Copy Mecha\n   ...\n }\n </pre>\n-<div class="section" id="modifers">\n-<h2><a class="toc-backref" href="#id13" name="modifers">Modifers</a></h2>\n-<p>The above job about deciding what attributes belong to the <em>core</em> and what\n-attributes are <em>inside</em> or <em>outside references</em> is done by the so called\n-<tt class="docutils literal"><span class="pre">Modifiers</span></tt>. <tt class="docutils literal"><span class="pre">Modifiers</span></tt> are plug ins and thus replaceable. This way\n+        <div class="section"\n+             id="modifers"\n+        >\n+          <h2><a class="toc-backref"\n+               href="#id13"\n+               name="modifers"\n+            >Modifers</a></h2>\n+          <p>The above job about deciding what attributes belong to the\n+            <em>core</em>\n+             and what\n+attributes are\n+            <em>inside</em>\n+            or\n+            <em>outside references</em>\n+             is done by the so called\n+            <tt class="docutils literal"><span class="pre">Modifiers</span></tt>.\n+            <tt class="docutils literal"><span class="pre">Modifiers</span></tt>\n+             are plug ins and thus replaceable. This way\n everything application/use case specific can be hold outside of the core\n versioning framework.</p>\n-</div>\n-</div>\n-<div class="section" id="overwiew-over-the-architecture">\n-<h1><a class="toc-backref" href="#id14" name="overwiew-over-the-architecture">Overwiew over the Architecture</a></h1>\n-<p>CMFEditions make heavily usage of the CMF(-Framework). The functionality\n+        </div>\n+      </div>\n+      <div class="section"\n+           id="overwiew-over-the-architecture"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id14"\n+             name="overwiew-over-the-architecture"\n+          >Overwiew over the Architecture</a></h1>\n+        <p>CMFEditions make heavily usage of the CMF(-Framework). The functionality\n is split into four tools to allow easy future replacement of the individual\n tools:</p>\n-<dl class="docutils">\n-<dt><tt class="docutils literal"><span class="pre">portal_repository</span></tt>/<tt class="docutils literal"><span class="pre">IRepository.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">CopyModifyMergeRepositoryTool.py</span></tt></dt>\n-<dd>This is the main API for doing versioning. The implementation depends\n-heavyly on the <strong>applications use cases/policies</strong>.</dd>\n-<dt><tt class="docutils literal"><span class="pre">portal_archivist</span></tt>/<tt class="docutils literal"><span class="pre">IArchivist.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">ArchivistTool.py</span></tt></dt>\n-<dd>The <tt class="docutils literal"><span class="pre">Archivist</span></tt> <strong>knows how to copy</strong> a python object. It needs the\n-help of the <tt class="docutils literal"><span class="pre">portal_modifier</span></tt> to find the boundaries of an object.\n+        <dl class="docutils">\n+          <dt><tt class="docutils literal"><span class="pre">portal_repository</span></tt>/<tt class="docutils literal"><span class="pre">IRepository.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">CopyModifyMergeRepositoryTool.py</span></tt></dt>\n+          <dd>This is the main API for doing versioning. The implementation depends\n+heavyly on the\n+            <strong>applications use cases/policies</strong>.</dd>\n+          <dt><tt class="docutils literal"><span class="pre">portal_archivist</span></tt>/<tt class="docutils literal"><span class="pre">IArchivist.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">ArchivistTool.py</span></tt></dt>\n+          <dd>The\n+            <tt class="docutils literal"><span class="pre">Archivist</span></tt>\n+            <strong>knows how to copy</strong>\n+             a python object. It needs the\n+help of the\n+            <tt class="docutils literal"><span class="pre">portal_modifier</span></tt>\n+             to find the boundaries of an object.\n This is an internal API.</dd>\n-<dt><tt class="docutils literal"><span class="pre">portal_modifier</span></tt>/<tt class="docutils literal"><span class="pre">IModifier.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">ModifierRegistryTool.py</span></tt></dt>\n-<dd>This is a registry for <tt class="docutils literal"><span class="pre">modifier</span></tt> plug ins. The modifiers themselves\n-<strong>know how to handle different aspects of objects</strong> during the versioning\n+          <dt><tt class="docutils literal"><span class="pre">portal_modifier</span></tt>/<tt class="docutils literal"><span class="pre">IModifier.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">ModifierRegistryTool.py</span></tt></dt>\n+          <dd>This is a registry for\n+            <tt class="docutils literal"><span class="pre">modifier</span></tt>\n+             plug ins. The modifiers themselves\n+            <strong>know how to handle different aspects of objects</strong>\n+             during the versioning\n process. This is an internal API.</dd>\n-<dt><tt class="docutils literal"><span class="pre">portal_historiesstorage</span></tt>/<tt class="docutils literal"><span class="pre">IStorage.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt></dt>\n-<dd>This is the storage layer. The passed copies of the individualized\n+          <dt><tt class="docutils literal"><span class="pre">portal_historiesstorage</span></tt>/<tt class="docutils literal"><span class="pre">IStorage.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt></dt>\n+          <dd>This is the storage layer. The passed copies of the individualized\n objects may just be stored. Handling references between objects is\n already done and the storage doesn\'t have to care about it anymore.\n-The goal was that the storage layer just has to <strong>handle storage related\n-stuff</strong> like accessing a possibly external data base, doing XML\n-marshalling, etc. <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt> is currently the default storage\n-using <tt class="docutils literal"><span class="pre">ZopeVersionControl</span></tt> to store data <a class="footnote-reference" href="#id6" id="id5" name="id5">[3]</a>. This is an internal API.</dd>\n-</dl>\n-<div class="image"><img alt="Overview over the architecture and flow of information on save." height="508" src="img/architecture.gif" width="781" /></div>\n-<p>Have also a look at the <a class="reference" href="architecture.pdf">high resolution version</a> of the architecture.</p>\n-<table class="docutils footnote" frame="void" id="id6" rules="none">\n-<colgroup><col class="label" /><col /></colgroup>\n-<tbody valign="top">\n-<tr><td class="label"><a class="fn-backref" href="#id5" name="id6">[3]</a></td><td>This isn\'t the most efficient and simple way of a ZODB storage.\n+The goal was that the storage layer just has to\n+            <strong>handle storage related\n+stuff</strong>\n+             like accessing a possibly external data base, doing XML\n+marshalling, etc.\n+            <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt>\n+             is currently the default storage\n+using\n+            <tt class="docutils literal"><span class="pre">ZopeVersionControl</span></tt>\n+            to store data\n+            <a class="footnote-reference"\n+               id="id5"\n+               href="#id6"\n+               name="id5"\n+            >[3]</a>. This is an internal API.</dd>\n+        </dl>\n+        <div class="image"><img alt="Overview over the architecture and flow of information on save."\n+               height="508"\n+               src="img/architecture.gif"\n+               width="781"\n+          /></div>\n+        <p>Have also a look at the\n+          <a class="reference"\n+             href="architecture.pdf"\n+          >high resolution version</a>\n+          of the architecture.</p>\n+        <table class="docutils footnote"\n+               id="id6"\n+               frame="void"\n+               rules="none"\n+        >\n+          <colgroup><col class="label" /><col /></colgroup>\n+          <tbody valign="top">\n+            <tr><td class="label"><a class="fn-backref"\n+                   href="#id5"\n+                   name="id6"\n+                >[3]</a></td><td>This isn\'t the most efficient and simple way of a ZODB storage.\n If somebody is interested in replacing this with a simple ZODB storage\n-just show up on the <a class="reference" href="mailto:collective-versioning&#64;lists.sourceforge.net">Versioning Mailing-List</a>.</td></tr>\n-</tbody>\n-</table>\n-</div>\n-<div class="section" id="further-reading">\n-<h1><a class="toc-backref" href="#id15" name="further-reading">Further Reading</a></h1>\n-<p>For more information please consult:</p>\n-<ul class="simple">\n-<li>the interfaces</li>\n-<li>the unit tests</li>\n-<li>the code :-)</li>\n-</ul>\n-</div>\n-</div>\n-<hr class="docutils footer" />\n-<div class="footer">\n-<a class="reference" href="DevelDoc.txt">View document source</a>.\n+just show up on the\n+                <a class="reference"\n+                   href="mailto:collective-versioning&#64;lists.sourceforge.net"\n+                >Versioning Mailing-List</a>.</td></tr>\n+          </tbody>\n+        </table>\n+      </div>\n+      <div class="section"\n+           id="further-reading"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id15"\n+             name="further-reading"\n+          >Further Reading</a></h1>\n+        <p>For more information please consult:</p>\n+        <ul class="simple">\n+          <li>the interfaces</li>\n+          <li>the unit tests</li>\n+          <li>the code :-)</li>\n+        </ul>\n+      </div>\n+    </div>\n+    <hr class="docutils footer" />\n+    <div class="footer">\n+      <a class="reference"\n+         href="DevelDoc.txt"\n+      >View document source</a>.\n Generated on: 2005-03-22 22:42 UTC.\n-Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.\n-</div>\n-</body>\n+Generated by\n+      <a class="reference"\n+         href="http://docutils.sourceforge.net/"\n+      >Docutils</a>\n+      from\n+      <a class="reference"\n+         href="http://docutils.sourceforge.net/rst.html"\n+      >reStructuredText</a>\n+       source.\n+    </div>\n+  </body>\n </html>\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:44:03+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/ee871380a7a3c8ad28ce0993e406ff354af959b1

feat: pyroma

Files changed:
M setup.py

b'diff --git a/setup.py b/setup.py\nindex c6b1ae9..99a37ae 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -37,6 +37,7 @@\n     namespace_packages=["Products"],\n     include_package_data=True,\n     zip_safe=False,\n+    python_requires=">=3.8",\n     extras_require=dict(\n         test=[\n             "plone.app.testing",\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:45:45+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/2b8ff0bd65b9f080514a3865154cb4acd2757a20

feat: flake8

Files changed:
M Products/CMFEditions/browser/views.py

b'diff --git a/Products/CMFEditions/browser/views.py b/Products/CMFEditions/browser/views.py\nindex 0d4c9c3..ed1c1d0 100644\n--- a/Products/CMFEditions/browser/views.py\n+++ b/Products/CMFEditions/browser/views.py\n@@ -1,5 +1,4 @@\n from Acquisition import aq_inner\n-from plone.base.utils import human_readable_size\n from Products.CMFCore.utils import getToolByName\n from Products.CMFEditions import CMFEditionsMessageFactory as _\n from Products.CMFEditions.interfaces.IModifier import FileTooLargeToVersionError\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T13:46:31+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/bae74092e31dd9114bc4c04ca9acf8c3a5958ecf

cleanup: drop pkgutil fallback

Files changed:
M Products/__init__.py

b'diff --git a/Products/__init__.py b/Products/__init__.py\nindex 05f0beb..5284146 100644\n--- a/Products/__init__.py\n+++ b/Products/__init__.py\n@@ -1,7 +1 @@\n-# See http://peak.telecommunity.com/DevCenter/setuptools#namespace-packages\n-try:\n-    __import__("pkg_resources").declare_namespace(__name__)\n-except ImportError:\n-    from pkgutil import extend_path\n-\n-    __path__ = extend_path(__path__, __name__)\n+__import__("pkg_resources").declare_namespace(__name__)\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T14:19:25+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/52cd025976df0a36b4ca28ed2c4c0bd536d44d1b

feat: configure codespell

Files changed:
M pyproject.toml

b'diff --git a/pyproject.toml b/pyproject.toml\nindex 9eb73f3..3a8a567 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -60,3 +60,6 @@ Zope = [\n   \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n ]\n python-dateutil = [\'dateutil\']\n+\n+[tool.codespell]\n+ignore-words-list = "discreet,alog,ist"\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T14:20:28+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/13fe34186f7294113f5c14bac6e8f78170868569

feat: codespell

Files changed:
M CHANGES.rst
M Products/CMFEditions/CopyModifyMergeRepositoryTool.py
M Products/CMFEditions/KeepLastNVersionsTool.py
M Products/CMFEditions/ModifierRegistryTool.py
M Products/CMFEditions/Modifiers.py
M Products/CMFEditions/StandardModifiers.py
M Products/CMFEditions/ZVCStorageTool.py
M Products/CMFEditions/interfaces/IArchivist.py
M Products/CMFEditions/interfaces/IModifier.py
M Products/CMFEditions/interfaces/IPurgePolicy.py
M Products/CMFEditions/interfaces/IRepository.py
M Products/CMFEditions/interfaces/IStorage.py
M Products/CMFEditions/tests/DummyTools.py
M Products/CMFEditions/tests/large_file_modifiers.rst
M Products/CMFEditions/tests/test_IntegrationTests.py
M Products/CMFEditions/tests/test_KeepLastNVersionsTool.py
M Products/CMFEditions/tests/test_ZVCStorageTool.py
M Products/CMFEditions/utilities.py
M Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt
M doc/DevelDoc.html
M doc/DevelDoc.txt
M doc/ToDo.txt
M doc/old-changelog.rst
M setup.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex c8290a1..10762d6 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -193,7 +193,7 @@ Bug fixes:\n - Fix Unauthorized error due to importing six inside Restricted Python\n   `Plone issue 2463 <https://github.com/plone/Products.CMFPlone/issues/2463>`_\n   [davilima6]\n-- Migrate Tests away fro  PloneTestCase\n+- Migrate Tests away from PloneTestCase\n   [pbauer]\n \n - Do not run webdav_history.txt in py3 since it breaks tests (no webdav support in py3).\ndiff --git a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\nindex d46be66..f1f3b7f 100644\n--- a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n+++ b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n@@ -320,7 +320,7 @@ def purge(self, obj, selector, comment="", metadata={}, countPurged=True):\n \n         # Trying to avoid mess with purged versions which we don\'t offer\n         # support yet when passed to the repository layer due to a missing\n-        # purge policy. The problem would occure on revert and retrieve.\n+        # purge policy. The problem would occur on revert and retrieve.\n         pp = getToolByName(self, "portal_purgepolicy", None)\n         if pp is None:\n             raise RepositoryPurgeError(\n@@ -432,7 +432,7 @@ def isUpToDate(self, obj, selector=None, countPurged=True):\n \n     def _assertAuthorized(self, obj, permission, name=None):\n         # We need to provide access to the repository upon the object\n-        # permissions istead of repositories method permissions.\n+        # permissions instead of repositories method permissions.\n         # So the repository method access is set to public and the\n         # access is check on the object when needed.\n         if not _checkPermission(permission, obj):\n@@ -550,7 +550,7 @@ def _recursiveRetrieve(\n         # revert) this has to be reversed after having recursed into the\n         # tree.\n         if hasBeenDeleted:\n-            # if the object to retreive doesn\'t have a counterpart in the tree\n+            # if the object to retrieve doesn\'t have a counterpart in the tree\n             # build a new one before retrieving an old state\n             vdata = portal_archivist.retrieve(\n                 obj, history_id, selector, preserve, countPurged\ndiff --git a/Products/CMFEditions/KeepLastNVersionsTool.py b/Products/CMFEditions/KeepLastNVersionsTool.py\nindex d4f8924..9583ab6 100644\n--- a/Products/CMFEditions/KeepLastNVersionsTool.py\n+++ b/Products/CMFEditions/KeepLastNVersionsTool.py\n@@ -89,7 +89,7 @@ def beforeSaveHook(self, history_id, obj, metadata={}):\n         return True\n \n     def retrieveSubstitute(self, history_id, selector, default=None):\n-        """Retrives the next older version\n+        """Retrieves the next older version\n \n         If there isn\'t a next older one returns the next newer one.\n         """\ndiff --git a/Products/CMFEditions/ModifierRegistryTool.py b/Products/CMFEditions/ModifierRegistryTool.py\nindex 0f0bc02..4450b3d 100644\n--- a/Products/CMFEditions/ModifierRegistryTool.py\n+++ b/Products/CMFEditions/ModifierRegistryTool.py\n@@ -167,7 +167,7 @@ def reattachReferencedAttributes(self, obj, referenced_data):\n     def getOnCloneModifiers(self, obj):\n         """See IModifier"""\n         # First check if there is at least one ICloneModifier to loop over.\n-        # The clone operation is much fater if there are no \'persistent_id\'\n+        # The clone operation is much faster if there are no \'persistent_id\'\n         # hooks to call.\n         modifiers = self._collectModifiers(obj, ICloneModifier)\n         if not modifiers:\ndiff --git a/Products/CMFEditions/Modifiers.py b/Products/CMFEditions/Modifiers.py\nindex fb6df97..68ce12f 100644\n--- a/Products/CMFEditions/Modifiers.py\n+++ b/Products/CMFEditions/Modifiers.py\n@@ -168,10 +168,10 @@ def createExpressionContext(obj, portal=None, **more_symbols):\n     """\n \n     def findNextFolderishParent(obj):\n-        """Try to find the folder of the given object by aquisition.\n+        """Try to find the folder of the given object by acquisition.\n \n         XXX what\'s the correct strategy in Zope2 land to check for a folder?\n-            what\'s most relyable?\n+            what\'s most reliable?\n             a) check if isPrincipiaFolderish is True?\n             b) check if the object is an ObjectManager?\n             c) other?\ndiff --git a/Products/CMFEditions/StandardModifiers.py b/Products/CMFEditions/StandardModifiers.py\nindex f1878ff..f32c25d 100644\n--- a/Products/CMFEditions/StandardModifiers.py\n+++ b/Products/CMFEditions/StandardModifiers.py\n@@ -97,7 +97,7 @@ def install(portal_modifier, ids=None):\n \n \n def manage_addOMOutsideChildrensModifier(self, id, title=None, REQUEST=None):\n-    """Add an object manager modifier treating childrens as outside refs"""\n+    """Add an object manager modifier treating children as outside refs"""\n     modifier = OMOutsideChildrensModifier()\n     self._setObject(id, ConditionalTalesModifier(id, modifier, title))\n \n@@ -320,7 +320,7 @@ class OMBaseModifier(RetainAttributeAnnotationItemsBase):\n     PRESERVE_ANNOTATION_KEYS = (DefaultOrdering.ORDER_KEY, DefaultOrdering.POS_KEY)\n \n     def _getOnCloneModifiers(self, obj):\n-        """Removes all childrens and returns them as references."""\n+        """Removes all children and returns them as references."""\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         VersionAwareReference = portal_archivist.classes.VersionAwareReference\n \n@@ -347,12 +347,12 @@ def persistent_load(ignored):\n         return persistent_id, persistent_load, result_refs\n \n     def _beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects."""\n+        """Returns all uninitialized \'IVersionAwareReference\' objects."""\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         adapter = portal_archivist.classes.ObjectManagerStorageAdapter\n \n         # just return adapters to the attributes that were replaced by\n-        # a uninitialzed \'IVersionAwareReference\' object\n+        # a uninitialized \'IVersionAwareReference\' object\n         result_refs = []\n         for name in clone.objectIds():\n             result_refs.append(adapter(clone, name, type="Folder"))\n@@ -372,21 +372,21 @@ def _getAttributeNamesHandlingSubObjects(self, obj, repo_clone):\n \n @implementer(ICloneModifier, ISaveRetrieveModifier)\n class OMOutsideChildrensModifier(OMBaseModifier):\n-    """ObjectManager modifier treating all childrens as outside refs\n+    """ObjectManager modifier treating all children as outside refs\n \n-    Treats all childrens as outside references (the repository layer\n+    Treats all children as outside references (the repository layer\n     knows what to do with that fact).\n     """\n \n     def getOnCloneModifiers(self, obj):\n-        """Removes all childrens and returns them as references."""\n+        """Removes all children and returns them as references."""\n         pers_id, pers_load, outside_refs = self._getOnCloneModifiers(obj)\n         return pers_id, pers_load, [], outside_refs, ""\n \n     def beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects.\n+        """Returns all uninitialized \'IVersionAwareReference\' objects.\n \n-        This allways goes in conjunction with \'getOnCloneModifiers\'.\n+        This always goes in conjunction with \'getOnCloneModifiers\'.\n         """\n         outside_refs = self._beforeSaveModifier(obj, clone)\n         return {}, [], outside_refs\n@@ -433,21 +433,21 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n \n @implementer(ICloneModifier, ISaveRetrieveModifier)\n class OMInsideChildrensModifier(OMBaseModifier):\n-    """ObjectManager modifier treating all childrens as inside refs\n+    """ObjectManager modifier treating all children as inside refs\n \n-    Treats all childrens as inside references (the repository layer\n+    Treats all children as inside references (the repository layer\n     knows what to do with that fact).\n     """\n \n     def getOnCloneModifiers(self, obj):\n-        """Removes all childrens and returns them as references."""\n+        """Removes all children and returns them as references."""\n         pers_id, pers_load, inside_refs = self._getOnCloneModifiers(obj)\n         return pers_id, pers_load, inside_refs, [], ""\n \n     def beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects.\n+        """Returns all uninitialized \'IVersionAwareReference\' objects.\n \n-        This allways goes in conjunction with \'getOnCloneModifiers\'.\n+        This always goes in conjunction with \'getOnCloneModifiers\'.\n         """\n         inside_refs = self._beforeSaveModifier(obj, clone)\n         return {}, inside_refs, []\n@@ -527,7 +527,7 @@ def remove(self, permanent=False):\n         # IM(alecm)O, we should update the catalog if the change is permanent\n         # and not if otherwise, this forces this Adapter to know a bit about\n         # implementation details, but it\'s an optional arg to a specific\n-        # implemetnation of this interface, so I think this is acceptable.\n+        # implementation of this interface, so I think this is acceptable.\n         # The only other option I see is to do the deletion in the\n         # CopyModifyMerge tool which is aware of the distinction between\n         # retrieve and revert.\n@@ -541,11 +541,11 @@ def remove(self, permanent=False):\n class RetainWorkflowStateAndHistory:\n     """Standard modifier retaining the working copies workflow state\n \n-    Avoids the objects workflow state from beeing retrieved also.\n+    Avoids the objects workflow state from being retrieved also.\n     """\n \n     def beforeSaveModifier(self, obj, clone):\n-        # Saving the ``review_state`` as this is hard to achieve at retreive\n+        # Saving the ``review_state`` as this is hard to achieve at retrieve\n         # (or because I\'m dumb). What happened is that ``getInfoFor`` always\n         # returned the state of the working copy although the retrieved\n         # temporary object was passed to it.\n@@ -789,7 +789,7 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n         # sorry: hack\n         clone = repo_clone.__of__(obj.aq_inner.aq_parent)\n \n-        # replace all occurences of DeMo with Demo and deMo with demo\n+        # replace all occurrences of DeMo with Demo and deMo with demo\n         text = clone.EditableBody()\n         text = text.replace("DeMo", "Demo").replace("deMo", "demo")\n         clone.setText(text)\n@@ -940,7 +940,7 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n @implementer(ICloneModifier, ISaveRetrieveModifier)\n class Skip_z3c_blobfile:\n     """Standard avoid storing blob data, may be useful for extremely\n-    large files where versioing the non-file metadata is important but\n+    large files where versioning the non-file metadata is important but\n     the cost of versioning the file data is too high.\n     """\n \n@@ -1073,7 +1073,7 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n     },\n     {\n         "id": "SillyDemoRetrieveModifier",\n-        "title": "Silly retrive modifier for demos only.",\n+        "title": "Silly retrieve modifier for demos only.",\n         "enabled": False,\n         "condition": "python: True",\n         "wrapper": ConditionalTalesModifier,\ndiff --git a/Products/CMFEditions/ZVCStorageTool.py b/Products/CMFEditions/ZVCStorageTool.py\nindex c7e8bee..03691a2 100644\n--- a/Products/CMFEditions/ZVCStorageTool.py\n+++ b/Products/CMFEditions/ZVCStorageTool.py\n@@ -77,7 +77,7 @@ def deepCopy(obj):\n def getSize(obj):\n     """Calculate the size as cheap as possible"""\n     # Try the cheap variants first.\n-    # Actually the checks ensure the code never fails but beeing sure\n+    # Actually the checks ensure the code never fails but being sure\n     # is better.\n     try:\n         # check if to return zero (length is zero)\n@@ -146,7 +146,7 @@ class ZVCStorageTool(UniqueObject, SimpleItem):\n     - When iterating over the history the removed versions (usually)\n       aren\'t of interest. Thus the next valid version may be accessed\n       by incrementing the selector and vice versa.\n-    - When retrieving a version beeing able to access removed version\n+    - When retrieving a version being able to access removed version\n       or correctly spoken a substitute (pretending to be the removed\n       version) is important when reconstructing relations between\n       objects.\n@@ -164,7 +164,7 @@ class ZVCStorageTool(UniqueObject, SimpleItem):\n         {"label": "Statistics (may take time)", "action": "storageStatistics"},\n     ) + SimpleItem.manage_options[:]\n \n-    # make exceptions available trough the tool\n+    # make exceptions available through the tool\n     StorageError = StorageError\n     StorageRetrieveError = StorageRetrieveError\n \n@@ -387,7 +387,7 @@ def _applyOrCheckin(\n         approxSize = getSize(object) + getSize(referenced_data)\n         metadata["sys_metadata"]["approxSize"] = approxSize\n \n-        # prepare the object for beeing saved with ZVC\n+        # prepare the object for being saved with ZVC\n         #\n         # - Recall the ``__vc_info__`` from the most current version\n         #   (selector=None).\n@@ -469,7 +469,7 @@ def _getZVCAccessInfo(self, history_id, selector, countPurged):\n         return zvc_hid, zvc_vid\n \n     def _getVcInfo(self, obj, shadowInfo, set_checked_in=False):\n-        """Recalls ZVC Related Informations and Attaches them to the Object"""\n+        """Recalls ZVC Related Information and Attaches them to the Object"""\n         vc_info = deepCopy(shadowInfo["vc_info"])\n         if vc_info is None:\n             return None\n@@ -551,7 +551,7 @@ def zmi_getStorageStatistics(self):\n         hidhandler = getToolByName(self, "portal_historyidhandler")\n         portal_paths_len = len(getToolByName(self, "portal_url")())\n \n-        # collect interesting informations\n+        # collect interesting information\n         histories = []\n         for hid in historyIds.keys():\n             history = self.getHistory(hid)\n@@ -840,7 +840,7 @@ def _getVersionPos(self, selector, countPurged):\n \n         # Lets search from the end of the available list as it is more\n         # likely that a younger versions position has to be returned.\n-        # Let\'s work on a copy to not trigger an unecessary ZODB store\n+        # Let\'s work on a copy to not trigger an unnecessary ZODB store\n         # operations.\n         history = self._available[:]\n         history.reverse()\ndiff --git a/Products/CMFEditions/interfaces/IArchivist.py b/Products/CMFEditions/interfaces/IArchivist.py\nindex c47e727..0ba3582 100644\n--- a/Products/CMFEditions/interfaces/IArchivist.py\n+++ b/Products/CMFEditions/interfaces/IArchivist.py\n@@ -93,7 +93,7 @@ def retrieve(obj=None, history_id=None, selector=None, preserve=()):\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n         """\n@@ -113,7 +113,7 @@ def getHistory(obj=None, history_id=None, preserve=()):\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n         """\n@@ -173,7 +173,7 @@ def purge(obj=None, history_id=None, selector=None, metadata={}, countPurged=Tru\n         for an object if no history_id is provided the history_id will be\n         obtained from the working copy object.\n \n-        The comment and metadata passed may be used to store informations\n+        The comment and metadata passed may be used to store information\n         about the reasons of the purging.\n \n         Also counts purged versions if ``True`` is passed to ``countPurged``\n@@ -211,7 +211,7 @@ def retrieve(\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n \n@@ -234,7 +234,7 @@ def getHistory(obj=None, history_id=None, preserve=(), countPurged=True):\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n \n@@ -283,7 +283,7 @@ class IPreparedObject(Interface):\n         """Data that is passed to the storage by reference.\n \n         These is an optimization for the case where a big blob (e.g. a Word\n-        file) has to be saved but you want to avoid costy cloning beeing done\n+        file) has to be saved but you want to avoid costy cloning being done\n         by the archivist.\n \n         Returns a dictionary of the following format:\n@@ -316,7 +316,7 @@ class IVersionData(Interface):\n     refs_to_be_deleted = Attribute(\n         """List of references to be deleted on revert.\n \n-        The items (containing the reference informations) are of\n+        The items (containing the reference information) are of\n         ``IReferenceAdapter``.\n         """\n     )\n@@ -327,7 +327,7 @@ class IVersionData(Interface):\n     )\n \n     preserved_data = Attribute(\n-        """Returns data beeing preserved from beeing overwritten by modifiers.\n+        """Returns data being preserved from being overwritten by modifiers.\n \n         The preserved data is a flat dictionary. With the example from above:\n         nick_name = obj.preserved_data[\'nick_name\']\n@@ -372,14 +372,14 @@ def __getattr__(version_id):\n         """\n \n     def __iter__():\n-        """Returns an ordered set of versions for beeing looped over.\n+        """Returns an ordered set of versions for being looped over.\n \n         The objects returned are of \'IVersionData\'.\n         """\n \n \n class IObjectData(Interface):\n-    """The object including informations about outgoing references."""\n+    """The object including information about outgoing references."""\n \n     object = Attribute(\n         """The object with some of the python references replaced by\ndiff --git a/Products/CMFEditions/interfaces/IModifier.py b/Products/CMFEditions/interfaces/IModifier.py\nindex e0a4444..49818e7 100644\n--- a/Products/CMFEditions/interfaces/IModifier.py\n+++ b/Products/CMFEditions/interfaces/IModifier.py\n@@ -114,7 +114,7 @@ def afterRetrieveModifier(obj, repo_clone, preserve=()):\n         Usually this hook is used to do one or more of the following\n         tasks:\n \n-            - readd data that was removed by the \'beforeSaveHook\'\n+            - re-add data that was removed by the \'beforeSaveHook\'\n             - manipulate data before it get restored\n             - return data that gets overwritte in this process\n \n@@ -126,10 +126,10 @@ def afterRetrieveModifier(obj, repo_clone, preserve=()):\n \n         - a list of references to be deleted on revert (providing\n           ``IReferenceAdapter``)\n-        - a list of attribute names beeing in charge of holding reference\n+        - a list of attribute names being in charge of holding reference\n           information (e.g. an ObjectManager with ``doc1`` and ``doc2``\n-          as childrens: [\'_objects\', \'doc1\', \'doc2\'])\n-        - a dictionary of the data having been preserved from beeing\n+          as children: [\'_objects\', \'doc1\', \'doc2\'])\n+        - a dictionary of the data having been preserved from being\n           overwritten.\n         """\n \n@@ -142,11 +142,11 @@ class IReferenceAdapter(Interface):\n     """\n \n     def remove():\n-        """Removes the refrence adapted to."""\n+        """Removes the reference adapted to."""\n \n \n class IModifierRegistrySet(Interface):\n-    """Registring and editing a modifier registry."""\n+    """Registering and editing a modifier registry."""\n \n     def register(id, modifier, pos=-1):\n         """Registers a before save and after retrieve modifier.\ndiff --git a/Products/CMFEditions/interfaces/IPurgePolicy.py b/Products/CMFEditions/interfaces/IPurgePolicy.py\nindex 1e9a52f..d9845b9 100644\n--- a/Products/CMFEditions/interfaces/IPurgePolicy.py\n+++ b/Products/CMFEditions/interfaces/IPurgePolicy.py\n@@ -46,7 +46,7 @@ def beforeSaveHook(history_id, obj, metadata={}):\n         ``save`` method.\n \n         Return True if ``obj`` has to be saved by the ``IStorage``\n-        implementation. Return ``False`` if the object has to be discared.\n+        implementation. Return ``False`` if the object has to be discarded.\n         """\n \n     def retrieveSubstitute(history_id, selector, default=None):\ndiff --git a/Products/CMFEditions/interfaces/IRepository.py b/Products/CMFEditions/interfaces/IRepository.py\nindex a8a4af8..a1ec70d 100644\n--- a/Products/CMFEditions/interfaces/IRepository.py\n+++ b/Products/CMFEditions/interfaces/IRepository.py\n@@ -56,7 +56,7 @@ def setAutoApplyMode(autoapply):\n         """Sets the autoapply mode.\n \n         Before a repository can host a version of a content it has to be\n-        registred.\n+        registered.\n         If True the first \'save\' operation will register the content\n         automatically and applies version control.\n         The default value is True.\n@@ -101,7 +101,7 @@ def restore(history_id, selector, container, new_id=None):\n \n         Usage Hint:\n \n-        May be used to restore a deleted object (delted from the tree).\n+        May be used to restore a deleted object (deleted from the tree).\n         A version having been purged from the storage may never be restored.\n         A new id may be chosen.\n         """\n@@ -180,7 +180,7 @@ def purge(obj, selector, comment="", metadata={}, countPurged=True):\n             selector: 0, 1, 2, 3,  4,  5, 6, 7, 8, 9 (countPurged==True)\n             selector: 0, 1, 2, -,  -,  3, 4, 5, 6, 7 (countPurged==False)\n \n-        The comment and metadata passed may be used to store informations\n+        The comment and metadata passed may be used to store information\n         about the reasons of the purging.\n         """\n \n@@ -211,7 +211,7 @@ def restore(history_id, selector, container, new_id=None, countPurged=True):\n \n         Usage Hint:\n \n-        May be used to restore a deleted object (delted from the tree).\n+        May be used to restore a deleted object (deleted from the tree).\n         A version having been purged from the storage may never be restored.\n         A new id may be chosen.\n \n@@ -312,7 +312,7 @@ class IVersionData(Interface):\n \n     preserved_data = Attribute(\n         """It is the data preserved from overwriting during the\n-        retrive process.\n+        retrieve process.\n \n         The preserved data is a flat dictionary.\n         With the example from above:\ndiff --git a/Products/CMFEditions/interfaces/IStorage.py b/Products/CMFEditions/interfaces/IStorage.py\nindex 45cf524..7f19e1e 100644\n--- a/Products/CMFEditions/interfaces/IStorage.py\n+++ b/Products/CMFEditions/interfaces/IStorage.py\n@@ -20,9 +20,9 @@\n #########################################################################\n """Manages Storing and Retrieving Version to and from the Storage\n \n-``IStorage`` defines the fundamental storage operations wheras\n+``IStorage`` defines the fundamental storage operations whereas\n ``IPurgePolicy`` defines support for purging versions from the\n-storage. The other interface definitions are defintions for types\n+storage. The other interface definitions are definitions for types\n returned by storage methods.\n \n """\n@@ -50,7 +50,7 @@ def register(history_id, object, referenced_data={}, metadata={}):\n         data to be added to the history.\n \n         \'object\' is already a clone and needn\'t be cloned anymore before\n-        beeing added to the history. Data in \'referenced_data\' are direct\n+        being added to the history. Data in \'referenced_data\' are direct\n         references to the original object and must be cloned before being\n         added to the history.\n \n@@ -60,7 +60,7 @@ def register(history_id, object, referenced_data={}, metadata={}):\n         \'metadata\' must be a (nested) dictionary. If a \'comment\' key exists\n         the implementation may assume it is a human readable string.\n \n-        May veto the registering proces by raising a \'StorageError\'\n+        May veto the registering process by raising a \'StorageError\'\n         exception. No action is performed on repeated registering.\n \n         Returns the value of the newest version(selector).\n@@ -73,7 +73,7 @@ def save(history_id, object, referenced_data={}, metadata={}):\n         data to be added to the history.\n \n         \'object\' is already a clone and needn\'t be cloned anymore before\n-        beeing added to the history. Data in \'referenced_data\' are direct\n+        being added to the history. Data in \'referenced_data\' are direct\n         references to the original object and must be cloned before being\n         added to the history.\n \n@@ -154,7 +154,7 @@ def purge(history_id, selector, metadata={}, countPurged=True):\n         account.\n \n         Purge the given version from the given history. The metadata\n-        passed may be used to store informations about the reasons of\n+        passed may be used to store information about the reasons of\n         the purging.\n         """\n \n@@ -230,7 +230,7 @@ class IVersionData(Interface):\n     )\n \n     referenced_data = Attribute(\n-        """Data beeing passed by reference at save time.\n+        """Data being passed by reference at save time.\n \n         Needs not be cloned before allowing write access. Cloning was\n         already done by the storage layer.\ndiff --git a/Products/CMFEditions/tests/DummyTools.py b/Products/CMFEditions/tests/DummyTools.py\nindex d3ef61d..7379441 100644\n--- a/Products/CMFEditions/tests/DummyTools.py\n+++ b/Products/CMFEditions/tests/DummyTools.py\n@@ -95,7 +95,7 @@ def prepare(self, obj, app_metadata=None, sys_metadata={}):\n         obj, history_id = dereference(obj)\n         if history_id is None:\n             # object isn\'t under version control yet\n-            # An working copy beeing under version control needs to have\n+            # An working copy being under version control needs to have\n             # a history_id, version_id (starts with 0) and a location_id\n             # (the current implementation isn\'t able yet to handle multiple\n             # locations. Nevertheless lets set the location id to a well\n@@ -338,16 +338,16 @@ class FolderishContentObjectModifier(DummyBaseTool):\n     id = "portal_modifier"\n \n     def getReferencedAttributes(self, obj):\n-        # we declare the title beeing a big blob we don\'t want to be\n+        # we declare the title being a big blob we don\'t want to be\n         # pickled and unpickled by the archivist\n         return {"title": obj.title}\n \n     def getOnCloneModifiers(self, obj):\n-        """Removes childrens ending with \'_inside\' or \'_outside\'.\n+        """Removes children ending with \'_inside\' or \'_outside\'.\n \n         Just replaces object manager sub objects ending \'_inside\' or\n-        \'_outside\' by a uninitialzed \'IVersionAwareReference\'.\n-        All other childrens get versioned with the parent.\n+        \'_outside\' by a uninitialized \'IVersionAwareReference\'.\n+        All other children get versioned with the parent.\n         """\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         VersionAwareReference = portal_archivist.classes.VersionAwareReference\n@@ -394,15 +394,15 @@ def persistent_load(pid):\n         return persistent_id, persistent_load, inside_refs, outside_refs, ""\n \n     def beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects.\n+        """Returns all uninitialized \'IVersionAwareReference\' objects.\n \n-        This allways goes in conjunction with \'getOnCloneModifiers\'.\n+        This always goes in conjunction with \'getOnCloneModifiers\'.\n         """\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         AttributeAdapter = portal_archivist.classes.AttributeAdapter\n \n         # just return adapters to the attributes that were replaced by\n-        # a uninitialzed \'IVersionAwareReference\' object\n+        # a uninitialized \'IVersionAwareReference\' object\n         outside_refs = []\n         inside_refs = []\n         for name in clone.objectIds():\n@@ -505,7 +505,7 @@ def register(self, history_id, object, referenced_data={}, metadata=None):\n             return self._save(history_id, object, referenced_data, metadata)\n \n     def save(self, history_id, object, referenced_data={}, metadata=None):\n-        # delegate the decission what to purge to the purge policy tool\n+        # delegate the decision what to purge to the purge policy tool\n         # if it exists. If the call returns ``True`` do not save the current\n         # version.\n         policy = getToolByName(self, "portal_purgepolicy", None)\n@@ -681,7 +681,7 @@ def beforeSaveHook(self, history_id, obj, metadata={}):\n         return True\n \n     def retrieveSubstitute(self, history_id, selector, default=None):\n-        """Retrives the next older version"""\n+        """Retrieves the next older version"""\n         storage = getToolByName(self, "portal_historiesstorage")\n         while selector:\n             selector -= 1\n@@ -693,7 +693,7 @@ def retrieveSubstitute(self, history_id, selector, default=None):\n \n @implementer(IStorage, IPurgeSupport)\n class PurgePolicyTestDummyStorage(DummyBaseTool):\n-    """Partial Storage used for PurgePolicy Tetss"""\n+    """Partial Storage used for PurgePolicy Tests"""\n \n     id = "portal_historiesstorage"\n \ndiff --git a/Products/CMFEditions/tests/large_file_modifiers.rst b/Products/CMFEditions/tests/large_file_modifiers.rst\nindex 8298f18..cf31c7a 100644\n--- a/Products/CMFEditions/tests/large_file_modifiers.rst\n+++ b/Products/CMFEditions/tests/large_file_modifiers.rst\n@@ -66,7 +66,7 @@ Skip Versioning of Large File Attributes\n \n Now let\'s test the alternate modifier, which tells the pickler to\n replace large file attributes with a marker to avoid pickling them.\n-We\'ll make our modifer and set some defaults as above, and then add to\n+We\'ll make our modifier and set some defaults as above, and then add to\n it file and image attributes::\n \n     >>> modifier = SkipVersioningOfLargeFilesAndImages()\ndiff --git a/Products/CMFEditions/tests/test_IntegrationTests.py b/Products/CMFEditions/tests/test_IntegrationTests.py\nindex f6b7ac1..2fc5197 100644\n--- a/Products/CMFEditions/tests/test_IntegrationTests.py\n+++ b/Products/CMFEditions/tests/test_IntegrationTests.py\n@@ -285,8 +285,8 @@ def test11_versionAFolderishObjectThatTreatsChildrensAsInsideRefs(self):\n         doc1 = fol.doc1\n         doc2 = fol.doc2\n \n-        # just configure the standard folder to treat the childrens as\n-        # inside refrences. For this we reconfigure the standard modifiers.\n+        # just configure the standard folder to treat the children as\n+        # inside references. For this we reconfigure the standard modifiers.\n         portal_modifier = self.portal.portal_modifier\n         portal_modifier.edit(\n             "OMOutsideChildrensModifier", enabled=False, condition="python: False"\n@@ -578,8 +578,8 @@ def test16_revertInsideRefsUpdatesCatalog(self):\n         fol = self.portal.fol\n         doc = fol.doc1\n \n-        # just configure the standard folder to treat the childrens as\n-        # inside refrences. For this we reconfigure the standard modifiers.\n+        # just configure the standard folder to treat the children as\n+        # inside references. For this we reconfigure the standard modifiers.\n         portal_modifier = self.portal.portal_modifier\n         portal_modifier.edit(\n             "OMOutsideChildrensModifier", enabled=False, condition="python: False"\n@@ -646,8 +646,8 @@ def test17_moveInsideRefThenRevertChangesUid(self):\n         fol = self.portal.fol\n         doc1 = fol.doc1\n \n-        # just configure the standard folder to treat the childrens as\n-        # inside refrences. For this we reconfigure the standard modifiers.\n+        # just configure the standard folder to treat the children as\n+        # inside references. For this we reconfigure the standard modifiers.\n         portal_modifier = self.portal.portal_modifier\n         portal_modifier.edit(\n             "OMOutsideChildrensModifier", enabled=False, condition="python: False"\n@@ -733,7 +733,7 @@ def disabled_test19_retrieveDeletedObjectWhichHasBeenReplacedInAnInsideRefsFolde\n     ):  # noqa\n         # disabled by gregweb/21-10-2006\n         # reason: Needs concentrated and deeper look.\n-        # --> Ideas exist, pleas contact us on the list if you like to work\n+        # --> Ideas exist, please contact us on the list if you like to work\n         #     on that.\n         # I know one should not do that! But solving this would bring more\n         # risks into the 1.0final than leaving the bug to be solved afterwards.\n@@ -795,7 +795,7 @@ def disabled_test20_retrieveMovedObjectWhichHasBeenReplacedInAnInsideRefsFolder(\n     ):  # noqa\n         # disabled by gregweb/21-10-2006\n         # reason: Needs concentrated and deeper look.\n-        # --> Ideas exist, pleas contact us on the list if you like to work\n+        # --> Ideas exist, please contact us on the list if you like to work\n         #     on that.\n         # I know one should not do that! But solving this would bring more\n         # risks into the 1.0final than leaving the bug to be solved afterwards.\ndiff --git a/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py b/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py\nindex ef6aa65..8caa80a 100644\n--- a/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py\n+++ b/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py\n@@ -62,15 +62,15 @@ def test02_beforeSaveHookKeepsMaximumTwoVersions(self):\n         storage = self.portal.portal_historiesstorage\n         purgepolicy.maxNumberOfVersionsToKeep = 2\n \n-        # call hook explicitely before save (dummy tool doesn\'t call it,\n-        # we wan\'t to do it explicitely)\n+        # call hook explicitly before save (dummy tool doesn\'t call it,\n+        # we want to do it explicitly)\n         res = purgepolicy.beforeSaveHook(history_id=1, obj=2, metadata={})\n         self.assertTrue(res)\n         storage.save(history_id=1, obj=DummyData(0))\n         self.assertEqual(len(storage.getHistory(history_id=1)), 1)\n \n-        # call hook explicitely before save (dummy tool doesn\'t call it,\n-        # we wan\'t to do it explicitely)\n+        # call hook explicitly before save (dummy tool doesn\'t call it,\n+        # we want to do it explicitly)\n         res = purgepolicy.beforeSaveHook(history_id=1, obj=2, metadata={})\n         self.assertTrue(res)\n         storage.save(history_id=1, obj=DummyData(1))\ndiff --git a/Products/CMFEditions/tests/test_ZVCStorageTool.py b/Products/CMFEditions/tests/test_ZVCStorageTool.py\nindex 1c4c8bb..8103c84 100644\n--- a/Products/CMFEditions/tests/test_ZVCStorageTool.py\n+++ b/Products/CMFEditions/tests/test_ZVCStorageTool.py\n@@ -226,7 +226,7 @@ def test07_getModificationDate(self):\n         )\n \n         # storage never gets the same object twice, because the archivist always generates another copy on save,\n-        # which then have a diffrent python id.\n+        # which then have a different python id.\n \n         # simulate object copy\n         notifyModified(obj)\ndiff --git a/Products/CMFEditions/utilities.py b/Products/CMFEditions/utilities.py\nindex 56bad8a..c222b0b 100644\n--- a/Products/CMFEditions/utilities.py\n+++ b/Products/CMFEditions/utilities.py\n@@ -35,7 +35,7 @@\n class KwAsAttributes(Persistent):\n     """Class attaching to itself passed keyword attributes."""\n \n-    # Not web accessable\n+    # Not web accessible\n     __roles__ = ()\n \n     def __init__(self, **kw):\n@@ -80,7 +80,7 @@ def dereference(obj=None, history_id=None, zodb_hook=None):\n \n \n def generateId(parent, prefix="", volatile=False):\n-    """Generate an unused id (optionaly a volatile one)."""\n+    """Generate an unused id (optionally a volatile one)."""\n     existingIds = parent.objectIds()\n     idTemplate = "{}{}_%s".format(volatile * "__v_", prefix + STUB_OBJECT_PREFIX)\n     while 1:\n@@ -131,11 +131,11 @@ def wrap(obj, parent):\n \n         getattr(wrapped.aq_parent, tempAttribute)\n     """\n-    # be sure the obj is unwraped before wrapping it (argh, having\n+    # be sure the obj is unwrapped before wrapping it (argh, having\n     # caused pulling my hair out until I realized it is wrapped)\n     obj = aq_base(obj).__of__(parent)\n \n-    # set containment temporarly\n+    # set containment temporary\n     tempAttribute = generateId(parent, volatile=True)\n     changed = parent._p_changed\n     setattr(parent, tempAttribute, obj)\ndiff --git a/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt b/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\nindex 4508a8c..b8d67c4 100644\n--- a/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\n+++ b/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\n@@ -6,7 +6,7 @@\n >tabs</p>\n \n \n-<h2>Add Silly Retrive Modifier For Demos</h2>\n+<h2>Add Silly Retrieve Modifier For Demos</h2>\n \n <form action="manage_addSillyDemoRetrieveModifier"\n       method="post"\ndiff --git a/doc/DevelDoc.html b/doc/DevelDoc.html\nindex 4e15fe7..0f19f85 100644\n--- a/doc/DevelDoc.html\n+++ b/doc/DevelDoc.html\n@@ -64,7 +64,7 @@ <h1 class="title">CMFEditions: Versioning in Plone</h1>\n       </table>\n       <div class="abstract topic">\n         <p class="topic-title first">Abstract</p>\n-        <p>The CMFEditions architecture looks like beeing overly complex.\n+        <p>The CMFEditions architecture looks like being overly complex.\n The complexity has it\'s reasons in Python itself but also in the goal\n of CMFEditions not to rely on specific behaviour of content objects.\n This document shall help developers to grok the architecture and ideas\n@@ -109,16 +109,16 @@ <h1 class="title">CMFEditions: Versioning in Plone</h1>\n             >The Copy Mechanism</a><ul>\n               <li><a class="reference"\n                    id="id13"\n-                   href="#modifers"\n+                   href="#modifiers"\n                    name="id13"\n-                >Modifers</a></li>\n+                >Modifiers</a></li>\n             </ul>\n           </li>\n           <li><a class="reference"\n                id="id14"\n                href="#overwiew-over-the-architecture"\n                name="id14"\n-            >Overwiew over the Architecture</a></li>\n+            >Overview over the Architecture</a></li>\n           <li><a class="reference"\n                id="id15"\n                href="#further-reading"\n@@ -145,7 +145,7 @@ <h1><a class="toc-backref"\n         </blockquote>\n         <p>In this document we concentrate on the first two points (<em>save</em>\n            and\n-          <em>retreive</em>\n+          <em>retrieve</em>\n           the state of something). But what does save\n           <em>save the current\n state</em>\n@@ -177,7 +177,7 @@ <h1><a class="toc-backref"\n &gt;&gt;&gt; a.__dict__\n {}\n </pre>\n-        <p>The data the object carries need not be soley set by code of the class\n+        <p>The data the object carries need not be solely set by code of the class\n implementation:</p>\n         <pre class="literal-block">\n &gt;&gt;&gt; a.x=5\n@@ -226,7 +226,7 @@ <h1><a class="toc-backref"\n     \'time\': DateTime(\'2005/02/14 20:03:37.250 GMT+1\')},)}\n }\n </pre>\n-        <p>Looks quite meaningfull! To store a version just make a (deep) copy of\n+        <p>Looks quite meaningful! To store a version just make a (deep) copy of\n           <tt class="docutils literal"><span class="pre">doc</span></tt>\n           and store the copy away for later retrieval.</p>\n       </div>\n@@ -397,13 +397,13 @@ <h1><a class="toc-backref"\n           of a document are the question part and the\n           <tt class="docutils literal"><span class="pre">body</span></tt>\n            is\n-the answer part. Additionaly a template\n+the answer part. Additionally a template\n           <tt class="docutils literal"><span class="pre">faq_view</span></tt>\n            showing all\n questions at once has to be added).</p>\n         <p>In step 2. above we assumed the subobjects don\'t get saved on a save\n operation of the folder. This assumption is now wrong for the F.A.Q.-Page.\n-We wan\'t the subobjects be saved in case we save the whole F.A.Q.-Page.\n+We want the subobjects be saved in case we save the whole F.A.Q.-Page.\n But how to distinguish the F.A.Q.-Page form a normal folder? The\n F.A.Q.-Page uses the same underlying code as the\n           <tt class="docutils literal"><span class="pre">Folder</span></tt>. Ok, the\n@@ -447,11 +447,11 @@ <h1><a class="toc-backref"\n                src="img/areas.gif"\n                width="138"\n           /></div>\n-        <p>We didn\'t talk about the criterias that decide to what onionskin an\n+        <p>We didn\'t talk about the criteria that decide to what onionskin an\n attribute belongs. See\n           <a class="reference"\n-             href="#modifers"\n-          >Modifers</a>\n+             href="#modifiers"\n+          >Modifiers</a>\n           for this.</p>\n       </div>\n       <div class="section"\n@@ -470,7 +470,7 @@ <h1><a class="toc-backref"\n         <p>So we need to intercept the copy mechanism!</p>\n         <p>This can be done by using one of Pythons serializer:\n           <tt class="docutils literal"><span class="pre">pickle</span></tt></p>\n-        <p>Before continueing please read the\n+        <p>Before continuing please read the\n           <a class="reference"\n              href="http://python.org/doc/2.4/lib/module-pickle.html"\n           >chapter about pickling</a>\n@@ -486,13 +486,13 @@ <h1><a class="toc-backref"\n         <ul class="simple">\n           <li>There is a hook called\n             <tt class="docutils literal"><span class="pre">persistent_id</span></tt>\n-             that get\'s called upon every\n+             that gets called upon every\n object during the serialization process.</li>\n           <li>In this hook you can decide if the object just has to be serialized as\n usual or you may return your own serialization of it.</li>\n           <li>There is another hook\n             <tt class="docutils literal"><span class="pre">persistent_load</span></tt>\n-             that get\'s called upon every\n+             that gets called upon every\n custom serialized object during the deserialization process.</li>\n         </ul>\n         <p>In case of a folder we know which of the attributes are the subobjects.\n@@ -509,11 +509,11 @@ <h1><a class="toc-backref"\n           <tt class="docutils literal"><span class="pre">id</span></tt>\n            get checked if it is one of the\n memorized\n-          <tt class="docutils literal"><span class="pre">id</span></tt>s. In that case just nothing get\'s serialized and all the\n+          <tt class="docutils literal"><span class="pre">id</span></tt>s. In that case just nothing gets serialized and all the\n subobjects information will be lost (which is by intention).</p>\n         <p>During the deserializing process the\n           <tt class="docutils literal"><span class="pre">persistent_load</span></tt>\n-           hook get\'s called\n+           hook gets called\n upon every subobject. We just return an empty version aware weak reference\n that will be initialized correctly later\n           <a class="footnote-reference"\n@@ -576,12 +576,12 @@ <h1><a class="toc-backref"\n }\n </pre>\n         <div class="section"\n-             id="modifers"\n+             id="modifiers"\n         >\n           <h2><a class="toc-backref"\n                href="#id13"\n-               name="modifers"\n-            >Modifers</a></h2>\n+               name="modifiers"\n+            >Modifiers</a></h2>\n           <p>The above job about deciding what attributes belong to the\n             <em>core</em>\n              and what\n@@ -603,7 +603,7 @@ <h2><a class="toc-backref"\n         <h1><a class="toc-backref"\n              href="#id14"\n              name="overwiew-over-the-architecture"\n-          >Overwiew over the Architecture</a></h1>\n+          >Overview over the Architecture</a></h1>\n         <p>CMFEditions make heavily usage of the CMF(-Framework). The functionality\n is split into four tools to allow easy future replacement of the individual\n tools:</p>\ndiff --git a/doc/DevelDoc.txt b/doc/DevelDoc.txt\nindex e326f43..5aba33c 100644\n--- a/doc/DevelDoc.txt\n+++ b/doc/DevelDoc.txt\n@@ -14,7 +14,7 @@ Developer Documentation\n :License: GNU Free Documentation License\n :Status: Draft\n :Audience: Developers\n-:Abstract: The CMFEditions architecture looks like beeing overly complex.\n+:Abstract: The CMFEditions architecture looks like being overly complex.\n   The complexity has it\'s reasons in Python itself but also in the goal\n   of CMFEditions not to rely on specific behaviour of content objects.\n   This document shall help developers to grok the architecture and ideas\n@@ -39,7 +39,7 @@ Just some words about what we talk about when we\'re saying "versioning".\n     to date, etc.\n \n In this document we concentrate on the first two points (*save* and\n-*retreive* the state of something). But what does save *save the current\n+*retrieve* the state of something). But what does save *save the current\n state* mean?\n \n Imagine you don\'t have access to a CVS or SVN repository but you\'re writing\n@@ -66,7 +66,7 @@ A python object is a dictionary::\n   >>> a.__dict__\n   {}\n \n-The data the object carries need not be soley set by code of the class\n+The data the object carries need not be solely set by code of the class\n implementation::\n \n   >>> a.x=5\n@@ -114,7 +114,7 @@ the object carries is found in the objects ``__dict__``::\n       \'time\': DateTime(\'2005/02/14 20:03:37.250 GMT+1\')},)}\n   }\n \n-Looks quite meaningfull! To store a version just make a (deep) copy of\n+Looks quite meaningful! To store a version just make a (deep) copy of\n ``doc`` and store the copy away for later retrieval.\n \n \n@@ -243,12 +243,12 @@ Now let\'s assume we customized the ``Folder`` content type in a way we\n can use it for F.A.Q.-Page (this is a commonly used pattern in CMF/Plone\n sites, it\'s just done by defining that the ``title`` and the\n ``description`` of a document are the question part and the ``body`` is\n-the answer part. Additionaly a template ``faq_view`` showing all\n+the answer part. Additionally a template ``faq_view`` showing all\n questions at once has to be added).\n \n In step 2. above we assumed the subobjects don\'t get saved on a save\n operation of the folder. This assumption is now wrong for the F.A.Q.-Page.\n-We wan\'t the subobjects be saved in case we save the whole F.A.Q.-Page.\n+We want the subobjects be saved in case we save the whole F.A.Q.-Page.\n But how to distinguish the F.A.Q.-Page form a normal folder? The\n F.A.Q.-Page uses the same underlying code as the ``Folder``. Ok, the\n ``portal_type`` attribute has a different value (e.g. ``FAQPage``), so\n@@ -278,7 +278,7 @@ c) outside of the core of the object and *loosely related* to the object.\n    :scale: 100\n    :alt: The different areas where information can live.\n \n-We didn\'t talk about the criterias that decide to what onionskin an\n+We didn\'t talk about the criteria that decide to what onionskin an\n attribute belongs. See `Modifers`_ for this.\n \n \n@@ -296,7 +296,7 @@ So we need to intercept the copy mechanism!\n \n This can be done by using one of Pythons serializer: ``pickle``\n \n-Before continueing please read the `chapter about pickling`_ in the python\n+Before continuing please read the `chapter about pickling`_ in the python\n documentation. For those who like to have a look at the "real code" see\n ``class OMBaseModifier`` in `StandardModifier.py`_.\n \n@@ -305,20 +305,20 @@ documentation. For those who like to have a look at the "real code" see\n \n Just a short resume about pickling:\n \n-- There is a hook called ``persistent_id`` that get\'s called upon every\n+- There is a hook called ``persistent_id`` that gets called upon every\n   object during the serialization process.\n - In this hook you can decide if the object just has to be serialized as\n   usual or you may return your own serialization of it.\n-- There is another hook ``persistent_load`` that get\'s called upon every\n+- There is another hook ``persistent_load`` that gets called upon every\n   custom serialized object during the deserialization process.\n \n In case of a folder we know which of the attributes are the subobjects.\n We just keep their python id [1]_ in "mind". In the ``persistent_id`` hook\n the currently passed objects ``id`` get checked if it is one of the\n-memorized ``id``\\ s. In that case just nothing get\'s serialized and all the\n+memorized ``id``\\ s. In that case just nothing gets serialized and all the\n subobjects information will be lost (which is by intention).\n \n-During the deserializing process the ``persistent_load`` hook get\'s called\n+During the deserializing process the ``persistent_load`` hook gets called\n upon every subobject. We just return an empty version aware weak reference\n that will be initialized correctly later [2]_.\n \n@@ -351,8 +351,8 @@ As a result the original object and the clone object look the following\n   }\n \n \n-Modifers\n---------\n+Modifiers\n+---------\n \n The above job about deciding what attributes belong to the *core* and what\n attributes are *inside* or *outside references* is done by the so called\n@@ -361,7 +361,7 @@ everything application/use case specific can be hold outside of the core\n versioning framework.\n \n \n-Overwiew over the Architecture\n+Overview over the Architecture\n ==============================\n \n CMFEditions make heavily usage of the CMF(-Framework). The functionality\ndiff --git a/doc/ToDo.txt b/doc/ToDo.txt\nindex 03e1ede..9df3817 100644\n--- a/doc/ToDo.txt\n+++ b/doc/ToDo.txt\n@@ -43,7 +43,7 @@ Deferred to a Future Version\n                  resource == all versions at every location\n \n 20. Make the autoapply of the CopyModifyMergerepository a Zope property\n-    beeing editable through the ZMI.\n+    being editable through the ZMI.\n \n 39. Revert, View and Save have different permissions. This must be\n     reflected by the version_history_form only showing actions that\n@@ -58,11 +58,11 @@ Deferred to a Future Version\n 21. No unit tests yet for the "preserve" feature. Write some.\n \n 25. Write a new much simpler history storage replacing the ZVCStorage.\n-    (eventually defered to CMFEditions 1.1, depends on resources, see\n+    (eventually deferred to CMFEditions 1.1, depends on resources, see\n     also 32.)\n \n 32. Make storage unit tests subclassable to allow people writing\n-    new storages to subclass a buch of unit tests (see also 25.).\n+    new storages to subclass a bunch of unit tests (see also 25.).\n \n 16. principal: save the name or kind of unique id?\n \n@@ -88,13 +88,13 @@ Done\n \n 10. archivist: move applying the context to the repository layer\n \n-13. modifier: The modifier API is not powerfull enough to handle:\n+13. modifier: The modifier API is not powerful enough to handle:\n     - subobjects that should not be cloned by pickling (e.g. because\n       they\'re to big) and be passed to the storage by reference.\n     - enable beforeSaveModifier/afterRetrieveModifier to be able to\n       return nested/related objects to be versioned separately.\n \n-17. The archivists getHistory shall return [] for objects not beeing under\n+17. The archivists getHistory shall return [] for objects not being under\n     version control\n \n 3. terminology: rename selector --> version_id --> NO!\n@@ -125,7 +125,7 @@ Done\n     (--> gregweb/everybody, done: gregweb)\n \n 24. Remove autoregister feature from ZVCStorage.py. This is YAGNI on that\n-    level as teh archivist doesn\'t use it.\n+    level as the archivist doesn\'t use it.\n \n 15. UI: refactoring and move to new API\n     (--> reflab, done: gregweb)\n@@ -154,7 +154,7 @@ Done\n 48. ``ZVCStorageTool.py`` stores the current ``__vc_info__`` in a mapping\n     even if the operation was a retrieve. But this is correct only in the\n     case of a revert. This may end in odd behaviour if a user is just looking\n-    at an old version but continueing working on teh current one.\n+    at an old version but continuing working on the current one.\n     --> ``ZVCStorageTool.py`` should not strip the ``__vc_info__`` away.\n     Argghhh: We really should replace the ``ZVCStorageTool`` by a simpler\n     ZODB based one. In the short term we have to write a test showing the\n@@ -165,7 +165,7 @@ Done\n     116                     % history_id)\n     117\n     118         def _saveZVCInfo(self, obj, history_id):\n-    119             """Saves ZVC related informations and deletes them from the object.\n+    119             """Saves ZVC related information and deletes them from the object.\n     120             """\n     121             vc_info = deepCopy(obj.__vc_info__)\n     122  ->         self._getHistoryIdMapping()[history_id] = vc_info\n@@ -174,7 +174,7 @@ Done\n     Also add tests for a mixed behaviour.\n \n 51. ``_recursiveRetrieve``: There is currently a problem with inside_references\n-    beeing moved to outside: What do on revert when reverting an inside_reference\n+    being moved to outside: What do on revert when reverting an inside_reference\n     that has previously been moved to outside (no control over it anymore)? We\n     may end in two object having the same ``history_id`` which is **REALLY** bad.\n     The reverted inside_reference should be attached a new history!!!\n@@ -197,7 +197,7 @@ Done\n     CMFEditions 0.6.x currently offers.\n \n 56. packaging: for the release we need an updated CMF 1.5 CMFUid package\n-    (collective). --> No support for Plone 2.0.x planed anymore.\n+    (collective). --> No support for Plone 2.0.x planned anymore.\n \n 28. CopyModifyMergeRepositoryTool.py currently implements one possible\n     policy how to handle references. Build a framework for pluggable\n@@ -211,7 +211,7 @@ Done\n     time the names of the parents may have changed. But there is a\n     need to store a version aware reference to the parent.\n \n-29. Solve all XXX or replace them by TODO\'s where apropriate.\n+29. Solve all XXX or replace them by TODO\'s where appropriate.\n \n 46. Discuss naming: ``revert`` <--> ``rollback``\n \n@@ -223,9 +223,9 @@ Done\n \n - check responses for tracker issues for alpha3\n - package and publish 1.0alpha3\n-- check answers about rollback versus revert and take a decission\n+- check answers about rollback versus revert and take a decision\n   --> rename to revert\n-- check name change opinions and take a decission\n+- check name change opinions and take a decision\n   --> no name change (lack of time, too risky)\n - storage migration from alpha3 (purge support)\n - Check what the problem is with retrieve in the version view (not purge\ndiff --git a/doc/old-changelog.rst b/doc/old-changelog.rst\nindex 5f5dbfb..88f6c4b 100644\n--- a/doc/old-changelog.rst\n+++ b/doc/old-changelog.rst\n@@ -117,7 +117,7 @@ Fixes:\n - Ported tests to plone.app.testing\n   [tomgross]\n \n-- Removed old FAQ testing code. Should go in a seperate product, if needed.\n+- Removed old FAQ testing code. Should go in a separate product, if needed.\n   [tomgross]\n \n - Frosted cleanups\n@@ -959,7 +959,7 @@ Bugs fixed\n   avoiding wrong information is attached to a working copy when\n   previewing a version. Fix for ToDo.txt item #48. [gregweb]\n \n-- Replaced all occurences of ``rollback`` with ``revert``. Brought into\n+- Replaced all occurrences of ``rollback`` with ``revert``. Brought into\n   sync internal names with UI. Rollback may suggest a transaction\n   rollback which is something different. Including i18n label\n   ``label_rollback`` which is now ``label_revert``. Added backwards\n@@ -987,7 +987,7 @@ Features Added\n - Added Polish translations provided by Piotr Furman [Piotr Furman, gregweb]\n \n - ``RetainWorkflowStateAndHistory`` now adds the ``review_state`` to the\n-  ``sys_metadata`` at save time because at retreive time the workflow tool\n+  ``sys_metadata`` at save time because at retrieve time the workflow tool\n   picks the working copies state. I didn\'t find any other way to do it\n   without digging into workflows internals (which would have been a bad\n   idea anyway). Had to extend the ``IModifier.ISaveRetrieveModifier``\n@@ -1003,7 +1003,7 @@ Features Added\n     will avoid a lot of future tracker items caused by people having\n     removed the purge policy but nevertheless providing purge support\n     to users. The reason is that the archivist and repo layer can\'t\n-    handle yet the empty placeholder object beeing returned by the\n+    handle yet the empty placeholder object being returned by the\n     storage for the purged version. This rule may be relaxed in future\n     versions if the archivist and repo layer support handling of those\n     empty placeholder objects.\n@@ -1019,8 +1019,8 @@ Features Added\n     schematas exist. Numbering counting purged versions and not\n     counting purged versions (passing True or False to ``countPurged``).\n     The default numbering schema is ``countPurged=True``. The UI\n-    history onyl shows unpurged versions (``countPurged=False``).\n-  - If the storage is asked to retreive a removed version it may be\n+    history only shows unpurged versions (``countPurged=False``).\n+  - If the storage is asked to retrieve a removed version it may be\n     instructed to return a substitute for the removed version. The\n     substitution policy itself is implemented in the new purge policy\n     tool. This strategy allows to keep most purge implementation\n@@ -1033,7 +1033,7 @@ Features Added\n     next older version. If no other version is available the next\n     newer is used as substitute. If none is available ... well this\n     isn\'t yet tested :-)\n-  - The archivist and storage may be asked to also retreive the empty\n+  - The archivist and storage may be asked to also retrieve the empty\n     placeholder of a purged version. This functionality is yet exposed\n     to the repo layer. This may change in a future release.\n   - Added ``isValid`` method on the vdata object that allows to ask if\n@@ -1042,7 +1042,7 @@ Features Added\n \n - At save time a version aware reference to the parent node is saved\n   also. Without it would be very ineffective or even impossible to\n-  find out the parents which potentially would prevent adding usefull\n+  find out the parents which potentially would prevent adding useful\n   features like retrieving the a whole site from one object in the\n   tree. [gregweb]\n \n@@ -1156,7 +1156,7 @@ Bugs fixed\n   obj.getModificationDate() because it\'s more fine graned. [gregweb]\n \n - Added ReferenceFactoriesTool.py which in essence knows how to\n-  instatiate a reference. The current implementation is inflexible and\n+  instantiate a reference. The current implementation is inflexible and\n   knows only how to instantiate object into an ObjectManager. This\n   is the first step in preparation for AT reference handling. [gregweb]\n \n@@ -1186,7 +1186,7 @@ Bugs fixed\n \n - Corrected bugs in ``RetainWorkflowStateAndHistory`` modifier and the\n   modifier registry avoiding the review state and the workflow history\n-  from beeing retained on retrieve and revert.\n+  from being retained on retrieve and revert.\n \n \n Features added\ndiff --git a/setup.py b/setup.py\nindex 99a37ae..e8e95e8 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -29,7 +29,7 @@\n         "Programming Language :: Python :: 3.11",\n     ],\n     keywords="Versioning Plone",\n-    author="CMFEditions contributers",\n+    author="CMFEditions contributors",\n     author_email="collective-versioning@lists.sourceforge.net",\n     url="https://pypi.org/project/Products.CMFEditions",\n     license="GPL",\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T14:38:05+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/30469dcf8abce02219089038f8ffe9a830defd69

feat: configure z3c.dependencychecker

Files changed:
M pyproject.toml

b'diff --git a/pyproject.toml b/pyproject.toml\nindex 3a8a567..acb5196 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -60,6 +60,7 @@ Zope = [\n   \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n ]\n python-dateutil = [\'dateutil\']\n+ignore-packages = [\'plone.namedfile\', \'z3c.blobfile\', \'Products.CMFDiffTool\']\n \n [tool.codespell]\n ignore-words-list = "discreet,alog,ist"\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-09T14:38:10+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/76be7b7bf30f602c59af90ba0955b4206d2ee9af

feat: declare dependencies

Files changed:
M setup.py

b'diff --git a/setup.py b/setup.py\nindex e8e95e8..4fd659d 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -40,25 +40,30 @@\n     python_requires=">=3.8",\n     extras_require=dict(\n         test=[\n+            "plone.app.contenttypes",\n+            "plone.app.robotframework",\n             "plone.app.testing",\n             "plone.app.textfield",\n-            "Products.CMFDynamicViewFTI",\n-            "zope.testing",\n+            "plone.base",\n+            "plone.testing",\n         ]\n     ),\n     install_requires=[\n-        "setuptools",\n-        "zope.copy",\n-        "zope.dottedname",\n-        "zope.i18nmessageid",\n-        "plone.base",\n+        "BTrees",\n+        "Missing",\n+        "Persistence",\n         "Products.CMFCore >=2.1",\n         "Products.CMFDiffTool",  # dependency in diff template\n         "Products.CMFUid",\n         "Products.GenericSetup >=1.4.0",\n         "Products.ZopeVersionControl",\n-        "Acquisition",\n+        "Products.statusmessages",\n         "Zope>=5",\n+        "plone.folder",\n+        "plone.locking",\n+        "setuptools",\n+        "zope.copy",\n+        "zope.dottedname",\n     ],\n     entry_points="""\n     [z3c.autoinclude.plugin]\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-04-12T00:10:30+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/8932be00655c52cfc9af387613c31f3248ea85e7

Merge pull request #96 from plone/config-with-default-template-64eff724

Config with default template

Files changed:
A .editorconfig
A .meta.toml
A .pre-commit-config.yaml
A news/3333c742.internal
A tox.ini
M CHANGES.rst
M Products/CMFEditions/ArchivistTool.py
M Products/CMFEditions/CopyModifyMergeRepositoryTool.py
M Products/CMFEditions/KeepLastNVersionsTool.py
M Products/CMFEditions/ModifierRegistryTool.py
M Products/CMFEditions/Modifiers.py
M Products/CMFEditions/StandardModifiers.py
M Products/CMFEditions/ZVCStorageTool.py
M Products/CMFEditions/browser/configure.zcml
M Products/CMFEditions/browser/diff.py
M Products/CMFEditions/browser/policies.py
M Products/CMFEditions/browser/templates/diff.pt
M Products/CMFEditions/browser/templates/diff_legend.pt
M Products/CMFEditions/browser/templates/version_file_view.pt
M Products/CMFEditions/browser/templates/version_image_view.pt
M Products/CMFEditions/browser/templates/version_metadata_view.pt
M Products/CMFEditions/browser/templates/versions_history_form.pt
M Products/CMFEditions/browser/views.py
M Products/CMFEditions/configure.zcml
M Products/CMFEditions/exportimport/configure.zcml
M Products/CMFEditions/interfaces/IArchivist.py
M Products/CMFEditions/interfaces/IModifier.py
M Products/CMFEditions/interfaces/IPurgePolicy.py
M Products/CMFEditions/interfaces/IRepository.py
M Products/CMFEditions/interfaces/IStorage.py
M Products/CMFEditions/permissions.zcml
M Products/CMFEditions/profiles.zcml
M Products/CMFEditions/profiles/default/catalog.xml
M Products/CMFEditions/profiles/default/componentregistry.xml
M Products/CMFEditions/profiles/default/metadata.xml
M Products/CMFEditions/profiles/default/repositorytool.xml
M Products/CMFEditions/profiles/default/rolemap.xml
M Products/CMFEditions/profiles/default/toolset.xml
M Products/CMFEditions/testing.py
M Products/CMFEditions/tests/DummyTools.py
M Products/CMFEditions/tests/large_file_modifiers.rst
M Products/CMFEditions/tests/test_ContentTypes.py
M Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py
M Products/CMFEditions/tests/test_IntegrationTests.py
M Products/CMFEditions/tests/test_KeepLastNVersionsTool.py
M Products/CMFEditions/tests/test_ZVCStorageTool.py
M Products/CMFEditions/utilities.py
M Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt
M Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt
M Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt
M Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt
M Products/CMFEditions/www/RetainUIDsModifierAddForm.pt
M Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt
M Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt
M Products/CMFEditions/www/SillyDemoRetrieveModifier.pt
M Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt
M Products/CMFEditions/www/SkipParentPointersAddForm.pt
M Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt
M Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt
M Products/CMFEditions/www/Skip_z3c_blobfile.pt
M Products/CMFEditions/www/fieldModifierEditForm.pt
M Products/CMFEditions/www/modifierAddForm.pt
M Products/CMFEditions/www/modifierEditForm.pt
M Products/CMFEditions/www/storageStatistics.pt
M Products/CMFEditions/www/talesModifierEditForm.pt
M Products/__init__.py
M doc/DevelDoc.html
M doc/DevelDoc.txt
M doc/ToDo.txt
M doc/old-changelog.rst
M pyproject.toml
M setup.cfg
M setup.py

b'diff --git a/.editorconfig b/.editorconfig\nnew file mode 100644\nindex 00000000..b4158b89\n--- /dev/null\n+++ b/.editorconfig\n@@ -0,0 +1,39 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+#\n+# EditorConfig Configuration file, for more details see:\n+# http://EditorConfig.org\n+# EditorConfig is a convention description, that could be interpreted\n+# by multiple editors to enforce common coding conventions for specific\n+# file types\n+\n+# top-most EditorConfig file:\n+# Will ignore other EditorConfig files in Home directory or upper tree level.\n+root = true\n+\n+\n+[*]  # For All Files\n+# Unix-style newlines with a newline ending every file\n+end_of_line = lf\n+insert_final_newline = true\n+trim_trailing_whitespace = true\n+# Set default charset\n+charset = utf-8\n+# Indent style default\n+indent_style = space\n+# Max Line Length - a hard line wrap, should be disabled\n+max_line_length = off\n+\n+[*.{py,cfg,ini}]\n+# 4 space indentation\n+indent_size = 4\n+\n+[*.{yml,zpt,pt,dtml,zcml}]\n+# 2 space indentation\n+indent_size = 2\n+\n+[{Makefile,.gitmodules}]\n+# Tab indentation (no size specified, but view as 4 spaces)\n+indent_style = tab\n+indent_size = unset\n+tab_width = unset\ndiff --git a/.meta.toml b/.meta.toml\nnew file mode 100644\nindex 00000000..d915ae98\n--- /dev/null\n+++ b/.meta.toml\n@@ -0,0 +1,5 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+[meta]\n+template = "default"\n+commit-id = "3333c742"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 00000000..fdafec1c\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,42 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.3.1\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.12.0\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 23.3.0\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.0.3\n+    hooks:\n+    -   id: zpretty\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 6.0.0\n+    hooks:\n+    -   id: flake8\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.4\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\ndiff --git a/CHANGES.rst b/CHANGES.rst\nindex c8290a1d..10762d63 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -193,7 +193,7 @@ Bug fixes:\n - Fix Unauthorized error due to importing six inside Restricted Python\n   `Plone issue 2463 <https://github.com/plone/Products.CMFPlone/issues/2463>`_\n   [davilima6]\n-- Migrate Tests away fro  PloneTestCase\n+- Migrate Tests away from PloneTestCase\n   [pbauer]\n \n - Do not run webdav_history.txt in py3 since it breaks tests (no webdav support in py3).\ndiff --git a/Products/CMFEditions/ArchivistTool.py b/Products/CMFEditions/ArchivistTool.py\nindex eb4029e4..3725cd70 100644\n--- a/Products/CMFEditions/ArchivistTool.py\n+++ b/Products/CMFEditions/ArchivistTool.py\n@@ -445,7 +445,6 @@ def __init__(\n         is_registered,\n         approxSize,\n     ):\n-\n         # parent reference (register the parent with the unique id handler)\n         # register with sys_metadata as there is no other possibility\n         obj = original.object\ndiff --git a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\nindex 3405a9a5..f1f3b7f2 100644\n--- a/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n+++ b/Products/CMFEditions/CopyModifyMergeRepositoryTool.py\n@@ -31,6 +31,7 @@\n from Acquisition import ImplicitAcquisitionWrapper\n from BTrees.OOBTree import OOBTree\n from OFS.SimpleItem import SimpleItem\n+from plone.locking.interfaces import ILockable\n from Products.CMFCore.utils import _checkPermission\n from Products.CMFCore.utils import getToolByName\n from Products.CMFCore.utils import UniqueObject\n@@ -55,7 +56,6 @@\n from Products.CMFEditions.VersionPolicies import VersionPolicy\n from ZODB.broken import Broken\n from zope.interface import implementer\n-from plone.locking.interfaces import ILockable\n \n import logging\n import time\n@@ -320,7 +320,7 @@ def purge(self, obj, selector, comment="", metadata={}, countPurged=True):\n \n         # Trying to avoid mess with purged versions which we don\'t offer\n         # support yet when passed to the repository layer due to a missing\n-        # purge policy. The problem would occure on revert and retrieve.\n+        # purge policy. The problem would occur on revert and retrieve.\n         pp = getToolByName(self, "portal_purgepolicy", None)\n         if pp is None:\n             raise RepositoryPurgeError(\n@@ -432,7 +432,7 @@ def isUpToDate(self, obj, selector=None, countPurged=True):\n \n     def _assertAuthorized(self, obj, permission, name=None):\n         # We need to provide access to the repository upon the object\n-        # permissions istead of repositories method permissions.\n+        # permissions instead of repositories method permissions.\n         # So the repository method access is set to public and the\n         # access is check on the object when needed.\n         if not _checkPermission(permission, obj):\n@@ -550,7 +550,7 @@ def _recursiveRetrieve(\n         # revert) this has to be reversed after having recursed into the\n         # tree.\n         if hasBeenDeleted:\n-            # if the object to retreive doesn\'t have a counterpart in the tree\n+            # if the object to retrieve doesn\'t have a counterpart in the tree\n             # build a new one before retrieving an old state\n             vdata = portal_archivist.retrieve(\n                 obj, history_id, selector, preserve, countPurged\n@@ -724,6 +724,7 @@ def _unlock(self, obj):\n         if lockable:\n             lockable.unlock()\n \n+\n @implementer(IVersionData)\n class VersionData:\n     """ """\ndiff --git a/Products/CMFEditions/KeepLastNVersionsTool.py b/Products/CMFEditions/KeepLastNVersionsTool.py\nindex d4f8924a..9583ab6f 100644\n--- a/Products/CMFEditions/KeepLastNVersionsTool.py\n+++ b/Products/CMFEditions/KeepLastNVersionsTool.py\n@@ -89,7 +89,7 @@ def beforeSaveHook(self, history_id, obj, metadata={}):\n         return True\n \n     def retrieveSubstitute(self, history_id, selector, default=None):\n-        """Retrives the next older version\n+        """Retrieves the next older version\n \n         If there isn\'t a next older one returns the next newer one.\n         """\ndiff --git a/Products/CMFEditions/ModifierRegistryTool.py b/Products/CMFEditions/ModifierRegistryTool.py\nindex 0f0bc021..4450b3d8 100644\n--- a/Products/CMFEditions/ModifierRegistryTool.py\n+++ b/Products/CMFEditions/ModifierRegistryTool.py\n@@ -167,7 +167,7 @@ def reattachReferencedAttributes(self, obj, referenced_data):\n     def getOnCloneModifiers(self, obj):\n         """See IModifier"""\n         # First check if there is at least one ICloneModifier to loop over.\n-        # The clone operation is much fater if there are no \'persistent_id\'\n+        # The clone operation is much faster if there are no \'persistent_id\'\n         # hooks to call.\n         modifiers = self._collectModifiers(obj, ICloneModifier)\n         if not modifiers:\ndiff --git a/Products/CMFEditions/Modifiers.py b/Products/CMFEditions/Modifiers.py\nindex fb6df971..68ce12f4 100644\n--- a/Products/CMFEditions/Modifiers.py\n+++ b/Products/CMFEditions/Modifiers.py\n@@ -168,10 +168,10 @@ def createExpressionContext(obj, portal=None, **more_symbols):\n     """\n \n     def findNextFolderishParent(obj):\n-        """Try to find the folder of the given object by aquisition.\n+        """Try to find the folder of the given object by acquisition.\n \n         XXX what\'s the correct strategy in Zope2 land to check for a folder?\n-            what\'s most relyable?\n+            what\'s most reliable?\n             a) check if isPrincipiaFolderish is True?\n             b) check if the object is an ObjectManager?\n             c) other?\ndiff --git a/Products/CMFEditions/StandardModifiers.py b/Products/CMFEditions/StandardModifiers.py\nindex d1961646..f32c25d5 100644\n--- a/Products/CMFEditions/StandardModifiers.py\n+++ b/Products/CMFEditions/StandardModifiers.py\n@@ -97,7 +97,7 @@ def install(portal_modifier, ids=None):\n \n \n def manage_addOMOutsideChildrensModifier(self, id, title=None, REQUEST=None):\n-    """Add an object manager modifier treating childrens as outside refs"""\n+    """Add an object manager modifier treating children as outside refs"""\n     modifier = OMOutsideChildrensModifier()\n     self._setObject(id, ConditionalTalesModifier(id, modifier, title))\n \n@@ -320,7 +320,7 @@ class OMBaseModifier(RetainAttributeAnnotationItemsBase):\n     PRESERVE_ANNOTATION_KEYS = (DefaultOrdering.ORDER_KEY, DefaultOrdering.POS_KEY)\n \n     def _getOnCloneModifiers(self, obj):\n-        """Removes all childrens and returns them as references."""\n+        """Removes all children and returns them as references."""\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         VersionAwareReference = portal_archivist.classes.VersionAwareReference\n \n@@ -347,12 +347,12 @@ def persistent_load(ignored):\n         return persistent_id, persistent_load, result_refs\n \n     def _beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects."""\n+        """Returns all uninitialized \'IVersionAwareReference\' objects."""\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         adapter = portal_archivist.classes.ObjectManagerStorageAdapter\n \n         # just return adapters to the attributes that were replaced by\n-        # a uninitialzed \'IVersionAwareReference\' object\n+        # a uninitialized \'IVersionAwareReference\' object\n         result_refs = []\n         for name in clone.objectIds():\n             result_refs.append(adapter(clone, name, type="Folder"))\n@@ -372,21 +372,21 @@ def _getAttributeNamesHandlingSubObjects(self, obj, repo_clone):\n \n @implementer(ICloneModifier, ISaveRetrieveModifier)\n class OMOutsideChildrensModifier(OMBaseModifier):\n-    """ObjectManager modifier treating all childrens as outside refs\n+    """ObjectManager modifier treating all children as outside refs\n \n-    Treats all childrens as outside references (the repository layer\n+    Treats all children as outside references (the repository layer\n     knows what to do with that fact).\n     """\n \n     def getOnCloneModifiers(self, obj):\n-        """Removes all childrens and returns them as references."""\n+        """Removes all children and returns them as references."""\n         pers_id, pers_load, outside_refs = self._getOnCloneModifiers(obj)\n         return pers_id, pers_load, [], outside_refs, ""\n \n     def beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects.\n+        """Returns all uninitialized \'IVersionAwareReference\' objects.\n \n-        This allways goes in conjunction with \'getOnCloneModifiers\'.\n+        This always goes in conjunction with \'getOnCloneModifiers\'.\n         """\n         outside_refs = self._beforeSaveModifier(obj, clone)\n         return {}, [], outside_refs\n@@ -433,21 +433,21 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n \n @implementer(ICloneModifier, ISaveRetrieveModifier)\n class OMInsideChildrensModifier(OMBaseModifier):\n-    """ObjectManager modifier treating all childrens as inside refs\n+    """ObjectManager modifier treating all children as inside refs\n \n-    Treats all childrens as inside references (the repository layer\n+    Treats all children as inside references (the repository layer\n     knows what to do with that fact).\n     """\n \n     def getOnCloneModifiers(self, obj):\n-        """Removes all childrens and returns them as references."""\n+        """Removes all children and returns them as references."""\n         pers_id, pers_load, inside_refs = self._getOnCloneModifiers(obj)\n         return pers_id, pers_load, inside_refs, [], ""\n \n     def beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects.\n+        """Returns all uninitialized \'IVersionAwareReference\' objects.\n \n-        This allways goes in conjunction with \'getOnCloneModifiers\'.\n+        This always goes in conjunction with \'getOnCloneModifiers\'.\n         """\n         inside_refs = self._beforeSaveModifier(obj, clone)\n         return {}, inside_refs, []\n@@ -527,7 +527,7 @@ def remove(self, permanent=False):\n         # IM(alecm)O, we should update the catalog if the change is permanent\n         # and not if otherwise, this forces this Adapter to know a bit about\n         # implementation details, but it\'s an optional arg to a specific\n-        # implemetnation of this interface, so I think this is acceptable.\n+        # implementation of this interface, so I think this is acceptable.\n         # The only other option I see is to do the deletion in the\n         # CopyModifyMerge tool which is aware of the distinction between\n         # retrieve and revert.\n@@ -541,11 +541,11 @@ def remove(self, permanent=False):\n class RetainWorkflowStateAndHistory:\n     """Standard modifier retaining the working copies workflow state\n \n-    Avoids the objects workflow state from beeing retrieved also.\n+    Avoids the objects workflow state from being retrieved also.\n     """\n \n     def beforeSaveModifier(self, obj, clone):\n-        # Saving the ``review_state`` as this is hard to achieve at retreive\n+        # Saving the ``review_state`` as this is hard to achieve at retrieve\n         # (or because I\'m dumb). What happened is that ``getInfoFor`` always\n         # returned the state of the working copy although the retrieved\n         # temporary object was passed to it.\n@@ -650,7 +650,6 @@ def getReferencedAttributes(self, obj):\n         return {"data": getattr(aq_base(obj), "data", None)}\n \n     def reattachReferencedAttributes(self, obj, attrs_dict):\n-\n         obj = aq_base(obj)\n         for name, attr_value in attrs_dict.items():\n             setattr(obj, name, attr_value)\n@@ -790,7 +789,7 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n         # sorry: hack\n         clone = repo_clone.__of__(obj.aq_inner.aq_parent)\n \n-        # replace all occurences of DeMo with Demo and deMo with demo\n+        # replace all occurrences of DeMo with Demo and deMo with demo\n         text = clone.EditableBody()\n         text = text.replace("DeMo", "Demo").replace("deMo", "demo")\n         clone.setText(text)\n@@ -941,7 +940,7 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n @implementer(ICloneModifier, ISaveRetrieveModifier)\n class Skip_z3c_blobfile:\n     """Standard avoid storing blob data, may be useful for extremely\n-    large files where versioing the non-file metadata is important but\n+    large files where versioning the non-file metadata is important but\n     the cost of versioning the file data is too high.\n     """\n \n@@ -1074,7 +1073,7 @@ def afterRetrieveModifier(self, obj, repo_clone, preserve=()):\n     },\n     {\n         "id": "SillyDemoRetrieveModifier",\n-        "title": "Silly retrive modifier for demos only.",\n+        "title": "Silly retrieve modifier for demos only.",\n         "enabled": False,\n         "condition": "python: True",\n         "wrapper": ConditionalTalesModifier,\ndiff --git a/Products/CMFEditions/ZVCStorageTool.py b/Products/CMFEditions/ZVCStorageTool.py\nindex c7e8bee6..03691a2e 100644\n--- a/Products/CMFEditions/ZVCStorageTool.py\n+++ b/Products/CMFEditions/ZVCStorageTool.py\n@@ -77,7 +77,7 @@ def deepCopy(obj):\n def getSize(obj):\n     """Calculate the size as cheap as possible"""\n     # Try the cheap variants first.\n-    # Actually the checks ensure the code never fails but beeing sure\n+    # Actually the checks ensure the code never fails but being sure\n     # is better.\n     try:\n         # check if to return zero (length is zero)\n@@ -146,7 +146,7 @@ class ZVCStorageTool(UniqueObject, SimpleItem):\n     - When iterating over the history the removed versions (usually)\n       aren\'t of interest. Thus the next valid version may be accessed\n       by incrementing the selector and vice versa.\n-    - When retrieving a version beeing able to access removed version\n+    - When retrieving a version being able to access removed version\n       or correctly spoken a substitute (pretending to be the removed\n       version) is important when reconstructing relations between\n       objects.\n@@ -164,7 +164,7 @@ class ZVCStorageTool(UniqueObject, SimpleItem):\n         {"label": "Statistics (may take time)", "action": "storageStatistics"},\n     ) + SimpleItem.manage_options[:]\n \n-    # make exceptions available trough the tool\n+    # make exceptions available through the tool\n     StorageError = StorageError\n     StorageRetrieveError = StorageRetrieveError\n \n@@ -387,7 +387,7 @@ def _applyOrCheckin(\n         approxSize = getSize(object) + getSize(referenced_data)\n         metadata["sys_metadata"]["approxSize"] = approxSize\n \n-        # prepare the object for beeing saved with ZVC\n+        # prepare the object for being saved with ZVC\n         #\n         # - Recall the ``__vc_info__`` from the most current version\n         #   (selector=None).\n@@ -469,7 +469,7 @@ def _getZVCAccessInfo(self, history_id, selector, countPurged):\n         return zvc_hid, zvc_vid\n \n     def _getVcInfo(self, obj, shadowInfo, set_checked_in=False):\n-        """Recalls ZVC Related Informations and Attaches them to the Object"""\n+        """Recalls ZVC Related Information and Attaches them to the Object"""\n         vc_info = deepCopy(shadowInfo["vc_info"])\n         if vc_info is None:\n             return None\n@@ -551,7 +551,7 @@ def zmi_getStorageStatistics(self):\n         hidhandler = getToolByName(self, "portal_historyidhandler")\n         portal_paths_len = len(getToolByName(self, "portal_url")())\n \n-        # collect interesting informations\n+        # collect interesting information\n         histories = []\n         for hid in historyIds.keys():\n             history = self.getHistory(hid)\n@@ -840,7 +840,7 @@ def _getVersionPos(self, selector, countPurged):\n \n         # Lets search from the end of the available list as it is more\n         # likely that a younger versions position has to be returned.\n-        # Let\'s work on a copy to not trigger an unecessary ZODB store\n+        # Let\'s work on a copy to not trigger an unnecessary ZODB store\n         # operations.\n         history = self._available[:]\n         history.reverse()\ndiff --git a/Products/CMFEditions/browser/configure.zcml b/Products/CMFEditions/browser/configure.zcml\nindex ffe9c052..76c65e47 100644\n--- a/Products/CMFEditions/browser/configure.zcml\n+++ b/Products/CMFEditions/browser/configure.zcml\n@@ -1,100 +1,101 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n-    xmlns:browser="http://namespaces.zope.org/browser">\n+    xmlns:browser="http://namespaces.zope.org/browser"\n+    >\n \n-    <browser:page\n-        for="*"\n-        name="history"\n-        class=".diff.DiffView"\n-        template="templates/diff.pt"\n-        permission="CMFEditions.AccessPreviousVersions"\n-        />\n+  <browser:page\n+      name="history"\n+      for="*"\n+      class=".diff.DiffView"\n+      template="templates/diff.pt"\n+      permission="CMFEditions.AccessPreviousVersions"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="get_macros"\n-        class=".utils.GetMacros"\n-        attribute="get_macros"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="get_macros"\n+      for="*"\n+      class=".utils.GetMacros"\n+      attribute="get_macros"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="update_version_on_edit"\n-        class=".views.UpdateVersionOnEditView"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="update_version_on_edit"\n+      for="*"\n+      class=".views.UpdateVersionOnEditView"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="update_version_before_edit"\n-        class=".views.UpdateVersionBeforeEditView"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="update_version_before_edit"\n+      for="*"\n+      class=".views.UpdateVersionBeforeEditView"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="version_file_view"\n-        template="templates/version_file_view.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="version_file_view"\n+      for="*"\n+      template="templates/version_file_view.pt"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="version_image_view"\n-        template="templates/version_image_view.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="version_image_view"\n+      for="*"\n+      template="templates/version_image_view.pt"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="version_metadata_view"\n-        template="templates/version_metadata_view.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="version_metadata_view"\n+      for="*"\n+      template="templates/version_metadata_view.pt"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="saveasnewversion"\n-        class=".policies.SaveAsNewVersion"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="saveasnewversion"\n+      for="*"\n+      class=".policies.SaveAsNewVersion"\n+      permission="zope2.View"\n+      />\n \n-    <browser:page\n-        for="*"\n-        name="revertversion"\n-        class=".policies.RevertVersion"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="revertversion"\n+      for="*"\n+      class=".policies.RevertVersion"\n+      permission="zope2.View"\n+      />\n \n-    <!-- Note: this is also used by plone.app.iterate -->\n-    <browser:page\n-        for="*"\n-        name="diff_legend"\n-        template="templates/diff_legend.pt"\n-        permission="zope2.View"\n-        />\n+  <!-- Note: this is also used by plone.app.iterate -->\n+  <browser:page\n+      name="diff_legend"\n+      for="*"\n+      template="templates/diff_legend.pt"\n+      permission="zope2.View"\n+      />\n \n-    <!-- Note: this is roughly the same as @@historyview in plone.app.layout\n+  <!-- Note: this is roughly the same as @@historyview in plone.app.layout\n          which is a small wrapper around @@contenthistory in plone.app.layout,\n          which is a viewlet turned into a view.  Their version looks nicer.\n          But our versions_history_form has a preview (which contenthistory points to)\n          and a form to add a new version, if the policy is manual. -->\n-    <browser:page\n-        for="*"\n-        name="versions_history_form"\n-        class=".views.VersionsHistoryForm"\n-        template="templates/versions_history_form.pt"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="versions_history_form"\n+      for="*"\n+      class=".views.VersionsHistoryForm"\n+      template="templates/versions_history_form.pt"\n+      permission="zope2.View"\n+      />\n \n-    <!-- We could make this a resource, but then we need to change plone.app.iterate as well.\n+  <!-- We could make this a resource, but then we need to change plone.app.iterate as well.\n          So for now make it a browser view. -->\n-    <browser:page\n-        for="*"\n-        name="compare.css"\n-        class=".views.CompareCSS"\n-        permission="zope2.View"\n-        />\n+  <browser:page\n+      name="compare.css"\n+      for="*"\n+      class=".views.CompareCSS"\n+      permission="zope2.View"\n+      />\n \n </configure>\ndiff --git a/Products/CMFEditions/browser/diff.py b/Products/CMFEditions/browser/diff.py\nindex 7143434e..d96ae43d 100644\n--- a/Products/CMFEditions/browser/diff.py\n+++ b/Products/CMFEditions/browser/diff.py\n@@ -6,7 +6,6 @@\n \n \n class DiffView(BrowserView):\n-\n     def __init__(self, *args):\n         super().__init__(*args)\n         self.repo_tool = getToolByName(self.context, "portal_repository")\ndiff --git a/Products/CMFEditions/browser/policies.py b/Products/CMFEditions/browser/policies.py\nindex be4af48b..3daf624f 100644\n--- a/Products/CMFEditions/browser/policies.py\n+++ b/Products/CMFEditions/browser/policies.py\n@@ -36,7 +36,7 @@ def __call__(self):\n             "url"\n         ]\n         if obj_type_view_url != "/":\n-            view_url = "%s/%s" % (self.context.absolute_url(), obj_type_view_url)\n+            view_url = f"{self.context.absolute_url()}/{obj_type_view_url}"\n         else:\n             view_url = self.context.absolute_url()\n \n@@ -44,7 +44,7 @@ def __call__(self):\n             try:\n                 commit_msg = translate(\n                     _(\n-                        u"Reverted to revision ${version}",\n+                        "Reverted to revision ${version}",\n                         mapping={"version": version_id},\n                     ),\n                     context=self.request,\ndiff --git a/Products/CMFEditions/browser/templates/diff.pt b/Products/CMFEditions/browser/templates/diff.pt\nindex e91edb3d..5f2ba8e0 100644\n--- a/Products/CMFEditions/browser/templates/diff.pt\n+++ b/Products/CMFEditions/browser/templates/diff.pt\n@@ -1,16 +1,23 @@\n <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"\n          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n <html xmlns="http://www.w3.org/1999/xhtml"\n-      xmlns:tal="http://xml.zope.org/namespaces/tal"\n-      xmlns:metal="http://xml.zope.org/namespaces/metal"\n       xmlns:i18n="http://xml.zope.org/namespaces/i18n"\n-      xml:lang="en" lang="en"\n+      xmlns:metal="http://xml.zope.org/namespaces/metal"\n+      xmlns:tal="http://xml.zope.org/namespaces/tal"\n+      lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="cmfeditions">\n+      xml:lang="en"\n+      i18n:domain="cmfeditions"\n+>\n \n   <tal:block metal:fill-slot="head_slot">\n-    <link rel="stylesheet" type="text/css" href="compare.css"\n-          tal:attributes="href string:${portal_url}/compare.css"/>\n+    <link href="compare.css"\n+          rel="stylesheet"\n+          type="text/css"\n+          tal:attributes="\n+            href string:${portal_url}/compare.css;\n+          "\n+    />\n   </tal:block>\n \n   <tal:block metal:fill-slot="javascript_head_slot">\n@@ -40,7 +47,7 @@\n       });\n     })(jQuery);\n \n-</script>\n+    </script>\n   </tal:block>\n \n   <body>\n@@ -50,140 +57,248 @@\n       </h1>\n \n       <div id="content-core">\n-          <p class="text-muted" tal:condition="not:view/history" i18n:translate="no_history">\n+        <p class="text-muted"\n+           tal:condition="not:view/history"\n+           i18n:translate="no_history"\n+        >\n             This object has no revision information.\n+        </p>\n+\n+        <tal:block condition="view/history">\n+          <form id="versionSelector"\n+                action="#"\n+                tal:define="\n+                  toLocalizedTime nocall:context/@@plone/toLocalizedTime;\n+                "\n+                tal:attributes="\n+                  action string:${context/absolute_url}/@@history;\n+                "\n+          >\n+            <fieldset>\n+              <legend i18n:translate="legend_revisions">Revisions</legend>\n+\n+              <div class="form-floating">\n+                <select class="form-select"\n+                        id="two"\n+                        name="two"\n+                        tal:define="\n+                          rev request/two|string:current;\n+                        "\n+                >\n+                  <option value="current"\n+                          tal:attributes="\n+                            selected python:rev==\'current\' and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_current"\n+                  >Current</option>\n+                  <option tal:repeat="version view/history"\n+                          tal:attributes="\n+                            value version/version_id;\n+                            selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_history_version"\n+                  ><tal:version content="version/version_id"\n+                                 i18n:name="version"\n+                    >1</tal:version>\n+                    (<tal:date content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])"\n+                              i18n:name="date"\n+                    >1975-12-24</tal:date>)</option>\n+                </select>\n+                <label for="two"\n+                       i18n:translate=""\n+                >First revision</label>\n+              </div>\n+\n+              <div class="form-floating">\n+                <select class="form-select"\n+                        id="one"\n+                        name="one"\n+                        tal:define="\n+                          rev request/one|string:current;\n+                        "\n+                >\n+                  <option value="current"\n+                          tal:attributes="\n+                            selected python:rev==\'current\' and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_current"\n+                  >Current</option>\n+                  <option tal:repeat="version view/history"\n+                          tal:attributes="\n+                            value version/version_id;\n+                            selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None;\n+                          "\n+                          i18n:translate="label_history_version"\n+                  ><tal:version content="version/version_id"\n+                                 i18n:name="version"\n+                    >1</tal:version>\n+                    (<tal:date content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])"\n+                              i18n:name="date"\n+                    >1975-12-24</tal:date>)</option>\n+                </select>\n+                <label for="one"\n+                       i18n:translate=""\n+                >Second revision</label>\n+              </div>\n+            </fieldset>\n+\n+            <noscript>\n+              <input type="submit"\n+                     value="Update"\n+                     i18n:attributes="value label_update"\n+              />\n+            </noscript>\n+          </form>\n+\n+          <div metal:use-macro="context/@@diff_legend/macros/diff_legend"></div>\n+\n+          <p tal:condition="not:view/changes"\n+             i18n:translate=""\n+          >\n+              There are no changes between the selected revisions.\n           </p>\n \n-          <tal:block condition="view/history">\n-            <form id="versionSelector"\n-                  action="#"\n-                  tal:attributes="action string:${context/absolute_url}/@@history"\n-                  tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime">\n-              <fieldset>\n-                <legend i18n:translate="legend_revisions">Revisions</legend>\n-\n-                <div class="form-floating">\n-                  <select class="form-select" id="two" name="two" tal:define="rev request/two|string:current">\n-                    <option i18n:translate="label_current" value="current" tal:attributes="selected python:rev==\'current\' and \'yes\' or None">Current</option>\n-                    <option tal:repeat="version view/history"\n-                            tal:attributes="value version/version_id; selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None"\n-                            i18n:translate="label_history_version"><tal:version i18n:name="version" content="version/version_id">1</tal:version>\n-                            (<tal:date i18n:name="date" content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])">1975-12-24</tal:date>)</option>\n-                  </select>\n-                  <label for="two" i18n:translate="">First revision</label>\n-                </div>\n-\n-                <div class="form-floating">\n-                  <select class="form-select" id="one" name="one" tal:define="rev request/one|string:current">\n-                    <option i18n:translate="label_current" value="current" tal:attributes="selected python:rev==\'current\' and \'yes\' or None">Current</option>\n-                    <option tal:repeat="version view/history"\n-                            tal:attributes="value version/version_id; selected python:str(rev)==str(version[\'version_id\']) and \'yes\' or None"\n-                            i18n:translate="label_history_version"><tal:version i18n:name="version" content="version/version_id">1</tal:version>\n-                            (<tal:date i18n:name="date" content="python:toLocalizedTime(version[\'sys_metadata\'][\'timestamp\'])">1975-12-24</tal:date>)</option>\n-                  </select>\n-                  <label for="one" i18n:translate="">Second revision</label>\n-                </div>\n-              </fieldset>\n-\n-              <noscript>\n-                <input type="submit" i18n:attributes="value label_update" value="Update"/>\n-              </noscript>\n+          <tal:changes condition="view/changes">\n+            <form class="mt-3"\n+                  id="diffTypeSelector"\n+                  action=""\n+                  method="post"\n+            >\n+              <label class="jsOnly"\n+                     for="diffstyle"\n+                     style="display: none"\n+                     i18n:translate=""\n+              >Show differences</label>\n+              <div class="form-check">\n+                <input class="form-check-input"\n+                       id="diffstylevisual"\n+                       checked="checked"\n+                       name="diffstyle"\n+                       type="radio"\n+                       value="visual"\n+                />\n+                <label class="form-check-label"\n+                       for="diffstylevisual"\n+                       i18n:translate=""\n+                >inline</label>\n+              </div>\n+              <div class="form-check">\n+                <input class="form-check-input"\n+                       id="diffstylecode"\n+                       name="diffstyle"\n+                       type="radio"\n+                       value="code"\n+                />\n+                <label class="form-check-label"\n+                       for="diffstylecode"\n+                       i18n:translate=""\n+                >as code</label>\n+              </div>\n             </form>\n \n-            <div metal:use-macro="context/@@diff_legend/macros/diff_legend" />\n+            <fieldset class="mt-3 bg-light border border-dark p-3"\n+                      tal:repeat="diff view/changes"\n+            >\n+              <legend tal:content="diff/label">Body text</legend>\n \n-            <p tal:condition="not:view/changes" i18n:translate="">\n-              There are no changes between the selected revisions.\n-            </p>\n-\n-            <tal:changes condition="view/changes">\n-              <form id="diffTypeSelector" method="post" action="" class="mt-3">\n-                <label for="diffstyle" class="jsOnly" style="display: none" i18n:translate="">Show differences</label>\n-                <div class="form-check">\n-                  <input class="form-check-input" id="diffstylevisual" type="radio" name="diffstyle" value="visual" checked="checked" />\n-                  <label class="form-check-label" for="diffstylevisual" i18n:translate="">inline</label>\n-                </div>\n-                <div class="form-check">\n-                  <input class="form-check-input" id="diffstylecode" type="radio" name="diffstyle" value="code" />\n-                  <label class="form-check-label" for="diffstylecode" i18n:translate="">as code</label>\n-                </div>\n-              </form>\n-\n-              <fieldset class="mt-3 bg-light border border-dark p-3" tal:repeat="diff view/changes">\n-                <legend tal:content="diff/label">Body text</legend>\n-\n-                <div class="fieldDiff inline-diff" tal:condition="exists:diff/inline_diff"\n-                     tal:content="structure python:diff.inline_diff()">\n+              <div class="fieldDiff inline-diff"\n+                   tal:condition="exists:diff/inline_diff"\n+                   tal:content="structure python:diff.inline_diff()"\n+              >\n                   Inline changes\n-                </div>\n+              </div>\n \n-                <p class="fieldDiff inline-diff" tal:condition="not:exists:diff/inline_diff" i18n:translate="">\n+              <p class="fieldDiff inline-diff"\n+                 tal:condition="not:exists:diff/inline_diff"\n+                 i18n:translate=""\n+              >\n                   This field has no inline difference view.\n-                </p>\n+              </p>\n \n-                <div class="fieldDiff code-diff"\n-                     style="display: none"\n-                     tal:define="exists_html_diff exists:diff/html_diff;\n-                                 html_diff python:diff.html_diff(wrapcolumn=80) if exists_html_diff else \'\';\n-                                 has_html_diff python:bool(html_diff)">\n-                  <pre tal:condition="has_html_diff"\n-                       tal:content="structure html_diff">\n+              <div class="fieldDiff code-diff"\n+                   style="display: none"\n+                   tal:define="\n+                     exists_html_diff exists:diff/html_diff;\n+                     html_diff python:diff.html_diff(wrapcolumn=80) if exists_html_diff else \'\';\n+                     has_html_diff python:bool(html_diff);\n+                   "\n+              >\n+                <pre tal:condition="has_html_diff"\n+                     tal:content="structure html_diff"\n+                >\n                     HTML formatted differences\n                   </pre>\n \n-                  <tal:block condition="not:has_html_diff">\n-                    <tal:block define="exists_ndiff exists:diff/ndiff;\n-                                       ndiff python:diff.ndiff() if exists_ndiff else \'\';\n-                                       has_ndiff python:bool(ndiff)">\n-                      <pre class="fieldDiff code-diff"\n-                           tal:condition="has_ndiff"\n-                           tal:content="ndiff">\n+                <tal:block condition="not:has_html_diff">\n+                  <tal:block define="\n+                               exists_ndiff exists:diff/ndiff;\n+                               ndiff python:diff.ndiff() if exists_ndiff else \'\';\n+                               has_ndiff python:bool(ndiff);\n+                             ">\n+                    <pre class="fieldDiff code-diff"\n+                         tal:condition="has_ndiff"\n+                         tal:content="ndiff"\n+                    >\n                         ndiff formatted differences\n                       </pre>\n-                      <p class="fieldDiff"\n-                         tal:condition="not:has_ndiff">\n+                    <p class="fieldDiff"\n+                       tal:condition="not:has_ndiff"\n+                    >\n                         This field has no code difference view.\n-                      </p>\n-                    </tal:block>\n+                    </p>\n                   </tal:block>\n-                </div>\n-              </fieldset>\n+                </tal:block>\n+              </div>\n+            </fieldset>\n \n-              <tal:block tal:condition="view/changeset/recursive">\n+            <tal:block tal:condition="view/changeset/recursive">\n \n \n-                <tal:changed define="subdiffs view/changeset/getSubDiffs;\n-                                     subdiffs python:[c for c in subdiffs if not c.same if c.id];"\n-                             condition="subdiffs">\n+              <tal:changed define="\n+                             subdiffs view/changeset/getSubDiffs;\n+                             subdiffs python:[c for c in subdiffs if not c.same if c.id];\n+                           "\n+                           condition="subdiffs"\n+              >\n \n-                  <h2>Changed files</h2>\n+                <h2>Changed files</h2>\n \n-                  <ul tal:condition="subdiffs">\n-                    <li tal:repeat="cs subdiffs">\n-                      <a tal:content="cs/id" tal:attributes="href cs/id">[filename]</a>\n-                    </li>\n-                  </ul>\n+                <ul tal:condition="subdiffs">\n+                  <li tal:repeat="cs subdiffs">\n+                    <a tal:content="cs/id"\n+                       tal:attributes="\n+                         href cs/id;\n+                       "\n+                    >[filename]</a>\n+                  </li>\n+                </ul>\n \n-                </tal:changed>\n+              </tal:changed>\n \n-                <tal:changed condition="view/changeset/getRemovedItems">\n-                  <h2>Removed files</h2>\n-                  <ul>\n-                    <li tal:repeat="id view/changeset/getRemovedItems" tal:content="id">[filename]</li>\n-                  </ul>\n-                </tal:changed>\n+              <tal:changed condition="view/changeset/getRemovedItems">\n+                <h2>Removed files</h2>\n+                <ul>\n+                  <li tal:repeat="id view/changeset/getRemovedItems"\n+                      tal:content="id"\n+                  >[filename]</li>\n+                </ul>\n+              </tal:changed>\n \n-                <tal:changed condition="view/changeset/getAddedItems">\n-                  <h2>Added files</h2>\n-                  <ul tal:condition="view/changeset/getAddedItems">\n-                    <li tal:repeat="id view/changeset/getAddedItems"><a tal:content="id" tal:attributes="href id">[filename]</a></li>\n-                  </ul>\n-                </tal:changed>\n+              <tal:changed condition="view/changeset/getAddedItems">\n+                <h2>Added files</h2>\n+                <ul tal:condition="view/changeset/getAddedItems">\n+                  <li tal:repeat="id view/changeset/getAddedItems"><a tal:content="id"\n+                       tal:attributes="\n+                         href id;\n+                       "\n+                    >[filename]</a></li>\n+                </ul>\n+              </tal:changed>\n \n-              </tal:block>\n+            </tal:block>\n \n-            </tal:changes>\n-          </tal:block>\n+          </tal:changes>\n+        </tal:block>\n       </div>\n     </metal:main>\n   </body>\ndiff --git a/Products/CMFEditions/browser/templates/diff_legend.pt b/Products/CMFEditions/browser/templates/diff_legend.pt\nindex d2b3c837..7a4b6a85 100644\n--- a/Products/CMFEditions/browser/templates/diff_legend.pt\n+++ b/Products/CMFEditions/browser/templates/diff_legend.pt\n@@ -1,16 +1,36 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"\n-    i18n:domain="cmfeditions">\n+<html xmlns="http://www.w3.org/1999/xhtml"\n+      lang="en-US"\n+      xml:lang="en-US"\n+      i18n:domain="cmfeditions"\n+>\n \n-<body>\n-    <div id="diff-legend" metal:define-macro="diff_legend">\n-      <table id="diff-table" cellpadding="2" summary="DiffLegend">\n-            <tr><th class="diff-legend-label" i18n:translate="label_diff_legend">Legend</th>\n-                <td class="diff_add" i18n:translate="label_diff_added">(+) Added</td>\n-                <td class="diff_sub" i18n:translate="label_diff_deleted">(-) Deleted</td></tr>\n-            <tr><td class="diff_chg" i18n:translate="label_diff_changed">Changed</td>\n-                <td class="tagInsert" i18n:translate="label_diff_tag_added">Tag Added</td>\n-                <td class="tagDelete" i18n:translate="label_diff_tag_deleted">Tag Deleted</td></tr>\n+  <body>\n+    <div id="diff-legend"\n+         metal:define-macro="diff_legend"\n+    >\n+      <table id="diff-table"\n+             cellpadding="2"\n+             summary="DiffLegend"\n+      >\n+        <tr><th class="diff-legend-label"\n+              i18n:translate="label_diff_legend"\n+          >Legend</th>\n+          <td class="diff_add"\n+              i18n:translate="label_diff_added"\n+          >(+) Added</td>\n+          <td class="diff_sub"\n+              i18n:translate="label_diff_deleted"\n+          >(-) Deleted</td></tr>\n+        <tr><td class="diff_chg"\n+              i18n:translate="label_diff_changed"\n+          >Changed</td>\n+          <td class="tagInsert"\n+              i18n:translate="label_diff_tag_added"\n+          >Tag Added</td>\n+          <td class="tagDelete"\n+              i18n:translate="label_diff_tag_deleted"\n+          >Tag Deleted</td></tr>\n       </table>\n     </div>\n-</body>\n+  </body>\n </html>\ndiff --git a/Products/CMFEditions/browser/templates/version_file_view.pt b/Products/CMFEditions/browser/templates/version_file_view.pt\nindex 42039c95..53e77c6d 100644\n--- a/Products/CMFEditions/browser/templates/version_file_view.pt\n+++ b/Products/CMFEditions/browser/templates/version_file_view.pt\n@@ -1,71 +1,93 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"\n+<html xmlns="http://www.w3.org/1999/xhtml"\n       lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="cmfeditions">\n+      xml:lang="en"\n+      i18n:domain="cmfeditions"\n+>\n \n-<body>\n+  <body>\n \n-<metal:main fill-slot="main">\n-    <tal:main-macro metal:define-macro="main"\n-           tal:define="size_value context/get_size;\n-                       size_label python:size_value and view.human_readable_size(size_value) or None;\n-                       content_type context/get_content_type|context/Format;\n-                      ">\n+    <metal:main fill-slot="main">\n+      <tal:main-macro metal:define-macro="main"\n+                      tal:define="\n+                        size_value context/get_size;\n+                        size_label python:size_value and view.human_readable_size(size_value) or None;\n+                        content_type context/get_content_type|context/Format;\n+                      "\n+      >\n \n         <div id="content-core">\n-            <p tal:condition="size_value">\n-                <a href=""\n-                   tal:define="here_url context/absolute_url"\n-                   tal:attributes="href string:$here_url/file_download_version?version_id=${version_id}">\n-                    <img src="" tal:attributes="src string:${portal_url}/file_icon.gif" alt="" />\n-                    <tal:block i18n:translate="label_click_to_get_file">\n+          <p tal:condition="size_value">\n+            <a href=""\n+               tal:define="\n+                 here_url context/absolute_url;\n+               "\n+               tal:attributes="\n+                 href string:$here_url/file_download_version?version_id=${version_id};\n+               "\n+            >\n+              <img alt=""\n+                   src=""\n+                   tal:attributes="\n+                     src string:${portal_url}/file_icon.gif;\n+                   "\n+              />\n+              <tal:block i18n:translate="label_click_to_get_file">\n                     Click here to get the file\n-                    </tal:block>\n-                </a>\n-            </p>\n+              </tal:block>\n+            </a>\n+          </p>\n \n-            <small class="discreet">\n+          <small class="discreet">\n \n-              <span tal:condition="not:size_value" i18n:translate="no_file_uploaded">\n+            <span tal:condition="not:size_value"\n+                  i18n:translate="no_file_uploaded"\n+            >\n                   (No file has been uploaded yet)\n-              </span>\n+            </span>\n \n-              <tal:fileinfo condition="size_value">\n-                <span i18n:translate="label_size" i18n:domain="plone">\n+            <tal:fileinfo condition="size_value">\n+              <span i18n:domain="plone"\n+                    i18n:translate="label_size"\n+              >\n                 Size\n-                </span>\n+              </span>\n \n-                <span tal:condition="size_value"\n-                    tal:content="size_label">\n+              <span tal:condition="size_value"\n+                    tal:content="size_label"\n+              >\n                 257 KB\n-                </span>\n+              </span>\n \n                 -\n \n-                <span i18n:translate="label_file_type">\n+              <span i18n:translate="label_file_type">\n                 File type\n-                </span>\n+              </span>\n \n-                <span tal:content="content_type">\n+              <span tal:content="content_type">\n                 Content type\n-                </span>\n-              </tal:fileinfo>\n-            </small>\n+              </span>\n+            </tal:fileinfo>\n+          </small>\n \n-            <div class="row"\n-                 tal:condition="python:test(size_value and content_type.find(\'text\')>-1, 1,0)">\n+          <div class="row"\n+               tal:condition="python:test(size_value and content_type.find(\'text\')&gt;-1, 1,0)"\n+          >\n \n-                    <h2 i18n:translate="heading_file_contents" i18n:domain="plone">File contents</h2>\n+            <h2 i18n:domain="plone"\n+                i18n:translate="heading_file_contents"\n+            >File contents</h2>\n \n-                    <pre tal:content="context/get_data|context/data|nothing">\n+            <pre tal:content="context/get_data|context/data|nothing">\n                     </pre>\n \n-            </div>\n+          </div>\n         </div>\n \n-    </tal:main-macro>\n-</metal:main>\n+      </tal:main-macro>\n+    </metal:main>\n \n-</body>\n+  </body>\n \n </html>\ndiff --git a/Products/CMFEditions/browser/templates/version_image_view.pt b/Products/CMFEditions/browser/templates/version_image_view.pt\nindex 5ca04253..c4167ff5 100644\n--- a/Products/CMFEditions/browser/templates/version_image_view.pt\n+++ b/Products/CMFEditions/browser/templates/version_image_view.pt\n@@ -1,43 +1,57 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"\n+<html xmlns="http://www.w3.org/1999/xhtml"\n       lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="plone">\n+      xml:lang="en"\n+      i18n:domain="plone"\n+>\n \n-<body>\n+  <body>\n \n-<metal:main fill-slot="main">\n-    <tal:main-macro metal:define-macro="main"\n-                    tal:define="plone_view here/@@plone;\n-                                size python:plone_view.human_readable_size(here.get_size());\n-                                here_url context/absolute_url;">\n+    <metal:main fill-slot="main">\n+      <tal:main-macro metal:define-macro="main"\n+                      tal:define="\n+                        plone_view here/@@plone;\n+                        size python:plone_view.human_readable_size(here.get_size());\n+                        here_url context/absolute_url;\n+                      "\n+      >\n \n         <div id="content-core">\n-            <a href=""\n-               class="discreet"\n-               tal:attributes="href string:$here_url/file_download_version?version_id=${request/version_id}">\n-                <tal:block condition="size" replace="structure python: here.version_image_tag(here_url, version_id)" />\n-                <br />\n-                <span class="visualNoPrint">\n-                    <img src="" alt="" tal:replace="structure here/search_icon.png" />\n-                    <span i18n:translate="label_click_to_view_full_image">Click to view full-size image&hellip;</span>\n-                </span>\n-            </a>\n-\n-            <span class="discreet visualNoPrint">\n+          <a class="discreet"\n+             href=""\n+             tal:attributes="\n+               href string:$here_url/file_download_version?version_id=${request/version_id};\n+             "\n+          >\n+            <tal:block condition="size"\n+                       replace="structure python: here.version_image_tag(here_url, version_id)"\n+            />\n+            <br />\n+            <span class="visualNoPrint">\n+              <img alt=""\n+                   src=""\n+                   tal:replace="structure here/search_icon.png"\n+              />\n+              <span i18n:translate="label_click_to_view_full_image">Click to view full-size image&hellip;</span>\n+            </span>\n+          </a>\n+\n+          <span class="discreet visualNoPrint">\n             &mdash;\n-                <span i18n:translate="label_size">Size</span>:\n+            <span i18n:translate="label_size">Size</span>:\n                 ${size}\n-                <span tal:condition="python:test(size, 0, 1)"\n-                      i18n:translate="no_image_uploaded">\n+            <span tal:condition="python:test(size, 0, 1)"\n+                  i18n:translate="no_image_uploaded"\n+            >\n                     (No image has been uploaded yet)\n-                </span>\n             </span>\n+          </span>\n         </div>\n \n-    </tal:main-macro>\n+      </tal:main-macro>\n \n-</metal:main>\n+    </metal:main>\n \n-</body>\n+  </body>\n \n </html>\ndiff --git a/Products/CMFEditions/browser/templates/version_metadata_view.pt b/Products/CMFEditions/browser/templates/version_metadata_view.pt\nindex 7b77da03..252dfc53 100644\n--- a/Products/CMFEditions/browser/templates/version_metadata_view.pt\n+++ b/Products/CMFEditions/browser/templates/version_metadata_view.pt\n@@ -1,102 +1,121 @@\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"\n+<html xmlns="http://www.w3.org/1999/xhtml"\n       lang="en"\n       metal:use-macro="here/main_template/macros/master"\n-      i18n:domain="plone">\n+      xml:lang="en"\n+      i18n:domain="plone"\n+>\n \n-<body>\n+  <body>\n \n-<metal:main fill-slot="main">\n-    <tal:main-macro metal:define-macro="main">\n+    <metal:main fill-slot="main">\n+      <tal:main-macro metal:define-macro="main">\n \n         <metal:metadata define-macro="metadata">\n \n-            <h1 class="documentFirstHeading">\n+          <h1 class="documentFirstHeading">\n                 Metadata\n-            </h1>\n-            <div id="content-core">\n-                <ul>\n-\n-                    <li>\n-                        <label for="predefined_subjects"\n-                              i18n:translate="label_existing_categories">\n+          </h1>\n+          <div id="content-core">\n+            <ul>\n+\n+              <li>\n+                <label for="predefined_subjects"\n+                       i18n:translate="label_existing_categories"\n+                >\n                           Existing categories\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="python: \', \'.join(here.Subject())"\n-                              tal:on-error="nothing">Keywords</span>\n-                    </li>\n+                <span tal:content="python: \', \'.join(here.Subject())"\n+                      tal:on-error="nothing"\n+                >Keywords</span>\n+              </li>\n \n-                    <li>\n-                      <label for="format"\n-                            i18n:translate="label_format">\n+              <li>\n+                <label for="format"\n+                       i18n:translate="label_format"\n+                >\n                         Format\n-                      </label>:\n+                </label>:\n \n-                      <span tal:content="here/Format">text/plain</span>\n-                    </li>\n+                <span tal:content="here/Format">text/plain</span>\n+              </li>\n \n-                    <li>\n-                        <label for="effective_date"\n-                              i18n:translate="label_effective_date">\n+              <li>\n+                <label for="effective_date"\n+                       i18n:translate="label_effective_date"\n+                >\n                           Effective Date\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="python:here.toLocalizedTime(here.EffectiveDate())"\n-                              tal:on-error="nothing">2005/01/01</span>\n-                    </li>\n+                <span tal:content="python:here.toLocalizedTime(here.EffectiveDate())"\n+                      tal:on-error="nothing"\n+                >2005/01/01</span>\n+              </li>\n \n-                    <li>\n-                        <label for="expiration_date"\n-                            i18n:translate="label_expiration_date">\n+              <li>\n+                <label for="expiration_date"\n+                       i18n:translate="label_expiration_date"\n+                >\n                           Expiration Date\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="python:here.toLocalizedTime(here.ExpirationDate())"\n-                              tal:on-error="nothing">2005/01/01</span>\n-                    </li>\n+                <span tal:content="python:here.toLocalizedTime(here.ExpirationDate())"\n+                      tal:on-error="nothing"\n+                >2005/01/01</span>\n+              </li>\n \n-                    <li>\n-                        <label for="language"\n-                              i18n:translate="label_language">\n+              <li>\n+                <label for="language"\n+                       i18n:translate="label_language"\n+                >\n                           Language\n-                        </label>:\n-\n-                        <span tal:define="language python:[name for (id,name) in here.availableLanguages() if id == here.Language()][0]"\n-                              tal:content="language"\n-                              tal:on-error="nothing">English</span>\n-                    </li>\n-\n-                    <li>\n-                        <label for="description"\n-                              i18n:translate="label_description">\n+                </label>:\n+\n+                <span tal:define="\n+                        language python:[name for (id,name) in here.availableLanguages() if id == here.Language()][0];\n+                      "\n+                      tal:content="language"\n+                      tal:on-error="nothing"\n+                >English</span>\n+              </li>\n+\n+              <li>\n+                <label for="description"\n+                       i18n:translate="label_description"\n+                >\n                           Description\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="here/Description"\n-                              tal:on-error="string: "></span>\n-                    </li>\n+                <span tal:content="here/Description"\n+                      tal:on-error="string: "\n+                ></span>\n+              </li>\n \n-                    <li>\n-                        <label for="rights"\n-                              i18n:translate="label_copyrights">\n+              <li>\n+                <label for="rights"\n+                       i18n:translate="label_copyrights"\n+                >\n                           Copyrights\n-                        </label>:\n+                </label>:\n \n-                        <span tal:content="here/Rights"\n-                              tal:on-error="nothing"></span>\n-                    </li>\n+                <span tal:content="here/Rights"\n+                      tal:on-error="nothing"\n+                ></span>\n+              </li>\n \n-                    <li>\n-                        <label for="contributors"\n-                              i18n:translate="label_contributors">\n+              <li>\n+                <label for="contributors"\n+                       i18n:translate="label_contributors"\n+                >\n                           Contributors\n-                        </label>:\n-\n-                        <span tal:content="python:\',\'.join(here.Contributors())"\n-                              tal:on-error="nothing"></span>\n-                    </li>\n-                </ul>\n-            </div>\n+                </label>:\n+\n+                <span tal:content="python:\',\'.join(here.Contributors())"\n+                      tal:on-error="nothing"\n+                ></span>\n+              </li>\n+            </ul>\n+          </div>\n \n         </metal:metadata>\n \ndiff --git a/Products/CMFEditions/browser/templates/versions_history_form.pt b/Products/CMFEditions/browser/templates/versions_history_form.pt\nindex 397b338c..866f584d 100644\n--- a/Products/CMFEditions/browser/templates/versions_history_form.pt\n+++ b/Products/CMFEditions/browser/templates/versions_history_form.pt\n@@ -1,236 +1,323 @@\n-<html metal:use-macro="context/main_template/macros/master" i18n:domain="cmfeditions">\n+<html metal:use-macro="context/main_template/macros/master"\n+      i18n:domain="cmfeditions"\n+>\n \n   <tal:block metal:fill-slot="head_slot">\n-        <link rel="stylesheet" type="text/css" href="compare.css" />\n+    <link href="compare.css"\n+          rel="stylesheet"\n+          type="text/css"\n+    />\n   </tal:block>\n \n   <metal:main fill-slot="main"\n-       tal:define="pr nocall:context/portal_repository;\n-                   version_id python:request.get(\'version_id\', None);\n-                   history python:pr.getHistoryMetadata(context);\n-                   revisions python:history and history.getLength(countPurged=False) or 0;\n-                   histrange python:range(revisions-1, -1, -1);\n-                   here_url context/absolute_url;\n-                   can_diff view/can_diff;\n-                   checkPermission nocall:context/portal_membership/checkPermission;\n-                   canRevertToPrevious python:checkPermission(\'CMFEditions: Revert to previous versions\', context);"\n-                   tal:condition="python: pr.isVersionable(context)">\n-\n-    <div tal:replace="structure provider:plone.abovecontenttitle" />\n+              tal:define="\n+                pr nocall:context/portal_repository;\n+                version_id python:request.get(\'version_id\', None);\n+                history python:pr.getHistoryMetadata(context);\n+                revisions python:history and history.getLength(countPurged=False) or 0;\n+                histrange python:range(revisions-1, -1, -1);\n+                here_url context/absolute_url;\n+                can_diff view/can_diff;\n+                checkPermission nocall:context/portal_membership/checkPermission;\n+                canRevertToPrevious python:checkPermission(\'CMFEditions: Revert to previous versions\', context);\n+              "\n+              tal:condition="python: pr.isVersionable(context)"\n+  >\n+\n+    <div tal:replace="structure provider:plone.abovecontenttitle"></div>\n \n     <h1 class="documentFirstHeading"\n-        i18n:translate="versions_of_title">Revisions of\n-          "<span i18n:name="title" tal:replace="context/title_or_id">title</span>"\n+        i18n:translate="versions_of_title"\n+    >Revisions of\n+      "<span tal:replace="context/title_or_id"\n+            i18n:name="title"\n+      >title</span>"\n     </h1>\n \n-    <div tal:replace="structure provider:plone.belowcontenttitle" />\n+    <div tal:replace="structure provider:plone.belowcontenttitle"></div>\n \n     <div id="content-core">\n-        <table id="sortable"\n-            class="listing"\n-            summary="Content history"\n-            cellpadding="0" cellspacing="0"\n-            tal:condition="history"\n-            tal:define="current python:view.checkUpToDate(history)">\n-            <thead>\n-                <tr>\n-                  <th><tal:title i18n:translate="listingheader_key"\n-                      >Revision</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_performed_by"\n-                      >Performed by</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_date_and_time"\n-                  >Date and Time</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_comment"\n-                      >Comment</tal:title></th>\n-                  <th><tal:title i18n:translate="listingheader_actions"\n-                      >Actions</tal:title></th>\n-                </tr>\n-            </thead>\n-\n-            <tbody tal:define="isModified current/isModified;\n-                               reverted_vid current/reverted_vid;\n-                               isReverted current/isReverted">\n-                <tr class="CurrentVersion odd"\n-                    tal:condition="isModified">\n-                  <td class="VersionId"\n-                      tal:define="id current/version_id;">\n-                    <span i18n:translate="">Current revision</span>\n-                  </td>\n-                  <td class="VersionUser">\n-                    <span tal:replace="context/Creator">user</span>\n-                  </td>\n-                  <td class="VersionDate">\n-                    <span tal:replace="python:context.toLocalizedTime(context.ModificationDate(),long_format=1)">2004/10/21 03:15 PM</span>\n-                  </td>\n-                  <td class="VersionComment">\n-                    <span i18n:translate="label_modifications_from_revision">\n+      <table class="listing"\n+             id="sortable"\n+             cellpadding="0"\n+             cellspacing="0"\n+             summary="Content history"\n+             tal:define="\n+               current python:view.checkUpToDate(history);\n+             "\n+             tal:condition="history"\n+      >\n+        <thead>\n+          <tr>\n+            <th><tal:title i18n:translate="listingheader_key">Revision</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_performed_by">Performed by</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_date_and_time">Date and Time</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_comment">Comment</tal:title></th>\n+            <th><tal:title i18n:translate="listingheader_actions">Actions</tal:title></th>\n+          </tr>\n+        </thead>\n+\n+        <tbody tal:define="\n+                 isModified current/isModified;\n+                 reverted_vid current/reverted_vid;\n+                 isReverted current/isReverted;\n+               ">\n+          <tr class="CurrentVersion odd"\n+              tal:condition="isModified"\n+          >\n+            <td class="VersionId"\n+                tal:define="\n+                  id current/version_id;\n+                "\n+            >\n+              <span i18n:translate="">Current revision</span>\n+            </td>\n+            <td class="VersionUser">\n+              <span tal:replace="context/Creator">user</span>\n+            </td>\n+            <td class="VersionDate">\n+              <span tal:replace="python:context.toLocalizedTime(context.ModificationDate(),long_format=1)">2004/10/21 03:15 PM</span>\n+            </td>\n+            <td class="VersionComment">\n+              <span i18n:translate="label_modifications_from_revision">\n                       modifications from revision\n-                      <span tal:replace="reverted_vid" i18n:name="version_id" />\n-                    </span>\n-                    <span tal:condition="isReverted"\n-                           i18n:translate="label_previously_reverted">\n+                <span tal:replace="reverted_vid"\n+                      i18n:name="version_id"\n+                ></span>\n+              </span>\n+              <span tal:condition="isReverted"\n+                    i18n:translate="label_previously_reverted"\n+              >\n                       (previously reverted)\n-                    </span>\n-                  </td>\n-                  <td class="VersionActions">\n-                    <ul>\n-                        <li tal:condition="can_diff">\n-                            <a href=""\n-                               style="text-decoration: none"\n-                               tal:attributes="href string:${here_url}/@@history?one=current&amp;two=${reverted_vid}">\n-                              <span tal:condition="isReverted"\n-                                    i18n:translate="label_compare_to_revision">\n+              </span>\n+            </td>\n+            <td class="VersionActions">\n+              <ul>\n+                <li tal:condition="can_diff">\n+                  <a href=""\n+                     style="text-decoration: none"\n+                     tal:attributes="\n+                       href string:${here_url}/@@history?one=current&amp;two=${reverted_vid};\n+                     "\n+                  >\n+                    <span tal:condition="isReverted"\n+                          i18n:translate="label_compare_to_revision"\n+                    >\n                                 Compare to revision\n-                                <span tal:replace="reverted_vid"\n-                                      i18n:name="version_id" />\n-                              </span>\n-                              <span tal:condition="not:isReverted"\n-                                    i18n:translate="label_compare_to_previous_revision">\n+                      <span tal:replace="reverted_vid"\n+                            i18n:name="version_id"\n+                      ></span>\n+                    </span>\n+                    <span tal:condition="not:isReverted"\n+                          i18n:translate="label_compare_to_previous_revision"\n+                    >\n                                 Compare to previous revision\n-                              </span>\n-                            </a>\n-                        </li>\n-                    </ul>\n-                  </td>\n-                </tr>\n-                <tal:block repeat="vdatai histrange">\n-                <tr tal:define="id     vdatai;\n-                                vdatafull   python:history.retrieve(vdatai, countPurged=False);\n-                                vdata       vdatafull/metadata;\n-                                current_version python:not current[\'isModified\'] and current[\'version_id\']==vdatai;\n-                                even repeat/vdatai/even;"\n-                    tal:attributes="class python:(current_version and \'CurrentVersion\' or \'\') + (even and \' even\' or \'\')">\n-                  <td class="VersionId">\n-                    <span tal:condition="current_version" i18n:translate="">Current revision</span>\n-                    <span tal:condition="not:current_version" tal:content="id">1</span>\n-                    <a href="#"\n-                       class="version-table-version"\n-                       tal:attributes="href string:${here_url}/versions_history_form?version_id=${id}#version_preview"\n-                       tal:condition="python:version_id!=id and not current_version"\n-                       i18n:translate="label_preview_version_link">(preview)</a>\n-                    <a href="#"\n-                       class="version-table-version"\n-                       tal:attributes="href string:${here_url}/versions_history_form?version_id=${id}#version_preview"\n-                       tal:condition="python:version_id==id"\n-                       i18n:translate="label_preview_version_below">(jump down)</a>\n-                  </td>\n-                  <td class="VersionUser">\n-                    <span tal:content="vdata/sys_metadata/principal">francesco</span>\n-                  </td>\n-                  <td class="VersionDate">\n-                    <span tal:content="python:context.toLocalizedTime(vdata[\'sys_metadata\'][\'timestamp\'],long_format=1)">2004/10/21 03:15 PM</span>\n-                  </td>\n-                  <td class="VersionComment">\n-                    <span tal:content="vdata/sys_metadata/comment" i18n:translate="">Draft version ready for comments from the group.</span>\n-                  </td>\n-                  <td class="VersionActions">\n-                    <ul>\n-                        <tal:diffs condition="can_diff">\n-                        <li tal:condition="not:current_version">\n-                            <a href=""\n-                               style="text-decoration: none"\n-                               tal:attributes="href string:${here_url}/@@history?one=current&amp;two=${id}"\n-                               i18n:translate="label_compare_current">\n+                    </span>\n+                  </a>\n+                </li>\n+              </ul>\n+            </td>\n+          </tr>\n+          <tal:block repeat="vdatai histrange">\n+            <tr tal:define="\n+                  id     vdatai;\n+                  vdatafull   python:history.retrieve(vdatai, countPurged=False);\n+                  vdata       vdatafull/metadata;\n+                  current_version python:not current[\'isModified\'] and current[\'version_id\']==vdatai;\n+                  even repeat/vdatai/even;\n+                "\n+                tal:attributes="\n+                  class python:(current_version and \'CurrentVersion\' or \'\') + (even and \' even\' or \'\');\n+                "\n+            >\n+              <td class="VersionId">\n+                <span tal:condition="current_version"\n+                      i18n:translate=""\n+                >Current revision</span>\n+                <span tal:condition="not:current_version"\n+                      tal:content="id"\n+                >1</span>\n+                <a class="version-table-version"\n+                   href="#"\n+                   tal:condition="python:version_id!=id and not current_version"\n+                   tal:attributes="\n+                     href string:${here_url}/versions_history_form?version_id=${id}#version_preview;\n+                   "\n+                   i18n:translate="label_preview_version_link"\n+                >(preview)</a>\n+                <a class="version-table-version"\n+                   href="#"\n+                   tal:condition="python:version_id==id"\n+                   tal:attributes="\n+                     href string:${here_url}/versions_history_form?version_id=${id}#version_preview;\n+                   "\n+                   i18n:translate="label_preview_version_below"\n+                >(jump down)</a>\n+              </td>\n+              <td class="VersionUser">\n+                <span tal:content="vdata/sys_metadata/principal">francesco</span>\n+              </td>\n+              <td class="VersionDate">\n+                <span tal:content="python:context.toLocalizedTime(vdata[\'sys_metadata\'][\'timestamp\'],long_format=1)">2004/10/21 03:15 PM</span>\n+              </td>\n+              <td class="VersionComment">\n+                <span tal:content="vdata/sys_metadata/comment"\n+                      i18n:translate=""\n+                >Draft version ready for comments from the group.</span>\n+              </td>\n+              <td class="VersionActions">\n+                <ul>\n+                  <tal:diffs condition="can_diff">\n+                    <li tal:condition="not:current_version">\n+                      <a href=""\n+                         style="text-decoration: none"\n+                         tal:attributes="\n+                           href string:${here_url}/@@history?one=current&amp;two=${id};\n+                         "\n+                         i18n:translate="label_compare_current"\n+                      >\n                             Compare to current revision\n-                            </a>\n-                        </li>\n-                        <li tal:condition="not:repeat/vdatai/end">\n-                            <a href=""\n-                               style="text-decoration: none"\n-                               tal:define="prev_ver python:str(int(id)-1)"\n-                               tal:attributes="href string:${here_url}/@@history?one=${id}&amp;two=${prev_ver}"\n-                               i18n:translate="label_compare_previous">\n+                      </a>\n+                    </li>\n+                    <li tal:condition="not:repeat/vdatai/end">\n+                      <a href=""\n+                         style="text-decoration: none"\n+                         tal:define="\n+                           prev_ver python:str(int(id)-1);\n+                         "\n+                         tal:attributes="\n+                           href string:${here_url}/@@history?one=${id}&amp;two=${prev_ver};\n+                         "\n+                         i18n:translate="label_compare_previous"\n+                      >\n                             Compare to previous revision\n-                            </a>\n-                        </li>\n-                        </tal:diffs>\n-                        <li tal:condition="python: (not current_version) and canRevertToPrevious">\n-\n-                            <form action="" method="post"\n-                                  tal:attributes="action string:$here_url/@@revertversion">\n-                              <input type="hidden" name="version_id" value="" tal:attributes="value id" />\n-                              <input class="standalone" type="submit"\n-                                     i18n:attributes="value label_revert"\n-                                     value="Revert to this revision" /></form>\n-                        </li>\n-                    </ul>\n-                  </td>\n-                </tr>\n-                </tal:block>\n-            </tbody>\n-          </table>\n-\n-    <form action="#"\n-        method="post"\n-        tal:define="here_url context/absolute_url"\n-        tal:attributes="action string:${here_url}/@@saveasnewversion"\n-        tal:condition="not: python:pr.supportsPolicy(context, \'at_edit_autoversion\')">\n+                      </a>\n+                    </li>\n+                  </tal:diffs>\n+                  <li tal:condition="python: (not current_version) and canRevertToPrevious">\n+\n+                    <form action=""\n+                          method="post"\n+                          tal:attributes="\n+                            action string:$here_url/@@revertversion;\n+                          "\n+                    >\n+                      <input name="version_id"\n+                             type="hidden"\n+                             value=""\n+                             tal:attributes="\n+                               value id;\n+                             "\n+                      />\n+                      <input class="standalone"\n+                             type="submit"\n+                             value="Revert to this revision"\n+                             i18n:attributes="value label_revert"\n+                      /></form>\n+                  </li>\n+                </ul>\n+              </td>\n+            </tr>\n+          </tal:block>\n+        </tbody>\n+      </table>\n+\n+      <form action="#"\n+            method="post"\n+            tal:define="\n+              here_url context/absolute_url;\n+            "\n+            tal:condition="not: python:pr.supportsPolicy(context, \'at_edit_autoversion\')"\n+            tal:attributes="\n+              action string:${here_url}/@@saveasnewversion;\n+            "\n+      >\n \n         <fieldset>\n \n-            <div class="field">\n-              <label for="description"\n-                    i18n:translate="label_newversion">New version</label>\n+          <div class="field">\n+            <label for="description"\n+                   i18n:translate="label_newversion"\n+            >New version</label>\n \n-              <div class="formHelp" i18n:translate="help_versioncomment">\n+            <div class="formHelp"\n+                 i18n:translate="help_versioncomment"\n+            >\n                 At any moment you can save the content you just edited as a new revision. Enter below a comment to identify the version and hit the "Save as new revision" button.\n-              </div>\n-              <textarea cols="60"\n-                        rows="3"\n-                        id="versioncomment"\n-                        name="versioncomment"\n-                        ></textarea>\n             </div>\n+            <textarea id="versioncomment"\n+                      cols="60"\n+                      name="versioncomment"\n+                      rows="3"\n+            ></textarea>\n+          </div>\n \n-            <input class="context"\n-                        type="submit"\n-                        name="saveversion"\n-                        value="Save as new revision"\n-                        i18n:attributes="value button_save_as_new_version"\n-                        />\n+          <input class="context"\n+                 name="saveversion"\n+                 type="submit"\n+                 value="Save as new revision"\n+                 i18n:attributes="value button_save_as_new_version"\n+          />\n \n         </fieldset>\n \n-    </form>\n+      </form>\n \n-    <a name="version_preview">\n-      <label for="description"\n-             tal:condition="version_id"\n-             i18n:translate="label_preview_version">\n-        Preview of Revision <span i18n:name="version_id" tal:replace="version_id">0</span>\n-      </label>\n-    </a>\n-    <div style="border:solid 1px gray"\n-         tal:condition="version_id">\n-      <tal:block define="vdata python:pr.retrieve(context, version_id);\n-                         context nocall:vdata/object;\n-                         portal_type python:context.getPortalTypeName().lower().replace(\' \', \'_\');\n-                         object_title context/Title;\n-                         suppress_preview python:True;\n-                         version_view context/@@version-view|nothing;">\n+      <a name="version_preview">\n+        <label for="description"\n+               tal:condition="version_id"\n+               i18n:translate="label_preview_version"\n+        >\n+        Preview of Revision\n+          <span tal:replace="version_id"\n+                i18n:name="version_id"\n+          >0</span>\n+        </label>\n+      </a>\n+      <div style="border:solid 1px gray"\n+           tal:condition="version_id"\n+      >\n+        <tal:block define="\n+                     vdata python:pr.retrieve(context, version_id);\n+                     context nocall:vdata/object;\n+                     portal_type python:context.getPortalTypeName().lower().replace(\' \', \'_\');\n+                     object_title context/Title;\n+                     suppress_preview python:True;\n+                     version_view context/@@version-view|nothing;\n+                   ">\n \n-        <div tal:replace="structure provider:plone.belowcontenttitle" />\n+          <div tal:replace="structure provider:plone.belowcontenttitle"></div>\n \n-        <h1 class="documentFirstHeading" tal:content="vdata/object/Title"/>\n-        <div class="documentDescription" tal:content="vdata/object/Description"></div>\n+          <h1 class="documentFirstHeading"\n+              tal:content="vdata/object/Title"\n+          ></h1>\n+          <div class="documentDescription"\n+               tal:content="vdata/object/Description"\n+          ></div>\n \n-        <div tal:condition="version_view" tal:replace="structure version_view" />\n+          <div tal:condition="version_view"\n+               tal:replace="structure version_view"\n+          ></div>\n \n-        <tal:noversionview\n-          condition="not:version_view"\n-          define="version_view_macro python:context.restrictedTraverse(\'@@get_macros\')(vdata);">\n+          <tal:noversionview define="\n+                               version_view_macro python:context.restrictedTraverse(\'@@get_macros\')(vdata);\n+                             "\n+                             condition="not:version_view"\n+          >\n \n-          <tal:viewmacro condition="version_view_macro">\n-            <metal:use_body use-macro="version_view_macro" />\n-          </tal:viewmacro>\n+            <tal:viewmacro condition="version_view_macro">\n+              <metal:use_body use-macro="version_view_macro" />\n+            </tal:viewmacro>\n \n-          <div tal:condition="not:version_view_macro" i18n:translate="">Preview is not available.</div>\n+            <div tal:condition="not:version_view_macro"\n+                 i18n:translate=""\n+            >Preview is not available.</div>\n \n-        </tal:noversionview>\n+          </tal:noversionview>\n \n-      </tal:block>\n+        </tal:block>\n \n+      </div>\n     </div>\n-  </div>\n   </metal:main>\n </html>\ndiff --git a/Products/CMFEditions/browser/views.py b/Products/CMFEditions/browser/views.py\nindex 0fa4fb3d..ed1c1d0a 100644\n--- a/Products/CMFEditions/browser/views.py\n+++ b/Products/CMFEditions/browser/views.py\n@@ -1,5 +1,4 @@\n from Acquisition import aq_inner\n-from plone.base.utils import human_readable_size\n from Products.CMFCore.utils import getToolByName\n from Products.CMFEditions import CMFEditionsMessageFactory as _\n from Products.CMFEditions.interfaces.IModifier import FileTooLargeToVersionError\n@@ -19,7 +18,6 @@\n )\n \n \n-\n class UpdateVersionOnEditView(BrowserView):\n     def success(self):\n         self.request.response.redirect("view")\ndiff --git a/Products/CMFEditions/configure.zcml b/Products/CMFEditions/configure.zcml\nindex f208b027..8d516987 100644\n--- a/Products/CMFEditions/configure.zcml\n+++ b/Products/CMFEditions/configure.zcml\n@@ -1,8 +1,10 @@\n-<configure xmlns="http://namespaces.zope.org/zope"\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n     xmlns:i18n="http://namespaces.zope.org/i18n"\n-    i18n_domain="cmfeditions">\n+    i18n_domain="cmfeditions"\n+    >\n \n-  <include file="permissions.zcml"/>\n+  <include file="permissions.zcml" />\n \n   <include package="Products.CMFUid" />\n   <!-- provides hooks for zope.copy -->\n@@ -10,15 +12,19 @@\n   <include package=".browser" />\n   <include package=".exportimport" />\n \n-  <include file="profiles.zcml"/>\n+  <include file="profiles.zcml" />\n \n \n-  <subscriber for=".interfaces.IVersioned\n-                   zope.lifecycleevent.interfaces.IObjectCopiedEvent"\n-              handler=".ArchivistTool.object_copied" />\n+  <subscriber\n+      for=".interfaces.IVersioned\n+           zope.lifecycleevent.interfaces.IObjectCopiedEvent"\n+      handler=".ArchivistTool.object_copied"\n+      />\n \n-  <subscriber for="*\n-                   zope.lifecycleevent.interfaces.IObjectRemovedEvent"\n-              handler=".subscriber.object_removed" />\n+  <subscriber\n+      for="*\n+           zope.lifecycleevent.interfaces.IObjectRemovedEvent"\n+      handler=".subscriber.object_removed"\n+      />\n \n </configure>\ndiff --git a/Products/CMFEditions/exportimport/configure.zcml b/Products/CMFEditions/exportimport/configure.zcml\nindex 170fd8b3..88f40286 100644\n--- a/Products/CMFEditions/exportimport/configure.zcml\n+++ b/Products/CMFEditions/exportimport/configure.zcml\n@@ -1,12 +1,15 @@\n-<configure xmlns="http://namespaces.zope.org/zope"\n-           xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n-           i18n_domain="cmfeditions">\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n+    i18n_domain="cmfeditions"\n+    >\n \n   <genericsetup:importStep\n       name="cmfeditions_various"\n-      handler="Products.CMFEditions.setuphandlers.importVarious"\n       title="Various CMFEditions Settings"\n-      description="CMFEditions specific settings">\n+      description="CMFEditions specific settings"\n+      handler="Products.CMFEditions.setuphandlers.importVarious"\n+      >\n     <depends name="toolset" />\n     <depends name="typeinfo" />\n   </genericsetup:importStep>\n@@ -23,7 +26,8 @@\n       name="repositorytool"\n       title="CMFEditions Repository Tool"\n       description="Import repository tool\'s settings."\n-      handler=".repository.importRepositoryTool">\n+      handler=".repository.importRepositoryTool"\n+      >\n     <depends name="toolset" />\n     <depends name="typeinfo" />\n     <depends name="cmfeditions_various" />\ndiff --git a/Products/CMFEditions/interfaces/IArchivist.py b/Products/CMFEditions/interfaces/IArchivist.py\nindex c47e727d..0ba3582e 100644\n--- a/Products/CMFEditions/interfaces/IArchivist.py\n+++ b/Products/CMFEditions/interfaces/IArchivist.py\n@@ -93,7 +93,7 @@ def retrieve(obj=None, history_id=None, selector=None, preserve=()):\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n         """\n@@ -113,7 +113,7 @@ def getHistory(obj=None, history_id=None, preserve=()):\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n         """\n@@ -173,7 +173,7 @@ def purge(obj=None, history_id=None, selector=None, metadata={}, countPurged=Tru\n         for an object if no history_id is provided the history_id will be\n         obtained from the working copy object.\n \n-        The comment and metadata passed may be used to store informations\n+        The comment and metadata passed may be used to store information\n         about the reasons of the purging.\n \n         Also counts purged versions if ``True`` is passed to ``countPurged``\n@@ -211,7 +211,7 @@ def retrieve(\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n \n@@ -234,7 +234,7 @@ def getHistory(obj=None, history_id=None, preserve=(), countPurged=True):\n         Modifiers may overwrite some aspects of the retrieved version by\n         the equivalent aspects of the working copy. Sometimes the\n         overwritten information is from interest. Attributes (and\n-        subattributes) beeing from interest can be passed with the\n+        subattributes) being from interest can be passed with the\n         \'preserve\' argument.\n         E.g. preserve=(\'family_name\', \'nick_name\', \'real_name\')\n \n@@ -283,7 +283,7 @@ class IPreparedObject(Interface):\n         """Data that is passed to the storage by reference.\n \n         These is an optimization for the case where a big blob (e.g. a Word\n-        file) has to be saved but you want to avoid costy cloning beeing done\n+        file) has to be saved but you want to avoid costy cloning being done\n         by the archivist.\n \n         Returns a dictionary of the following format:\n@@ -316,7 +316,7 @@ class IVersionData(Interface):\n     refs_to_be_deleted = Attribute(\n         """List of references to be deleted on revert.\n \n-        The items (containing the reference informations) are of\n+        The items (containing the reference information) are of\n         ``IReferenceAdapter``.\n         """\n     )\n@@ -327,7 +327,7 @@ class IVersionData(Interface):\n     )\n \n     preserved_data = Attribute(\n-        """Returns data beeing preserved from beeing overwritten by modifiers.\n+        """Returns data being preserved from being overwritten by modifiers.\n \n         The preserved data is a flat dictionary. With the example from above:\n         nick_name = obj.preserved_data[\'nick_name\']\n@@ -372,14 +372,14 @@ def __getattr__(version_id):\n         """\n \n     def __iter__():\n-        """Returns an ordered set of versions for beeing looped over.\n+        """Returns an ordered set of versions for being looped over.\n \n         The objects returned are of \'IVersionData\'.\n         """\n \n \n class IObjectData(Interface):\n-    """The object including informations about outgoing references."""\n+    """The object including information about outgoing references."""\n \n     object = Attribute(\n         """The object with some of the python references replaced by\ndiff --git a/Products/CMFEditions/interfaces/IModifier.py b/Products/CMFEditions/interfaces/IModifier.py\nindex e0a44445..49818e74 100644\n--- a/Products/CMFEditions/interfaces/IModifier.py\n+++ b/Products/CMFEditions/interfaces/IModifier.py\n@@ -114,7 +114,7 @@ def afterRetrieveModifier(obj, repo_clone, preserve=()):\n         Usually this hook is used to do one or more of the following\n         tasks:\n \n-            - readd data that was removed by the \'beforeSaveHook\'\n+            - re-add data that was removed by the \'beforeSaveHook\'\n             - manipulate data before it get restored\n             - return data that gets overwritte in this process\n \n@@ -126,10 +126,10 @@ def afterRetrieveModifier(obj, repo_clone, preserve=()):\n \n         - a list of references to be deleted on revert (providing\n           ``IReferenceAdapter``)\n-        - a list of attribute names beeing in charge of holding reference\n+        - a list of attribute names being in charge of holding reference\n           information (e.g. an ObjectManager with ``doc1`` and ``doc2``\n-          as childrens: [\'_objects\', \'doc1\', \'doc2\'])\n-        - a dictionary of the data having been preserved from beeing\n+          as children: [\'_objects\', \'doc1\', \'doc2\'])\n+        - a dictionary of the data having been preserved from being\n           overwritten.\n         """\n \n@@ -142,11 +142,11 @@ class IReferenceAdapter(Interface):\n     """\n \n     def remove():\n-        """Removes the refrence adapted to."""\n+        """Removes the reference adapted to."""\n \n \n class IModifierRegistrySet(Interface):\n-    """Registring and editing a modifier registry."""\n+    """Registering and editing a modifier registry."""\n \n     def register(id, modifier, pos=-1):\n         """Registers a before save and after retrieve modifier.\ndiff --git a/Products/CMFEditions/interfaces/IPurgePolicy.py b/Products/CMFEditions/interfaces/IPurgePolicy.py\nindex 1e9a52f3..d9845b9a 100644\n--- a/Products/CMFEditions/interfaces/IPurgePolicy.py\n+++ b/Products/CMFEditions/interfaces/IPurgePolicy.py\n@@ -46,7 +46,7 @@ def beforeSaveHook(history_id, obj, metadata={}):\n         ``save`` method.\n \n         Return True if ``obj`` has to be saved by the ``IStorage``\n-        implementation. Return ``False`` if the object has to be discared.\n+        implementation. Return ``False`` if the object has to be discarded.\n         """\n \n     def retrieveSubstitute(history_id, selector, default=None):\ndiff --git a/Products/CMFEditions/interfaces/IRepository.py b/Products/CMFEditions/interfaces/IRepository.py\nindex a8a4af89..a1ec70d2 100644\n--- a/Products/CMFEditions/interfaces/IRepository.py\n+++ b/Products/CMFEditions/interfaces/IRepository.py\n@@ -56,7 +56,7 @@ def setAutoApplyMode(autoapply):\n         """Sets the autoapply mode.\n \n         Before a repository can host a version of a content it has to be\n-        registred.\n+        registered.\n         If True the first \'save\' operation will register the content\n         automatically and applies version control.\n         The default value is True.\n@@ -101,7 +101,7 @@ def restore(history_id, selector, container, new_id=None):\n \n         Usage Hint:\n \n-        May be used to restore a deleted object (delted from the tree).\n+        May be used to restore a deleted object (deleted from the tree).\n         A version having been purged from the storage may never be restored.\n         A new id may be chosen.\n         """\n@@ -180,7 +180,7 @@ def purge(obj, selector, comment="", metadata={}, countPurged=True):\n             selector: 0, 1, 2, 3,  4,  5, 6, 7, 8, 9 (countPurged==True)\n             selector: 0, 1, 2, -,  -,  3, 4, 5, 6, 7 (countPurged==False)\n \n-        The comment and metadata passed may be used to store informations\n+        The comment and metadata passed may be used to store information\n         about the reasons of the purging.\n         """\n \n@@ -211,7 +211,7 @@ def restore(history_id, selector, container, new_id=None, countPurged=True):\n \n         Usage Hint:\n \n-        May be used to restore a deleted object (delted from the tree).\n+        May be used to restore a deleted object (deleted from the tree).\n         A version having been purged from the storage may never be restored.\n         A new id may be chosen.\n \n@@ -312,7 +312,7 @@ class IVersionData(Interface):\n \n     preserved_data = Attribute(\n         """It is the data preserved from overwriting during the\n-        retrive process.\n+        retrieve process.\n \n         The preserved data is a flat dictionary.\n         With the example from above:\ndiff --git a/Products/CMFEditions/interfaces/IStorage.py b/Products/CMFEditions/interfaces/IStorage.py\nindex 45cf5247..7f19e1e1 100644\n--- a/Products/CMFEditions/interfaces/IStorage.py\n+++ b/Products/CMFEditions/interfaces/IStorage.py\n@@ -20,9 +20,9 @@\n #########################################################################\n """Manages Storing and Retrieving Version to and from the Storage\n \n-``IStorage`` defines the fundamental storage operations wheras\n+``IStorage`` defines the fundamental storage operations whereas\n ``IPurgePolicy`` defines support for purging versions from the\n-storage. The other interface definitions are defintions for types\n+storage. The other interface definitions are definitions for types\n returned by storage methods.\n \n """\n@@ -50,7 +50,7 @@ def register(history_id, object, referenced_data={}, metadata={}):\n         data to be added to the history.\n \n         \'object\' is already a clone and needn\'t be cloned anymore before\n-        beeing added to the history. Data in \'referenced_data\' are direct\n+        being added to the history. Data in \'referenced_data\' are direct\n         references to the original object and must be cloned before being\n         added to the history.\n \n@@ -60,7 +60,7 @@ def register(history_id, object, referenced_data={}, metadata={}):\n         \'metadata\' must be a (nested) dictionary. If a \'comment\' key exists\n         the implementation may assume it is a human readable string.\n \n-        May veto the registering proces by raising a \'StorageError\'\n+        May veto the registering process by raising a \'StorageError\'\n         exception. No action is performed on repeated registering.\n \n         Returns the value of the newest version(selector).\n@@ -73,7 +73,7 @@ def save(history_id, object, referenced_data={}, metadata={}):\n         data to be added to the history.\n \n         \'object\' is already a clone and needn\'t be cloned anymore before\n-        beeing added to the history. Data in \'referenced_data\' are direct\n+        being added to the history. Data in \'referenced_data\' are direct\n         references to the original object and must be cloned before being\n         added to the history.\n \n@@ -154,7 +154,7 @@ def purge(history_id, selector, metadata={}, countPurged=True):\n         account.\n \n         Purge the given version from the given history. The metadata\n-        passed may be used to store informations about the reasons of\n+        passed may be used to store information about the reasons of\n         the purging.\n         """\n \n@@ -230,7 +230,7 @@ class IVersionData(Interface):\n     )\n \n     referenced_data = Attribute(\n-        """Data beeing passed by reference at save time.\n+        """Data being passed by reference at save time.\n \n         Needs not be cloned before allowing write access. Cloning was\n         already done by the storage layer.\ndiff --git a/Products/CMFEditions/permissions.zcml b/Products/CMFEditions/permissions.zcml\nindex da6e9518..5ce3c861 100644\n--- a/Products/CMFEditions/permissions.zcml\n+++ b/Products/CMFEditions/permissions.zcml\n@@ -6,31 +6,30 @@\n   <permission\n       id="CMFEditions.AccessPreviousVersions"\n       title="CMFEditions: Access previous versions"\n-  />\n+      />\n   <permission\n       id="CMFEditions.RevertToPreviousVersions"\n       title="CMFEditions: Revert to previous versions"\n-  />\n+      />\n   <permission\n       id="CMFEditions.ApplyVersionControl"\n       title="CMFEditions: Apply version control"\n-  />\n+      />\n   <permission\n       id="CMFEditions.SaveNewVersion"\n       title="CMFEditions: Save new version"\n-  />\n+      />\n   <permission\n       id="CMFEditions.PurgeVersion"\n       title="CMFEditions: Purge version"\n-  />\n+      />\n   <permission\n       id="CMFEditions.CheckoutToLocation"\n       title="CMFEditions: Checkout to location"\n-  />\n+      />\n   <permission\n       id="CMFEditions.ManagVersioningPolicies"\n       title="CMFEditions: Manage versioning policies"\n-  />\n+      />\n \n </configure>\n-\ndiff --git a/Products/CMFEditions/profiles.zcml b/Products/CMFEditions/profiles.zcml\nindex bafc1034..ac118d6c 100644\n--- a/Products/CMFEditions/profiles.zcml\n+++ b/Products/CMFEditions/profiles.zcml\n@@ -1,53 +1,61 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n-    i18n_domain="cmfeditions">\n+    i18n_domain="cmfeditions"\n+    >\n \n   <genericsetup:registerProfile\n       name="CMFEditions"\n       title="CMFEditions"\n-      directory="profiles/default"\n       description="Extension profile for default CMFEditions setup."\n       provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/default"\n       />\n \n-    <genericsetup:upgradeSteps\n-        source="2.0"\n-        destination="3"\n-        profile="Products.CMFEditions:CMFEditions">\n-\n-        <genericsetup:upgradeDepends\n-           title="Fix portal_historyidhandler"\n-           import_steps="toolset"\n-          />\n-\n-    </genericsetup:upgradeSteps>\n-\n-    <genericsetup:upgradeSteps\n-        source="3"\n-        destination="4"\n-        profile="Products.CMFEditions:CMFEditions">\n-        <genericsetup:upgradeStep\n-           title="Install the component registry bases modifier."\n-           handler=".setuphandlers.installSkipRegistryBasesPointersModifier" />\n-    </genericsetup:upgradeSteps>\n-\n-    <genericsetup:upgradeSteps\n-        source="4"\n-        destination="10"\n-        profile="Products.CMFEditions:CMFEditions">\n-        <genericsetup:upgradeStep\n-           title="Remove old broken Archetypes modifiers."\n-           handler=".setuphandlers.removeBrokenModifiers" />\n-    </genericsetup:upgradeSteps>\n-\n-    <genericsetup:upgradeSteps\n-        source="10"\n-        destination="11"\n-        profile="Products.CMFEditions:CMFEditions">\n-        <genericsetup:upgradeStep\n-           title="Remove CMFEditions skin layer"\n-           handler=".setuphandlers.removeSkinLayer" />\n-    </genericsetup:upgradeSteps>\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="2.0"\n+      destination="3"\n+      >\n+\n+    <genericsetup:upgradeDepends\n+        title="Fix portal_historyidhandler"\n+        import_steps="toolset"\n+        />\n+\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="3"\n+      destination="4"\n+      >\n+    <genericsetup:upgradeStep\n+        title="Install the component registry bases modifier."\n+        handler=".setuphandlers.installSkipRegistryBasesPointersModifier"\n+        />\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="4"\n+      destination="10"\n+      >\n+    <genericsetup:upgradeStep\n+        title="Remove old broken Archetypes modifiers."\n+        handler=".setuphandlers.removeBrokenModifiers"\n+        />\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeSteps\n+      profile="Products.CMFEditions:CMFEditions"\n+      source="10"\n+      destination="11"\n+      >\n+    <genericsetup:upgradeStep\n+        title="Remove CMFEditions skin layer"\n+        handler=".setuphandlers.removeSkinLayer"\n+        />\n+  </genericsetup:upgradeSteps>\n \n </configure>\ndiff --git a/Products/CMFEditions/profiles/default/catalog.xml b/Products/CMFEditions/profiles/default/catalog.xml\nindex 292ec230..6da5cc0c 100644\n--- a/Products/CMFEditions/profiles/default/catalog.xml\n+++ b/Products/CMFEditions/profiles/default/catalog.xml\n@@ -1,7 +1,11 @@\n-<?xml version="1.0"?>\n-<object name="portal_catalog" meta_type="CMF Catalog">\n- <index name="cmf_uid" meta_type="FieldIndex">\n-  <indexed_attr value="cmf_uid"/>\n- </index>\n- <column value="cmf_uid"/>\n+<?xml version="1.0" encoding="utf-8"?>\n+<object meta_type="CMF Catalog"\n+        name="portal_catalog"\n+>\n+  <index meta_type="FieldIndex"\n+         name="cmf_uid"\n+  >\n+    <indexed_attr value="cmf_uid" />\n+  </index>\n+  <column value="cmf_uid" />\n </object>\ndiff --git a/Products/CMFEditions/profiles/default/componentregistry.xml b/Products/CMFEditions/profiles/default/componentregistry.xml\nindex 8d48b6ef..751c1d8d 100644\n--- a/Products/CMFEditions/profiles/default/componentregistry.xml\n+++ b/Products/CMFEditions/profiles/default/componentregistry.xml\n@@ -1,12 +1,12 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <componentregistry>\n- <adapters/>\n- <utilities>\n-  <utility\n-     interface="Products.CMFUid.interfaces.IUniqueIdAnnotationManagement"\n-     object="portal_uidannotation"/>\n-  <utility\n-     interface="Products.CMFUid.interfaces.IUniqueIdGenerator"\n-     object="portal_uidgenerator"/>\n- </utilities>\n+  <adapters />\n+  <utilities>\n+    <utility interface="Products.CMFUid.interfaces.IUniqueIdAnnotationManagement"\n+             object="portal_uidannotation"\n+    />\n+    <utility interface="Products.CMFUid.interfaces.IUniqueIdGenerator"\n+             object="portal_uidgenerator"\n+    />\n+  </utilities>\n </componentregistry>\ndiff --git a/Products/CMFEditions/profiles/default/metadata.xml b/Products/CMFEditions/profiles/default/metadata.xml\nindex 295a9a26..8ecf4ba7 100644\n--- a/Products/CMFEditions/profiles/default/metadata.xml\n+++ b/Products/CMFEditions/profiles/default/metadata.xml\n@@ -1,4 +1,4 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <metadata>\n   <version>11</version>\n </metadata>\ndiff --git a/Products/CMFEditions/profiles/default/repositorytool.xml b/Products/CMFEditions/profiles/default/repositorytool.xml\nindex 9b659529..08130c9d 100644\n--- a/Products/CMFEditions/profiles/default/repositorytool.xml\n+++ b/Products/CMFEditions/profiles/default/repositorytool.xml\n@@ -1,27 +1,30 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <repositorytool>\n- <policies purge="true">\n-  <policy name="at_edit_autoversion"\n-     title="Create version on edit (AT objects only)"\n-     class="Products.CMFEditions.VersionPolicies.ATVersionOnEditPolicy"/>\n-  <policy name="version_on_revert" title="Create version on version revert"/>\n- </policies>\n- <policymap purge="true">\n-  <type name="Document">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n-  <type name="Event">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n-  <type name="Link">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n-  <type name="News Item">\n-   <policy name="at_edit_autoversion"/>\n-   <policy name="version_on_revert"/>\n-  </type>\n- </policymap>\n+  <policies purge="true">\n+    <policy class="Products.CMFEditions.VersionPolicies.ATVersionOnEditPolicy"\n+            name="at_edit_autoversion"\n+            title="Create version on edit (AT objects only)"\n+    />\n+    <policy name="version_on_revert"\n+            title="Create version on version revert"\n+    />\n+  </policies>\n+  <policymap purge="true">\n+    <type name="Document">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+    <type name="Event">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+    <type name="Link">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+    <type name="News Item">\n+      <policy name="at_edit_autoversion" />\n+      <policy name="version_on_revert" />\n+    </type>\n+  </policymap>\n </repositorytool>\ndiff --git a/Products/CMFEditions/profiles/default/rolemap.xml b/Products/CMFEditions/profiles/default/rolemap.xml\nindex 0db2272a..1c597962 100644\n--- a/Products/CMFEditions/profiles/default/rolemap.xml\n+++ b/Products/CMFEditions/profiles/default/rolemap.xml\n@@ -1,47 +1,52 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <rolemap>\n   <permissions>\n-    <permission name="CMFEditions: Access previous versions"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Access previous versions"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n       <role name="Contributor" />\n     </permission>\n-    <permission name="CMFEditions: Apply version control"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Apply version control"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n       <role name="Contributor" />\n     </permission>\n-    <permission name="CMFEditions: Checkout to location"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Checkout to location"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n     </permission>\n-    <permission name="CMFEditions: Revert to previous versions"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Revert to previous versions"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n     </permission>\n-    <permission name="CMFEditions: Save new version"\n-                acquire="True">\n-      <role name="Manager"/>\n-      <role name="Site Administrator"/>\n-      <role name="Owner"/>\n-      <role name="Editor"/>\n-      <role name="Reviewer"/>\n+    <permission acquire="True"\n+                name="CMFEditions: Save new version"\n+    >\n+      <role name="Manager" />\n+      <role name="Site Administrator" />\n+      <role name="Owner" />\n+      <role name="Editor" />\n+      <role name="Reviewer" />\n       <role name="Contributor" />\n     </permission>\n   </permissions>\ndiff --git a/Products/CMFEditions/profiles/default/toolset.xml b/Products/CMFEditions/profiles/default/toolset.xml\nindex 30f7017a..d5943bef 100644\n--- a/Products/CMFEditions/profiles/default/toolset.xml\n+++ b/Products/CMFEditions/profiles/default/toolset.xml\n@@ -1,23 +1,33 @@\n-<?xml version="1.0"?>\n+<?xml version="1.0" encoding="utf-8"?>\n <tool-setup>\n- <required tool_id="portal_archivist"\n-           class="Products.CMFEditions.ArchivistTool.ArchivistTool"/>\n- <required tool_id="portal_repository"\n-           class="Products.CMFEditions.CopyModifyMergeRepositoryTool.CopyModifyMergeRepositoryTool"/>\n- <required tool_id="portal_historyidhandler"\n-           class="Products.CMFEditions.historyidhandlertool.HistoryIdHandlerTool"/>\n- <required tool_id="portal_purgepolicy"\n-           class="Products.CMFEditions.KeepLastNVersionsTool.KeepLastNVersionsTool"/>\n- <required tool_id="portal_modifier"\n-           class="Products.CMFEditions.ModifierRegistryTool.ModifierRegistryTool"/>\n- <required tool_id="portal_referencefactories"\n-           class="Products.CMFEditions.ReferenceFactoriesTool.ReferenceFactoriesTool"/>\n- <required tool_id="portal_historiesstorage"\n-           class="Products.CMFEditions.ZVCStorageTool.ZVCStorageTool"/>\n- <required tool_id="portal_uidannotation"\n-           class="Products.CMFUid.UniqueIdAnnotationTool.UniqueIdAnnotationTool"/>\n- <required tool_id="portal_uidgenerator"\n-           class="Products.CMFUid.UniqueIdGeneratorTool.UniqueIdGeneratorTool"/>\n- <required tool_id="portal_uidhandler"\n-           class="Products.CMFUid.UniqueIdHandlerTool.UniqueIdHandlerTool"/>\n+  <required class="Products.CMFEditions.ArchivistTool.ArchivistTool"\n+            tool_id="portal_archivist"\n+  />\n+  <required class="Products.CMFEditions.CopyModifyMergeRepositoryTool.CopyModifyMergeRepositoryTool"\n+            tool_id="portal_repository"\n+  />\n+  <required class="Products.CMFEditions.historyidhandlertool.HistoryIdHandlerTool"\n+            tool_id="portal_historyidhandler"\n+  />\n+  <required class="Products.CMFEditions.KeepLastNVersionsTool.KeepLastNVersionsTool"\n+            tool_id="portal_purgepolicy"\n+  />\n+  <required class="Products.CMFEditions.ModifierRegistryTool.ModifierRegistryTool"\n+            tool_id="portal_modifier"\n+  />\n+  <required class="Products.CMFEditions.ReferenceFactoriesTool.ReferenceFactoriesTool"\n+            tool_id="portal_referencefactories"\n+  />\n+  <required class="Products.CMFEditions.ZVCStorageTool.ZVCStorageTool"\n+            tool_id="portal_historiesstorage"\n+  />\n+  <required class="Products.CMFUid.UniqueIdAnnotationTool.UniqueIdAnnotationTool"\n+            tool_id="portal_uidannotation"\n+  />\n+  <required class="Products.CMFUid.UniqueIdGeneratorTool.UniqueIdGeneratorTool"\n+            tool_id="portal_uidgenerator"\n+  />\n+  <required class="Products.CMFUid.UniqueIdHandlerTool.UniqueIdHandlerTool"\n+            tool_id="portal_uidhandler"\n+  />\n </tool-setup>\ndiff --git a/Products/CMFEditions/testing.py b/Products/CMFEditions/testing.py\nindex 3bdab1fc..7e8c29fb 100644\n--- a/Products/CMFEditions/testing.py\n+++ b/Products/CMFEditions/testing.py\n@@ -10,7 +10,6 @@\n \n \n class ProductsCmfeditionsLayer(PloneSandboxLayer):\n-\n     defaultBases = (PLONE_APP_CONTENTTYPES_FIXTURE,)\n \n     def setUpZope(self, app, configurationContext):\ndiff --git a/Products/CMFEditions/tests/DummyTools.py b/Products/CMFEditions/tests/DummyTools.py\nindex d3ef61d2..73794419 100644\n--- a/Products/CMFEditions/tests/DummyTools.py\n+++ b/Products/CMFEditions/tests/DummyTools.py\n@@ -95,7 +95,7 @@ def prepare(self, obj, app_metadata=None, sys_metadata={}):\n         obj, history_id = dereference(obj)\n         if history_id is None:\n             # object isn\'t under version control yet\n-            # An working copy beeing under version control needs to have\n+            # An working copy being under version control needs to have\n             # a history_id, version_id (starts with 0) and a location_id\n             # (the current implementation isn\'t able yet to handle multiple\n             # locations. Nevertheless lets set the location id to a well\n@@ -338,16 +338,16 @@ class FolderishContentObjectModifier(DummyBaseTool):\n     id = "portal_modifier"\n \n     def getReferencedAttributes(self, obj):\n-        # we declare the title beeing a big blob we don\'t want to be\n+        # we declare the title being a big blob we don\'t want to be\n         # pickled and unpickled by the archivist\n         return {"title": obj.title}\n \n     def getOnCloneModifiers(self, obj):\n-        """Removes childrens ending with \'_inside\' or \'_outside\'.\n+        """Removes children ending with \'_inside\' or \'_outside\'.\n \n         Just replaces object manager sub objects ending \'_inside\' or\n-        \'_outside\' by a uninitialzed \'IVersionAwareReference\'.\n-        All other childrens get versioned with the parent.\n+        \'_outside\' by a uninitialized \'IVersionAwareReference\'.\n+        All other children get versioned with the parent.\n         """\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         VersionAwareReference = portal_archivist.classes.VersionAwareReference\n@@ -394,15 +394,15 @@ def persistent_load(pid):\n         return persistent_id, persistent_load, inside_refs, outside_refs, ""\n \n     def beforeSaveModifier(self, obj, clone):\n-        """Returns all unititialized \'IVersionAwareReference\' objects.\n+        """Returns all uninitialized \'IVersionAwareReference\' objects.\n \n-        This allways goes in conjunction with \'getOnCloneModifiers\'.\n+        This always goes in conjunction with \'getOnCloneModifiers\'.\n         """\n         portal_archivist = getToolByName(obj, "portal_archivist")\n         AttributeAdapter = portal_archivist.classes.AttributeAdapter\n \n         # just return adapters to the attributes that were replaced by\n-        # a uninitialzed \'IVersionAwareReference\' object\n+        # a uninitialized \'IVersionAwareReference\' object\n         outside_refs = []\n         inside_refs = []\n         for name in clone.objectIds():\n@@ -505,7 +505,7 @@ def register(self, history_id, object, referenced_data={}, metadata=None):\n             return self._save(history_id, object, referenced_data, metadata)\n \n     def save(self, history_id, object, referenced_data={}, metadata=None):\n-        # delegate the decission what to purge to the purge policy tool\n+        # delegate the decision what to purge to the purge policy tool\n         # if it exists. If the call returns ``True`` do not save the current\n         # version.\n         policy = getToolByName(self, "portal_purgepolicy", None)\n@@ -681,7 +681,7 @@ def beforeSaveHook(self, history_id, obj, metadata={}):\n         return True\n \n     def retrieveSubstitute(self, history_id, selector, default=None):\n-        """Retrives the next older version"""\n+        """Retrieves the next older version"""\n         storage = getToolByName(self, "portal_historiesstorage")\n         while selector:\n             selector -= 1\n@@ -693,7 +693,7 @@ def retrieveSubstitute(self, history_id, selector, default=None):\n \n @implementer(IStorage, IPurgeSupport)\n class PurgePolicyTestDummyStorage(DummyBaseTool):\n-    """Partial Storage used for PurgePolicy Tetss"""\n+    """Partial Storage used for PurgePolicy Tests"""\n \n     id = "portal_historiesstorage"\n \ndiff --git a/Products/CMFEditions/tests/large_file_modifiers.rst b/Products/CMFEditions/tests/large_file_modifiers.rst\nindex 8298f18c..cf31c7a4 100644\n--- a/Products/CMFEditions/tests/large_file_modifiers.rst\n+++ b/Products/CMFEditions/tests/large_file_modifiers.rst\n@@ -66,7 +66,7 @@ Skip Versioning of Large File Attributes\n \n Now let\'s test the alternate modifier, which tells the pickler to\n replace large file attributes with a marker to avoid pickling them.\n-We\'ll make our modifer and set some defaults as above, and then add to\n+We\'ll make our modifier and set some defaults as above, and then add to\n it file and image attributes::\n \n     >>> modifier = SkipVersioningOfLargeFilesAndImages()\ndiff --git a/Products/CMFEditions/tests/test_ContentTypes.py b/Products/CMFEditions/tests/test_ContentTypes.py\nindex df7e158f..c0e05c1d 100644\n--- a/Products/CMFEditions/tests/test_ContentTypes.py\n+++ b/Products/CMFEditions/tests/test_ContentTypes.py\n@@ -1,9 +1,9 @@\n from plone.app.textfield.value import RichTextValue\n+from plone.base.utils import unrestricted_construct_instance\n from plone.namedfile.file import NamedBlobFile\n from plone.namedfile.file import NamedBlobImage\n from Products.CMFEditions import PACKAGE_HOME\n from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase\n-from plone.base.utils import unrestricted_construct_instance\n \n import os\n \ndiff --git a/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py b/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py\nindex 14b37757..40092451 100644\n--- a/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py\n+++ b/Products/CMFEditions/tests/test_CopyModifyMergeRepositoryTool.py\n@@ -25,6 +25,8 @@\n \n from .DummyTools import DummyArchivist\n from .DummyTools import notifyModified\n+from plone.locking.interfaces import ILockable\n+from plone.locking.interfaces import ITTWLockable\n from Products.CMFEditions.interfaces.IRepository import IContentTypeVersionPolicySupport\n from Products.CMFEditions.interfaces.IRepository import ICopyModifyMergeRepository\n from Products.CMFEditions.interfaces.IRepository import IPurgeSupport\n@@ -32,10 +34,8 @@\n from Products.CMFEditions.interfaces.IRepository import RepositoryPurgeError\n from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase\n from Products.CMFEditions.VersionPolicies import VersionPolicy\n-from zope.interface.verify import verifyObject\n from zope.interface import alsoProvides\n-from plone.locking.interfaces import ILockable\n-from plone.locking.interfaces import ITTWLockable\n+from zope.interface.verify import verifyObject\n \n import transaction\n \ndiff --git a/Products/CMFEditions/tests/test_IntegrationTests.py b/Products/CMFEditions/tests/test_IntegrationTests.py\nindex f6b7ac19..2fc5197d 100644\n--- a/Products/CMFEditions/tests/test_IntegrationTests.py\n+++ b/Products/CMFEditions/tests/test_IntegrationTests.py\n@@ -285,8 +285,8 @@ def test11_versionAFolderishObjectThatTreatsChildrensAsInsideRefs(self):\n         doc1 = fol.doc1\n         doc2 = fol.doc2\n \n-        # just configure the standard folder to treat the childrens as\n-        # inside refrences. For this we reconfigure the standard modifiers.\n+        # just configure the standard folder to treat the children as\n+        # inside references. For this we reconfigure the standard modifiers.\n         portal_modifier = self.portal.portal_modifier\n         portal_modifier.edit(\n             "OMOutsideChildrensModifier", enabled=False, condition="python: False"\n@@ -578,8 +578,8 @@ def test16_revertInsideRefsUpdatesCatalog(self):\n         fol = self.portal.fol\n         doc = fol.doc1\n \n-        # just configure the standard folder to treat the childrens as\n-        # inside refrences. For this we reconfigure the standard modifiers.\n+        # just configure the standard folder to treat the children as\n+        # inside references. For this we reconfigure the standard modifiers.\n         portal_modifier = self.portal.portal_modifier\n         portal_modifier.edit(\n             "OMOutsideChildrensModifier", enabled=False, condition="python: False"\n@@ -646,8 +646,8 @@ def test17_moveInsideRefThenRevertChangesUid(self):\n         fol = self.portal.fol\n         doc1 = fol.doc1\n \n-        # just configure the standard folder to treat the childrens as\n-        # inside refrences. For this we reconfigure the standard modifiers.\n+        # just configure the standard folder to treat the children as\n+        # inside references. For this we reconfigure the standard modifiers.\n         portal_modifier = self.portal.portal_modifier\n         portal_modifier.edit(\n             "OMOutsideChildrensModifier", enabled=False, condition="python: False"\n@@ -733,7 +733,7 @@ def disabled_test19_retrieveDeletedObjectWhichHasBeenReplacedInAnInsideRefsFolde\n     ):  # noqa\n         # disabled by gregweb/21-10-2006\n         # reason: Needs concentrated and deeper look.\n-        # --> Ideas exist, pleas contact us on the list if you like to work\n+        # --> Ideas exist, please contact us on the list if you like to work\n         #     on that.\n         # I know one should not do that! But solving this would bring more\n         # risks into the 1.0final than leaving the bug to be solved afterwards.\n@@ -795,7 +795,7 @@ def disabled_test20_retrieveMovedObjectWhichHasBeenReplacedInAnInsideRefsFolder(\n     ):  # noqa\n         # disabled by gregweb/21-10-2006\n         # reason: Needs concentrated and deeper look.\n-        # --> Ideas exist, pleas contact us on the list if you like to work\n+        # --> Ideas exist, please contact us on the list if you like to work\n         #     on that.\n         # I know one should not do that! But solving this would bring more\n         # risks into the 1.0final than leaving the bug to be solved afterwards.\ndiff --git a/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py b/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py\nindex ef6aa657..8caa80a4 100644\n--- a/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py\n+++ b/Products/CMFEditions/tests/test_KeepLastNVersionsTool.py\n@@ -62,15 +62,15 @@ def test02_beforeSaveHookKeepsMaximumTwoVersions(self):\n         storage = self.portal.portal_historiesstorage\n         purgepolicy.maxNumberOfVersionsToKeep = 2\n \n-        # call hook explicitely before save (dummy tool doesn\'t call it,\n-        # we wan\'t to do it explicitely)\n+        # call hook explicitly before save (dummy tool doesn\'t call it,\n+        # we want to do it explicitly)\n         res = purgepolicy.beforeSaveHook(history_id=1, obj=2, metadata={})\n         self.assertTrue(res)\n         storage.save(history_id=1, obj=DummyData(0))\n         self.assertEqual(len(storage.getHistory(history_id=1)), 1)\n \n-        # call hook explicitely before save (dummy tool doesn\'t call it,\n-        # we wan\'t to do it explicitely)\n+        # call hook explicitly before save (dummy tool doesn\'t call it,\n+        # we want to do it explicitly)\n         res = purgepolicy.beforeSaveHook(history_id=1, obj=2, metadata={})\n         self.assertTrue(res)\n         storage.save(history_id=1, obj=DummyData(1))\ndiff --git a/Products/CMFEditions/tests/test_ZVCStorageTool.py b/Products/CMFEditions/tests/test_ZVCStorageTool.py\nindex 1c4c8bbc..8103c845 100644\n--- a/Products/CMFEditions/tests/test_ZVCStorageTool.py\n+++ b/Products/CMFEditions/tests/test_ZVCStorageTool.py\n@@ -226,7 +226,7 @@ def test07_getModificationDate(self):\n         )\n \n         # storage never gets the same object twice, because the archivist always generates another copy on save,\n-        # which then have a diffrent python id.\n+        # which then have a different python id.\n \n         # simulate object copy\n         notifyModified(obj)\ndiff --git a/Products/CMFEditions/utilities.py b/Products/CMFEditions/utilities.py\nindex 56bad8a4..c222b0bd 100644\n--- a/Products/CMFEditions/utilities.py\n+++ b/Products/CMFEditions/utilities.py\n@@ -35,7 +35,7 @@\n class KwAsAttributes(Persistent):\n     """Class attaching to itself passed keyword attributes."""\n \n-    # Not web accessable\n+    # Not web accessible\n     __roles__ = ()\n \n     def __init__(self, **kw):\n@@ -80,7 +80,7 @@ def dereference(obj=None, history_id=None, zodb_hook=None):\n \n \n def generateId(parent, prefix="", volatile=False):\n-    """Generate an unused id (optionaly a volatile one)."""\n+    """Generate an unused id (optionally a volatile one)."""\n     existingIds = parent.objectIds()\n     idTemplate = "{}{}_%s".format(volatile * "__v_", prefix + STUB_OBJECT_PREFIX)\n     while 1:\n@@ -131,11 +131,11 @@ def wrap(obj, parent):\n \n         getattr(wrapped.aq_parent, tempAttribute)\n     """\n-    # be sure the obj is unwraped before wrapping it (argh, having\n+    # be sure the obj is unwrapped before wrapping it (argh, having\n     # caused pulling my hair out until I realized it is wrapped)\n     obj = aq_base(obj).__of__(parent)\n \n-    # set containment temporarly\n+    # set containment temporary\n     tempAttribute = generateId(parent, volatile=True)\n     changed = parent._p_changed\n     setattr(parent, tempAttribute, obj)\ndiff --git a/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt b/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt\nindex 69fcd32c..34ee7c86 100644\n--- a/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt\n+++ b/Products/CMFEditions/www/AbortVersioningOfLargeFilesAndImagesAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Abort Versioning of Large Files and Images Modifier</h2>\n \n-<form action="manage_addAbortVersioningOfLargeFilesAndImages" method="post">\n+<form action="manage_addAbortVersioningOfLargeFilesAndImages"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt b/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt\nindex b088e2b5..31c099ac 100644\n--- a/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt\n+++ b/Products/CMFEditions/www/OMInsideChildrensModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add OMInsideChildrens Modifier</h2>\n \n-<form action="manage_addOMInsideChildrensModifier" method="post">\n+<form action="manage_addOMInsideChildrensModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt b/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt\nindex ddc1db51..8ea7704d 100644\n--- a/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt\n+++ b/Products/CMFEditions/www/OMOutsideChildrensModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add OMOutsideChildrens Modifier</h2>\n \n-<form action="manage_addOMInsideChildrensModifier" method="post">\n+<form action="manage_addOMInsideChildrensModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt b/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt\nindex e934f5a0..17d93866 100644\n--- a/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt\n+++ b/Products/CMFEditions/www/RetainPermissionsSettingsModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add RetainPermissionsSettings Modifier</h2>\n \n-<form action="manage_addRetainPermissionsSettings" method="post">\n+<form action="manage_addRetainPermissionsSettings"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt b/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt\nindex a01495a3..1aa780dc 100644\n--- a/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt\n+++ b/Products/CMFEditions/www/RetainUIDsModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add RetainUIDs Modifier</h2>\n \n-<form action="manage_addRetainUIDs" method="post">\n+<form action="manage_addRetainUIDs"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt b/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt\nindex 1e6947bb..957ecc57 100644\n--- a/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt\n+++ b/Products/CMFEditions/www/RetainWorkflowStateAndHistoryModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add RetainWorkflowStateAndHistory Modifier</h2>\n \n-<form action="manage_addRetainWorkflowStateAndHistory" method="post">\n+<form action="manage_addRetainWorkflowStateAndHistory"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt b/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt\nindex 89a61c22..947ae851 100644\n--- a/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt\n+++ b/Products/CMFEditions/www/SaveFileDataInFileTypeByReferenceModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add SaveFileDataInFileTypeByReference Modifier</h2>\n \n-<form action="manage_addSaveFileDataInFileTypeByReference" method="post">\n+<form action="manage_addSaveFileDataInFileTypeByReference"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt b/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt\nindex 5360376d..a1536df9 100644\n--- a/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt\n+++ b/Products/CMFEditions/www/SillyDemoRetrieveModifier.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Silly Modifier For Demos Only</h2>\n \n-<form action="manage_addSillyDemoRetrieveModifier" method="post">\n+<form action="manage_addSillyDemoRetrieveModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt b/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\nindex 4deec278..b8d67c4e 100644\n--- a/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\n+++ b/Products/CMFEditions/www/SillyDemoRetrieveModifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n-<h2>Add Silly Retrive Modifier For Demos</h2>\n+<h2>Add Silly Retrieve Modifier For Demos</h2>\n \n-<form action="manage_addSillyDemoRetrieveModifier" method="post">\n+<form action="manage_addSillyDemoRetrieveModifier"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SkipParentPointersAddForm.pt b/Products/CMFEditions/www/SkipParentPointersAddForm.pt\nindex 25246978..60c07c9d 100644\n--- a/Products/CMFEditions/www/SkipParentPointersAddForm.pt\n+++ b/Products/CMFEditions/www/SkipParentPointersAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip Versioning of Parent Pointers Modifier</h2>\n \n-<form action="manage_addSkipParentPointers" method="post">\n+<form action="manage_addSkipParentPointers"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt b/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt\nindex ac288aba..e8c00728 100644\n--- a/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt\n+++ b/Products/CMFEditions/www/SkipRegistryBasesPointersAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip Versioning of Component Registry Bases Modifier</h2>\n \n-<form action="manage_addSkipRegistryBasesPointers" method="post">\n+<form action="manage_addSkipRegistryBasesPointers"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt b/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt\nindex 077867a4..39196d0d 100644\n--- a/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt\n+++ b/Products/CMFEditions/www/SkipVersioningOfLargeFilesAndImagesAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip Versioning of Large Files and Images Modifier</h2>\n \n-<form action="manage_addSkipVersioningOfLargeFilesAndImages" method="post">\n+<form action="manage_addSkipVersioningOfLargeFilesAndImages"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/Skip_z3c_blobfile.pt b/Products/CMFEditions/www/Skip_z3c_blobfile.pt\nindex 9ca58247..a59d3d0b 100644\n--- a/Products/CMFEditions/www/Skip_z3c_blobfile.pt\n+++ b/Products/CMFEditions/www/Skip_z3c_blobfile.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Skip z3c.blobfile Modifier</h2>\n \n-<form action="manage_addSkip_z3c_blobfile" method="post">\n+<form action="manage_addSkip_z3c_blobfile"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +32,20 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/fieldModifierEditForm.pt b/Products/CMFEditions/www/fieldModifierEditForm.pt\nindex 05f9bfad..d71adfe4 100644\n--- a/Products/CMFEditions/www/fieldModifierEditForm.pt\n+++ b/Products/CMFEditions/www/fieldModifierEditForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Edit Modifier</h2>\n \n-<form action="edit" method="post">\n+<form action="edit"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,60 +19,95 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40" tal:attributes="value here/title" />\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/title;\n+               "\n+        />\n       </td>\n     </tr>\n \n-      <tr>\n-        <th>\n+    <tr>\n+      <th>\n           Enabled\n-        </th>\n-        <td>\n-          <input type="checkbox" name="enabled" value="True" tal:attributes="checked here/isEnabled" />\n-        </td>\n-      </tr>\n+      </th>\n+      <td>\n+        <input name="enabled"\n+               type="checkbox"\n+               value="True"\n+               tal:attributes="\n+                 checked here/isEnabled;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n+    <tr>\n+      <th>\n             Condition\n-          </th>\n-          <td>\n-            <input type="text" name="condition" value="" size="80" tal:attributes="value here/getTalesCondition" />\n-          </td>\n-        </tr>\n+      </th>\n+      <td>\n+        <input name="condition"\n+               size="80"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/getTalesCondition;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n+    <tr>\n+      <th>\n             Field names to check\n-          </th>\n-          <td>\n-            <textarea name="field_names" value="" rows="4" cols="25"\n-                      tal:content="here/getFieldNames">\n-            </textarea>\n-          </td>\n-        </tr>\n+      </th>\n+      <td>\n+        <textarea cols="25"\n+                  name="field_names"\n+                  rows="4"\n+                  value=""\n+                  tal:content="here/getFieldNames"\n+        >\n+        </textarea>\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n-            Maximum file size in bytes <br />\n+    <tr>\n+      <th>\n+            Maximum file size in bytes\n+        <br />\n             (should not be set larger than 32768000)\n-          </th>\n-          <td>\n-            <input type="text" name="max_size" value=""\n-                   tal:attributes="value here/max_size" />\n-          </td>\n-        </tr>\n+      </th>\n+      <td>\n+        <input name="max_size"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/max_size;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-        <tr>\n-          <th>\n-          </th>\n-          <td colspan="2">\n-            <input type="submit" name="submit" value="Save" />\n-          </td>\n-        </tr>\n+    <tr>\n+      <th>\n+      </th>\n+      <td colspan="2">\n+        <input name="submit"\n+               type="submit"\n+               value="Save"\n+        />\n+      </td>\n+    </tr>\n \n-    </table>\n+  </table>\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/modifierAddForm.pt b/Products/CMFEditions/www/modifierAddForm.pt\nindex 568d7fd6..94034537 100644\n--- a/Products/CMFEditions/www/modifierAddForm.pt\n+++ b/Products/CMFEditions/www/modifierAddForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Add Modifier</h2>\n \n-<form action="add" method="post">\n+<form action="add"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,11 @@\n         Id\n       </th>\n       <td>\n-        <input type="text" name="id" value="" size="40"/>\n+        <input name="id"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n     <tr>\n@@ -21,12 +31,19 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+        />\n       </td>\n     </tr>\n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Add"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Add"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +53,6 @@\n \n <tal:block content="structure request" />\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/modifierEditForm.pt b/Products/CMFEditions/www/modifierEditForm.pt\nindex 990ead3f..ade7f492 100644\n--- a/Products/CMFEditions/www/modifierEditForm.pt\n+++ b/Products/CMFEditions/www/modifierEditForm.pt\n@@ -1,10 +1,16 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n \n <h2>Edit Modifier</h2>\n \n-<form action="edit" method="post">\n+<form action="edit"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -13,7 +19,14 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40" tal:attributes="value here/title"/>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value here/title;\n+               "\n+        />\n       </td>\n     </tr>\n \n@@ -22,13 +35,22 @@\n         Enabled\n       </th>\n       <td>\n-        <input type="checkbox" name="enabled" value="True" tal:attributes="checked here/isEnabled"/>\n+        <input name="enabled"\n+               type="checkbox"\n+               value="True"\n+               tal:attributes="\n+                 checked here/isEnabled;\n+               "\n+        />\n       </td>\n     </tr>\n \n     <tr>\n       <td colspan="2">\n-        <input type="submit" name="submit" value="Save"/>\n+        <input name="submit"\n+               type="submit"\n+               value="Save"\n+        />\n       </td>\n     </tr>\n \n@@ -36,4 +58,6 @@\n \n </form>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/storageStatistics.pt b/Products/CMFEditions/www/storageStatistics.pt\nindex a8395339..dc630e9b 100644\n--- a/Products/CMFEditions/www/storageStatistics.pt\n+++ b/Products/CMFEditions/www/storageStatistics.pt\n@@ -1,79 +1,98 @@\n-<p tal:replace="structure here/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure here/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure here/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure here/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n-<tal:block define="statistics here/zmi_getStorageStatistics;\n-                   existing statistics/existing;\n-                   deleted statistics/deleted;\n-                   summaries statistics/summaries;\n-                   ">\n-<h2>Storage Statistics</h2>\n+<tal:block define="\n+             statistics here/zmi_getStorageStatistics;\n+             existing statistics/existing;\n+             deleted statistics/deleted;\n+             summaries statistics/summaries;\n+           ">\n+  <h2>Storage Statistics</h2>\n \n-<p>Calculating the statistics took <span tal:replace="summaries/time" /> seconds.</p>\n+  <p>Calculating the statistics took\n+    <span tal:replace="summaries/time"></span>\n+    seconds.</p>\n \n-<table border="0" cellspacing="0" tal:condition="existing">\n-  <tr>\n-    <th colspan="2" align="left">Number of Histories:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/totalHistories"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of existing items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/existingHistories"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of deleted items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/deletedHistories"></td>\n-  </tr>\n-  <tr>\n-    <th colspan="4"></th>\n-  </tr>\n-  <tr>\n-    <th colspan="2" align="left">Number of Versions:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/totalVersions"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of existing items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/existingVersions"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of deleted items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/deletedVersions"></td>\n-  </tr>\n-  <tr>\n-    <th colspan="4"></th>\n-  </tr>\n-  <tr>\n-    <th colspan="2" align="left">Average Versions per History:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/totalAverage"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of existing items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/existingAverage"></td>\n-  </tr>\n-  <tr>\n-    <th>&nbsp;&nbsp;&nbsp;</th>\n-    <th align="left">of deleted items:</th>\n-    <td>&nbsp;&nbsp;</td>\n-    <td tal:content="summaries/deletedAverage"></td>\n-  </tr>\n-</table>\n+  <table border="0"\n+         cellspacing="0"\n+         tal:condition="existing"\n+  >\n+    <tr>\n+      <th align="left"\n+          colspan="2"\n+      >Number of Histories:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/totalHistories"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of existing items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/existingHistories"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of deleted items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/deletedHistories"></td>\n+    </tr>\n+    <tr>\n+      <th colspan="4"></th>\n+    </tr>\n+    <tr>\n+      <th align="left"\n+          colspan="2"\n+      >Number of Versions:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/totalVersions"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of existing items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/existingVersions"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of deleted items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/deletedVersions"></td>\n+    </tr>\n+    <tr>\n+      <th colspan="4"></th>\n+    </tr>\n+    <tr>\n+      <th align="left"\n+          colspan="2"\n+      >Average Versions per History:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/totalAverage"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of existing items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/existingAverage"></td>\n+    </tr>\n+    <tr>\n+      <th>&nbsp;&nbsp;&nbsp;</th>\n+      <th align="left">of deleted items:</th>\n+      <td>&nbsp;&nbsp;</td>\n+      <td tal:content="summaries/deletedAverage"></td>\n+    </tr>\n+  </table>\n \n-<h3>Existing Working Copies</h3>\n+  <h3>Existing Working Copies</h3>\n \n   <p tal:condition="not:existing">None</p>\n-  <table border="1" cellspacing="0" tal:condition="existing">\n+  <table border="1"\n+         cellspacing="0"\n+         tal:condition="existing"\n+  >\n \n     <tr>\n       <th align="left">\n@@ -99,19 +118,29 @@\n     <tr tal:repeat="histData existing">\n       <td tal:content="histData/history_id">history id</td>\n       <td tal:content="histData/length">length</td>\n-      <td align="right" tal:content="histData/size">size</td>\n-      <td align="right" tal:content="histData/sizeState">size state</td>\n+      <td align="right"\n+          tal:content="histData/size"\n+      >size</td>\n+      <td align="right"\n+          tal:content="histData/sizeState"\n+      >size state</td>\n       <td tal:content="histData/portal_type">portal type</td>\n-      <td><a tal:attributes="href histData/url"\n-             tal:content="histData/path">current path</a></td>\n+      <td><a tal:content="histData/path"\n+           tal:attributes="\n+             href histData/url;\n+           "\n+        >current path</a></td>\n     </tr>\n \n   </table>\n \n-<h3>Deleted Working Copies</h3>\n+  <h3>Deleted Working Copies</h3>\n \n   <p tal:condition="not:deleted">None</p>\n-  <table border="1" cellspacing="0" tal:condition="deleted">\n+  <table border="1"\n+         cellspacing="0"\n+         tal:condition="deleted"\n+  >\n \n     <tr>\n       <th align="left">\n@@ -134,8 +163,12 @@\n     <tr tal:repeat="histData deleted">\n       <td tal:content="histData/history_id">history id</td>\n       <td tal:content="histData/length">length</td>\n-      <td align="right" tal:content="histData/size">size</td>\n-      <td align="right" tal:content="histData/sizeState">size state</td>\n+      <td align="right"\n+          tal:content="histData/size"\n+      >size</td>\n+      <td align="right"\n+          tal:content="histData/sizeState"\n+      >size state</td>\n       <td tal:content="histData/portal_type">portal type</td>\n     </tr>\n \n@@ -143,4 +176,6 @@\n \n </tal:block>\n \n-<p tal:replace="structure here/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure here/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/CMFEditions/www/talesModifierEditForm.pt b/Products/CMFEditions/www/talesModifierEditForm.pt\nindex f22d2125..f0c78023 100644\n--- a/Products/CMFEditions/www/talesModifierEditForm.pt\n+++ b/Products/CMFEditions/www/talesModifierEditForm.pt\n@@ -1,9 +1,15 @@\n-<p tal:replace="structure context/manage_page_header" omit-tag="">Header</p>\n-<p tal:replace="structure context/manage_tabs" omit-tag="">tabs</p>\n+<p tal:replace="structure context/manage_page_header"\n+   omit-tag=""\n+>Header</p>\n+<p tal:replace="structure context/manage_tabs"\n+   omit-tag=""\n+>tabs</p>\n \n <h2>Edit Modifier</h2>\n \n-<form action="edit" method="post">\n+<form action="edit"\n+      method="post"\n+>\n \n   <table border="0">\n \n@@ -12,36 +18,61 @@\n         Title\n       </th>\n       <td>\n-        <input type="text" name="title" value="" size="40" tal:attributes="value context/title"/>\n-        </td>\n-      </tr>\n+        <input name="title"\n+               size="40"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value context/title;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-      <tr>\n-        <th>\n+    <tr>\n+      <th>\n           Enabled\n-        </th>\n-        <td>\n-          <input type="checkbox" name="enabled" value="True" tal:attributes="checked context/isEnabled"/>\n-          </td>\n-        </tr>\n-\n-        <tr>\n-          <th>\n+      </th>\n+      <td>\n+        <input name="enabled"\n+               type="checkbox"\n+               value="True"\n+               tal:attributes="\n+                 checked context/isEnabled;\n+               "\n+        />\n+      </td>\n+    </tr>\n+\n+    <tr>\n+      <th>\n             Condition\n-          </th>\n-          <td>\n-            <input type="text" name="condition" value="" size="80" tal:attributes="value context/getTalesCondition"/>\n-            </td>\n-      </tr>\n+      </th>\n+      <td>\n+        <input name="condition"\n+               size="80"\n+               type="text"\n+               value=""\n+               tal:attributes="\n+                 value context/getTalesCondition;\n+               "\n+        />\n+      </td>\n+    </tr>\n \n-      <tr>\n-        <td colspan="2">\n-          <input type="submit" name="submit" value="Save"/>\n-          </td>\n-        </tr>\n+    <tr>\n+      <td colspan="2">\n+        <input name="submit"\n+               type="submit"\n+               value="Save"\n+        />\n+      </td>\n+    </tr>\n \n-    </table>\n+  </table>\n \n </form>\n \n-<p tal:replace="structure context/manage_page_footer" omit-tag="">Footer</p>\n+<p tal:replace="structure context/manage_page_footer"\n+   omit-tag=""\n+>Footer</p>\ndiff --git a/Products/__init__.py b/Products/__init__.py\nindex 05f0bebb..5284146e 100644\n--- a/Products/__init__.py\n+++ b/Products/__init__.py\n@@ -1,7 +1 @@\n-# See http://peak.telecommunity.com/DevCenter/setuptools#namespace-packages\n-try:\n-    __import__("pkg_resources").declare_namespace(__name__)\n-except ImportError:\n-    from pkgutil import extend_path\n-\n-    __path__ = extend_path(__path__, __name__)\n+__import__("pkg_resources").declare_namespace(__name__)\ndiff --git a/doc/DevelDoc.html b/doc/DevelDoc.html\nindex 0d5a2bd3..0f19f856 100644\n--- a/doc/DevelDoc.html\n+++ b/doc/DevelDoc.html\n@@ -1,119 +1,199 @@\n <?xml version="1.0" encoding="UTF-8" ?>\n <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n-<head>\n-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n-<meta name="generator" content="Docutils 0.3.7: http://docutils.sourceforge.net/" />\n-<title>CMFEditions: Versioning in Plone</title>\n-<meta name="author" content="Gr\xc3\xa9goire Weber (gregweb)" />\n-<meta name="author" content="... (please fill in your name here)" />\n-<meta name="date" content="2005-03-22" />\n-<meta name="copyright" content="Gr\xc3\xa9goire Weber" />\n-</head>\n-<body>\n-<div class="document" id="cmfeditions-versioning-in-plone">\n-<h1 class="title">CMFEditions: Versioning in Plone</h1>\n-<h2 class="subtitle" id="developer-documentation">Developer Documentation</h2>\n-<table class="docinfo" frame="void" rules="none">\n-<col class="docinfo-name" />\n-<col class="docinfo-content" />\n-<tbody valign="top">\n-<tr><th class="docinfo-name">Author:</th>\n-<td>Gr\xc3\xa9goire Weber (gregweb)</td></tr>\n-<tr><th class="docinfo-name">Author:</th>\n-<td>... (please fill in your name here)</td></tr>\n-<tr><th class="docinfo-name">Contact:</th>\n-<td><a class="first last reference" href="mailto:gregweb&#64;incept.ch">gregweb&#64;incept.ch</a></td></tr>\n-<tr><th class="docinfo-name">Date:</th>\n-<td>2005-03-22</td></tr>\n-<tr><th class="docinfo-name">Revision:</th>\n-<td>1.4</td></tr>\n-<tr><th class="docinfo-name">Copyright:</th>\n-<td>Gr\xc3\xa9goire Weber</td></tr>\n-<tr class="field"><th class="docinfo-name">License:</th><td class="field-body">GNU Free Documentation License</td>\n-</tr>\n-<tr><th class="docinfo-name">Status:</th>\n-<td>Draft</td></tr>\n-<tr class="field"><th class="docinfo-name">Audience:</th><td class="field-body">Developers</td>\n-</tr>\n-</tbody>\n-</table>\n-<div class="abstract topic">\n-<p class="topic-title first">Abstract</p>\n-<p>The CMFEditions architecture looks like beeing overly complex.\n+<html xmlns="http://www.w3.org/1999/xhtml"\n+      lang="en"\n+      xml:lang="en"\n+>\n+  <head>\n+    <meta http-equiv="Content-Type"\n+          content="text/html; charset=UTF-8"\n+    />\n+    <meta name="generator"\n+          content="Docutils 0.3.7: http://docutils.sourceforge.net/"\n+    />\n+    <title>CMFEditions: Versioning in Plone</title>\n+    <meta name="author"\n+          content="Gr\xc3\xa9goire Weber (gregweb)"\n+    />\n+    <meta name="author"\n+          content="... (please fill in your name here)"\n+    />\n+    <meta name="date"\n+          content="2005-03-22"\n+    />\n+    <meta name="copyright"\n+          content="Gr\xc3\xa9goire Weber"\n+    />\n+  </head>\n+  <body>\n+    <div class="document"\n+         id="cmfeditions-versioning-in-plone"\n+    >\n+      <h1 class="title">CMFEditions: Versioning in Plone</h1>\n+      <h2 class="subtitle"\n+          id="developer-documentation"\n+      >Developer Documentation</h2>\n+      <table class="docinfo"\n+             frame="void"\n+             rules="none"\n+      >\n+        <col class="docinfo-name" />\n+        <col class="docinfo-content" />\n+        <tbody valign="top">\n+          <tr><th class="docinfo-name">Author:</th>\n+            <td>Gr&eacute;goire Weber (gregweb)</td></tr>\n+          <tr><th class="docinfo-name">Author:</th>\n+            <td>... (please fill in your name here)</td></tr>\n+          <tr><th class="docinfo-name">Contact:</th>\n+            <td><a class="first last reference"\n+                 href="mailto:gregweb&#64;incept.ch"\n+              >gregweb&#64;incept.ch</a></td></tr>\n+          <tr><th class="docinfo-name">Date:</th>\n+            <td>2005-03-22</td></tr>\n+          <tr><th class="docinfo-name">Revision:</th>\n+            <td>1.4</td></tr>\n+          <tr><th class="docinfo-name">Copyright:</th>\n+            <td>Gr&eacute;goire Weber</td></tr>\n+          <tr class="field"><th class="docinfo-name">License:</th><td class="field-body">GNU Free Documentation License</td>\n+          </tr>\n+          <tr><th class="docinfo-name">Status:</th>\n+            <td>Draft</td></tr>\n+          <tr class="field"><th class="docinfo-name">Audience:</th><td class="field-body">Developers</td>\n+          </tr>\n+        </tbody>\n+      </table>\n+      <div class="abstract topic">\n+        <p class="topic-title first">Abstract</p>\n+        <p>The CMFEditions architecture looks like being overly complex.\n The complexity has it\'s reasons in Python itself but also in the goal\n of CMFEditions not to rely on specific behaviour of content objects.\n This document shall help developers to grok the architecture and ideas\n behind CMFEditions by unfolding one aspect after the other.</p>\n-<p>This document emerged from the notes for a presentation for PyCon 2005\n+        <p>This document emerged from the notes for a presentation for PyCon 2005\n I (gregweb) couldn\'t hold because of a flu.</p>\n-</div>\n-<div class="contents topic" id="table-of-contents">\n-<p class="topic-title first"><a name="table-of-contents">Table of Contents</a></p>\n-<ul class="simple">\n-<li><a class="reference" href="#about-versioning" id="id7" name="id7">About Versioning</a></li>\n-<li><a class="reference" href="#what-is-a-python-object" id="id8" name="id8">What is a Python Object?</a></li>\n-<li><a class="reference" href="#folderish-objects-folder" id="id9" name="id9">Folderish Objects: Folder</a></li>\n-<li><a class="reference" href="#folderish-objects-f-a-q-page" id="id10" name="id10">Folderish Objects: F.A.Q.-Page</a></li>\n-<li><a class="reference" href="#object-attributes-and-inside-and-outside-references" id="id11" name="id11">Object Attributes and Inside and Outside References</a></li>\n-<li><a class="reference" href="#the-copy-mechanism" id="id12" name="id12">The Copy Mechanism</a><ul>\n-<li><a class="reference" href="#modifers" id="id13" name="id13">Modifers</a></li>\n-</ul>\n-</li>\n-<li><a class="reference" href="#overwiew-over-the-architecture" id="id14" name="id14">Overwiew over the Architecture</a></li>\n-<li><a class="reference" href="#further-reading" id="id15" name="id15">Further Reading</a></li>\n-</ul>\n-</div>\n-<div class="section" id="about-versioning">\n-<h1><a class="toc-backref" href="#id7" name="about-versioning">About Versioning</a></h1>\n-<p>Just some words about what we talk about when we\'re saying &quot;versioning&quot;.</p>\n-<blockquote>\n-<p>Versioning essentially means:</p>\n-<ul class="simple">\n-<li>save the state of an object for later retrieval</li>\n-<li>retrieve a former state of an object</li>\n-<li>do some management stuff like showing the history, if an object is up\n+      </div>\n+      <div class="contents topic"\n+           id="table-of-contents"\n+      >\n+        <p class="topic-title first"><a name="table-of-contents">Table of Contents</a></p>\n+        <ul class="simple">\n+          <li><a class="reference"\n+               id="id7"\n+               href="#about-versioning"\n+               name="id7"\n+            >About Versioning</a></li>\n+          <li><a class="reference"\n+               id="id8"\n+               href="#what-is-a-python-object"\n+               name="id8"\n+            >What is a Python Object?</a></li>\n+          <li><a class="reference"\n+               id="id9"\n+               href="#folderish-objects-folder"\n+               name="id9"\n+            >Folderish Objects: Folder</a></li>\n+          <li><a class="reference"\n+               id="id10"\n+               href="#folderish-objects-f-a-q-page"\n+               name="id10"\n+            >Folderish Objects: F.A.Q.-Page</a></li>\n+          <li><a class="reference"\n+               id="id11"\n+               href="#object-attributes-and-inside-and-outside-references"\n+               name="id11"\n+            >Object Attributes and Inside and Outside References</a></li>\n+          <li><a class="reference"\n+               id="id12"\n+               href="#the-copy-mechanism"\n+               name="id12"\n+            >The Copy Mechanism</a><ul>\n+              <li><a class="reference"\n+                   id="id13"\n+                   href="#modifiers"\n+                   name="id13"\n+                >Modifiers</a></li>\n+            </ul>\n+          </li>\n+          <li><a class="reference"\n+               id="id14"\n+               href="#overwiew-over-the-architecture"\n+               name="id14"\n+            >Overview over the Architecture</a></li>\n+          <li><a class="reference"\n+               id="id15"\n+               href="#further-reading"\n+               name="id15"\n+            >Further Reading</a></li>\n+        </ul>\n+      </div>\n+      <div class="section"\n+           id="about-versioning"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id7"\n+             name="about-versioning"\n+          >About Versioning</a></h1>\n+        <p>Just some words about what we talk about when we\'re saying &quot;versioning&quot;.</p>\n+        <blockquote>\n+          <p>Versioning essentially means:</p>\n+          <ul class="simple">\n+            <li>save the state of an object for later retrieval</li>\n+            <li>retrieve a former state of an object</li>\n+            <li>do some management stuff like showing the history, if an object is up\n to date, etc.</li>\n-</ul>\n-</blockquote>\n-<p>In this document we concentrate on the first two points (<em>save</em> and\n-<em>retreive</em> the state of something). But what does save <em>save the current\n-state</em> mean?</p>\n-<p>Imagine you don\'t have access to a CVS or SVN repository but you\'re writing\n+          </ul>\n+        </blockquote>\n+        <p>In this document we concentrate on the first two points (<em>save</em>\n+           and\n+          <em>retrieve</em>\n+          the state of something). But what does save\n+          <em>save the current\n+state</em>\n+          mean?</p>\n+        <p>Imagine you don\'t have access to a CVS or SVN repository but you\'re writing\n an article. What are you usually doing to preserve important milestones of\n your article? From time to time you make a copy of your document\n (article.rst), append a number to it (article_003.rst) and move it\n-to an <tt class="docutils literal"><span class="pre">old_versions</span></tt> folder.</p>\n-<p>Versioning just means that! The copy operation above is a deep copy as you\n+to an\n+          <tt class="docutils literal"><span class="pre">old_versions</span></tt>\n+          folder.</p>\n+        <p>Versioning just means that! The copy operation above is a deep copy as you\n like to have preserved the whole state to be able to retrieve it entirely\n later.</p>\n-</div>\n-<div class="section" id="what-is-a-python-object">\n-<h1><a class="toc-backref" href="#id8" name="what-is-a-python-object">What is a Python Object?</a></h1>\n-<p>First let\'s start with something well known:</p>\n-<p>A python object is a dictionary:</p>\n-<pre class="literal-block">\n+      </div>\n+      <div class="section"\n+           id="what-is-a-python-object"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id8"\n+             name="what-is-a-python-object"\n+          >What is a Python Object?</a></h1>\n+        <p>First let\'s start with something well known:</p>\n+        <p>A python object is a dictionary:</p>\n+        <pre class="literal-block">\n &gt;&gt;&gt; class A: pass\n ...\n &gt;&gt;&gt; a = A()\n &gt;&gt;&gt; a.__dict__\n {}\n </pre>\n-<p>The data the object carries need not be soley set by code of the class\n+        <p>The data the object carries need not be solely set by code of the class\n implementation:</p>\n-<pre class="literal-block">\n+        <pre class="literal-block">\n &gt;&gt;&gt; a.x=5\n &gt;&gt;&gt; a.__dict__\n {\'x\': 5}\n &gt;&gt;&gt;\n </pre>\n-<p>So there is in fact no control over who stores what for information in the\n+        <p>So there is in fact no control over who stores what for information in the\n object. In Zope setting attributes at &quot;foreign&quot; objects is quite normal.\n A versioning solution has to handle that (by simply saving away a copy of\n-the <tt class="docutils literal"><span class="pre">__dict__</span></tt>).</p>\n-<p>So let\'s have a look at real Zope (2.x) object. As expected, every data\n-the object carries is found in the objects <tt class="docutils literal"><span class="pre">__dict__</span></tt>:</p>\n-<pre class="literal-block">\n+the\n+          <tt class="docutils literal"><span class="pre">__dict__</span></tt>).</p>\n+        <p>So let\'s have a look at real Zope (2.x) object. As expected, every data\n+the object carries is found in the objects\n+          <tt class="docutils literal"><span class="pre">__dict__</span></tt>:</p>\n+        <pre class="literal-block">\n &gt;&gt;&gt; PrettyPrinter().pprint(doc.__dict__)\n {\n   \'_Access_contents_information_Permission\': [\'Anonymous\',\n@@ -146,13 +226,19 @@ <h1><a class="toc-backref" href="#id8" name="what-is-a-python-object">What is a\n     \'time\': DateTime(\'2005/02/14 20:03:37.250 GMT+1\')},)}\n }\n </pre>\n-<p>Looks quite meaningfull! To store a version just make a (deep) copy of\n-<tt class="docutils literal"><span class="pre">doc</span></tt> and store the copy away for later retrieval.</p>\n-</div>\n-<div class="section" id="folderish-objects-folder">\n-<h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish Objects: Folder</a></h1>\n-<p>No let us have a look at a folderish object:</p>\n-<pre class="literal-block">\n+        <p>Looks quite meaningful! To store a version just make a (deep) copy of\n+          <tt class="docutils literal"><span class="pre">doc</span></tt>\n+          and store the copy away for later retrieval.</p>\n+      </div>\n+      <div class="section"\n+           id="folderish-objects-folder"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id9"\n+             name="folderish-objects-folder"\n+          >Folderish Objects: Folder</a></h1>\n+        <p>No let us have a look at a folderish object:</p>\n+        <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder.__dict__)\n {\n@@ -185,10 +271,10 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n     \'time\': DateTime(\'2005/02/14 20:03:37.187 GMT+1\')},)}\n }\n </pre>\n-<p>It looks a little unclear what some of the stuff here is for! Ok as Zope\n+        <p>It looks a little unclear what some of the stuff here is for! Ok as Zope\n geek you know what\'s interesting and what isn\'t. Let\'s just strip away the\n unimportant stuff:</p>\n-<pre class="literal-block">\n+        <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder.__dict__)\n {\n@@ -200,32 +286,54 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n   ...\n }\n </pre>\n-<p>From the <tt class="docutils literal"><span class="pre">_objects</span></tt> attribute we conclude it is an ObjectManager (the\n+        <p>From the\n+          <tt class="docutils literal"><span class="pre">_objects</span></tt>\n+           attribute we conclude it is an ObjectManager (the\n Zope base class for folderish content types).</p>\n-<p>So lets just make a deep copy of everything. <strong>Stop!</strong> What if a folder\n+        <p>So lets just make a deep copy of everything.\n+          <strong>Stop!</strong>\n+           What if a folder\n would conaitn another folder and this subfolder will contain a whole site\n with hundreds of folders?</p>\n-<p>We just would version the whole subtree! Ok, we have to copy deeply but\n+        <p>We just would version the whole subtree! Ok, we have to copy deeply but\n have to stop at some point!</p>\n-<p>Ok, it looks like the <tt class="docutils literal"><span class="pre">_objects</span></tt> contains the ids of the subobjects of\n+        <p>Ok, it looks like the\n+          <tt class="docutils literal"><span class="pre">_objects</span></tt>\n+           contains the ids of the subobjects of\n the folder. So let\'s write down what has to be done:</p>\n-<ul class="simple">\n-<li>deep copy all the stuff except the <tt class="docutils literal"><span class="pre">doc1</span></tt> and the <tt class="docutils literal"><span class="pre">doc2</span></tt> attribute.</li>\n-<li>recurse into the subobjects and version them separately.\n-<strong>Stop!</strong> The same problem as before arrises. We just version the whole\n+        <ul class="simple">\n+          <li>deep copy all the stuff except the\n+            <tt class="docutils literal"><span class="pre">doc1</span></tt>\n+            and the\n+            <tt class="docutils literal"><span class="pre">doc2</span></tt>\n+            attribute.</li>\n+          <li>recurse into the subobjects and version them separately.\n+            <strong>Stop!</strong>\n+             The same problem as before arrises. We just version the whole\n subtree!</li>\n-<li>And we forgot to think about how to track the subobjects from the\n+          <li>And we forgot to think about how to track the subobjects from the\n viewpoint of the folder.</li>\n-</ul>\n-<p>Ok, the solution is:</p>\n-<ol class="arabic">\n-<li><p class="first">Replace the hard python references to the subobjects\n-(<tt class="docutils literal"><span class="pre">&lt;Document</span> <span class="pre">at</span> <span class="pre">doc1&gt;</span></tt> and <tt class="docutils literal"><span class="pre">&lt;Document</span> <span class="pre">at</span> <span class="pre">doc2&gt;</span></tt>) by a version aware\n-week reference. In CMFEditions this is done by replacing the <tt class="docutils literal"><span class="pre">doc1</span></tt>\n-resp. the <tt class="docutils literal"><span class="pre">doc2</span></tt> attribute by an object holding the so called\n-<tt class="docutils literal"><span class="pre">history_id</span></tt> (a unique id within at least the portal) and\n-<tt class="docutils literal"><span class="pre">version_id</span></tt> (another unique id within the subobjects history):</p>\n-<pre class="literal-block">\n+        </ul>\n+        <p>Ok, the solution is:</p>\n+        <ol class="arabic">\n+          <li><p class="first">Replace the hard python references to the subobjects\n+(<tt class="docutils literal"><span class="pre">&lt;Document</span>\n+                <span class="pre">at</span>\n+                <span class="pre">doc1&gt;</span></tt>\n+              and\n+              <tt class="docutils literal"><span class="pre">&lt;Document</span>\n+                <span class="pre">at</span>\n+                <span class="pre">doc2&gt;</span></tt>) by a version aware\n+week reference. In CMFEditions this is done by replacing the\n+              <tt class="docutils literal"><span class="pre">doc1</span></tt>\n+resp. the\n+              <tt class="docutils literal"><span class="pre">doc2</span></tt>\n+               attribute by an object holding the so called\n+              <tt class="docutils literal"><span class="pre">history_id</span></tt>\n+               (a unique id within at least the portal) and\n+              <tt class="docutils literal"><span class="pre">version_id</span></tt>\n+              (another unique id within the subobjects history):</p>\n+            <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder.__dict__)\n {\n@@ -237,11 +345,13 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n   ...\n }\n </pre>\n-</li>\n-<li><p class="first">We just assume the subobjects got already versioned before. For the\n-moment let us assume that just to make life simpler. So <tt class="docutils literal"><span class="pre">doc1</span></tt> looks\n+          </li>\n+          <li><p class="first">We just assume the subobjects got already versioned before. For the\n+moment let us assume that just to make life simpler. So\n+              <tt class="docutils literal"><span class="pre">doc1</span></tt>\n+               looks\n like this:</p>\n-<pre class="literal-block">\n+            <pre class="literal-block">\n &gt;&gt;&gt; PrettyPrinter().pprint(doc1.__dict__)\n {\n   \'title\': &quot;Document 1&quot;,\n@@ -250,105 +360,201 @@ <h1><a class="toc-backref" href="#id9" name="folderish-objects-folder">Folderish\n   ...\n }\n </pre>\n-</li>\n-<li><p class="first">Save the object.</p>\n-</li>\n-</ol>\n-<p>Ok, that\'s quite right but not 100%. There is a problem remaining:</p>\n-<ul class="simple">\n-<li>We can not replace the python references to the subobjects on the\n+          </li>\n+          <li><p class="first">Save the object.</p>\n+          </li>\n+        </ol>\n+        <p>Ok, that\'s quite right but not 100%. There is a problem remaining:</p>\n+        <ul class="simple">\n+          <li>We can not replace the python references to the subobjects on the\n original (and changing the working copy in the Zope tree).</li>\n-<li>But we can\'t first copy and then replace the subobjects neither.</li>\n-</ul>\n-<p>The solution:</p>\n-<ul class="simple">\n-<li>Replace the python reference to the subobjects during the copy\n-mechanism. Let\'s have a look at this later at <a class="reference" href="#the-copy-mechanism">The Copy Mechanism</a>.</li>\n-</ul>\n-</div>\n-<div class="section" id="folderish-objects-f-a-q-page">\n-<h1><a class="toc-backref" href="#id10" name="folderish-objects-f-a-q-page">Folderish Objects: F.A.Q.-Page</a></h1>\n-<p>Now let\'s assume we customized the <tt class="docutils literal"><span class="pre">Folder</span></tt> content type in a way we\n+          <li>But we can\'t first copy and then replace the subobjects neither.</li>\n+        </ul>\n+        <p>The solution:</p>\n+        <ul class="simple">\n+          <li>Replace the python reference to the subobjects during the copy\n+mechanism. Let\'s have a look at this later at\n+            <a class="reference"\n+               href="#the-copy-mechanism"\n+            >The Copy Mechanism</a>.</li>\n+        </ul>\n+      </div>\n+      <div class="section"\n+           id="folderish-objects-f-a-q-page"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id10"\n+             name="folderish-objects-f-a-q-page"\n+          >Folderish Objects: F.A.Q.-Page</a></h1>\n+        <p>Now let\'s assume we customized the\n+          <tt class="docutils literal"><span class="pre">Folder</span></tt>\n+           content type in a way we\n can use it for F.A.Q.-Page (this is a commonly used pattern in CMF/Plone\n-sites, it\'s just done by defining that the <tt class="docutils literal"><span class="pre">title</span></tt> and the\n-<tt class="docutils literal"><span class="pre">description</span></tt> of a document are the question part and the <tt class="docutils literal"><span class="pre">body</span></tt> is\n-the answer part. Additionaly a template <tt class="docutils literal"><span class="pre">faq_view</span></tt> showing all\n+sites, it\'s just done by defining that the\n+          <tt class="docutils literal"><span class="pre">title</span></tt>\n+           and the\n+          <tt class="docutils literal"><span class="pre">description</span></tt>\n+          of a document are the question part and the\n+          <tt class="docutils literal"><span class="pre">body</span></tt>\n+           is\n+the answer part. Additionally a template\n+          <tt class="docutils literal"><span class="pre">faq_view</span></tt>\n+           showing all\n questions at once has to be added).</p>\n-<p>In step 2. above we assumed the subobjects don\'t get saved on a save\n+        <p>In step 2. above we assumed the subobjects don\'t get saved on a save\n operation of the folder. This assumption is now wrong for the F.A.Q.-Page.\n-We wan\'t the subobjects be saved in case we save the whole F.A.Q.-Page.\n+We want the subobjects be saved in case we save the whole F.A.Q.-Page.\n But how to distinguish the F.A.Q.-Page form a normal folder? The\n-F.A.Q.-Page uses the same underlying code as the <tt class="docutils literal"><span class="pre">Folder</span></tt>. Ok, the\n-<tt class="docutils literal"><span class="pre">portal_type</span></tt> attribute has a different value (e.g. <tt class="docutils literal"><span class="pre">FAQPage</span></tt>), so\n+F.A.Q.-Page uses the same underlying code as the\n+          <tt class="docutils literal"><span class="pre">Folder</span></tt>. Ok, the\n+          <tt class="docutils literal"><span class="pre">portal_type</span></tt>\n+          attribute has a different value (e.g.\n+          <tt class="docutils literal"><span class="pre">FAQPage</span></tt>), so\n the F.A.Q.-Page is distinguishable from a normal folder by the\n versioning system.</p>\n-</div>\n-<div class="section" id="object-attributes-and-inside-and-outside-references">\n-<h1><a class="toc-backref" href="#id11" name="object-attributes-and-inside-and-outside-references">Object Attributes and Inside and Outside References</a></h1>\n-<p>In CMFEditions there are three &quot;areas&quot; where information may live in\n+      </div>\n+      <div class="section"\n+           id="object-attributes-and-inside-and-outside-references"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id11"\n+             name="object-attributes-and-inside-and-outside-references"\n+          >Object Attributes and Inside and Outside References</a></h1>\n+        <p>In CMFEditions there are three &quot;areas&quot; where information may live in\n an object:</p>\n-<ol class="loweralpha simple">\n-<li>in the <em>core</em> of the object like e.g. the <tt class="docutils literal"><span class="pre">title</span></tt> attributes\n+        <ol class="loweralpha simple">\n+          <li>in the\n+            <em>core</em>\n+            of the object like e.g. the\n+            <tt class="docutils literal"><span class="pre">title</span></tt>\n+             attributes\n (usually everything except content objects)</li>\n-<li>outside of the core of the object but nevertheless <em>closely related</em>\n-to the object. We gave them the name <em>inside references</em>. In the\n+          <li>outside of the core of the object but nevertheless\n+            <em>closely related</em>\n+to the object. We gave them the name\n+            <em>inside references</em>. In the\n examples above the document subobjects in a F.A.Q.-Page are of such\n type.</li>\n-<li>outside of the core of the object and <em>loosely related</em> to the object.\n-We gave them the name <em>outside references</em>. In the examples\n+          <li>outside of the core of the object and\n+            <em>loosely related</em>\n+             to the object.\n+We gave them the name\n+            <em>outside references</em>. In the examples\n above the document subobjects in a folder are of such type.</li>\n-</ol>\n-<div class="image"><img alt="The different areas where information can live." height="132" src="img/areas.gif" width="138" /></div>\n-<p>We didn\'t talk about the criterias that decide to what onionskin an\n-attribute belongs. See <a class="reference" href="#modifers">Modifers</a> for this.</p>\n-</div>\n-<div class="section" id="the-copy-mechanism">\n-<h1><a class="toc-backref" href="#id12" name="the-copy-mechanism">The Copy Mechanism</a></h1>\n-<p>Just to remember:</p>\n-<blockquote>\n+        </ol>\n+        <div class="image"><img alt="The different areas where information can live."\n+               height="132"\n+               src="img/areas.gif"\n+               width="138"\n+          /></div>\n+        <p>We didn\'t talk about the criteria that decide to what onionskin an\n+attribute belongs. See\n+          <a class="reference"\n+             href="#modifiers"\n+          >Modifiers</a>\n+          for this.</p>\n+      </div>\n+      <div class="section"\n+           id="the-copy-mechanism"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id12"\n+             name="the-copy-mechanism"\n+          >The Copy Mechanism</a></h1>\n+        <p>Just to remember:</p>\n+        <blockquote>\n We can not deeply copy an object and then cut at the necessary places as\n the deepcopy operation could be very costy (probably cloning a whole\n subsite). We can\'t cut before the copy operation neither as this would\n change the original.</blockquote>\n-<p>So we need to intercept the copy mechanism!</p>\n-<p>This can be done by using one of Pythons serializer: <tt class="docutils literal"><span class="pre">pickle</span></tt></p>\n-<p>Before continueing please read the <a class="reference" href="http://python.org/doc/2.4/lib/module-pickle.html">chapter about pickling</a> in the python\n+        <p>So we need to intercept the copy mechanism!</p>\n+        <p>This can be done by using one of Pythons serializer:\n+          <tt class="docutils literal"><span class="pre">pickle</span></tt></p>\n+        <p>Before continuing please read the\n+          <a class="reference"\n+             href="http://python.org/doc/2.4/lib/module-pickle.html"\n+          >chapter about pickling</a>\n+           in the python\n documentation. For those who like to have a look at the &quot;real code&quot; see\n-<tt class="docutils literal"><span class="pre">class</span> <span class="pre">OMBaseModifier</span></tt> in <a class="reference" href="http://cvs.sourceforge.net/viewcvs.py/collective/CMFEditions/StandardModifiers.py?rev=1.4&amp;view=auto">StandardModifier.py</a>.</p>\n-<p>Just a short resume about pickling:</p>\n-<ul class="simple">\n-<li>There is a hook called <tt class="docutils literal"><span class="pre">persistent_id</span></tt> that get\'s called upon every\n+          <tt class="docutils literal"><span class="pre">class</span>\n+            <span class="pre">OMBaseModifier</span></tt>\n+          in\n+          <a class="reference"\n+             href="http://cvs.sourceforge.net/viewcvs.py/collective/CMFEditions/StandardModifiers.py?rev=1.4&amp;view=auto"\n+          >StandardModifier.py</a>.</p>\n+        <p>Just a short resume about pickling:</p>\n+        <ul class="simple">\n+          <li>There is a hook called\n+            <tt class="docutils literal"><span class="pre">persistent_id</span></tt>\n+             that gets called upon every\n object during the serialization process.</li>\n-<li>In this hook you can decide if the object just has to be serialized as\n+          <li>In this hook you can decide if the object just has to be serialized as\n usual or you may return your own serialization of it.</li>\n-<li>There is another hook <tt class="docutils literal"><span class="pre">persistent_load</span></tt> that get\'s called upon every\n+          <li>There is another hook\n+            <tt class="docutils literal"><span class="pre">persistent_load</span></tt>\n+             that gets called upon every\n custom serialized object during the deserialization process.</li>\n-</ul>\n-<p>In case of a folder we know which of the attributes are the subobjects.\n-We just keep their python id <a class="footnote-reference" href="#id3" id="id1" name="id1">[1]</a> in &quot;mind&quot;. In the <tt class="docutils literal"><span class="pre">persistent_id</span></tt> hook\n-the currently passed objects <tt class="docutils literal"><span class="pre">id</span></tt> get checked if it is one of the\n-memorized <tt class="docutils literal"><span class="pre">id</span></tt>s. In that case just nothing get\'s serialized and all the\n+        </ul>\n+        <p>In case of a folder we know which of the attributes are the subobjects.\n+We just keep their python id\n+          <a class="footnote-reference"\n+             id="id1"\n+             href="#id3"\n+             name="id1"\n+          >[1]</a>\n+          in &quot;mind&quot;. In the\n+          <tt class="docutils literal"><span class="pre">persistent_id</span></tt>\n+           hook\n+the currently passed objects\n+          <tt class="docutils literal"><span class="pre">id</span></tt>\n+           get checked if it is one of the\n+memorized\n+          <tt class="docutils literal"><span class="pre">id</span></tt>s. In that case just nothing gets serialized and all the\n subobjects information will be lost (which is by intention).</p>\n-<p>During the deserializing process the <tt class="docutils literal"><span class="pre">persistent_load</span></tt> hook get\'s called\n+        <p>During the deserializing process the\n+          <tt class="docutils literal"><span class="pre">persistent_load</span></tt>\n+           hook gets called\n upon every subobject. We just return an empty version aware weak reference\n-that will be initialized correctly later <a class="footnote-reference" href="#id4" id="id2" name="id2">[2]</a>.</p>\n-<table class="docutils footnote" frame="void" id="id3" rules="none">\n-<colgroup><col class="label" /><col /></colgroup>\n-<tbody valign="top">\n-<tr><td class="label"><a class="fn-backref" href="#id1" name="id3">[1]</a></td><td><tt class="docutils literal"><span class="pre">id(&lt;object&gt;)</span></tt> returns the python identity of <tt class="docutils literal"><span class="pre">&lt;object&gt;</span></tt>.\n-<tt class="docutils literal"><span class="pre">id()</span></tt> had to be used as types like dicts can not be used as hash keys.</td></tr>\n-</tbody>\n-</table>\n-<table class="docutils footnote" frame="void" id="id4" rules="none">\n-<colgroup><col class="label" /><col /></colgroup>\n-<tbody valign="top">\n-<tr><td class="label"><a class="fn-backref" href="#id2" name="id4">[2]</a></td><td>this is actually an implementation detail and isn\'t of any\n+that will be initialized correctly later\n+          <a class="footnote-reference"\n+             id="id2"\n+             href="#id4"\n+             name="id2"\n+          >[2]</a>.</p>\n+        <table class="docutils footnote"\n+               id="id3"\n+               frame="void"\n+               rules="none"\n+        >\n+          <colgroup><col class="label" /><col /></colgroup>\n+          <tbody valign="top">\n+            <tr><td class="label"><a class="fn-backref"\n+                   href="#id1"\n+                   name="id3"\n+                >[1]</a></td><td><tt class="docutils literal"><span class="pre">id(&lt;object&gt;)</span></tt>\n+                returns the python identity of\n+                <tt class="docutils literal"><span class="pre">&lt;object&gt;</span></tt>.\n+                <tt class="docutils literal"><span class="pre">id()</span></tt>\n+                had to be used as types like dicts can not be used as hash keys.</td></tr>\n+          </tbody>\n+        </table>\n+        <table class="docutils footnote"\n+               id="id4"\n+               frame="void"\n+               rules="none"\n+        >\n+          <colgroup><col class="label" /><col /></colgroup>\n+          <tbody valign="top">\n+            <tr><td class="label"><a class="fn-backref"\n+                   href="#id2"\n+                   name="id4"\n+                >[2]</a></td><td>this is actually an implementation detail and isn\'t of any\n importance here.</td></tr>\n-</tbody>\n-</table>\n-<p>As a result the original object and the clone object look the following\n+          </tbody>\n+        </table>\n+        <p>As a result the original object and the clone object look the following\n (non interesting parts are just removed):</p>\n-<pre class="literal-block">\n+        <pre class="literal-block">\n &gt;&gt;&gt; from pprint import PrettyPrinter\n &gt;&gt;&gt; PrettyPrinter().pprint(folder_original.__dict__)\n {\n@@ -369,67 +575,146 @@ <h1><a class="toc-backref" href="#id12" name="the-copy-mechanism">The Copy Mecha\n   ...\n }\n </pre>\n-<div class="section" id="modifers">\n-<h2><a class="toc-backref" href="#id13" name="modifers">Modifers</a></h2>\n-<p>The above job about deciding what attributes belong to the <em>core</em> and what\n-attributes are <em>inside</em> or <em>outside references</em> is done by the so called\n-<tt class="docutils literal"><span class="pre">Modifiers</span></tt>. <tt class="docutils literal"><span class="pre">Modifiers</span></tt> are plug ins and thus replaceable. This way\n+        <div class="section"\n+             id="modifiers"\n+        >\n+          <h2><a class="toc-backref"\n+               href="#id13"\n+               name="modifiers"\n+            >Modifiers</a></h2>\n+          <p>The above job about deciding what attributes belong to the\n+            <em>core</em>\n+             and what\n+attributes are\n+            <em>inside</em>\n+            or\n+            <em>outside references</em>\n+             is done by the so called\n+            <tt class="docutils literal"><span class="pre">Modifiers</span></tt>.\n+            <tt class="docutils literal"><span class="pre">Modifiers</span></tt>\n+             are plug ins and thus replaceable. This way\n everything application/use case specific can be hold outside of the core\n versioning framework.</p>\n-</div>\n-</div>\n-<div class="section" id="overwiew-over-the-architecture">\n-<h1><a class="toc-backref" href="#id14" name="overwiew-over-the-architecture">Overwiew over the Architecture</a></h1>\n-<p>CMFEditions make heavily usage of the CMF(-Framework). The functionality\n+        </div>\n+      </div>\n+      <div class="section"\n+           id="overwiew-over-the-architecture"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id14"\n+             name="overwiew-over-the-architecture"\n+          >Overview over the Architecture</a></h1>\n+        <p>CMFEditions make heavily usage of the CMF(-Framework). The functionality\n is split into four tools to allow easy future replacement of the individual\n tools:</p>\n-<dl class="docutils">\n-<dt><tt class="docutils literal"><span class="pre">portal_repository</span></tt>/<tt class="docutils literal"><span class="pre">IRepository.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">CopyModifyMergeRepositoryTool.py</span></tt></dt>\n-<dd>This is the main API for doing versioning. The implementation depends\n-heavyly on the <strong>applications use cases/policies</strong>.</dd>\n-<dt><tt class="docutils literal"><span class="pre">portal_archivist</span></tt>/<tt class="docutils literal"><span class="pre">IArchivist.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">ArchivistTool.py</span></tt></dt>\n-<dd>The <tt class="docutils literal"><span class="pre">Archivist</span></tt> <strong>knows how to copy</strong> a python object. It needs the\n-help of the <tt class="docutils literal"><span class="pre">portal_modifier</span></tt> to find the boundaries of an object.\n+        <dl class="docutils">\n+          <dt><tt class="docutils literal"><span class="pre">portal_repository</span></tt>/<tt class="docutils literal"><span class="pre">IRepository.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">CopyModifyMergeRepositoryTool.py</span></tt></dt>\n+          <dd>This is the main API for doing versioning. The implementation depends\n+heavyly on the\n+            <strong>applications use cases/policies</strong>.</dd>\n+          <dt><tt class="docutils literal"><span class="pre">portal_archivist</span></tt>/<tt class="docutils literal"><span class="pre">IArchivist.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">ArchivistTool.py</span></tt></dt>\n+          <dd>The\n+            <tt class="docutils literal"><span class="pre">Archivist</span></tt>\n+            <strong>knows how to copy</strong>\n+             a python object. It needs the\n+help of the\n+            <tt class="docutils literal"><span class="pre">portal_modifier</span></tt>\n+             to find the boundaries of an object.\n This is an internal API.</dd>\n-<dt><tt class="docutils literal"><span class="pre">portal_modifier</span></tt>/<tt class="docutils literal"><span class="pre">IModifier.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">ModifierRegistryTool.py</span></tt></dt>\n-<dd>This is a registry for <tt class="docutils literal"><span class="pre">modifier</span></tt> plug ins. The modifiers themselves\n-<strong>know how to handle different aspects of objects</strong> during the versioning\n+          <dt><tt class="docutils literal"><span class="pre">portal_modifier</span></tt>/<tt class="docutils literal"><span class="pre">IModifier.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">ModifierRegistryTool.py</span></tt></dt>\n+          <dd>This is a registry for\n+            <tt class="docutils literal"><span class="pre">modifier</span></tt>\n+             plug ins. The modifiers themselves\n+            <strong>know how to handle different aspects of objects</strong>\n+             during the versioning\n process. This is an internal API.</dd>\n-<dt><tt class="docutils literal"><span class="pre">portal_historiesstorage</span></tt>/<tt class="docutils literal"><span class="pre">IStorage.py</span></tt> implemented by <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt></dt>\n-<dd>This is the storage layer. The passed copies of the individualized\n+          <dt><tt class="docutils literal"><span class="pre">portal_historiesstorage</span></tt>/<tt class="docutils literal"><span class="pre">IStorage.py</span></tt>\n+            implemented by\n+            <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt></dt>\n+          <dd>This is the storage layer. The passed copies of the individualized\n objects may just be stored. Handling references between objects is\n already done and the storage doesn\'t have to care about it anymore.\n-The goal was that the storage layer just has to <strong>handle storage related\n-stuff</strong> like accessing a possibly external data base, doing XML\n-marshalling, etc. <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt> is currently the default storage\n-using <tt class="docutils literal"><span class="pre">ZopeVersionControl</span></tt> to store data <a class="footnote-reference" href="#id6" id="id5" name="id5">[3]</a>. This is an internal API.</dd>\n-</dl>\n-<div class="image"><img alt="Overview over the architecture and flow of information on save." height="508" src="img/architecture.gif" width="781" /></div>\n-<p>Have also a look at the <a class="reference" href="architecture.pdf">high resolution version</a> of the architecture.</p>\n-<table class="docutils footnote" frame="void" id="id6" rules="none">\n-<colgroup><col class="label" /><col /></colgroup>\n-<tbody valign="top">\n-<tr><td class="label"><a class="fn-backref" href="#id5" name="id6">[3]</a></td><td>This isn\'t the most efficient and simple way of a ZODB storage.\n+The goal was that the storage layer just has to\n+            <strong>handle storage related\n+stuff</strong>\n+             like accessing a possibly external data base, doing XML\n+marshalling, etc.\n+            <tt class="docutils literal"><span class="pre">ZVCStorage.py</span></tt>\n+             is currently the default storage\n+using\n+            <tt class="docutils literal"><span class="pre">ZopeVersionControl</span></tt>\n+            to store data\n+            <a class="footnote-reference"\n+               id="id5"\n+               href="#id6"\n+               name="id5"\n+            >[3]</a>. This is an internal API.</dd>\n+        </dl>\n+        <div class="image"><img alt="Overview over the architecture and flow of information on save."\n+               height="508"\n+               src="img/architecture.gif"\n+               width="781"\n+          /></div>\n+        <p>Have also a look at the\n+          <a class="reference"\n+             href="architecture.pdf"\n+          >high resolution version</a>\n+          of the architecture.</p>\n+        <table class="docutils footnote"\n+               id="id6"\n+               frame="void"\n+               rules="none"\n+        >\n+          <colgroup><col class="label" /><col /></colgroup>\n+          <tbody valign="top">\n+            <tr><td class="label"><a class="fn-backref"\n+                   href="#id5"\n+                   name="id6"\n+                >[3]</a></td><td>This isn\'t the most efficient and simple way of a ZODB storage.\n If somebody is interested in replacing this with a simple ZODB storage\n-just show up on the <a class="reference" href="mailto:collective-versioning&#64;lists.sourceforge.net">Versioning Mailing-List</a>.</td></tr>\n-</tbody>\n-</table>\n-</div>\n-<div class="section" id="further-reading">\n-<h1><a class="toc-backref" href="#id15" name="further-reading">Further Reading</a></h1>\n-<p>For more information please consult:</p>\n-<ul class="simple">\n-<li>the interfaces</li>\n-<li>the unit tests</li>\n-<li>the code :-)</li>\n-</ul>\n-</div>\n-</div>\n-<hr class="docutils footer" />\n-<div class="footer">\n-<a class="reference" href="DevelDoc.txt">View document source</a>.\n+just show up on the\n+                <a class="reference"\n+                   href="mailto:collective-versioning&#64;lists.sourceforge.net"\n+                >Versioning Mailing-List</a>.</td></tr>\n+          </tbody>\n+        </table>\n+      </div>\n+      <div class="section"\n+           id="further-reading"\n+      >\n+        <h1><a class="toc-backref"\n+             href="#id15"\n+             name="further-reading"\n+          >Further Reading</a></h1>\n+        <p>For more information please consult:</p>\n+        <ul class="simple">\n+          <li>the interfaces</li>\n+          <li>the unit tests</li>\n+          <li>the code :-)</li>\n+        </ul>\n+      </div>\n+    </div>\n+    <hr class="docutils footer" />\n+    <div class="footer">\n+      <a class="reference"\n+         href="DevelDoc.txt"\n+      >View document source</a>.\n Generated on: 2005-03-22 22:42 UTC.\n-Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.\n-</div>\n-</body>\n+Generated by\n+      <a class="reference"\n+         href="http://docutils.sourceforge.net/"\n+      >Docutils</a>\n+      from\n+      <a class="reference"\n+         href="http://docutils.sourceforge.net/rst.html"\n+      >reStructuredText</a>\n+       source.\n+    </div>\n+  </body>\n </html>\ndiff --git a/doc/DevelDoc.txt b/doc/DevelDoc.txt\nindex e326f433..5aba33cb 100644\n--- a/doc/DevelDoc.txt\n+++ b/doc/DevelDoc.txt\n@@ -14,7 +14,7 @@ Developer Documentation\n :License: GNU Free Documentation License\n :Status: Draft\n :Audience: Developers\n-:Abstract: The CMFEditions architecture looks like beeing overly complex.\n+:Abstract: The CMFEditions architecture looks like being overly complex.\n   The complexity has it\'s reasons in Python itself but also in the goal\n   of CMFEditions not to rely on specific behaviour of content objects.\n   This document shall help developers to grok the architecture and ideas\n@@ -39,7 +39,7 @@ Just some words about what we talk about when we\'re saying "versioning".\n     to date, etc.\n \n In this document we concentrate on the first two points (*save* and\n-*retreive* the state of something). But what does save *save the current\n+*retrieve* the state of something). But what does save *save the current\n state* mean?\n \n Imagine you don\'t have access to a CVS or SVN repository but you\'re writing\n@@ -66,7 +66,7 @@ A python object is a dictionary::\n   >>> a.__dict__\n   {}\n \n-The data the object carries need not be soley set by code of the class\n+The data the object carries need not be solely set by code of the class\n implementation::\n \n   >>> a.x=5\n@@ -114,7 +114,7 @@ the object carries is found in the objects ``__dict__``::\n       \'time\': DateTime(\'2005/02/14 20:03:37.250 GMT+1\')},)}\n   }\n \n-Looks quite meaningfull! To store a version just make a (deep) copy of\n+Looks quite meaningful! To store a version just make a (deep) copy of\n ``doc`` and store the copy away for later retrieval.\n \n \n@@ -243,12 +243,12 @@ Now let\'s assume we customized the ``Folder`` content type in a way we\n can use it for F.A.Q.-Page (this is a commonly used pattern in CMF/Plone\n sites, it\'s just done by defining that the ``title`` and the\n ``description`` of a document are the question part and the ``body`` is\n-the answer part. Additionaly a template ``faq_view`` showing all\n+the answer part. Additionally a template ``faq_view`` showing all\n questions at once has to be added).\n \n In step 2. above we assumed the subobjects don\'t get saved on a save\n operation of the folder. This assumption is now wrong for the F.A.Q.-Page.\n-We wan\'t the subobjects be saved in case we save the whole F.A.Q.-Page.\n+We want the subobjects be saved in case we save the whole F.A.Q.-Page.\n But how to distinguish the F.A.Q.-Page form a normal folder? The\n F.A.Q.-Page uses the same underlying code as the ``Folder``. Ok, the\n ``portal_type`` attribute has a different value (e.g. ``FAQPage``), so\n@@ -278,7 +278,7 @@ c) outside of the core of the object and *loosely related* to the object.\n    :scale: 100\n    :alt: The different areas where information can live.\n \n-We didn\'t talk about the criterias that decide to what onionskin an\n+We didn\'t talk about the criteria that decide to what onionskin an\n attribute belongs. See `Modifers`_ for this.\n \n \n@@ -296,7 +296,7 @@ So we need to intercept the copy mechanism!\n \n This can be done by using one of Pythons serializer: ``pickle``\n \n-Before continueing please read the `chapter about pickling`_ in the python\n+Before continuing please read the `chapter about pickling`_ in the python\n documentation. For those who like to have a look at the "real code" see\n ``class OMBaseModifier`` in `StandardModifier.py`_.\n \n@@ -305,20 +305,20 @@ documentation. For those who like to have a look at the "real code" see\n \n Just a short resume about pickling:\n \n-- There is a hook called ``persistent_id`` that get\'s called upon every\n+- There is a hook called ``persistent_id`` that gets called upon every\n   object during the serialization process.\n - In this hook you can decide if the object just has to be serialized as\n   usual or you may return your own serialization of it.\n-- There is another hook ``persistent_load`` that get\'s called upon every\n+- There is another hook ``persistent_load`` that gets called upon every\n   custom serialized object during the deserialization process.\n \n In case of a folder we know which of the attributes are the subobjects.\n We just keep their python id [1]_ in "mind". In the ``persistent_id`` hook\n the currently passed objects ``id`` get checked if it is one of the\n-memorized ``id``\\ s. In that case just nothing get\'s serialized and all the\n+memorized ``id``\\ s. In that case just nothing gets serialized and all the\n subobjects information will be lost (which is by intention).\n \n-During the deserializing process the ``persistent_load`` hook get\'s called\n+During the deserializing process the ``persistent_load`` hook gets called\n upon every subobject. We just return an empty version aware weak reference\n that will be initialized correctly later [2]_.\n \n@@ -351,8 +351,8 @@ As a result the original object and the clone object look the following\n   }\n \n \n-Modifers\n---------\n+Modifiers\n+---------\n \n The above job about deciding what attributes belong to the *core* and what\n attributes are *inside* or *outside references* is done by the so called\n@@ -361,7 +361,7 @@ everything application/use case specific can be hold outside of the core\n versioning framework.\n \n \n-Overwiew over the Architecture\n+Overview over the Architecture\n ==============================\n \n CMFEditions make heavily usage of the CMF(-Framework). The functionality\ndiff --git a/doc/ToDo.txt b/doc/ToDo.txt\nindex 03e1edee..9df38178 100644\n--- a/doc/ToDo.txt\n+++ b/doc/ToDo.txt\n@@ -43,7 +43,7 @@ Deferred to a Future Version\n                  resource == all versions at every location\n \n 20. Make the autoapply of the CopyModifyMergerepository a Zope property\n-    beeing editable through the ZMI.\n+    being editable through the ZMI.\n \n 39. Revert, View and Save have different permissions. This must be\n     reflected by the version_history_form only showing actions that\n@@ -58,11 +58,11 @@ Deferred to a Future Version\n 21. No unit tests yet for the "preserve" feature. Write some.\n \n 25. Write a new much simpler history storage replacing the ZVCStorage.\n-    (eventually defered to CMFEditions 1.1, depends on resources, see\n+    (eventually deferred to CMFEditions 1.1, depends on resources, see\n     also 32.)\n \n 32. Make storage unit tests subclassable to allow people writing\n-    new storages to subclass a buch of unit tests (see also 25.).\n+    new storages to subclass a bunch of unit tests (see also 25.).\n \n 16. principal: save the name or kind of unique id?\n \n@@ -88,13 +88,13 @@ Done\n \n 10. archivist: move applying the context to the repository layer\n \n-13. modifier: The modifier API is not powerfull enough to handle:\n+13. modifier: The modifier API is not powerful enough to handle:\n     - subobjects that should not be cloned by pickling (e.g. because\n       they\'re to big) and be passed to the storage by reference.\n     - enable beforeSaveModifier/afterRetrieveModifier to be able to\n       return nested/related objects to be versioned separately.\n \n-17. The archivists getHistory shall return [] for objects not beeing under\n+17. The archivists getHistory shall return [] for objects not being under\n     version control\n \n 3. terminology: rename selector --> version_id --> NO!\n@@ -125,7 +125,7 @@ Done\n     (--> gregweb/everybody, done: gregweb)\n \n 24. Remove autoregister feature from ZVCStorage.py. This is YAGNI on that\n-    level as teh archivist doesn\'t use it.\n+    level as the archivist doesn\'t use it.\n \n 15. UI: refactoring and move to new API\n     (--> reflab, done: gregweb)\n@@ -154,7 +154,7 @@ Done\n 48. ``ZVCStorageTool.py`` stores the current ``__vc_info__`` in a mapping\n     even if the operation was a retrieve. But this is correct only in the\n     case of a revert. This may end in odd behaviour if a user is just looking\n-    at an old version but continueing working on teh current one.\n+    at an old version but continuing working on the current one.\n     --> ``ZVCStorageTool.py`` should not strip the ``__vc_info__`` away.\n     Argghhh: We really should replace the ``ZVCStorageTool`` by a simpler\n     ZODB based one. In the short term we have to write a test showing the\n@@ -165,7 +165,7 @@ Done\n     116                     % history_id)\n     117\n     118         def _saveZVCInfo(self, obj, history_id):\n-    119             """Saves ZVC related informations and deletes them from the object.\n+    119             """Saves ZVC related information and deletes them from the object.\n     120             """\n     121             vc_info = deepCopy(obj.__vc_info__)\n     122  ->         self._getHistoryIdMapping()[history_id] = vc_info\n@@ -174,7 +174,7 @@ Done\n     Also add tests for a mixed behaviour.\n \n 51. ``_recursiveRetrieve``: There is currently a problem with inside_references\n-    beeing moved to outside: What do on revert when reverting an inside_reference\n+    being moved to outside: What do on revert when reverting an inside_reference\n     that has previously been moved to outside (no control over it anymore)? We\n     may end in two object having the same ``history_id`` which is **REALLY** bad.\n     The reverted inside_reference should be attached a new history!!!\n@@ -197,7 +197,7 @@ Done\n     CMFEditions 0.6.x currently offers.\n \n 56. packaging: for the release we need an updated CMF 1.5 CMFUid package\n-    (collective). --> No support for Plone 2.0.x planed anymore.\n+    (collective). --> No support for Plone 2.0.x planned anymore.\n \n 28. CopyModifyMergeRepositoryTool.py currently implements one possible\n     policy how to handle references. Build a framework for pluggable\n@@ -211,7 +211,7 @@ Done\n     time the names of the parents may have changed. But there is a\n     need to store a version aware reference to the parent.\n \n-29. Solve all XXX or replace them by TODO\'s where apropriate.\n+29. Solve all XXX or replace them by TODO\'s where appropriate.\n \n 46. Discuss naming: ``revert`` <--> ``rollback``\n \n@@ -223,9 +223,9 @@ Done\n \n - check responses for tracker issues for alpha3\n - package and publish 1.0alpha3\n-- check answers about rollback versus revert and take a decission\n+- check answers about rollback versus revert and take a decision\n   --> rename to revert\n-- check name change opinions and take a decission\n+- check name change opinions and take a decision\n   --> no name change (lack of time, too risky)\n - storage migration from alpha3 (purge support)\n - Check what the problem is with retrieve in the version view (not purge\ndiff --git a/doc/old-changelog.rst b/doc/old-changelog.rst\nindex 5f5dbfba..88f6c4b3 100644\n--- a/doc/old-changelog.rst\n+++ b/doc/old-changelog.rst\n@@ -117,7 +117,7 @@ Fixes:\n - Ported tests to plone.app.testing\n   [tomgross]\n \n-- Removed old FAQ testing code. Should go in a seperate product, if needed.\n+- Removed old FAQ testing code. Should go in a separate product, if needed.\n   [tomgross]\n \n - Frosted cleanups\n@@ -959,7 +959,7 @@ Bugs fixed\n   avoiding wrong information is attached to a working copy when\n   previewing a version. Fix for ToDo.txt item #48. [gregweb]\n \n-- Replaced all occurences of ``rollback`` with ``revert``. Brought into\n+- Replaced all occurrences of ``rollback`` with ``revert``. Brought into\n   sync internal names with UI. Rollback may suggest a transaction\n   rollback which is something different. Including i18n label\n   ``label_rollback`` which is now ``label_revert``. Added backwards\n@@ -987,7 +987,7 @@ Features Added\n - Added Polish translations provided by Piotr Furman [Piotr Furman, gregweb]\n \n - ``RetainWorkflowStateAndHistory`` now adds the ``review_state`` to the\n-  ``sys_metadata`` at save time because at retreive time the workflow tool\n+  ``sys_metadata`` at save time because at retrieve time the workflow tool\n   picks the working copies state. I didn\'t find any other way to do it\n   without digging into workflows internals (which would have been a bad\n   idea anyway). Had to extend the ``IModifier.ISaveRetrieveModifier``\n@@ -1003,7 +1003,7 @@ Features Added\n     will avoid a lot of future tracker items caused by people having\n     removed the purge policy but nevertheless providing purge support\n     to users. The reason is that the archivist and repo layer can\'t\n-    handle yet the empty placeholder object beeing returned by the\n+    handle yet the empty placeholder object being returned by the\n     storage for the purged version. This rule may be relaxed in future\n     versions if the archivist and repo layer support handling of those\n     empty placeholder objects.\n@@ -1019,8 +1019,8 @@ Features Added\n     schematas exist. Numbering counting purged versions and not\n     counting purged versions (passing True or False to ``countPurged``).\n     The default numbering schema is ``countPurged=True``. The UI\n-    history onyl shows unpurged versions (``countPurged=False``).\n-  - If the storage is asked to retreive a removed version it may be\n+    history only shows unpurged versions (``countPurged=False``).\n+  - If the storage is asked to retrieve a removed version it may be\n     instructed to return a substitute for the removed version. The\n     substitution policy itself is implemented in the new purge policy\n     tool. This strategy allows to keep most purge implementation\n@@ -1033,7 +1033,7 @@ Features Added\n     next older version. If no other version is available the next\n     newer is used as substitute. If none is available ... well this\n     isn\'t yet tested :-)\n-  - The archivist and storage may be asked to also retreive the empty\n+  - The archivist and storage may be asked to also retrieve the empty\n     placeholder of a purged version. This functionality is yet exposed\n     to the repo layer. This may change in a future release.\n   - Added ``isValid`` method on the vdata object that allows to ask if\n@@ -1042,7 +1042,7 @@ Features Added\n \n - At save time a version aware reference to the parent node is saved\n   also. Without it would be very ineffective or even impossible to\n-  find out the parents which potentially would prevent adding usefull\n+  find out the parents which potentially would prevent adding useful\n   features like retrieving the a whole site from one object in the\n   tree. [gregweb]\n \n@@ -1156,7 +1156,7 @@ Bugs fixed\n   obj.getModificationDate() because it\'s more fine graned. [gregweb]\n \n - Added ReferenceFactoriesTool.py which in essence knows how to\n-  instatiate a reference. The current implementation is inflexible and\n+  instantiate a reference. The current implementation is inflexible and\n   knows only how to instantiate object into an ObjectManager. This\n   is the first step in preparation for AT reference handling. [gregweb]\n \n@@ -1186,7 +1186,7 @@ Bugs fixed\n \n - Corrected bugs in ``RetainWorkflowStateAndHistory`` modifier and the\n   modifier registry avoiding the review state and the workflow history\n-  from beeing retained on retrieve and revert.\n+  from being retained on retrieve and revert.\n \n \n Features added\ndiff --git a/news/3333c742.internal b/news/3333c742.internal\nnew file mode 100644\nindex 00000000..c08f5399\n--- /dev/null\n+++ b/news/3333c742.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615de..acb5196c 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,3 +1,5 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [tool.towncrier]\n filename = "CHANGES.rst"\n directory = "news/"\n@@ -18,3 +20,47 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+[tool.isort]\n+profile = "plone"\n+\n+[tool.black]\n+target-version = ["py38"]\n+\n+[tool.dependencychecker]\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # Zope dependencies\n+  \'Acquisition\', \'DateTime\', \'transaction\', \'zExceptions\', \'ZODB\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.deferredimport\', \'zope.event\',\n+  \'zope.exceptions\', \'zope.globalrequest\', \'zope.i18n\', \'zope.i18nmessageid\',\n+  \'zope.interface\', \'zope.lifecycleevent\', \'zope.location\', \'zope.publisher\',\n+  \'zope.schema\', \'zope.security\', \'zope.site\', \'zope.traversing\', \'AccessControl\',\n+]\n+\'plone.base\' = [\n+  \'AccessControl\', \'Products.BTreeFolder2\', \'Products.CMFCore\',\n+  \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n+]\n+python-dateutil = [\'dateutil\']\n+ignore-packages = [\'plone.namedfile\', \'z3c.blobfile\', \'Products.CMFDiffTool\']\n+\n+[tool.codespell]\n+ignore-words-list = "discreet,alog,ist"\ndiff --git a/setup.cfg b/setup.cfg\nindex 965bc82c..0da8f8fb 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -1,9 +1,23 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [bdist_wheel]\n universal = 0\n \n-[isort]\n-# black compatible isort rules:\n-profile = black\n-force_alphabetical_sort = True\n-force_single_line = True\n-lines_after_imports = 2\n+[flake8]\n+doctests = 1\n+ignore =\n+    # black takes care of line length\n+    E501,\n+    # black takes care of where to break lines\n+    W503,\n+    # black takes care of spaces within slicing (list[:])\n+    E203,\n+    # black takes care of spaces after commas\n+    E231,\n+\n+[check-manifest]\n+ignore =\n+    .editorconfig\n+    .meta.toml\n+    .pre-commit-config.yaml\n+    tox.ini\ndiff --git a/setup.py b/setup.py\nindex c6b1ae9c..4fd659d1 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -29,7 +29,7 @@\n         "Programming Language :: Python :: 3.11",\n     ],\n     keywords="Versioning Plone",\n-    author="CMFEditions contributers",\n+    author="CMFEditions contributors",\n     author_email="collective-versioning@lists.sourceforge.net",\n     url="https://pypi.org/project/Products.CMFEditions",\n     license="GPL",\n@@ -37,27 +37,33 @@\n     namespace_packages=["Products"],\n     include_package_data=True,\n     zip_safe=False,\n+    python_requires=">=3.8",\n     extras_require=dict(\n         test=[\n+            "plone.app.contenttypes",\n+            "plone.app.robotframework",\n             "plone.app.testing",\n             "plone.app.textfield",\n-            "Products.CMFDynamicViewFTI",\n-            "zope.testing",\n+            "plone.base",\n+            "plone.testing",\n         ]\n     ),\n     install_requires=[\n-        "setuptools",\n-        "zope.copy",\n-        "zope.dottedname",\n-        "zope.i18nmessageid",\n-        "plone.base",\n+        "BTrees",\n+        "Missing",\n+        "Persistence",\n         "Products.CMFCore >=2.1",\n         "Products.CMFDiffTool",  # dependency in diff template\n         "Products.CMFUid",\n         "Products.GenericSetup >=1.4.0",\n         "Products.ZopeVersionControl",\n-        "Acquisition",\n+        "Products.statusmessages",\n         "Zope>=5",\n+        "plone.folder",\n+        "plone.locking",\n+        "setuptools",\n+        "zope.copy",\n+        "zope.dottedname",\n     ],\n     entry_points="""\n     [z3c.autoinclude.plugin]\ndiff --git a/tox.ini b/tox.ini\nnew file mode 100644\nindex 00000000..d9b6af75\n--- /dev/null\n+++ b/tox.ini\n@@ -0,0 +1,68 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+[tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n+envlist =\n+    format\n+    lint\n+    test\n+\n+[testenv]\n+allowlist_externals =\n+    sh\n+\n+[testenv:format]\n+description = automatically reformat code\n+skip_install = true\n+deps =\n+    pre-commit\n+commands =\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n+\n+[testenv:lint]\n+description = run linters that will help improve the code style\n+skip_install = true\n+deps =\n+    pre-commit\n+commands =\n+    pre-commit run -a\n+\n+[testenv:dependencies]\n+description = check if the package defines all its dependencies and generate a graph out of them\n+deps =\n+    z3c.dependencychecker==2.11\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n+commands =\n+    dependencychecker\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+\n+[testenv:test]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    zope-testrunner --all --test-path={toxinidir} -s Products.CMFEditions {posargs}\n+extras =\n+    test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s Products.CMFEditions {posargs}\n+    coverage report -m --format markdown\n+extras =\n+    test\n'

