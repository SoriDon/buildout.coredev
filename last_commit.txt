Repository: plone.subrequest


Branch: refs/heads/master
Date: 2023-03-03T21:41:59+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.subrequest/commit/8e2c79c53541ad8529e0e55c7383f9541f1ff1ca

Configuring with plone/meta

Files changed:
A .pre-commit-config.yaml
A news/13d8d6c0.internal
M .meta.toml
M setup.cfg
M tox.ini

b'diff --git a/.meta.toml b/.meta.toml\nindex 96f8c7c..8f04719 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -2,7 +2,7 @@\n # https://github.com/plone/meta/tree/master/config/default\n [meta]\n template = "default"\n-commit-id = "49620d68"\n+commit-id = "13d8d6c0"\n \n [dependencies]\n mappings = [\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 0000000..582f8ac\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,42 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.3.1\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.12.0\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 23.1.0\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.0.2\n+    hooks:\n+    -   id: zpretty\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 6.0.0\n+    hooks:\n+    -   id: flake8\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.2\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\ndiff --git a/news/13d8d6c0.internal b/news/13d8d6c0.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/13d8d6c0.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/setup.cfg b/setup.cfg\nindex 8849fbc..e70eb25 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -19,5 +19,6 @@ ignore =\n ignore =\n     .editorconfig\n     .meta.toml\n+    .pre-commit-config.yaml\n     tox.ini\n     lint-requirements.txt\ndiff --git a/tox.ini b/tox.ini\nindex c4810c9..f5d556f 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -4,47 +4,47 @@\n envlist =\n     format\n     lint\n+    test\n \n [testenv]\n-py_files = git ls-files "*.py"\n-text_files = git ls-files "*.rst" "*.md"\n allowlist_externals =\n     sh\n \n [testenv:format]\n-description = automatically reformat python code\n+description = automatically reformat code\n skip_install = true\n deps =\n-    pyupgrade\n-    isort\n-    black\n-    -c lint-requirements.txt\n+    pre-commit\n commands =\n-    sh -c \'{[testenv]py_files} | xargs pyupgrade --py38-plus\'\n-    sh -c \'{[testenv]py_files} | xargs isort\'\n-    sh -c \'{[testenv]py_files} | xargs black\'\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n \n [testenv:lint]\n description = run linters that will help improve the code style\n skip_install = true\n deps =\n-    flake8\n-    codespell\n-    tomli  # needed for codespell to read pyproject.toml\n-    check-manifest\n-    pyroma\n-    -c lint-requirements.txt\n+    pre-commit\n commands =\n-    sh -c \'{[testenv]py_files} | xargs flake8\'\n-    sh -c \'{[testenv]py_files} | xargs codespell\'\n-    sh -c \'{[testenv]text_files} | xargs codespell\'\n-    check-manifest\n-    pyroma -n 10 .\n+    pre-commit run -a\n \n [testenv:dependencies]\n-description = check if the package defines all its dependencies\n+description = check if the package defines all its dependencies and generate a graph out of them\n deps =\n-    z3c.dependencychecker\n-    -c lint-requirements.txt\n+    z3c.dependencychecker==2.11\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n commands =\n     dependencychecker\n+    sh -c \'pipdeptree --exclude setuptools,pipdeptree,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+\n+[testenv:test]\n+usedevelop = true\n+deps =\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    zope-testrunner --test-path={toxinidir} -s plone.subrequest\n+extras =\n+    test\n'

Repository: plone.subrequest


Branch: refs/heads/master
Date: 2023-03-03T21:56:41+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.subrequest/commit/0e60f1eb05f74fda3dcdef75df028914ebfb9921

fix: let tests run

Files changed:
M tox.ini

b'diff --git a/tox.ini b/tox.ini\nindex f5d556f..9e72ca6 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -43,6 +43,8 @@ commands =\n usedevelop = true\n deps =\n     zope.testrunner\n+    plone.portlets  # undeclared dependency of plone.protect\n+    Products.CMFCore  # undeclared dependency of plone.protect\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n commands =\n     zope-testrunner --test-path={toxinidir} -s plone.subrequest\n'

Repository: plone.subrequest


Branch: refs/heads/master
Date: 2023-03-03T21:56:41+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.subrequest/commit/0906c23757f715c94d40671ff46a1b4652ff9ec6

chore: zpretty

Files changed:
M plone/subrequest/testing.zcml

b'diff --git a/plone/subrequest/testing.zcml b/plone/subrequest/testing.zcml\nindex 8c7e507..594a5fa 100644\n--- a/plone/subrequest/testing.zcml\n+++ b/plone/subrequest/testing.zcml\n@@ -1,81 +1,82 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:browser="http://namespaces.zope.org/browser"\n-    xmlns:zcml="http://namespaces.zope.org/zcml">\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n+    >\n \n-    <include package="plone.subrequest" />\n+  <include package="plone.subrequest" />\n \n-    <browser:page\n-        name="cookie"\n-        for="*"\n-        class="plone.subrequest.testing.CookieView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="cookie"\n+      for="*"\n+      class="plone.subrequest.testing.CookieView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="parameter"\n-        for="*"\n-        class="plone.subrequest.testing.ParameterView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="parameter"\n+      for="*"\n+      class="plone.subrequest.testing.ParameterView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="url"\n-        for="*"\n-        class="plone.subrequest.testing.URLView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="url"\n+      for="*"\n+      class="plone.subrequest.testing.URLView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="response-write"\n-        for="*"\n-        class="plone.subrequest.testing.ResponseWriteView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="response-write"\n+      for="*"\n+      class="plone.subrequest.testing.ResponseWriteView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="error"\n-        for="*"\n-        class="plone.subrequest.testing.ErrorView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="error"\n+      for="*"\n+      class="plone.subrequest.testing.ErrorView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="root"\n-        for="OFS.Application.Application"\n-        class="plone.subrequest.testing.RootView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="root"\n+      for="OFS.Application.Application"\n+      class="plone.subrequest.testing.RootView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="test"\n-        for="*"\n-        class="plone.subrequest.testing.SubrequestView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="test"\n+      for="*"\n+      class="plone.subrequest.testing.SubrequestView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:defaultView\n-        for="OFS.Folder.Folder"\n-        name="test"\n-        />\n+  <browser:defaultView\n+      name="test"\n+      for="OFS.Folder.Folder"\n+      />\n \n-    <browser:defaultView\n-        for="OFS.Application.Application"\n-        name="root"\n-        />\n+  <browser:defaultView\n+      name="root"\n+      for="OFS.Application.Application"\n+      />\n \n-    <browser:page\n-        name="custom-error"\n-        for="*"\n-        class="plone.subrequest.testing.CustomErrorView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="custom-error"\n+      for="*"\n+      class="plone.subrequest.testing.CustomErrorView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="index.html"\n-        for="plone.subrequest.testing.CustomException"\n-        class="plone.subrequest.testing.CustomExceptionHandler"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="index.html"\n+      for="plone.subrequest.testing.CustomException"\n+      class="plone.subrequest.testing.CustomExceptionHandler"\n+      permission="zope.Public"\n+      />\n \n </configure>\n'

Repository: plone.subrequest


Branch: refs/heads/master
Date: 2023-03-07T10:49:48+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.subrequest/commit/286c1e44e8c764794727a7f25631b32973b26e8d

Merge pull request #30 from plone/config-with-default-template-240fc920

Config with default template

Files changed:
A .pre-commit-config.yaml
A news/13d8d6c0.internal
M .meta.toml
M plone/subrequest/testing.zcml
M setup.cfg
M tox.ini

b'diff --git a/.meta.toml b/.meta.toml\nindex 96f8c7c..8f04719 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -2,7 +2,7 @@\n # https://github.com/plone/meta/tree/master/config/default\n [meta]\n template = "default"\n-commit-id = "49620d68"\n+commit-id = "13d8d6c0"\n \n [dependencies]\n mappings = [\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 0000000..582f8ac\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,42 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.3.1\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.12.0\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 23.1.0\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.0.2\n+    hooks:\n+    -   id: zpretty\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 6.0.0\n+    hooks:\n+    -   id: flake8\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.2\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\ndiff --git a/news/13d8d6c0.internal b/news/13d8d6c0.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/13d8d6c0.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/plone/subrequest/testing.zcml b/plone/subrequest/testing.zcml\nindex 8c7e507..594a5fa 100644\n--- a/plone/subrequest/testing.zcml\n+++ b/plone/subrequest/testing.zcml\n@@ -1,81 +1,82 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:browser="http://namespaces.zope.org/browser"\n-    xmlns:zcml="http://namespaces.zope.org/zcml">\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n+    >\n \n-    <include package="plone.subrequest" />\n+  <include package="plone.subrequest" />\n \n-    <browser:page\n-        name="cookie"\n-        for="*"\n-        class="plone.subrequest.testing.CookieView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="cookie"\n+      for="*"\n+      class="plone.subrequest.testing.CookieView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="parameter"\n-        for="*"\n-        class="plone.subrequest.testing.ParameterView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="parameter"\n+      for="*"\n+      class="plone.subrequest.testing.ParameterView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="url"\n-        for="*"\n-        class="plone.subrequest.testing.URLView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="url"\n+      for="*"\n+      class="plone.subrequest.testing.URLView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="response-write"\n-        for="*"\n-        class="plone.subrequest.testing.ResponseWriteView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="response-write"\n+      for="*"\n+      class="plone.subrequest.testing.ResponseWriteView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="error"\n-        for="*"\n-        class="plone.subrequest.testing.ErrorView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="error"\n+      for="*"\n+      class="plone.subrequest.testing.ErrorView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="root"\n-        for="OFS.Application.Application"\n-        class="plone.subrequest.testing.RootView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="root"\n+      for="OFS.Application.Application"\n+      class="plone.subrequest.testing.RootView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="test"\n-        for="*"\n-        class="plone.subrequest.testing.SubrequestView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="test"\n+      for="*"\n+      class="plone.subrequest.testing.SubrequestView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:defaultView\n-        for="OFS.Folder.Folder"\n-        name="test"\n-        />\n+  <browser:defaultView\n+      name="test"\n+      for="OFS.Folder.Folder"\n+      />\n \n-    <browser:defaultView\n-        for="OFS.Application.Application"\n-        name="root"\n-        />\n+  <browser:defaultView\n+      name="root"\n+      for="OFS.Application.Application"\n+      />\n \n-    <browser:page\n-        name="custom-error"\n-        for="*"\n-        class="plone.subrequest.testing.CustomErrorView"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="custom-error"\n+      for="*"\n+      class="plone.subrequest.testing.CustomErrorView"\n+      permission="zope.Public"\n+      />\n \n-    <browser:page\n-        name="index.html"\n-        for="plone.subrequest.testing.CustomException"\n-        class="plone.subrequest.testing.CustomExceptionHandler"\n-        permission="zope.Public"\n-        />\n+  <browser:page\n+      name="index.html"\n+      for="plone.subrequest.testing.CustomException"\n+      class="plone.subrequest.testing.CustomExceptionHandler"\n+      permission="zope.Public"\n+      />\n \n </configure>\ndiff --git a/setup.cfg b/setup.cfg\nindex 8849fbc..e70eb25 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -19,5 +19,6 @@ ignore =\n ignore =\n     .editorconfig\n     .meta.toml\n+    .pre-commit-config.yaml\n     tox.ini\n     lint-requirements.txt\ndiff --git a/tox.ini b/tox.ini\nindex c4810c9..9e72ca6 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -4,47 +4,49 @@\n envlist =\n     format\n     lint\n+    test\n \n [testenv]\n-py_files = git ls-files "*.py"\n-text_files = git ls-files "*.rst" "*.md"\n allowlist_externals =\n     sh\n \n [testenv:format]\n-description = automatically reformat python code\n+description = automatically reformat code\n skip_install = true\n deps =\n-    pyupgrade\n-    isort\n-    black\n-    -c lint-requirements.txt\n+    pre-commit\n commands =\n-    sh -c \'{[testenv]py_files} | xargs pyupgrade --py38-plus\'\n-    sh -c \'{[testenv]py_files} | xargs isort\'\n-    sh -c \'{[testenv]py_files} | xargs black\'\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n \n [testenv:lint]\n description = run linters that will help improve the code style\n skip_install = true\n deps =\n-    flake8\n-    codespell\n-    tomli  # needed for codespell to read pyproject.toml\n-    check-manifest\n-    pyroma\n-    -c lint-requirements.txt\n+    pre-commit\n commands =\n-    sh -c \'{[testenv]py_files} | xargs flake8\'\n-    sh -c \'{[testenv]py_files} | xargs codespell\'\n-    sh -c \'{[testenv]text_files} | xargs codespell\'\n-    check-manifest\n-    pyroma -n 10 .\n+    pre-commit run -a\n \n [testenv:dependencies]\n-description = check if the package defines all its dependencies\n+description = check if the package defines all its dependencies and generate a graph out of them\n deps =\n-    z3c.dependencychecker\n-    -c lint-requirements.txt\n+    z3c.dependencychecker==2.11\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n commands =\n     dependencychecker\n+    sh -c \'pipdeptree --exclude setuptools,pipdeptree,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+\n+[testenv:test]\n+usedevelop = true\n+deps =\n+    zope.testrunner\n+    plone.portlets  # undeclared dependency of plone.protect\n+    Products.CMFCore  # undeclared dependency of plone.protect\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    zope-testrunner --test-path={toxinidir} -s plone.subrequest\n+extras =\n+    test\n'

