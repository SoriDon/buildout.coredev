Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-01-06T07:47:40+01:00
Author: Timo Stollenwerk (tisto) <tisto@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/2cbdefe6155c6ec80305b5798b719e002156929f

Add deprecation msg in docs for tiles endpoint (#1234)

* Add deprecation msg in docs for tiles endpoint

* Remove components.rst. Has been deprecated since 1.0b1.

* Add deprecation warnings on tiles endpoint

* Fix rst, black

Files changed:
M docs/source/index.rst
M docs/source/tiles.rst
M src/plone/restapi/services/tiles/get.py
D docs/source/components.rst

b'diff --git a/docs/source/components.rst b/docs/source/components.rst\ndeleted file mode 100644\nindex 21f7baf9c..000000000\n--- a/docs/source/components.rst\n+++ /dev/null\n@@ -1,8 +0,0 @@\n-Components\n-==========\n-\n-.. warning::\n-   The @components endpoint is deprecated and has been removed in plone.restapi\n-   1.0b1. :doc:`breadcrumbs` and :doc:`navigation` are now top-level endpoints.\n-\n-How to get pages components (i.e. everything but the main content), like breadcrumbs, navigations, actions, etc.\ndiff --git a/docs/source/index.rst b/docs/source/index.rst\nindex 9965fbf16..bd7f657fd 100644\n--- a/docs/source/index.rst\n+++ b/docs/source/index.rst\n@@ -40,7 +40,6 @@ plone.restapi: A RESTful hypermedia API for Plone.\n    groups\n    principals\n    roles\n-   components\n    breadcrumbs\n    navigation\n    contextnavigation\ndiff --git a/docs/source/tiles.rst b/docs/source/tiles.rst\nindex 846f5557d..cb3cde18d 100644\n--- a/docs/source/tiles.rst\n+++ b/docs/source/tiles.rst\n@@ -1,6 +1,9 @@\n Tiles\n =====\n \n+.. warning::\n+   The tiles endpoint is deprecated and will be removed in plone.restapi 9.\n+\n .. note::\n   The tiles endpoint currently match only partially (the GET endpoints) the default Plone implementation.\n \ndiff --git a/src/plone/restapi/services/tiles/get.py b/src/plone/restapi/services/tiles/get.py\nindex d2ad76606..c4af7b8b6 100644\n--- a/src/plone/restapi/services/tiles/get.py\n+++ b/src/plone/restapi/services/tiles/get.py\n@@ -3,12 +3,23 @@\n from plone.restapi.interfaces import ISerializeToJsonSummary\n from plone.restapi.services import Service\n from plone.tiles.interfaces import ITileType\n+from zope.deprecation import deprecated\n from zope.component import getMultiAdapter\n from zope.component import getUtilitiesFor\n from zope.component import getUtility\n from zope.interface import implementer\n from zope.publisher.interfaces import IPublishTraverse\n \n+import zope.deprecation\n+import warnings\n+import sys\n+\n+\n+sys.modules["plone.restapi.services.tiles"] = deprecated(\n+    zope.deprecation,\n+    "``plone.restapi.services.tiles`` is deprecated and will be removed in plone.restapi 9.",\n+)\n+\n \n @implementer(IPublishTraverse)\n class TilesGet(Service):\n@@ -22,6 +33,11 @@ def publishTraverse(self, request, name):\n         return self\n \n     def reply(self):\n+        warnings.warn(\n+            "``plone.restapi.services.tiles`` is deprecated and will be removed in plone.restapi 9.",\n+            DeprecationWarning,\n+        )\n+\n         if self.params and len(self.params) > 0:\n             self.content_type = "application/json+schema"\n             try:\n'

