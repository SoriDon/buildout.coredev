Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-09-14T08:43:33+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/f2d8813d0a1b82cd8ef3adfc0554609452b1e51c

The portal catalog will not try to index itself anymore

Fixes #3312

Files changed:
A news/3312.bugfix
M Products/CMFPlone/CatalogTool.py

b"diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py\nindex d0732672b4..17c6001ec8 100644\n--- a/Products/CMFPlone/CatalogTool.py\n+++ b/Products/CMFPlone/CatalogTool.py\n@@ -465,8 +465,11 @@ def clearFindAndRebuild(self):\n         idxs = list(self.indexes())\n \n         def indexObject(obj, path):\n-            if (base_hasattr(obj, 'reindexObject') and\n-                    safe_callable(obj.reindexObject)):\n+            if (\n+                obj != self\n+                and base_hasattr(obj, 'reindexObject')\n+                and safe_callable(obj.reindexObject)\n+            ):\n                 try:\n                     self.reindexObject(obj, idxs=idxs)\n                     # index conversions from plone.app.discussion\ndiff --git a/news/3312.bugfix b/news/3312.bugfix\nnew file mode 100644\nindex 0000000000..056cdf5453\n--- /dev/null\n+++ b/news/3312.bugfix\n@@ -0,0 +1 @@\n+The portal catalog will not try to index itself anymore [ale-rt]\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-09-14T10:14:36+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/Products.CMFPlone/commit/fcff871d0dda26ada7bad827747b1509c4da21b7

Merge pull request #3315 from plone/do-not-catalog-the-catalog

The portal catalog will not try to index itself anymore

Files changed:
A news/3312.bugfix
M Products/CMFPlone/CatalogTool.py

b"diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py\nindex d0732672b4..17c6001ec8 100644\n--- a/Products/CMFPlone/CatalogTool.py\n+++ b/Products/CMFPlone/CatalogTool.py\n@@ -465,8 +465,11 @@ def clearFindAndRebuild(self):\n         idxs = list(self.indexes())\n \n         def indexObject(obj, path):\n-            if (base_hasattr(obj, 'reindexObject') and\n-                    safe_callable(obj.reindexObject)):\n+            if (\n+                obj != self\n+                and base_hasattr(obj, 'reindexObject')\n+                and safe_callable(obj.reindexObject)\n+            ):\n                 try:\n                     self.reindexObject(obj, idxs=idxs)\n                     # index conversions from plone.app.discussion\ndiff --git a/news/3312.bugfix b/news/3312.bugfix\nnew file mode 100644\nindex 0000000000..056cdf5453\n--- /dev/null\n+++ b/news/3312.bugfix\n@@ -0,0 +1 @@\n+The portal catalog will not try to index itself anymore [ale-rt]\n"

