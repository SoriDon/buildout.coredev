Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-10-04T16:31:11-03:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/f9620a140cd114c86c159ffbff80cebe47c57b19

When compiling a bundle and including a resource from a request, open the temporary file in binary mode. fixes gh-38

Files changed:
A news/38.bugfix
M src/plone/staticresources/_scripts/_generate_gruntfile.py

b"diff --git a/news/38.bugfix b/news/38.bugfix\nnew file mode 100644\nindex 0000000..c7dc25f\n--- /dev/null\n+++ b/news/38.bugfix\n@@ -0,0 +1,3 @@\n+- When compiling a bundle and including a resource from a request, open the \n+  temporary file in binary mode.\n+  [frapell]\ndiff --git a/src/plone/staticresources/_scripts/_generate_gruntfile.py b/src/plone/staticresources/_scripts/_generate_gruntfile.py\nindex f9d6452..d11b96b 100644\n--- a/src/plone/staticresources/_scripts/_generate_gruntfile.py\n+++ b/src/plone/staticresources/_scripts/_generate_gruntfile.py\n@@ -242,7 +242,7 @@ def resource_to_dir(resource, file_type='.js'):\n                 local_file = temp_resource_folder + '/' + file_name + '.js'\n                 if isinstance(js_body, six.text_type):\n                     js_body = js_body.encode('utf-8')\n-                with open(local_file, 'w') as temp_file:\n+                with open(local_file, 'wb') as temp_file:\n                     temp_file.write(js_body)\n \n         if local_file:\n@@ -337,7 +337,7 @@ def resource_to_dir(resource, file_type='.js'):\n                 except OSError:\n                     pass\n                 local_file = temp_resource_folder + '/' + file_name + '.js'\n-                temp_file = open(local_file, 'w')\n+                temp_file = open(local_file, 'wb')\n                 if isinstance(css_body, six.text_type):\n                     css_body = css_body.encode('utf-8')\n                 temp_file.write(css_body)\n"

Repository: plone.staticresources


Branch: refs/heads/master
Date: 2019-10-08T09:47:47+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.staticresources/commit/0decfad2d778786d9144a47a747a7e66ff4ccbe6

Merge pull request #39 from plone/issue-38

Issue 38

Files changed:
A news/38.bugfix
M src/plone/staticresources/_scripts/_generate_gruntfile.py

b"diff --git a/news/38.bugfix b/news/38.bugfix\nnew file mode 100644\nindex 0000000..c7dc25f\n--- /dev/null\n+++ b/news/38.bugfix\n@@ -0,0 +1,3 @@\n+- When compiling a bundle and including a resource from a request, open the \n+  temporary file in binary mode.\n+  [frapell]\ndiff --git a/src/plone/staticresources/_scripts/_generate_gruntfile.py b/src/plone/staticresources/_scripts/_generate_gruntfile.py\nindex f9d6452..d11b96b 100644\n--- a/src/plone/staticresources/_scripts/_generate_gruntfile.py\n+++ b/src/plone/staticresources/_scripts/_generate_gruntfile.py\n@@ -242,7 +242,7 @@ def resource_to_dir(resource, file_type='.js'):\n                 local_file = temp_resource_folder + '/' + file_name + '.js'\n                 if isinstance(js_body, six.text_type):\n                     js_body = js_body.encode('utf-8')\n-                with open(local_file, 'w') as temp_file:\n+                with open(local_file, 'wb') as temp_file:\n                     temp_file.write(js_body)\n \n         if local_file:\n@@ -337,7 +337,7 @@ def resource_to_dir(resource, file_type='.js'):\n                 except OSError:\n                     pass\n                 local_file = temp_resource_folder + '/' + file_name + '.js'\n-                temp_file = open(local_file, 'w')\n+                temp_file = open(local_file, 'wb')\n                 if isinstance(css_body, six.text_type):\n                     css_body = css_body.encode('utf-8')\n                 temp_file.write(css_body)\n"

