Repository: plone.app.blob


Branch: refs/heads/master
Date: 2018-10-02T18:09:50+02:00
Author: Manuel Reinhardt (reinhardt) <reinhardt@syslab.com>
Commit: https://github.com/plone/plone.app.blob/commit/130d380108b0ab7c3ab7665eed19a58b302a6cdc

Removed usage of getObjSize script from tests.
Also declared dependency on Products.CMFPlone.
https://github.com/plone/Products.CMFPlone/issues/1801

Files changed:
M setup.py
M src/plone/app/blob/tests/test_replacements.py

b"diff --git a/setup.py b/setup.py\nindex de283fa..304a889 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -44,6 +44,7 @@ def read(*rnames):\n     platforms='Any',\n     zip_safe=False,\n     install_requires=[\n+        'Products.CMFPlone',\n         'Products.MimetypesRegistry',\n         'ZODB3 >=3.8.1',\n         'archetypes.schemaextender >=1.6',\ndiff --git a/src/plone/app/blob/tests/test_replacements.py b/src/plone/app/blob/tests/test_replacements.py\nindex 79a71d1..fe6e4ed 100644\n--- a/src/plone/app/blob/tests/test_replacements.py\n+++ b/src/plone/app/blob/tests/test_replacements.py\n@@ -19,6 +19,7 @@\n from Products.ATContentTypes.interfaces import IATFile as Z2IATFile\n from Products.ATContentTypes.interfaces import IATImage as Z2IATImage\n from Products.ATContentTypes.interfaces import image as atimage\n+from Products.CMFPlone.utils import human_readable_size\n from Products.GenericSetup.interfaces import IFilesystemExporter\n from Products.GenericSetup.interfaces import IFilesystemImporter\n from ZODB.blob import SAVEPOINT_SUFFIX\n@@ -147,7 +148,7 @@ def testCatalogAfterFileMigration(self):\n         foo = self.folder['foo']\n         brain = catalog(id='foo')[0]\n         self.assertEqual(foo.UID(), brain.UID)\n-        self.assertEqual(foo.getObjSize(), brain.getObjSize)\n+        self.assertEqual(human_readable_size(foo.get_size()), brain.getObjSize)\n         self.assertEqual(foo.getPortalTypeName(), brain.Type)\n         # compare pre-migration and current catalog data...\n         okay = ('meta_type', 'Type', 'object_provides',\n@@ -356,7 +357,7 @@ def testCatalogAfterImageMigration(self):\n         # check migrated content item\n         brain = catalog(id='foo')[0]\n         self.assertEqual(foo.UID(), brain.UID)\n-        self.assertEqual(foo.getObjSize(), brain.getObjSize)\n+        self.assertEqual(human_readable_size(foo.get_size()), brain.getObjSize)\n         self.assertEqual(foo.getPortalTypeName(), brain.Type)\n \n         # compare pre-migration and current catalog data...\n"

Repository: plone.app.blob


Branch: refs/heads/master
Date: 2018-10-02T18:14:23+02:00
Author: Manuel Reinhardt (reinhardt) <reinhardt@syslab.com>
Commit: https://github.com/plone/plone.app.blob/commit/dfaf548248d07b0416d72acae5fa96d491d643de

Added changelog entry.

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 108b728..6b07e2a 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -10,7 +10,10 @@ Breaking changes:\n \n New features:\n \n-- *add item here*\n+- Removed usage of getObjSize script from tests.\n+  Also declared dependency on Products.CMFPlone.\n+  https://github.com/plone/Products.CMFPlone/issues/1801\n+  [reinhardt]\n \n Bug fixes:\n \n'

Repository: plone.app.blob


Branch: refs/heads/master
Date: 2018-10-05T20:16:16+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.blob/commit/4de7add132898eb171c8631b8ceb5a82f79742c3

Merge pull request #52 from plone/1801-get-size

Removed usage of getObjSize script from tests.

Files changed:
M CHANGES.rst
M setup.py
M src/plone/app/blob/tests/test_replacements.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 108b728..6b07e2a 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -10,7 +10,10 @@ Breaking changes:\n \n New features:\n \n-- *add item here*\n+- Removed usage of getObjSize script from tests.\n+  Also declared dependency on Products.CMFPlone.\n+  https://github.com/plone/Products.CMFPlone/issues/1801\n+  [reinhardt]\n \n Bug fixes:\n \ndiff --git a/setup.py b/setup.py\nindex de283fa..304a889 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -44,6 +44,7 @@ def read(*rnames):\n     platforms='Any',\n     zip_safe=False,\n     install_requires=[\n+        'Products.CMFPlone',\n         'Products.MimetypesRegistry',\n         'ZODB3 >=3.8.1',\n         'archetypes.schemaextender >=1.6',\ndiff --git a/src/plone/app/blob/tests/test_replacements.py b/src/plone/app/blob/tests/test_replacements.py\nindex 79a71d1..fe6e4ed 100644\n--- a/src/plone/app/blob/tests/test_replacements.py\n+++ b/src/plone/app/blob/tests/test_replacements.py\n@@ -19,6 +19,7 @@\n from Products.ATContentTypes.interfaces import IATFile as Z2IATFile\n from Products.ATContentTypes.interfaces import IATImage as Z2IATImage\n from Products.ATContentTypes.interfaces import image as atimage\n+from Products.CMFPlone.utils import human_readable_size\n from Products.GenericSetup.interfaces import IFilesystemExporter\n from Products.GenericSetup.interfaces import IFilesystemImporter\n from ZODB.blob import SAVEPOINT_SUFFIX\n@@ -147,7 +148,7 @@ def testCatalogAfterFileMigration(self):\n         foo = self.folder['foo']\n         brain = catalog(id='foo')[0]\n         self.assertEqual(foo.UID(), brain.UID)\n-        self.assertEqual(foo.getObjSize(), brain.getObjSize)\n+        self.assertEqual(human_readable_size(foo.get_size()), brain.getObjSize)\n         self.assertEqual(foo.getPortalTypeName(), brain.Type)\n         # compare pre-migration and current catalog data...\n         okay = ('meta_type', 'Type', 'object_provides',\n@@ -356,7 +357,7 @@ def testCatalogAfterImageMigration(self):\n         # check migrated content item\n         brain = catalog(id='foo')[0]\n         self.assertEqual(foo.UID(), brain.UID)\n-        self.assertEqual(foo.getObjSize(), brain.getObjSize)\n+        self.assertEqual(human_readable_size(foo.get_size()), brain.getObjSize)\n         self.assertEqual(foo.getPortalTypeName(), brain.Type)\n \n         # compare pre-migration and current catalog data...\n"

