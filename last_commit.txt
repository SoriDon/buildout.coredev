Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-03-30T22:29:25+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/cbbe0bea9ff111c21f78823a59f3518663b824fb

Remove obsolete css files previously used in tinymce (fix #3463)

Files changed:
M Products/CMFPlone/interfaces/controlpanel.py
M Products/CMFPlone/patterns/tinymce.py

b'diff --git a/Products/CMFPlone/interfaces/controlpanel.py b/Products/CMFPlone/interfaces/controlpanel.py\nindex 7e83192f62..b46119af83 100644\n--- a/Products/CMFPlone/interfaces/controlpanel.py\n+++ b/Products/CMFPlone/interfaces/controlpanel.py\n@@ -382,18 +382,15 @@ class ITinyMCELayoutSchema(Interface):\n     content_css = schema.List(\n         title=_("Choose the CSS used in WYSIWYG Editor Area"),\n         description=_(\n-            "This option enables you to specify a custom CSS file "\n-            "that provides content CSS. "\n-            "This CSS file is the one used within the editor "\n-            "(the editable area). In addition to what is listed, "\n-            "here the plone bundle CSS and diazo themes using the "\n-            "tinymce-content-css setting are also added."\n+            "This option enables you to specify CSS files "\n+            "that will be used within the the editable area of the editor "\n+            "(e.g. ++plone++mystyles/tinymce.css). "\n+            "In addition to what is listed here, "\n+            "the barceloneta bundle CSS is also added."\n         ),\n         value_type=schema.TextLine(),\n         missing_value=[],\n-        default=[\n-            "++plone++static/components/tinymce/" "skins/lightgray/content.min.css"\n-        ],\n+        default=[],\n         required=False,\n     )\n \ndiff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py\nindex 075d7a9e40..c3d206530a 100644\n--- a/Products/CMFPlone/patterns/tinymce.py\n+++ b/Products/CMFPlone/patterns/tinymce.py\n@@ -32,7 +32,7 @@ def get_theme(self):\n         return theming_policy().get_theme()\n \n     def get_content_css(self, style_css=""):\n-        files = [f"{self.nav_root_url}/++plone++static/plone-compiled.css"]\n+        files = []\n         if style_css:\n             files.extend(style_css.split(","))\n         content_css = self.settings.content_css or []\n@@ -94,9 +94,7 @@ def get_all_style_formats(self):\n \n     def get_tiny_config(self):\n         settings = self.settings\n-        importcss_file_filter = "%s/++plone++static/tinymce-styles.css" % (\n-            self.nav_root_url\n-        )\n+        importcss_file_filter = ""\n \n         theme = self.get_theme()\n         if theme and getattr(theme, "tinymce_styles_css", None):\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-03-30T22:29:25+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/039e33f4bd435e5096e39e5b21b96d48ff9cb6ec

add changenote

Files changed:
A news/3463.bugfix

b'diff --git a/news/3463.bugfix b/news/3463.bugfix\nnew file mode 100644\nindex 0000000000..dcd5766edf\n--- /dev/null\n+++ b/news/3463.bugfix\n@@ -0,0 +1,2 @@\n+Remove obsolete css files previously used in tinymce.\n+[pbauer]\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-03-30T22:29:54+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/bf85f5042b7e7442391955083355218c79b3c479

Merge pull request #3472 from plone/cleanup_tinymce_css

Remove obsolete css files previously used in tinymce

Files changed:
A news/3463.bugfix
M Products/CMFPlone/interfaces/controlpanel.py
M Products/CMFPlone/patterns/tinymce.py

b'diff --git a/Products/CMFPlone/interfaces/controlpanel.py b/Products/CMFPlone/interfaces/controlpanel.py\nindex 7e83192f62..b46119af83 100644\n--- a/Products/CMFPlone/interfaces/controlpanel.py\n+++ b/Products/CMFPlone/interfaces/controlpanel.py\n@@ -382,18 +382,15 @@ class ITinyMCELayoutSchema(Interface):\n     content_css = schema.List(\n         title=_("Choose the CSS used in WYSIWYG Editor Area"),\n         description=_(\n-            "This option enables you to specify a custom CSS file "\n-            "that provides content CSS. "\n-            "This CSS file is the one used within the editor "\n-            "(the editable area). In addition to what is listed, "\n-            "here the plone bundle CSS and diazo themes using the "\n-            "tinymce-content-css setting are also added."\n+            "This option enables you to specify CSS files "\n+            "that will be used within the the editable area of the editor "\n+            "(e.g. ++plone++mystyles/tinymce.css). "\n+            "In addition to what is listed here, "\n+            "the barceloneta bundle CSS is also added."\n         ),\n         value_type=schema.TextLine(),\n         missing_value=[],\n-        default=[\n-            "++plone++static/components/tinymce/" "skins/lightgray/content.min.css"\n-        ],\n+        default=[],\n         required=False,\n     )\n \ndiff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py\nindex 075d7a9e40..c3d206530a 100644\n--- a/Products/CMFPlone/patterns/tinymce.py\n+++ b/Products/CMFPlone/patterns/tinymce.py\n@@ -32,7 +32,7 @@ def get_theme(self):\n         return theming_policy().get_theme()\n \n     def get_content_css(self, style_css=""):\n-        files = [f"{self.nav_root_url}/++plone++static/plone-compiled.css"]\n+        files = []\n         if style_css:\n             files.extend(style_css.split(","))\n         content_css = self.settings.content_css or []\n@@ -94,9 +94,7 @@ def get_all_style_formats(self):\n \n     def get_tiny_config(self):\n         settings = self.settings\n-        importcss_file_filter = "%s/++plone++static/tinymce-styles.css" % (\n-            self.nav_root_url\n-        )\n+        importcss_file_filter = ""\n \n         theme = self.get_theme()\n         if theme and getattr(theme, "tinymce_styles_css", None):\ndiff --git a/news/3463.bugfix b/news/3463.bugfix\nnew file mode 100644\nindex 0000000000..dcd5766edf\n--- /dev/null\n+++ b/news/3463.bugfix\n@@ -0,0 +1,2 @@\n+Remove obsolete css files previously used in tinymce.\n+[pbauer]\n\\ No newline at end of file\n'

