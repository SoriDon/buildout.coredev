Repository: plone.testing


Branch: refs/heads/master
Date: 2019-07-01T23:57:00+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.testing/commit/e078a5476cdae1c44090853ba87041acc01899de

Remove the ``ZOPETESTCASEALERT`` as it imports from ZopeTestCase and has side effects.
Fixes #64.

Files changed:
A news/67.bugfix
M src/plone/testing/zope.py

b'diff --git a/news/67.bugfix b/news/67.bugfix\nnew file mode 100644\nindex 0000000..c8edab4\n--- /dev/null\n+++ b/news/67.bugfix\n@@ -0,0 +1,3 @@\n+Remove the ``ZOPETESTCASEALERT`` as it imports from ZopeTestCase and has side effects.\n+Fixes #64.\n+[thet]\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex 6af2c81..07e95d2 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -7,7 +7,6 @@\n from plone.testing import zca\n from plone.testing import zodb\n from plone.testing._z2_testbrowser import Browser  # noqa\n-from Testing.ZopeTestCase.ZopeLite import _patched as ZOPETESTCASEALERT\n from webtest.http import StopableWSGIServer\n from Zope2.App.schema import Zope2VocabularyRegistry\n from zope.schema.vocabulary import getVocabularyRegistry\n@@ -461,11 +460,6 @@ def setUpDatabase(self):\n         that the database that is opened by Zope 2 is in fact the top of\n         the resource stack.\n         """\n-        if ZOPETESTCASEALERT:\n-            raise Exception(\'You try to run plone.testing tests together with \'\n-                            \'ZopeTestCase tests. This will result in random \'\n-                            \'failures. Convert the ZopeTestCase Tests or \'\n-                            \'do not run them together\')\n \n         import Zope2.Startup.datatypes\n         import App.config\n'

Repository: plone.testing


Branch: refs/heads/master
Date: 2019-07-03T07:27:29+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.testing/commit/137252533f9650d8dbe4203e9a6e13bc8c6d4215

Merge pull request #67 from plone/thet-fix-64-2

Remove the ``ZOPETESTCASEALERT`` as it imports from ZopeTestCase and has side effects.

Files changed:
A news/67.bugfix
M src/plone/testing/zope.py

b'diff --git a/news/67.bugfix b/news/67.bugfix\nnew file mode 100644\nindex 0000000..c8edab4\n--- /dev/null\n+++ b/news/67.bugfix\n@@ -0,0 +1,3 @@\n+Remove the ``ZOPETESTCASEALERT`` as it imports from ZopeTestCase and has side effects.\n+Fixes #64.\n+[thet]\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex 6af2c81..07e95d2 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -7,7 +7,6 @@\n from plone.testing import zca\n from plone.testing import zodb\n from plone.testing._z2_testbrowser import Browser  # noqa\n-from Testing.ZopeTestCase.ZopeLite import _patched as ZOPETESTCASEALERT\n from webtest.http import StopableWSGIServer\n from Zope2.App.schema import Zope2VocabularyRegistry\n from zope.schema.vocabulary import getVocabularyRegistry\n@@ -461,11 +460,6 @@ def setUpDatabase(self):\n         that the database that is opened by Zope 2 is in fact the top of\n         the resource stack.\n         """\n-        if ZOPETESTCASEALERT:\n-            raise Exception(\'You try to run plone.testing tests together with \'\n-                            \'ZopeTestCase tests. This will result in random \'\n-                            \'failures. Convert the ZopeTestCase Tests or \'\n-                            \'do not run them together\')\n \n         import Zope2.Startup.datatypes\n         import App.config\n'

