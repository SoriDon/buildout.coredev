Repository: plone.namedfile


Branch: refs/heads/master
Date: 2022-02-28T10:16:08+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.namedfile/commit/9c4574fff31763a3df937d3386d1af73c0349194

ImageScaling view: use guarded_orig_image to get field from a url.

Mostly, this makes the view easier to customize.
I want to use this in https://github.com/plone/plone.app.tiles/pull/50.
`plone.app.tiles` would no longer need to override the `publishTraverse` method then.

Files changed:
A news/104.bugfix
M plone/namedfile/scaling.py

b'diff --git a/news/104.bugfix b/news/104.bugfix\nnew file mode 100644\nindex 0000000..a3d3e9d\n--- /dev/null\n+++ b/news/104.bugfix\n@@ -0,0 +1,3 @@\n+``ImageScaling`` view: use ``guarded_orig_image`` to get field from a url.\n+Mostly, this makes the view easier to customize.\n+[maurits]\ndiff --git a/plone/namedfile/scaling.py b/plone/namedfile/scaling.py\nindex db2c59b..cf4133a 100644\n--- a/plone/namedfile/scaling.py\n+++ b/plone/namedfile/scaling.py\n@@ -380,7 +380,7 @@ def publishTraverse(self, request, name):\n             # otherwise `name` must refer to a field...\n             if "." in name:\n                 name, ext = name.rsplit(".", 1)\n-            value = getattr(self.context, name)\n+            value = self.guarded_orig_image(name)\n             scale_view = self._scale_view_class(\n                 self.context, self.request, data=value, fieldname=name,\n             )\n'

Repository: plone.namedfile


Branch: refs/heads/master
Date: 2022-02-28T22:51:56+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.namedfile/commit/02d18a68411897d8435a3e3ca249de164ff2b741

Merge pull request #110 from plone/maurits-image-scaling-use-guarded-orig-image

ImageScaling view: use guarded_orig_image to get field from a url.

Files changed:
A news/104.bugfix
M plone/namedfile/scaling.py

b'diff --git a/news/104.bugfix b/news/104.bugfix\nnew file mode 100644\nindex 0000000..a3d3e9d\n--- /dev/null\n+++ b/news/104.bugfix\n@@ -0,0 +1,3 @@\n+``ImageScaling`` view: use ``guarded_orig_image`` to get field from a url.\n+Mostly, this makes the view easier to customize.\n+[maurits]\ndiff --git a/plone/namedfile/scaling.py b/plone/namedfile/scaling.py\nindex db2c59b..cf4133a 100644\n--- a/plone/namedfile/scaling.py\n+++ b/plone/namedfile/scaling.py\n@@ -380,7 +380,7 @@ def publishTraverse(self, request, name):\n             # otherwise `name` must refer to a field...\n             if "." in name:\n                 name, ext = name.rsplit(".", 1)\n-            value = getattr(self.context, name)\n+            value = self.guarded_orig_image(name)\n             scale_view = self._scale_view_class(\n                 self.context, self.request, data=value, fieldname=name,\n             )\n'

