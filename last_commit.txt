Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-04-09T14:15:49+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/a43f0d9deead63c1e24c966bd0f1fa560f8058b0

Fixed unstable Markup Control Panel robot test again.

The trick seems to be to first check the allowed type that we want to add,
and then uncheck the other ones.
Otherwise you get a slightly belated validation error before pressing Save,
and the Save has no effect.

(If this does not help, we really have to add a 'Sleep  1' before pressing Save.)

Files changed:
A news/2809.bugfix
M Products/CMFPlone/tests/robot/test_controlpanel_markup.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\nindex b455c5cf4..1df997158 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n@@ -46,12 +46,11 @@ the markup control panel\n # --- WHEN -------------------------------------------------------------------\n \n I set allowed types to "${type}"\n-  [Documentation]  \'Wait until page contains  Changes saved\' is nicer, but is unstable. See https://github.com/plone/Products.CMFPlone/issues/2809\n+  with the label  ${type}   Select Checkbox\n   with the label  text/html  UnSelect Checkbox\n   with the label  text/x-web-textile  UnSelect Checkbox\n-  with the label  ${type}   Select Checkbox\n   Click Button  Save\n-  Go to  ${PLONE_URL}/@@markup-controlpanel\n+  Wait until page contains  Changes saved\n   Checkbox Should Be Selected  ${type}\n   Checkbox Should Not Be Selected  text/html\n   Checkbox Should Not Be Selected  text/x-web-textile\ndiff --git a/news/2809.bugfix b/news/2809.bugfix\nnew file mode 100644\nindex 000000000..9e3c9b8e1\n--- /dev/null\n+++ b/news/2809.bugfix\n@@ -0,0 +1 @@\n+Fixed unstable Markup Control Panel robot test again.  [maurits]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-04-09T16:12:50+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/183982b1dec33f56c4e6f5e5fe182efa6f780c91

Merge pull request #2826 from plone/maurits-issue-2809-unstable-robot-markup-2

Fixed unstable Markup Control Panel robot test again.

Files changed:
A news/2809.bugfix
M Products/CMFPlone/tests/robot/test_controlpanel_markup.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\nindex b455c5cf4..1df997158 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n@@ -46,12 +46,11 @@ the markup control panel\n # --- WHEN -------------------------------------------------------------------\n \n I set allowed types to "${type}"\n-  [Documentation]  \'Wait until page contains  Changes saved\' is nicer, but is unstable. See https://github.com/plone/Products.CMFPlone/issues/2809\n+  with the label  ${type}   Select Checkbox\n   with the label  text/html  UnSelect Checkbox\n   with the label  text/x-web-textile  UnSelect Checkbox\n-  with the label  ${type}   Select Checkbox\n   Click Button  Save\n-  Go to  ${PLONE_URL}/@@markup-controlpanel\n+  Wait until page contains  Changes saved\n   Checkbox Should Be Selected  ${type}\n   Checkbox Should Not Be Selected  text/html\n   Checkbox Should Not Be Selected  text/x-web-textile\ndiff --git a/news/2809.bugfix b/news/2809.bugfix\nnew file mode 100644\nindex 000000000..9e3c9b8e1\n--- /dev/null\n+++ b/news/2809.bugfix\n@@ -0,0 +1 @@\n+Fixed unstable Markup Control Panel robot test again.  [maurits]\n'

