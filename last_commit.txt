Repository: plone.memoize


Branch: refs/heads/master
Date: 2023-04-03T12:02:58+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.memoize/commit/64e61250e595729a0e30af39f103add75c07dc6e

Add coverage tox env.

Files changed:
M tox.ini

b'diff --git a/tox.ini b/tox.ini\nindex a3a0f54..25de9ec 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -68,3 +68,17 @@ commands =\n     zope-testrunner --all --test-path={toxinidir} -s plone.memoize {posargs}\n extras =\n     test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s plone.memoize {posargs}\n+    coverage report -m --format markdown\n+extras =\n+    test\n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2023-04-03T12:05:42+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.memoize/commit/3485139fe4fbc6ac7300562088754fc6ffb83f69

Removed more Python 2 compatibility code.

Files changed:
A news/55.internal
M plone/memoize/request.py

b'diff --git a/news/55.internal b/news/55.internal\nnew file mode 100644\nindex 0000000..b712ac0\n--- /dev/null\n+++ b/news/55.internal\n@@ -0,0 +1,2 @@\n+Removed more Python 2 compatibility code.\n+[maurits]\ndiff --git a/plone/memoize/request.py b/plone/memoize/request.py\nindex 05fe4df..43ecc3d 100644\n--- a/plone/memoize/request.py\n+++ b/plone/memoize/request.py\n@@ -3,18 +3,10 @@\n Stores values in an annotation of the request.\n """\n from functools import wraps\n+from inspect import getfullargspec\n from plone.memoize import volatile\n from zope.annotation.interfaces import IAnnotations\n \n-import inspect\n-\n-\n-try:\n-    getargspec = inspect.getfullargspec\n-except AttributeError:\n-    # for Python 2\n-    getargspec = inspect.getargspec\n-\n \n _marker = object()\n \n@@ -58,7 +50,7 @@ def store_in_annotation_of(expr):\n     def _store_in_annotation(fun, *args, **kwargs):\n         # Use expr to find out the name of the request variable\n         vars = {}\n-        spec = getargspec(fun)\n+        spec = getfullargspec(fun)\n         num_args = len(args)\n         expected_num_args = num_args\n \n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2023-04-03T23:28:15+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.memoize/commit/2bc56bad6138a212f1b2887ef3c186eadf567561

Merge pull request #30 from plone/maurits-coverage

Removed more Python 2 compatibility code, pointed to by coverage

Files changed:
A news/55.internal
M plone/memoize/request.py
M tox.ini

b'diff --git a/news/55.internal b/news/55.internal\nnew file mode 100644\nindex 0000000..b712ac0\n--- /dev/null\n+++ b/news/55.internal\n@@ -0,0 +1,2 @@\n+Removed more Python 2 compatibility code.\n+[maurits]\ndiff --git a/plone/memoize/request.py b/plone/memoize/request.py\nindex 05fe4df..43ecc3d 100644\n--- a/plone/memoize/request.py\n+++ b/plone/memoize/request.py\n@@ -3,18 +3,10 @@\n Stores values in an annotation of the request.\n """\n from functools import wraps\n+from inspect import getfullargspec\n from plone.memoize import volatile\n from zope.annotation.interfaces import IAnnotations\n \n-import inspect\n-\n-\n-try:\n-    getargspec = inspect.getfullargspec\n-except AttributeError:\n-    # for Python 2\n-    getargspec = inspect.getargspec\n-\n \n _marker = object()\n \n@@ -58,7 +50,7 @@ def store_in_annotation_of(expr):\n     def _store_in_annotation(fun, *args, **kwargs):\n         # Use expr to find out the name of the request variable\n         vars = {}\n-        spec = getargspec(fun)\n+        spec = getfullargspec(fun)\n         num_args = len(args)\n         expected_num_args = num_args\n \ndiff --git a/tox.ini b/tox.ini\nindex a3a0f54..25de9ec 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -68,3 +68,17 @@ commands =\n     zope-testrunner --all --test-path={toxinidir} -s plone.memoize {posargs}\n extras =\n     test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s plone.memoize {posargs}\n+    coverage report -m --format markdown\n+extras =\n+    test\n'

