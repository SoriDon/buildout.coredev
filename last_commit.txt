Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-02-06T14:24:55+01:00
Author: tschorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/cef29594bb8cc74eac5b2c73ecf6064ae58084ab

display warnings in fg mode

Files changed:
M CHANGES.rst
M src/plone/recipe/zope2instance/ctl.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex e41d866..ce6b9bd 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -6,6 +6,8 @@ Changelog\n \n - Use correct debug switch for WSGI.\n   (`Products.CMFPlone #2719 <https://github.com/plone/Products.CMFPlone/issues/2719>`_)\n+  Display warnings in debug mode with WSGI (override with PYTHONWARNINGS).\n+  (`Products.CMFPlone #2724 <https://github.com/plone/Products.CMFPlone/issues/2724>`_)\n   [tschorr]\n \n - Improve debugging of run scripts by providing the source code for the\ndiff --git a/src/plone/recipe/zope2instance/ctl.py b/src/plone/recipe/zope2instance/ctl.py\nindex e4ab506..0aee689 100644\n--- a/src/plone/recipe/zope2instance/ctl.py\n+++ b/src/plone/recipe/zope2instance/ctl.py\n@@ -810,7 +810,12 @@ def do_foreground(self, arg, debug=True):\n         local_additions = []\n \n         if debug:\n-            debug_switch = '-d' if self.options.wsgi else '-X'\n+            if self.options.wsgi:\n+                debug_switch = '-d'\n+                if 'PYTHONWARNINGS' not in env:\n+                    env['PYTHONWARNINGS'] = 'on'\n+            else:\n+                debug_switch = '-X'\n             if not program.count(debug_switch):\n                 local_additions += [debug_switch]\n             if not program.count('debug-mode=on'):\n"

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-02-06T16:05:58+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/58ea3753ad632f891d388f26e743e8bc92910a9e

Merge pull request #70 from plone/fg_display_deprecation_warnings

Display warnings in fg mode

Files changed:
M CHANGES.rst
M src/plone/recipe/zope2instance/ctl.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex e41d866..ce6b9bd 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -6,6 +6,8 @@ Changelog\n \n - Use correct debug switch for WSGI.\n   (`Products.CMFPlone #2719 <https://github.com/plone/Products.CMFPlone/issues/2719>`_)\n+  Display warnings in debug mode with WSGI (override with PYTHONWARNINGS).\n+  (`Products.CMFPlone #2724 <https://github.com/plone/Products.CMFPlone/issues/2724>`_)\n   [tschorr]\n \n - Improve debugging of run scripts by providing the source code for the\ndiff --git a/src/plone/recipe/zope2instance/ctl.py b/src/plone/recipe/zope2instance/ctl.py\nindex e4ab506..0aee689 100644\n--- a/src/plone/recipe/zope2instance/ctl.py\n+++ b/src/plone/recipe/zope2instance/ctl.py\n@@ -810,7 +810,12 @@ def do_foreground(self, arg, debug=True):\n         local_additions = []\n \n         if debug:\n-            debug_switch = '-d' if self.options.wsgi else '-X'\n+            if self.options.wsgi:\n+                debug_switch = '-d'\n+                if 'PYTHONWARNINGS' not in env:\n+                    env['PYTHONWARNINGS'] = 'on'\n+            else:\n+                debug_switch = '-X'\n             if not program.count(debug_switch):\n                 local_additions += [debug_switch]\n             if not program.count('debug-mode=on'):\n"

