Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2022-03-18T09:44:01+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.portlets/commit/cea2519c393bc7cc36f71119802b52d11ca6519d

Compatibility with latest z3c.form

Files changed:
M plone/app/portlets/tests/test_formextender.py

b'diff --git a/plone/app/portlets/tests/test_formextender.py b/plone/app/portlets/tests/test_formextender.py\nindex 6961f178..51fb7ada 100644\n--- a/plone/app/portlets/tests/test_formextender.py\n+++ b/plone/app/portlets/tests/test_formextender.py\n@@ -59,7 +59,7 @@ def __getattr__(self, attr):\n \n class TestSchemaExtender(PortletsTestCase):\n     def test_addform_fields(self):\n-        schema_field_names = field.Fields(news.INewsPortlet).keys()\n+        schema_field_names = [k for k in field.Fields(news.INewsPortlet).keys()]\n \n         # We use the news portlet as a random example of a portlet\n         portlet = getUtility(IPortletType, name="portlets.News")\n@@ -67,7 +67,7 @@ def test_addform_fields(self):\n         mapping = self.portal.restrictedTraverse("++contextportlets++plone.leftcolumn")\n         addview = mapping.restrictedTraverse("+/" + portlet.addview)\n         addview.update()\n-        addview_field_names = addview.fields.keys()\n+        addview_field_names = [k for k in addview.fields.keys()]\n \n         # Our addview schema before we register our extender:\n         self.assertEqual(addview_field_names, schema_field_names)\n@@ -85,7 +85,7 @@ def test_addform_fields(self):\n         mapping = self.portal.restrictedTraverse("++contextportlets++plone.leftcolumn")\n         addview = mapping.restrictedTraverse("+/" + portlet.addview)\n         addview.update()\n-        addview_field_names = addview.fields.keys()\n+        addview_field_names = [k for k in addview.fields.keys()]\n \n         gsm.unregisterAdapter(\n             PortletCssClassFormExtender,\n@@ -150,14 +150,14 @@ def test_invoke_add_form(self):\n \n     def test_editform_fields(self):\n \n-        schema_field_names = field.Fields(news.INewsPortlet).keys()\n+        schema_field_names = [k for k in field.Fields(news.INewsPortlet).keys()]\n \n         mapping = PortletAssignmentMapping()\n         request = self.folder.REQUEST\n         mapping["foo"] = news.Assignment(count=5)\n         editview = getMultiAdapter((mapping["foo"], request), name="edit")\n         editview.update()\n-        editview_field_names = editview.fields.keys()\n+        editview_field_names = [k for k in editview.fields.keys()]\n \n         # Our editview schema before we register our extender:\n         self.assertEqual(editview_field_names, schema_field_names)\n@@ -177,7 +177,7 @@ def test_editform_fields(self):\n         mapping["foo"] = news.Assignment(count=5)\n         editview = getMultiAdapter((mapping["foo"], request), name="edit")\n         editview.update()\n-        editview_field_names = editview.fields.keys()\n+        editview_field_names = [k for k in editview.fields.keys()]\n \n         gsm.unregisterAdapter(\n             PortletCssClassFormExtender,\n'

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2022-03-18T09:44:45+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.portlets/commit/7aab6904afd1b9ab12cafa72a1a83288430177e0

add changelog

Files changed:
A news/161.feature

b'diff --git a/news/161.feature b/news/161.feature\nnew file mode 100644\nindex 00000000..f9520720\n--- /dev/null\n+++ b/news/161.feature\n@@ -0,0 +1,2 @@\n+Fixes for latest z3c.form\n+[petschki]\n'

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2022-03-21T09:13:57+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/16194efcf991eab3d6d697e75afa82303b836c8c

Merge pull request #161 from plone/z3c-form-latest

Compatibility with latest z3c.form

Files changed:
A news/161.feature
M plone/app/portlets/tests/test_formextender.py

b'diff --git a/news/161.feature b/news/161.feature\nnew file mode 100644\nindex 00000000..f9520720\n--- /dev/null\n+++ b/news/161.feature\n@@ -0,0 +1,2 @@\n+Fixes for latest z3c.form\n+[petschki]\ndiff --git a/plone/app/portlets/tests/test_formextender.py b/plone/app/portlets/tests/test_formextender.py\nindex 6961f178..51fb7ada 100644\n--- a/plone/app/portlets/tests/test_formextender.py\n+++ b/plone/app/portlets/tests/test_formextender.py\n@@ -59,7 +59,7 @@ def __getattr__(self, attr):\n \n class TestSchemaExtender(PortletsTestCase):\n     def test_addform_fields(self):\n-        schema_field_names = field.Fields(news.INewsPortlet).keys()\n+        schema_field_names = [k for k in field.Fields(news.INewsPortlet).keys()]\n \n         # We use the news portlet as a random example of a portlet\n         portlet = getUtility(IPortletType, name="portlets.News")\n@@ -67,7 +67,7 @@ def test_addform_fields(self):\n         mapping = self.portal.restrictedTraverse("++contextportlets++plone.leftcolumn")\n         addview = mapping.restrictedTraverse("+/" + portlet.addview)\n         addview.update()\n-        addview_field_names = addview.fields.keys()\n+        addview_field_names = [k for k in addview.fields.keys()]\n \n         # Our addview schema before we register our extender:\n         self.assertEqual(addview_field_names, schema_field_names)\n@@ -85,7 +85,7 @@ def test_addform_fields(self):\n         mapping = self.portal.restrictedTraverse("++contextportlets++plone.leftcolumn")\n         addview = mapping.restrictedTraverse("+/" + portlet.addview)\n         addview.update()\n-        addview_field_names = addview.fields.keys()\n+        addview_field_names = [k for k in addview.fields.keys()]\n \n         gsm.unregisterAdapter(\n             PortletCssClassFormExtender,\n@@ -150,14 +150,14 @@ def test_invoke_add_form(self):\n \n     def test_editform_fields(self):\n \n-        schema_field_names = field.Fields(news.INewsPortlet).keys()\n+        schema_field_names = [k for k in field.Fields(news.INewsPortlet).keys()]\n \n         mapping = PortletAssignmentMapping()\n         request = self.folder.REQUEST\n         mapping["foo"] = news.Assignment(count=5)\n         editview = getMultiAdapter((mapping["foo"], request), name="edit")\n         editview.update()\n-        editview_field_names = editview.fields.keys()\n+        editview_field_names = [k for k in editview.fields.keys()]\n \n         # Our editview schema before we register our extender:\n         self.assertEqual(editview_field_names, schema_field_names)\n@@ -177,7 +177,7 @@ def test_editform_fields(self):\n         mapping["foo"] = news.Assignment(count=5)\n         editview = getMultiAdapter((mapping["foo"], request), name="edit")\n         editview.update()\n-        editview_field_names = editview.fields.keys()\n+        editview_field_names = [k for k in editview.fields.keys()]\n \n         gsm.unregisterAdapter(\n             PortletCssClassFormExtender,\n'

