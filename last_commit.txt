Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2016-10-18T16:43:39-04:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFEditions/commit/6dd694cede3806d1baea0ead98ef496a9e9486a5

Do not log using plone restricted python logging script

Files changed:
M CHANGES.rst
M Products/CMFEditions/browser/utils.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 58b349e..3f5e3f4 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Do not log using plone restricted python logging script.
+  [jensens]
 
 
 2.2.21 (2016-08-18)
diff --git a/Products/CMFEditions/browser/utils.py b/Products/CMFEditions/browser/utils.py
index 5d723d9..c681378 100644
--- a/Products/CMFEditions/browser/utils.py
+++ b/Products/CMFEditions/browser/utils.py
@@ -1,6 +1,10 @@
 from Acquisition import aq_inner
 from Products.Five.browser import BrowserView
 
+import logging
+
+logger = logging.getLogger(__name__)
+
 
 class GetMacros(BrowserView):
     """Get macros.
@@ -47,8 +51,9 @@ def get_macros(self, vdata):
         try:
             return versionPreviewTemplate.macros['main']
         except KeyError:
-            context.plone_log(
-                "(CMFEditions: @@get_macros) Internal error: Missing TAL "
-                "macros %s in template '%s'." % (', '.join(macro_names),
-                                                  versionPreviewMethodName))
-            return None
+            logger.warn(
+                'Missing TAL macros {0} in template "{1}".' .format(
+                    ', '.join(macro_names),
+                    versionPreviewMethodName
+                )
+            )


Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2016-10-18T19:54:26-04:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFEditions/commit/7cb131a499a41d2da9b3e02fb99b8fddfe414e7c

Merge pull request #41 from plone/sane-logging

Do not log using plone restricted python logging script

Files changed:
M CHANGES.rst
M Products/CMFEditions/browser/utils.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 58b349e..3f5e3f4 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Do not log using plone restricted python logging script.
+  [jensens]
 
 
 2.2.21 (2016-08-18)
diff --git a/Products/CMFEditions/browser/utils.py b/Products/CMFEditions/browser/utils.py
index 5d723d9..c681378 100644
--- a/Products/CMFEditions/browser/utils.py
+++ b/Products/CMFEditions/browser/utils.py
@@ -1,6 +1,10 @@
 from Acquisition import aq_inner
 from Products.Five.browser import BrowserView
 
+import logging
+
+logger = logging.getLogger(__name__)
+
 
 class GetMacros(BrowserView):
     """Get macros.
@@ -47,8 +51,9 @@ def get_macros(self, vdata):
         try:
             return versionPreviewTemplate.macros['main']
         except KeyError:
-            context.plone_log(
-                "(CMFEditions: @@get_macros) Internal error: Missing TAL "
-                "macros %s in template '%s'." % (', '.join(macro_names),
-                                                  versionPreviewMethodName))
-            return None
+            logger.warn(
+                'Missing TAL macros {0} in template "{1}".' .format(
+                    ', '.join(macro_names),
+                    versionPreviewMethodName
+                )
+            )


