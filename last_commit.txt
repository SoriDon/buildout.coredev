Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-10-22T09:05:50-04:00
Author: nathan.vangheem () <nathan.vangheem@wildcardcorp.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/faea64e1cb48e86a62e8731808aa4a4a486309fe

Fix TinyMCE table styles

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/tinymce.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ce5a65d..bb1761f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -49,6 +49,7 @@ New features:
 Bug fixes:
 
 - Avoid dependency on plone.app.imaging. [davisagli]
+- Fix TinyMCE table styles [vangheem]
 
 - Add utf8 headers to all Python source files. [jensens]
 
diff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py
index 1a05ed3..8627a1b 100644
--- a/Products/CMFPlone/patterns/tinymce.py
+++ b/Products/CMFPlone/patterns/tinymce.py
@@ -56,7 +56,7 @@ def get_style_format(self, txt, _type='format', base=None):
         if base is None:
             val = {}
         else:
-            val = base
+            val = base.copy()
         val.update({
             'title': parts[0],
             _type: parts[1]
@@ -94,7 +94,8 @@ def get_all_style_formats(self):
             'items': self.get_styles(alignment_styles)
         }, {
             'title': 'Tables',
-            'items': self.get_styles(table_styles)
+            'items': self.get_styles(
+                table_styles, 'classes', {'selector': 'table'})
         }]
 
     def get_tiny_config(self):


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-10-22T12:11:21-04:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/76df088e62e6646f57794b433f1e10c78accbc1b

Merge pull request #1790 from plone/fix-tinymce-formats

Fix TinyMCE table styles

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/tinymce.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 217e6f9..2347858 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -49,6 +49,7 @@ New features:
 Bug fixes:
 
 - Avoid dependency on plone.app.imaging. [davisagli]
+- Fix TinyMCE table styles [vangheem]
 
 - Add utf8 headers to all Python source files. [jensens]
 
diff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py
index 1a05ed3..8627a1b 100644
--- a/Products/CMFPlone/patterns/tinymce.py
+++ b/Products/CMFPlone/patterns/tinymce.py
@@ -56,7 +56,7 @@ def get_style_format(self, txt, _type='format', base=None):
         if base is None:
             val = {}
         else:
-            val = base
+            val = base.copy()
         val.update({
             'title': parts[0],
             _type: parts[1]
@@ -94,7 +94,8 @@ def get_all_style_formats(self):
             'items': self.get_styles(alignment_styles)
         }, {
             'title': 'Tables',
-            'items': self.get_styles(table_styles)
+            'items': self.get_styles(
+                table_styles, 'classes', {'selector': 'table'})
         }]
 
     def get_tiny_config(self):


