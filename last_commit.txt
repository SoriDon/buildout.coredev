Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-07-08T18:23:33+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/41f3887dcb229626cd54ce38aff2011edfc52bbb

resource registries: Fix tests after removing jquery and bootstrap bundles.

Files changed:
M Products/CMFPlone/tests/testResourceRegistries.py

b'diff --git a/Products/CMFPlone/tests/testResourceRegistries.py b/Products/CMFPlone/tests/testResourceRegistries.py\nindex 6049d5f2e1..a619d4679e 100644\n--- a/Products/CMFPlone/tests/testResourceRegistries.py\n+++ b/Products/CMFPlone/tests/testResourceRegistries.py\n@@ -79,10 +79,6 @@ def test_scripts_viewlet(self):\n         scripts = ScriptsView(self.layer["portal"], self.layer["request"], None)\n         scripts.update()\n         results = scripts.render()\n-        self.assertIn("++plone++static/bundle-plone/jquery-remote.min.js", results)\n-        self.assertIn(\n-            "++plone++static/bundle-plone/bootstrap-remote.min.js", results\n-        )\n         self.assertIn("++plone++static/bundle-plone/bundle.min.js", results)\n         self.assertIn("http://nohost/plone/++webresource++", results)\n \n@@ -91,10 +87,6 @@ def test_scripts_viewlet_anonymous(self):\n         scripts = ScriptsView(self.layer["portal"], self.layer["request"], None)\n         scripts.update()\n         results = scripts.render()\n-        self.assertIn("++plone++static/bundle-plone/jquery-remote.min.js", results)\n-        self.assertIn(\n-            "++plone++static/bundle-plone/bootstrap-remote.min.js", results\n-        )\n         self.assertIn("++plone++static/bundle-plone/bundle.min.js", results)\n         self.assertIn("http://nohost/plone/++webresource++", results)\n \n@@ -396,7 +388,7 @@ def test_controlpanel(self):\n \n     def test_add_resource(self):\n         # the last form is the add form\n-        add_form = self.browser.getForm(index=7)\n+        add_form = self.browser.getForm(index=5)\n         add_form.getControl(name="name").value = "my-resource"\n         add_form.getControl(name="jscompilation").value = "++resource++my.resource.js"\n         add_form.getControl(name="enabled").value = "checked"\n@@ -409,14 +401,14 @@ def test_add_resource(self):\n \n     def test_update_resource(self):\n         # try to set already existing name should fail\n-        form = self.browser.getForm(index=6)\n+        form = self.browser.getForm(index=4)\n         form.getControl(name="name").value = "plone"\n         form.getControl("update").click()\n \n         self.assertIn("Record name plone already taken.", self.browser.contents)\n \n         # set new name\n-        form = self.browser.getForm(index=6)\n+        form = self.browser.getForm(index=4)\n         form.getControl(name="name").value = "new-resource-name"\n         form.getControl("update").click()\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-07-09T16:10:35+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/26963cb0ea58747dd83482ab476ee54f22dea83b

Merge pull request #3576 from plone/register-globally-cleanup

resource registries: Fix tests after removing jquery and bootstrap buâ€¦

Files changed:
M Products/CMFPlone/tests/testResourceRegistries.py

b'diff --git a/Products/CMFPlone/tests/testResourceRegistries.py b/Products/CMFPlone/tests/testResourceRegistries.py\nindex 6049d5f2e1..a619d4679e 100644\n--- a/Products/CMFPlone/tests/testResourceRegistries.py\n+++ b/Products/CMFPlone/tests/testResourceRegistries.py\n@@ -79,10 +79,6 @@ def test_scripts_viewlet(self):\n         scripts = ScriptsView(self.layer["portal"], self.layer["request"], None)\n         scripts.update()\n         results = scripts.render()\n-        self.assertIn("++plone++static/bundle-plone/jquery-remote.min.js", results)\n-        self.assertIn(\n-            "++plone++static/bundle-plone/bootstrap-remote.min.js", results\n-        )\n         self.assertIn("++plone++static/bundle-plone/bundle.min.js", results)\n         self.assertIn("http://nohost/plone/++webresource++", results)\n \n@@ -91,10 +87,6 @@ def test_scripts_viewlet_anonymous(self):\n         scripts = ScriptsView(self.layer["portal"], self.layer["request"], None)\n         scripts.update()\n         results = scripts.render()\n-        self.assertIn("++plone++static/bundle-plone/jquery-remote.min.js", results)\n-        self.assertIn(\n-            "++plone++static/bundle-plone/bootstrap-remote.min.js", results\n-        )\n         self.assertIn("++plone++static/bundle-plone/bundle.min.js", results)\n         self.assertIn("http://nohost/plone/++webresource++", results)\n \n@@ -396,7 +388,7 @@ def test_controlpanel(self):\n \n     def test_add_resource(self):\n         # the last form is the add form\n-        add_form = self.browser.getForm(index=7)\n+        add_form = self.browser.getForm(index=5)\n         add_form.getControl(name="name").value = "my-resource"\n         add_form.getControl(name="jscompilation").value = "++resource++my.resource.js"\n         add_form.getControl(name="enabled").value = "checked"\n@@ -409,14 +401,14 @@ def test_add_resource(self):\n \n     def test_update_resource(self):\n         # try to set already existing name should fail\n-        form = self.browser.getForm(index=6)\n+        form = self.browser.getForm(index=4)\n         form.getControl(name="name").value = "plone"\n         form.getControl("update").click()\n \n         self.assertIn("Record name plone already taken.", self.browser.contents)\n \n         # set new name\n-        form = self.browser.getForm(index=6)\n+        form = self.browser.getForm(index=4)\n         form.getControl(name="name").value = "new-resource-name"\n         form.getControl("update").click()\n \n'

