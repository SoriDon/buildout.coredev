Repository: plone.session


Branch: refs/heads/master
Date: 2023-03-11T18:03:19+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.session/commit/71ab353880c6e814d767e6393d61a6afea450b1d

Fix circular dependency on CMFPlone.

Files changed:
M plone/session/configure.zcml
M plone/session/hiddenprofiles.py
M plone/session/profiles/default/registry.xml
M plone/session/profiles/uninstall/registry.xml
M setup.py

b'diff --git a/plone/session/configure.zcml b/plone/session/configure.zcml\nindex 0b40a0e..844cbb2 100644\n--- a/plone/session/configure.zcml\n+++ b/plone/session/configure.zcml\n@@ -12,7 +12,7 @@\n   <include file="resources.zcml" />\n   <include\n       file="profiles.zcml"\n-      zcml:condition="installed Products.CMFPlone"\n+      zcml:condition="installed plone.base"\n   />\n \n </configure>\ndiff --git a/plone/session/hiddenprofiles.py b/plone/session/hiddenprofiles.py\nindex 1068269..a950d72 100644\n--- a/plone/session/hiddenprofiles.py\n+++ b/plone/session/hiddenprofiles.py\n@@ -1,4 +1,4 @@\n-from Products.CMFPlone.interfaces import INonInstallable\n+from plone.base.interfaces import INonInstallable\n from zope.interface import implementer\n \n \ndiff --git a/plone/session/profiles/default/registry.xml b/plone/session/profiles/default/registry.xml\nindex 2031f0e..f3426b8 100644\n--- a/plone/session/profiles/default/registry.xml\n+++ b/plone/session/profiles/default/registry.xml\n@@ -6,7 +6,7 @@\n   ===============================\n   -->\n   <records\n-      interface="Products.CMFPlone.interfaces.IBundleRegistry"\n+      interface="plone.base.interfaces.IBundleRegistry"\n       prefix="plone.bundles/plone-session">\n     <value key="enabled">True</value>\n     <value key="jscompilation">++resource++plone.session.refreshsupport.js</value>\ndiff --git a/plone/session/profiles/uninstall/registry.xml b/plone/session/profiles/uninstall/registry.xml\nindex 6dfe299..f82bf15 100644\n--- a/plone/session/profiles/uninstall/registry.xml\n+++ b/plone/session/profiles/uninstall/registry.xml\n@@ -2,7 +2,7 @@\n <registry>\n \n   <records\n-      interface="Products.CMFPlone.interfaces.IBundleRegistry"\n+      interface="plone.base.interfaces.IBundleRegistry"\n       prefix="plone.bundles/plone-session"\n       remove="true">\n   </records>\ndiff --git a/setup.py b/setup.py\nindex 5a10e4f..6447eeb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -45,15 +45,11 @@\n         ]\n     ),\n     install_requires=[\n-        "AccessControl",\n         "plone.keyring",\n         "plone.protect",\n         "Products.GenericSetup",\n-        "Products.CMFPlone",\n         "Products.PluggableAuthService",\n         "setuptools",\n-        "zope.component",\n-        "zope.interface",\n         "Zope",\n     ],\n )\n'

Repository: plone.session


Branch: refs/heads/master
Date: 2023-03-11T18:04:05+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.session/commit/866bfceaddd288b1931d278745068808c3574b27

black

Files changed:
M plone/session/tests/testPAS.py
M plone/session/tktauth.py

b'diff --git a/plone/session/tests/testPAS.py b/plone/session/tests/testPAS.py\nindex 97674f8..8872042 100644\n--- a/plone/session/tests/testPAS.py\n+++ b/plone/session/tests/testPAS.py\n@@ -27,7 +27,6 @@ def setCookie(\n \n \n class TestSessionPlugin(unittest.TestCase):\n-\n     layer = PLONE_SEESION_FUNCTIONAL_TESTING\n     userid = "jbloggs"\n \ndiff --git a/plone/session/tktauth.py b/plone/session/tktauth.py\nindex 85b817f..0637c09 100755\n--- a/plone/session/tktauth.py\n+++ b/plone/session/tktauth.py\n@@ -163,7 +163,7 @@ def safe_text(value, encoding="utf-8"):\n     elif isinstance(value, bytes):\n         try:\n             value = str(value, encoding)\n-        except (UnicodeDecodeError):\n+        except UnicodeDecodeError:\n             value = value.decode("utf-8", "replace")\n     return value\n \n'

Repository: plone.session


Branch: refs/heads/master
Date: 2023-03-11T18:04:51+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.session/commit/e4eada2bc54e98277dc5a3fc050f81cfb5ddde3c

document changes

Files changed:
A news/38.bugfix

b'diff --git a/news/38.bugfix b/news/38.bugfix\nnew file mode 100644\nindex 0000000..ead4a22\n--- /dev/null\n+++ b/news/38.bugfix\n@@ -0,0 +1,2 @@\n+Remove circular dependency on Products.CMFPlone. Use moved imports from plone.base instead.\n+[jensens]\n'

Repository: plone.session


Branch: refs/heads/master
Date: 2023-03-11T22:49:56+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.session/commit/c9bd6da9319cfced7513ec9a1d4c2b67e8fe1882

Merge pull request #38 from plone/fix-circular-dependency-CMFPlone

Fix circular dependency on CMFPlone.

Files changed:
A news/38.bugfix
M plone/session/configure.zcml
M plone/session/hiddenprofiles.py
M plone/session/profiles/default/registry.xml
M plone/session/profiles/uninstall/registry.xml
M plone/session/tests/testPAS.py
M plone/session/tktauth.py
M setup.py

b'diff --git a/news/38.bugfix b/news/38.bugfix\nnew file mode 100644\nindex 0000000..ead4a22\n--- /dev/null\n+++ b/news/38.bugfix\n@@ -0,0 +1,2 @@\n+Remove circular dependency on Products.CMFPlone. Use moved imports from plone.base instead.\n+[jensens]\ndiff --git a/plone/session/configure.zcml b/plone/session/configure.zcml\nindex 0b40a0e..844cbb2 100644\n--- a/plone/session/configure.zcml\n+++ b/plone/session/configure.zcml\n@@ -12,7 +12,7 @@\n   <include file="resources.zcml" />\n   <include\n       file="profiles.zcml"\n-      zcml:condition="installed Products.CMFPlone"\n+      zcml:condition="installed plone.base"\n   />\n \n </configure>\ndiff --git a/plone/session/hiddenprofiles.py b/plone/session/hiddenprofiles.py\nindex 1068269..a950d72 100644\n--- a/plone/session/hiddenprofiles.py\n+++ b/plone/session/hiddenprofiles.py\n@@ -1,4 +1,4 @@\n-from Products.CMFPlone.interfaces import INonInstallable\n+from plone.base.interfaces import INonInstallable\n from zope.interface import implementer\n \n \ndiff --git a/plone/session/profiles/default/registry.xml b/plone/session/profiles/default/registry.xml\nindex 2031f0e..f3426b8 100644\n--- a/plone/session/profiles/default/registry.xml\n+++ b/plone/session/profiles/default/registry.xml\n@@ -6,7 +6,7 @@\n   ===============================\n   -->\n   <records\n-      interface="Products.CMFPlone.interfaces.IBundleRegistry"\n+      interface="plone.base.interfaces.IBundleRegistry"\n       prefix="plone.bundles/plone-session">\n     <value key="enabled">True</value>\n     <value key="jscompilation">++resource++plone.session.refreshsupport.js</value>\ndiff --git a/plone/session/profiles/uninstall/registry.xml b/plone/session/profiles/uninstall/registry.xml\nindex 6dfe299..f82bf15 100644\n--- a/plone/session/profiles/uninstall/registry.xml\n+++ b/plone/session/profiles/uninstall/registry.xml\n@@ -2,7 +2,7 @@\n <registry>\n \n   <records\n-      interface="Products.CMFPlone.interfaces.IBundleRegistry"\n+      interface="plone.base.interfaces.IBundleRegistry"\n       prefix="plone.bundles/plone-session"\n       remove="true">\n   </records>\ndiff --git a/plone/session/tests/testPAS.py b/plone/session/tests/testPAS.py\nindex 97674f8..8872042 100644\n--- a/plone/session/tests/testPAS.py\n+++ b/plone/session/tests/testPAS.py\n@@ -27,7 +27,6 @@ def setCookie(\n \n \n class TestSessionPlugin(unittest.TestCase):\n-\n     layer = PLONE_SEESION_FUNCTIONAL_TESTING\n     userid = "jbloggs"\n \ndiff --git a/plone/session/tktauth.py b/plone/session/tktauth.py\nindex 85b817f..0637c09 100755\n--- a/plone/session/tktauth.py\n+++ b/plone/session/tktauth.py\n@@ -163,7 +163,7 @@ def safe_text(value, encoding="utf-8"):\n     elif isinstance(value, bytes):\n         try:\n             value = str(value, encoding)\n-        except (UnicodeDecodeError):\n+        except UnicodeDecodeError:\n             value = value.decode("utf-8", "replace")\n     return value\n \ndiff --git a/setup.py b/setup.py\nindex 5a10e4f..6447eeb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -45,15 +45,11 @@\n         ]\n     ),\n     install_requires=[\n-        "AccessControl",\n         "plone.keyring",\n         "plone.protect",\n         "Products.GenericSetup",\n-        "Products.CMFPlone",\n         "Products.PluggableAuthService",\n         "setuptools",\n-        "zope.component",\n-        "zope.interface",\n         "Zope",\n     ],\n )\n'

