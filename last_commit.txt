Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2015-11-23T09:13:00-03:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/3f07781675f23be6e3e2b61264947fd9ad70c393

Update Site Setup link in all control panels (fixes plone/Products.CMFPlone#1255)

Files changed:
M CHANGES.rst
M plone/app/discussion/browser/controlpanel.pt
M plone/app/discussion/tests/functional_test_comments.txt

diff --git a/CHANGES.rst b/CHANGES.rst
index bc6a2a1..8cb33dd 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,6 +10,9 @@ New:
 
 Fixes:
 
+- Update Site Setup link in all control panels (fixes https://github.com/plone/Products.CMFPlone/issues/1255)
+  [davilima6]
+
 - Move translations to plone.app.locales
   https://github.com/plone/plone.app.discussion/issues/66
   [gforcada]
diff --git a/plone/app/discussion/browser/controlpanel.pt b/plone/app/discussion/browser/controlpanel.pt
index f050f5a..b389c24 100644
--- a/plone/app/discussion/browser/controlpanel.pt
+++ b/plone/app/discussion/browser/controlpanel.pt
@@ -5,13 +5,11 @@
       lang="en"
       metal:use-macro="here/prefs_main_template/macros/master"
       i18n:domain="plone">
-
 <body>
 <article id="content"
      tal:attributes="class view/settings"
      metal:fill-slot="prefs_configlet_content">
 
-
     <div class="portalMessage warning"
         tal:condition="view/mailhost_warning">
         <strong i18n:translate="">
@@ -74,9 +72,8 @@
       Portal status message
     </div>
 
-    <a href=""
-       id="setup-link"
-       tal:attributes="href string:$portal_url/plone_control_panel"
+    <a id="setup-link" class="link-parent"
+       tal:attributes="href string:$portal_url/@@overview-controlpanel"
        i18n:translate="">
         Site Setup
     </a>
@@ -92,6 +89,7 @@
   <script type="text/javascript"
           tal:attributes="src string:${context/portal_url}/++resource++plone.app.discussion.javascripts/controlpanel.js">
   </script>
+
 </article>
 </body>
 </html>
diff --git a/plone/app/discussion/tests/functional_test_comments.txt b/plone/app/discussion/tests/functional_test_comments.txt
index 56b8736..ccdb4ff 100644
--- a/plone/app/discussion/tests/functional_test_comments.txt
+++ b/plone/app/discussion/tests/functional_test_comments.txt
@@ -262,7 +262,7 @@ Log in as admin
 
 Use the Plone control panel to enable comment editing.
 
-    >>> browser.open(portal_url + '/plone_control_panel')
+    >>> browser.open(portal_url + '/@@overview-controlpanel')
     >>> browser.getLink('Discussion').click()
     >>> browser.getControl('Enable editing of comments').selected = True
     >>> browser.getControl(name='form.buttons.save').click()


Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2015-11-25T01:39:33+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/plone.app.discussion/commit/a2439609c696755b3c29f5f897090a333c3083ce

Merge pull request #75 from plone/fix_sitesetup_link

Update Site Setup link in all control panels

Files changed:
M CHANGES.rst
M plone/app/discussion/browser/controlpanel.pt
M plone/app/discussion/tests/functional_test_comments.txt

diff --git a/CHANGES.rst b/CHANGES.rst
index bc6a2a1..8cb33dd 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,6 +10,9 @@ New:
 
 Fixes:
 
+- Update Site Setup link in all control panels (fixes https://github.com/plone/Products.CMFPlone/issues/1255)
+  [davilima6]
+
 - Move translations to plone.app.locales
   https://github.com/plone/plone.app.discussion/issues/66
   [gforcada]
diff --git a/plone/app/discussion/browser/controlpanel.pt b/plone/app/discussion/browser/controlpanel.pt
index f050f5a..b389c24 100644
--- a/plone/app/discussion/browser/controlpanel.pt
+++ b/plone/app/discussion/browser/controlpanel.pt
@@ -5,13 +5,11 @@
       lang="en"
       metal:use-macro="here/prefs_main_template/macros/master"
       i18n:domain="plone">
-
 <body>
 <article id="content"
      tal:attributes="class view/settings"
      metal:fill-slot="prefs_configlet_content">
 
-
     <div class="portalMessage warning"
         tal:condition="view/mailhost_warning">
         <strong i18n:translate="">
@@ -74,9 +72,8 @@
       Portal status message
     </div>
 
-    <a href=""
-       id="setup-link"
-       tal:attributes="href string:$portal_url/plone_control_panel"
+    <a id="setup-link" class="link-parent"
+       tal:attributes="href string:$portal_url/@@overview-controlpanel"
        i18n:translate="">
         Site Setup
     </a>
@@ -92,6 +89,7 @@
   <script type="text/javascript"
           tal:attributes="src string:${context/portal_url}/++resource++plone.app.discussion.javascripts/controlpanel.js">
   </script>
+
 </article>
 </body>
 </html>
diff --git a/plone/app/discussion/tests/functional_test_comments.txt b/plone/app/discussion/tests/functional_test_comments.txt
index 56b8736..ccdb4ff 100644
--- a/plone/app/discussion/tests/functional_test_comments.txt
+++ b/plone/app/discussion/tests/functional_test_comments.txt
@@ -262,7 +262,7 @@ Log in as admin
 
 Use the Plone control panel to enable comment editing.
 
-    >>> browser.open(portal_url + '/plone_control_panel')
+    >>> browser.open(portal_url + '/@@overview-controlpanel')
     >>> browser.getLink('Discussion').click()
     >>> browser.getControl('Enable editing of comments').selected = True
     >>> browser.getControl(name='form.buttons.save').click()


