Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2017-11-17T11:58:02+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.PlonePAS/commit/7c310fe4e71e5196aa96fa2c08eecbe3dd5ef821

Fix imports for py3

Files changed:
M CHANGES.rst
M setup.py
M src/Products/PlonePAS/browser/info.py
M src/Products/PlonePAS/browser/member.py
M src/Products/PlonePAS/browser/search.py
M src/Products/PlonePAS/tests/dummy.py
M src/Products/PlonePAS/tests/test_memberdatatool.py
M src/Products/PlonePAS/tests/test_membershiptool.py
M src/Products/PlonePAS/tools/membership.py
M src/Products/PlonePAS/utils.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 3d19f29..f605b65 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -12,7 +12,8 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- Make imports work with python 3
+  [pbauer]
 
 Bug fixes:
 
diff --git a/setup.py b/setup.py
index 84c6f80..db61704 100644
--- a/setup.py
+++ b/setup.py
@@ -18,6 +18,7 @@
         'Products.GenericSetup',
         'Products.PluggableAuthService',
         'setuptools',
+        'six',
         'zope.deprecation',
         'Zope2 >=2.13.22',
     ]
diff --git a/src/Products/PlonePAS/browser/info.py b/src/Products/PlonePAS/browser/info.py
index 01a0342..7bcd8cd 100644
--- a/src/Products/PlonePAS/browser/info.py
+++ b/src/Products/PlonePAS/browser/info.py
@@ -1,12 +1,11 @@
 # -*- coding: utf-8 -*-
 from Acquisition import aq_inner
+from plone.memoize.instance import memoize
 from Products.CMFCore.utils import getToolByName
 from Products.Five import BrowserView
 from Products.PlonePAS.interfaces.browser import IPASInfoView
 from Products.PluggableAuthService.interfaces.plugins import IExtractionPlugin
-from Products.PluggableAuthService.interfaces.plugins \
-    import ILoginPasswordExtractionPlugin
-from plone.memoize.instance import memoize
+from Products.PluggableAuthService.interfaces.plugins import ILoginPasswordExtractionPlugin  # noqa: E501
 from zope.interface import implementer
 
 
diff --git a/src/Products/PlonePAS/browser/member.py b/src/Products/PlonePAS/browser/member.py
index b0fcfa6..311f14d 100644
--- a/src/Products/PlonePAS/browser/member.py
+++ b/src/Products/PlonePAS/browser/member.py
@@ -1,7 +1,7 @@
 # -*- coding: utf-8 -*-
+from plone.memoize.instance import memoize
 from Products.CMFCore.utils import getToolByName
 from Products.PlonePAS.interfaces.browser import IPASMemberView
-from plone.memoize.instance import memoize
 from zope.interface import implementer
 from zope.publisher.browser import BrowserView
 
diff --git a/src/Products/PlonePAS/browser/search.py b/src/Products/PlonePAS/browser/search.py
index b2d0b00..25d67d9 100644
--- a/src/Products/PlonePAS/browser/search.py
+++ b/src/Products/PlonePAS/browser/search.py
@@ -1,8 +1,8 @@
 # -*- coding: utf-8 -*-
+from plone.i18n.normalizer.interfaces import IIDNormalizer
 from Products.CMFCore.utils import getToolByName
 from Products.Five import BrowserView
 from Products.PlonePAS.interfaces.browser import IPASSearchView
-from plone.i18n.normalizer.interfaces import IIDNormalizer
 from zope.component import queryUtility
 from zope.interface import implementer
 
diff --git a/src/Products/PlonePAS/tests/dummy.py b/src/Products/PlonePAS/tests/dummy.py
index e6d2e78..5c7a8c3 100644
--- a/src/Products/PlonePAS/tests/dummy.py
+++ b/src/Products/PlonePAS/tests/dummy.py
@@ -1,6 +1,6 @@
 # -*- coding: utf-8 -*-
 from OFS.SimpleItem import SimpleItem
-from StringIO import StringIO
+from six import StringIO
 from ZPublisher.HTTPRequest import FileUpload
 
 TEXT = 'file data'
diff --git a/src/Products/PlonePAS/tests/test_memberdatatool.py b/src/Products/PlonePAS/tests/test_memberdatatool.py
index b7ae400..440322a 100644
--- a/src/Products/PlonePAS/tests/test_memberdatatool.py
+++ b/src/Products/PlonePAS/tests/test_memberdatatool.py
@@ -1,9 +1,9 @@
 # -*- coding: utf-8 -*-
 from DateTime import DateTime
 from OFS.Image import Image
+from plone.app.testing import TEST_USER_ID as default_user
 from Products.PlonePAS.tests import base
 from Products.PlonePAS.tests import dummy
-from plone.app.testing import TEST_USER_ID as default_user
 
 
 class TestMemberDataTool(base.TestCase):
diff --git a/src/Products/PlonePAS/tests/test_membershiptool.py b/src/Products/PlonePAS/tests/test_membershiptool.py
index 8438b70..3616979 100644
--- a/src/Products/PlonePAS/tests/test_membershiptool.py
+++ b/src/Products/PlonePAS/tests/test_membershiptool.py
@@ -1,11 +1,16 @@
 # -*- coding: utf-8 -*-
-from AccessControl import Unauthorized
 from AccessControl import getSecurityManager
+from AccessControl import Unauthorized
 from AccessControl.User import nobody
 from Acquisition import aq_base
 from Acquisition import aq_parent
 from DateTime import DateTime
 from OFS.Image import Image
+from plone.app.testing import PLONE_SITE_ID
+from plone.app.testing import SITE_OWNER_NAME
+from plone.app.testing import TEST_USER_ID
+from plone.app.testing import TEST_USER_NAME
+from plone.app.testing import TEST_USER_PASSWORD
 from Products.CMFCore.utils import getToolByName
 from Products.PlonePAS.browser.member import PASMemberView
 from Products.PlonePAS.interfaces.membership import IMembershipTool
@@ -15,13 +20,9 @@
 from Products.PlonePAS.tools.memberdata import MemberData
 from Products.PlonePAS.tools.membership import MembershipTool
 from Products.PlonePAS.utils import getGroupsForPrincipal
-from cStringIO import StringIO
-from plone.app.testing import PLONE_SITE_ID
-from plone.app.testing import SITE_OWNER_NAME
-from plone.app.testing import TEST_USER_ID
-from plone.app.testing import TEST_USER_NAME
-from plone.app.testing import TEST_USER_PASSWORD
+from six import StringIO
 from zExceptions import BadRequest
+
 import os
 
 
diff --git a/src/Products/PlonePAS/tools/membership.py b/src/Products/PlonePAS/tools/membership.py
index c6be3af..9fcaa82 100644
--- a/src/Products/PlonePAS/tools/membership.py
+++ b/src/Products/PlonePAS/tools/membership.py
@@ -30,13 +30,14 @@
 from Products.PlonePAS.utils import safe_unicode
 from Products.PlonePAS.utils import scale_image
 from ZODB.POSException import ConflictError
-from cStringIO import StringIO
 from plone.protect.interfaces import IDisableCSRFProtection
+from six import StringIO
 from zExceptions import BadRequest
 from zope import event
 from zope.component import getUtility
 from zope.interface import alsoProvides
 from zope.interface import implementer
+
 import logging
 import transaction
 
diff --git a/src/Products/PlonePAS/utils.py b/src/Products/PlonePAS/utils.py
index 6f0db2f..7834830 100644
--- a/src/Products/PlonePAS/utils.py
+++ b/src/Products/PlonePAS/utils.py
@@ -1,7 +1,7 @@
 # -*- coding: utf-8 -*-
 from Products.PlonePAS.config import IMAGE_SCALE_PARAMS
 from Products.PluggableAuthService.interfaces.plugins import IGroupsPlugin
-from cStringIO import StringIO
+from six import StringIO
 from urllib import quote as url_quote
 from urllib import unquote as url_unquote
 
@@ -43,7 +43,7 @@ def scale_image(image_file, max_size=None, default_format=None):
 
         >>> from Products.PlonePAS import config
         >>> import os
-        >>> from StringIO import StringIO
+        >>> from six import StringIO
         >>> from Products.PlonePAS.utils import scale_image
         >>> from PIL import Image
 


