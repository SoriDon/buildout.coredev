Repository: plone.restapi


Branch: refs/heads/master
Date: 2019-05-09T17:37:49+02:00
Author: Timo Stollenwerk (tisto) <stollenwerk@kitconcept.com>
Commit: https://github.com/plone/plone.restapi/commit/4ce3e037ec63431d726ec454e2fa7834a2688f1f

Update upgrade guide for 4.0.0 release.

Files changed:
M CHANGES.rst
M docs/source/upgrade-guide.rst
M news/535.breaking

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 033cdc7d..87312b33 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -69,7 +69,7 @@ Bug fixes:\n   [ajung]\n \n - Hide performance, testing, and tiles profile. (#700)\n-  [Timo]\n+  [timo]\n \n \n 3.8.0 (2019-03-21)\ndiff --git a/docs/source/upgrade-guide.rst b/docs/source/upgrade-guide.rst\nindex 173141c2..e4bf72d6 100644\n--- a/docs/source/upgrade-guide.rst\n+++ b/docs/source/upgrade-guide.rst\n@@ -7,16 +7,22 @@ This upgrade guide lists all breaking changes in plone.restapi and explains the\n Upgrading to plone.restapi 4.x\n ------------------------------\n \n+plone.restapi 4.0.0 introduces the following breaking changes:\n+\n+1) Fields with vocabularies now return the `token` and `title` instead of the stored value.\n+2) Choice and list fields return a hyperlink to a vocabulary instead of `choices`, `enum`, and `enumNames`.\n+3) Serialize widget parameters into a ``widgetOptions`` object instead of adding them to the top level of the schema property.\n+4) The vocabularies endpoint does no longer returns an ``@id`` for terms, the results are batched, and terms are now listed as ``items`` instead of ``terms`` to match other batched responses.\n+\n+\n Serialization and Deserialization of fields with vocabularies\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-The serialization of fields with vocabularies (e.g. ``Choice``) now returns the\n+The serialization of fields with vocabularies (e.g. ``Choice``) now return the\n `token` and the `title` of the vocabulary term instead of the stored value.\n This is allows displaying the term (title) without additionally querying the\n vocabulary. However it\'s necessary to adopt existing client implementations.\n \n-Example:\n-\n The date and time controlpanel previously returned a number for the\n ``first_weekday`` property::\n \n@@ -47,12 +53,13 @@ Now it returns an object with a token and a title::\n \n Deserialization accepts objects that contain a token, but also just the token\n or the value.\n+\n However it\'s highly recommended to always use the token as vocabulary terms\n may contain values that are not JSON serializable.\n \n \n-Vocabularies\n-^^^^^^^^^^^^\n+Choice and List fields return link to vocabulary instead of the values\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n Choice and List fields using named vocabularies are now serialized\n with a ``vocabulary`` property giving the URL of the ``@vocabularies``\n@@ -86,8 +93,10 @@ New response::\n         "@id": "http://localhost:55001/plone/@vocabularies/plone.app.discussion.vocabularies.CaptchaVocabulary"\n     },\n \n-  - Serialize widget parameters into a ``widgetOptions`` object\n-    instead of adding them to the top level of the schema property.\n+Serialize widget parameters into a ``widgetOptions`` object\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+Serialize widget parameters into a ``widgetOptions`` object instead of adding them to the top level of the schema property.\n \n Old response::\n \n@@ -102,6 +111,7 @@ New response::\n         "vocabulary": { "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.Users" }\n       }\n \n+\n Example: Vocabularies Subjects Field\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n@@ -111,9 +121,9 @@ of ``string`` items using the ``plone.app.vocabularies.Keywords`` vocabulary.\n Old response::\n \n     "subjects": {\n-      "choices": [],\n-      "enum": [],\n-      "enumNames": [],\n+      "choices": [...],\n+      "enum": [...],\n+      "enumNames": [...],\n     }\n     "type": "string"\n \n@@ -292,13 +302,6 @@ New response::\n     }\n \n \n-New Features:\n-\n-- ``@vocabularies`` service: Use ``query`` parameter to filter terms by title\n-  (case-insensitive).\n-  [davisagli]\n-\n-\n Upgrading to plone.restapi 3.x\n ------------------------------\n \ndiff --git a/news/535.breaking b/news/535.breaking\nindex a95ca829..95d8ab46 100644\n--- a/news/535.breaking\n+++ b/news/535.breaking\n@@ -1,8 +1,11 @@\n @vocabularies service: No longer returns an @id for terms. Results are batched, and terms are now listed as items instead of terms to match other batched responses. Batch size is 25 by default but can be overridden using the b_size parameter.\n [davisagli]\n \n-@types service: Choice fields using named vocabularies are now serialized with a vocabulary property giving the URL of the @vocabularies endpoint for the vocabulary instead of including choices, enum and enumNames inline. The subjects field is now serialized as an array of string items using the plone.app.vocabularies.Keywords vocabulary. \n+@types service: Choice fields using named vocabularies are now serialized with a vocabulary property giving the URL of the @vocabularies endpoint for the vocabulary instead of including choices, enum and enumNames inline. The subjects field is now serialized as an array of string items using the plone.app.vocabularies.Keywords vocabulary.\n [davisagli]\n \n Serialize widget parameters into a widgetOptions object instead of adding them to the top level of the schema property.\n [davisagli]\n+\n+Add `title` and `token` filter to the vocabularies endpoint.\n+[davisagli, sneridagh, timo]\n\\ No newline at end of file\n'

