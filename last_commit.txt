Repository: plone.namedfile


Branch: refs/heads/master
Date: 2022-11-21T10:14:06+02:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.namedfile/commit/dbd9ed928cc7cd12101f756680772b2bf8cb6dd2

return original image data if want_original is set

Files changed:
M plone/namedfile/scaling.py

b'diff --git a/plone/namedfile/scaling.py b/plone/namedfile/scaling.py\nindex 7783c03..75cae45 100644\n--- a/plone/namedfile/scaling.py\n+++ b/plone/namedfile/scaling.py\n@@ -322,6 +322,7 @@ def __call__(\n         height=None,\n         width=None,\n         scale=None,\n+        want_original=None,\n         **parameters,\n     ):\n \n@@ -336,8 +337,7 @@ def __call__(\n         orig_value = self.get_original_value()\n         if orig_value is None:\n             return\n-\n-        if height is None and width is None:\n+        if height is None and width is None and want_original is None:\n             # We don\'t seem to want an image, so we return nothing\n             # as image value (the first argument).\n             dummy, format_ = orig_value.contentType.split("/", 1)\n@@ -356,7 +356,7 @@ def __call__(\n             and width\n             and height == getattr(orig_value, "_height", None)\n             and width == getattr(orig_value, "_width", None)\n-        ):\n+        ) or want_original:\n             # No special wishes, and the original image already has the\n             # requested height and width.  Return the original.\n             dummy, format_ = orig_value.contentType.split("/", 1)\n'

Repository: plone.namedfile


Branch: refs/heads/master
Date: 2022-11-21T10:14:15+02:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.namedfile/commit/04fad1206fa570d9ed931915ac838c2cf7248680

fix formating

Files changed:
M plone/namedfile/scaling.py

b'diff --git a/plone/namedfile/scaling.py b/plone/namedfile/scaling.py\nindex 75cae45..853dd61 100644\n--- a/plone/namedfile/scaling.py\n+++ b/plone/namedfile/scaling.py\n@@ -282,13 +282,9 @@ def create_scale(self, data, mode, height, width, **parameters):\n                 DeprecationWarning,\n             )\n             mode = parameters.pop("direction")\n-        return scaleImage(\n-            data, mode=mode, height=height, width=width, **parameters\n-        )\n+        return scaleImage(data, mode=mode, height=height, width=width, **parameters)\n \n-    def handle_image(\n-        self, orig_value, orig_data, mode, height, width, **parameters\n-    ):\n+    def handle_image(self, orig_value, orig_data, mode, height, width, **parameters):\n         """Return a scaled image, its mimetype format, and width and height."""\n         if getattr(orig_value, "contentType", "") == "image/svg+xml":\n             # No need to scale, we can simply use the original data,\n'

