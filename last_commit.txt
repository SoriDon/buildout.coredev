Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-09-19T07:37:21+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/dada89ea3dd44a85d5caea63cdc2c4db6fa64443

adapt test to change in https://github.com/plone/plone.app.users/pull/75/commits/4cad485c2323ae63db923f00acdda802b3f8ab3a

Files changed:
M Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups_siteadmin_role.py

b'diff --git a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups_siteadmin_role.py b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups_siteadmin_role.py\nindex c3c168500..efedfbbda 100644\n--- a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups_siteadmin_role.py\n+++ b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_usergroups_siteadmin_role.py\n@@ -291,7 +291,7 @@ def test_user_registration_form_blocks_escalation(self):\n             \'(Administrators)" />\' in contents\n         )\n \n-        # and should not be addable if we try to force it\n+        # and should not be getting that roles if we try to force it\n         form = {\n             \'_authenticator\': self.siteadmin_token,\n             \'form.widgets.username\': \'newuser\',\n@@ -307,7 +307,9 @@ def test_user_registration_form_blocks_escalation(self):\n                            request_method=\'POST\', stdin=post_data,\n                            basic=\'siteadmin:secret\')\n         self.assertNotEqual(200, res.status)\n-        self.assertEqual(None, self.portal.acl_users.getUserById(\'newuser\'))\n+        self.assertEqual(\n+            [\'Member\', \'Authenticated\'],\n+            self.portal.acl_users.getUserById(\'newuser\').getRoles())\n \n     def test_users_overview_blocks_deleting_managers(self):\n         # a user without the Manager role cannot delete a user with the\n'

