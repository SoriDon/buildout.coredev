Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-06-20T22:50:46+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/2092ada5a051a1a5c6b05316fb34f35f6a0ad9e6

add missing i18n:translate calls

Files changed:
A news/2891.bugfix
M Products/CMFPlone/browser/login/templates/explainPWResetTool.pt
M Products/CMFPlone/browser/login/templates/login_failsafe.pt
M Products/CMFPlone/browser/templates/basic_error_message.pt
M Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt
M Products/CMFPlone/controlpanel/browser/types.pt

b'diff --git a/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt b/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt\nindex 28471e088..197623334 100644\n--- a/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt\n+++ b/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt\n@@ -19,12 +19,12 @@\n   </p>\n   <form action="#" method="post"\n         tal:attributes="action request/getURL">\n-    <p>Set timeout interval to\n-      <input type="text" name="timeout_days" value="${view/timeout_days}" size="10"\n+    <p i18n:translate="">Set timeout interval to\n+      <input i18n:name="number" type="text" name="timeout_days" value="${view/timeout_days}" size="10"\n              style="display: inline; width: auto;"/> days.</p>\n \n   <h3 i18n:translate="title_username_check">Username Check</h3>\n-  <p>\n+  <p i18n:translate="">\n     If "username check" is on, users following the confirmation link from their email\n     will be required to re-enter their username. This is to combat anonymous email\n     sniffing attacks and it is <strong>highly recommended</strong> that you leave\n@@ -46,7 +46,3 @@\n \n </body>\n </html>\n-\n-\n-\n-\ndiff --git a/Products/CMFPlone/browser/login/templates/login_failsafe.pt b/Products/CMFPlone/browser/login/templates/login_failsafe.pt\nindex f0c701a20..7857ecf5a 100644\n--- a/Products/CMFPlone/browser/login/templates/login_failsafe.pt\n+++ b/Products/CMFPlone/browser/login/templates/login_failsafe.pt\n@@ -9,7 +9,7 @@\n \n  <div id="login-form">\n \n-  <h1>Failsafe Login</h1>\n+  <h1 i18n:translate="">Failsafe Login</h1>\n \n   <div class="portalMessage error pat-cookietrigger" style="display:none">\n       <strong i18n:translate="">\ndiff --git a/Products/CMFPlone/browser/templates/basic_error_message.pt b/Products/CMFPlone/browser/templates/basic_error_message.pt\nindex ec4e34987..5c03cebe7 100644\n--- a/Products/CMFPlone/browser/templates/basic_error_message.pt\n+++ b/Products/CMFPlone/browser/templates/basic_error_message.pt\n@@ -8,7 +8,7 @@\n <tal:def define="isManager python:view.is_manager()">\n \n <head>\n-  <title tal:condition="not:isManager">Error</title>\n+  <title tal:condition="not:isManager" i18n:translate="">Error</title>\n   <title tal:condition="isManager">${options/error_type}</title>\n </head>\n \ndiff --git a/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt b/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt\nindex 5e4aa1663..980c57d33 100644\n--- a/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt\n+++ b/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt\n@@ -253,7 +253,7 @@\n                tal:attributes="class python:error and \'field error\' or \'field\'"\n                tal:content="error" />\n \n-          <p>Alternative url path &rarr; target url path (date and time of creation, manually created yes/no) </p>\n+          <p i18n:translate="">Alternative url path &rarr; target url path (date and time of creation, manually created yes/no) </p>\n           <tal:redirects repeat="redirect batch">\n             <div>\n               <label>\ndiff --git a/Products/CMFPlone/controlpanel/browser/types.pt b/Products/CMFPlone/controlpanel/browser/types.pt\nindex 9b705bde3..9bc8e8782 100644\n--- a/Products/CMFPlone/controlpanel/browser/types.pt\n+++ b/Products/CMFPlone/controlpanel/browser/types.pt\n@@ -249,7 +249,7 @@\n                 </tal:workflows>\n \n                 <div tal:condition="view/have_new_workflow" class="portalMessage info" role="status">\n-                    <strong>Info</strong>\n+                    <strong i18n:translate="">Info</strong>\n                     <span i18n:translate="types_controlpanel_warn_remap">\n                         Changing the workflow of a type will take a while, and may slow down\n                         the site significantly while the content is updated to the new setting.\ndiff --git a/news/2891.bugfix b/news/2891.bugfix\nnew file mode 100644\nindex 000000000..37f117f13\n--- /dev/null\n+++ b/news/2891.bugfix\n@@ -0,0 +1,2 @@\n+Add missing i18n:translate calls\n+[erral]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-06-21T11:01:32+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/d40d477d615d85b200784b69f483a96a192234f5

Merge branch 'master' into erral-add-missing-i18n-translate

Files changed:
A news/2893.bugfix
M Products/CMFPlone/browser/login/templates/login_help.pt

b'diff --git a/Products/CMFPlone/browser/login/templates/login_help.pt b/Products/CMFPlone/browser/login/templates/login_help.pt\nindex d541a0c12..224c824f3 100644\n--- a/Products/CMFPlone/browser/login/templates/login_help.pt\n+++ b/Products/CMFPlone/browser/login/templates/login_help.pt\n@@ -23,8 +23,8 @@\n               tal:define="subforms view/subforms">\n \n           <div class="row">\n-            <div class="col-xs-6 col-sm-6" tal:repeat="subform subforms"\n-                 tal:attributes="class python:\'col-xs-12 col-sm-12\' if len(subforms) == 1 else \'col-xs-6 col-sm-6\'">\n+            <div class="col-xs-12 col-sm-6" tal:repeat="subform subforms"\n+                 tal:attributes="class python:\'col-xs-12 col-sm-12\' if len(subforms) == 1 else \'col-xs-12 col-sm-6\'">\n                 <tal:subform replace="structure subform/render"></tal:subform>\n             </div>\n           </div>\ndiff --git a/news/2893.bugfix b/news/2893.bugfix\nnew file mode 100644\nindex 000000000..70e721239\n--- /dev/null\n+++ b/news/2893.bugfix\n@@ -0,0 +1,2 @@\n+Fix login-help layout on mobile.\n+[jensens]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-06-22T20:24:09+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/4ef6375e2524eb093e5f05eb72d01b5cb281b673

Merge branch 'master' into erral-add-missing-i18n-translate

Files changed:
A news/2896.feature
M Products/CMFPlone/PloneControlPanel.py
M Products/CMFPlone/browser/admin.py
M Products/CMFPlone/controlpanel/browser/maintenance.py
M Products/CMFPlone/utils.py

b"diff --git a/Products/CMFPlone/PloneControlPanel.py b/Products/CMFPlone/PloneControlPanel.py\nindex 87131b9b9..b749d2d51 100644\n--- a/Products/CMFPlone/PloneControlPanel.py\n+++ b/Products/CMFPlone/PloneControlPanel.py\n@@ -182,10 +182,10 @@ def _extractAction(self, properties, index):\n         if not name:\n             raise ValueError('A name is required.')\n \n-        if action is not '':\n+        if action != '':\n             action = Expression(text=action)\n \n-        if condition is not '':\n+        if condition != '':\n             condition = Expression(text=condition)\n \n         if category == '':\ndiff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 826b094f0..7b1c1b502 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -57,7 +57,7 @@ def sites(self, root=None):\n         result = []\n         secman = getSecurityManager()\n         for obj in root.values():\n-            if obj.meta_type is 'Folder':\n+            if obj.meta_type == 'Folder':\n                 result = result + self.sites(obj)\n             elif IPloneSiteRoot.providedBy(obj):\n                 if secman.checkPermission(View, obj):\ndiff --git a/Products/CMFPlone/controlpanel/browser/maintenance.py b/Products/CMFPlone/controlpanel/browser/maintenance.py\nindex 2a777a163..275c735e1 100644\n--- a/Products/CMFPlone/controlpanel/browser/maintenance.py\n+++ b/Products/CMFPlone/controlpanel/browser/maintenance.py\n@@ -3,7 +3,6 @@\n from AccessControl.Permissions import view_management_screens\n from Acquisition import aq_inner\n from App.config import getConfiguration\n-from cgi import escape\n from plone.autoform.form import AutoExtensibleForm\n from plone.memoize.view import memoize\n from plone.protect import CheckAuthenticator\n@@ -25,6 +24,11 @@\n except ImportError:\n     LIFETIME = False\n \n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n+\n \n logger = logging.getLogger(__file__)\n \ndiff --git a/Products/CMFPlone/utils.py b/Products/CMFPlone/utils.py\nindex 73f7578ee..930aa3df6 100644\n--- a/Products/CMFPlone/utils.py\n+++ b/Products/CMFPlone/utils.py\n@@ -12,7 +12,6 @@\n from App.Common import package_home\n from App.Dialogs import MessageDialog\n from App.ImageFile import ImageFile\n-from cgi import escape\n from DateTime import DateTime\n from DateTime.interfaces import DateTimeError\n from OFS.CopySupport import CopyError\n@@ -57,6 +56,10 @@\n import warnings\n import zope.interface\n \n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n \n try:\n     from types import ClassType\ndiff --git a/news/2896.feature b/news/2896.feature\nnew file mode 100644\nindex 000000000..c0eea9eb8\n--- /dev/null\n+++ b/news/2896.feature\n@@ -0,0 +1 @@\n+Add support for Python 3.8 [pbauer]\n\\ No newline at end of file\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-06-22T21:43:44+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/b0bbef9e2340bf1b613314b6fc2a5b3ef44549ba

Merge pull request #2892 from plone/erral-add-missing-i18n-translate

add missing i18n:translate calls

Files changed:
A news/2891.bugfix
M Products/CMFPlone/browser/login/templates/explainPWResetTool.pt
M Products/CMFPlone/browser/login/templates/login_failsafe.pt
M Products/CMFPlone/browser/templates/basic_error_message.pt
M Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt
M Products/CMFPlone/controlpanel/browser/types.pt

b'diff --git a/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt b/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt\nindex 28471e088..197623334 100644\n--- a/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt\n+++ b/Products/CMFPlone/browser/login/templates/explainPWResetTool.pt\n@@ -19,12 +19,12 @@\n   </p>\n   <form action="#" method="post"\n         tal:attributes="action request/getURL">\n-    <p>Set timeout interval to\n-      <input type="text" name="timeout_days" value="${view/timeout_days}" size="10"\n+    <p i18n:translate="">Set timeout interval to\n+      <input i18n:name="number" type="text" name="timeout_days" value="${view/timeout_days}" size="10"\n              style="display: inline; width: auto;"/> days.</p>\n \n   <h3 i18n:translate="title_username_check">Username Check</h3>\n-  <p>\n+  <p i18n:translate="">\n     If "username check" is on, users following the confirmation link from their email\n     will be required to re-enter their username. This is to combat anonymous email\n     sniffing attacks and it is <strong>highly recommended</strong> that you leave\n@@ -46,7 +46,3 @@\n \n </body>\n </html>\n-\n-\n-\n-\ndiff --git a/Products/CMFPlone/browser/login/templates/login_failsafe.pt b/Products/CMFPlone/browser/login/templates/login_failsafe.pt\nindex f0c701a20..7857ecf5a 100644\n--- a/Products/CMFPlone/browser/login/templates/login_failsafe.pt\n+++ b/Products/CMFPlone/browser/login/templates/login_failsafe.pt\n@@ -9,7 +9,7 @@\n \n  <div id="login-form">\n \n-  <h1>Failsafe Login</h1>\n+  <h1 i18n:translate="">Failsafe Login</h1>\n \n   <div class="portalMessage error pat-cookietrigger" style="display:none">\n       <strong i18n:translate="">\ndiff --git a/Products/CMFPlone/browser/templates/basic_error_message.pt b/Products/CMFPlone/browser/templates/basic_error_message.pt\nindex ec4e34987..5c03cebe7 100644\n--- a/Products/CMFPlone/browser/templates/basic_error_message.pt\n+++ b/Products/CMFPlone/browser/templates/basic_error_message.pt\n@@ -8,7 +8,7 @@\n <tal:def define="isManager python:view.is_manager()">\n \n <head>\n-  <title tal:condition="not:isManager">Error</title>\n+  <title tal:condition="not:isManager" i18n:translate="">Error</title>\n   <title tal:condition="isManager">${options/error_type}</title>\n </head>\n \ndiff --git a/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt b/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt\nindex 5e4aa1663..980c57d33 100644\n--- a/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt\n+++ b/Products/CMFPlone/controlpanel/browser/redirects-controlpanel.pt\n@@ -253,7 +253,7 @@\n                tal:attributes="class python:error and \'field error\' or \'field\'"\n                tal:content="error" />\n \n-          <p>Alternative url path &rarr; target url path (date and time of creation, manually created yes/no) </p>\n+          <p i18n:translate="">Alternative url path &rarr; target url path (date and time of creation, manually created yes/no) </p>\n           <tal:redirects repeat="redirect batch">\n             <div>\n               <label>\ndiff --git a/Products/CMFPlone/controlpanel/browser/types.pt b/Products/CMFPlone/controlpanel/browser/types.pt\nindex 9b705bde3..9bc8e8782 100644\n--- a/Products/CMFPlone/controlpanel/browser/types.pt\n+++ b/Products/CMFPlone/controlpanel/browser/types.pt\n@@ -249,7 +249,7 @@\n                 </tal:workflows>\n \n                 <div tal:condition="view/have_new_workflow" class="portalMessage info" role="status">\n-                    <strong>Info</strong>\n+                    <strong i18n:translate="">Info</strong>\n                     <span i18n:translate="types_controlpanel_warn_remap">\n                         Changing the workflow of a type will take a while, and may slow down\n                         the site significantly while the content is updated to the new setting.\ndiff --git a/news/2891.bugfix b/news/2891.bugfix\nnew file mode 100644\nindex 000000000..37f117f13\n--- /dev/null\n+++ b/news/2891.bugfix\n@@ -0,0 +1,2 @@\n+Add missing i18n:translate calls\n+[erral]\n'

