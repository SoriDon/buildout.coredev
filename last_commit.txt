Repository: plone.app.registry


Branch: refs/heads/master
Date: 2022-01-28T18:29:46+01:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.app.registry/commit/cd3bbfaceaf6fa620b6aa2c06c6ee8f78974b13e

move registry.js to mockup

Files changed:
M plone/app/registry/browser/configure.zcml
M plone/app/registry/browser/templates/records.pt
D plone/app/registry/browser/resources/registry.js

b'diff --git a/plone/app/registry/browser/configure.zcml b/plone/app/registry/browser/configure.zcml\nindex a1f5b22..4c2e7c7 100644\n--- a/plone/app/registry/browser/configure.zcml\n+++ b/plone/app/registry/browser/configure.zcml\n@@ -6,10 +6,10 @@\n     <include package="plone.app.z3cform" />\n     <include package="plone.autoform" />\n \n-    <browser:resourceDirectory\n+    <!-- <browser:resourceDirectory\n         name="plone.app.registry"\n         directory="resources"\n-        />\n+        /> -->\n \n     <browser:defaultView\n         for="plone.registry.interfaces.IRegistry"\ndiff --git a/plone/app/registry/browser/resources/registry.js b/plone/app/registry/browser/resources/registry.js\ndeleted file mode 100644\nindex 276abdc..0000000\n--- a/plone/app/registry/browser/resources/registry.js\n+++ /dev/null\n@@ -1,69 +0,0 @@\n-/* global require */\n-require([\n-  \'jquery\',\n-  \'pat-registry\',\n-  \'mockup-utils\',\n-  \'mockup-patterns-modal\'\n-], function($, Registry, utils, Modal) {\n-  \'use strict\';\n-\n-  var loadModals = function(){\n-    $(\'.recordsEditLink\').each(function(){\n-      var $el = $(this);\n-      var options = {\n-        actionOptions: {\n-          onSuccess: function(modal){\n-            modal.hide();\n-            $(\'#searchrow form#registry-filter\').trigger(\'submit\');\n-          }\n-        }\n-      };\n-      $el.addClass(\'pat-plone-modal\');\n-      new Modal($el, options);\n-    });\n-  }\n-\n-  $().ready(function() {\n-    loadModals();\n-\n-    /* ajax retrieval of paging */\n-    $(\'#recordsContainer\').on(\'click\', \'nav.pagination a, div.listingBar a\', function(){\n-      var self = $(this);\n-      utils.loading.show();\n-      $(\'#recordsContainer\').load(self.attr(\'href\') + \' #recordsTable\', function(){\n-        /* scan registry */\n-        Registry.scan($(\'#recordsTable\'));\n-        loadModals();\n-        utils.loading.hide();\n-      });\n-      return false;\n-    });\n-\n-    /* ajax form submission */\n-    $(\'#recordsContainer\').on(\'submit\', \'#searchrow form\', function(e){\n-      var self = $(this);\n-      utils.loading.show();\n-      $(\'#recordsContainer\').load(\n-        $(\'body\').attr(\'data-base-url\') + \'?\' + self.serialize() + \' #recordsTable\',\n-        function(){\n-          $(\'#spinner\').hide();\n-          $(\'#searchrow input[name="q"]\').trigger(\'keypress\');\n-          Registry.scan($(\'#recordsTable\'));\n-          loadModals();\n-          utils.loading.hide();\n-        }\n-      );\n-      e.preventDefault();\n-      return false;\n-    });\n-\n-    /* force submit on select change */\n-    $(\'#recordsContainer\').on(\'change\', \'#searchrow select\', function(){\n-      $(\'#searchrow form#registry-filter\').trigger(\'submit\');\n-    });\n-\n-    /* some init */\n-    $(\'#searchrow input[name="q"]\').trigger(\'keypress\');\n-  });\n-\n-});\ndiff --git a/plone/app/registry/browser/templates/records.pt b/plone/app/registry/browser/templates/records.pt\nindex 54b0cb8..696cf00 100644\n--- a/plone/app/registry/browser/templates/records.pt\n+++ b/plone/app/registry/browser/templates/records.pt\n@@ -31,7 +31,7 @@\n            data-pat-autotoc="section:.tab;levels:h2;">\n         <div id="recordsContainer" class="tab">\n           <h2 i18n:translate="heading_records">Records</h2>\n-          <div id="recordsTable">\n+          <div id="recordsTable" class="pat-registry">\n \n             <div id="searchrow">\n \n@@ -171,8 +171,6 @@\n           </metal:block>\n         </div>\n       </div>\n-      <script type="text/javascript" src="${context/portal_url}/++resource++plone.app.registry/registry.js">\n-      </script>\n     </div>\n </article>\n </body>\n'

Repository: plone.app.registry


Branch: refs/heads/master
Date: 2022-01-28T18:29:46+01:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.app.registry/commit/30d21765d04c2dac829aa33f52abc167efa06ce1

use type reset for reset button in crontrol panel

Files changed:
A news/57.breaking
M plone/app/registry/browser/templates/records.pt

b'diff --git a/news/57.breaking b/news/57.breaking\nnew file mode 100644\nindex 0000000..0bc5d7d\n--- /dev/null\n+++ b/news/57.breaking\n@@ -0,0 +1 @@\n+Remove registry.js, lives now in mockup [MrTango]\n\\ No newline at end of file\ndiff --git a/plone/app/registry/browser/templates/records.pt b/plone/app/registry/browser/templates/records.pt\nindex 696cf00..64f3aa9 100644\n--- a/plone/app/registry/browser/templates/records.pt\n+++ b/plone/app/registry/browser/templates/records.pt\n@@ -10,8 +10,6 @@\n <tal:defines tal:define="dummy python:request.set(\'disable_border\', 1);\n                          disable_column_one python:request.set(\'disable_plone.leftcolumn\', 1);\n                          disable_column_two python:request.set(\'disable_plone.rightcolumn\', 0);"/>\n-    <link rel="stylesheet" type="text/css"\n-          tal:attributes="href string:${context/portal_url}/++resource++plone.app.registry/style.css" />\n </metal:block>\n \n <body>\n@@ -77,7 +75,7 @@\n                     <div class="mb-3 col-auto">\n                       <form id="clear-filter">\n                           <button class="btn btn-secondary"\n-                            type="submit"\n+                            type="reset"\n                             i18n:translate="clear_filter">\n                               Clear filter\n                           </button>\n'

Repository: plone.app.registry


Branch: refs/heads/master
Date: 2022-03-24T15:21:35+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.registry/commit/b8c768d510e114253f2de44267c84fa60de746e5

Merge pull request #57 from plone/es6-pat-registry

Es6 pat registry

Files changed:
A news/57.breaking
M plone/app/registry/browser/configure.zcml
M plone/app/registry/browser/templates/records.pt
D plone/app/registry/browser/resources/registry.js

b'diff --git a/news/57.breaking b/news/57.breaking\nnew file mode 100644\nindex 0000000..0bc5d7d\n--- /dev/null\n+++ b/news/57.breaking\n@@ -0,0 +1 @@\n+Remove registry.js, lives now in mockup [MrTango]\n\\ No newline at end of file\ndiff --git a/plone/app/registry/browser/configure.zcml b/plone/app/registry/browser/configure.zcml\nindex a1f5b22..4c2e7c7 100644\n--- a/plone/app/registry/browser/configure.zcml\n+++ b/plone/app/registry/browser/configure.zcml\n@@ -6,10 +6,10 @@\n     <include package="plone.app.z3cform" />\n     <include package="plone.autoform" />\n \n-    <browser:resourceDirectory\n+    <!-- <browser:resourceDirectory\n         name="plone.app.registry"\n         directory="resources"\n-        />\n+        /> -->\n \n     <browser:defaultView\n         for="plone.registry.interfaces.IRegistry"\ndiff --git a/plone/app/registry/browser/resources/registry.js b/plone/app/registry/browser/resources/registry.js\ndeleted file mode 100644\nindex 276abdc..0000000\n--- a/plone/app/registry/browser/resources/registry.js\n+++ /dev/null\n@@ -1,69 +0,0 @@\n-/* global require */\n-require([\n-  \'jquery\',\n-  \'pat-registry\',\n-  \'mockup-utils\',\n-  \'mockup-patterns-modal\'\n-], function($, Registry, utils, Modal) {\n-  \'use strict\';\n-\n-  var loadModals = function(){\n-    $(\'.recordsEditLink\').each(function(){\n-      var $el = $(this);\n-      var options = {\n-        actionOptions: {\n-          onSuccess: function(modal){\n-            modal.hide();\n-            $(\'#searchrow form#registry-filter\').trigger(\'submit\');\n-          }\n-        }\n-      };\n-      $el.addClass(\'pat-plone-modal\');\n-      new Modal($el, options);\n-    });\n-  }\n-\n-  $().ready(function() {\n-    loadModals();\n-\n-    /* ajax retrieval of paging */\n-    $(\'#recordsContainer\').on(\'click\', \'nav.pagination a, div.listingBar a\', function(){\n-      var self = $(this);\n-      utils.loading.show();\n-      $(\'#recordsContainer\').load(self.attr(\'href\') + \' #recordsTable\', function(){\n-        /* scan registry */\n-        Registry.scan($(\'#recordsTable\'));\n-        loadModals();\n-        utils.loading.hide();\n-      });\n-      return false;\n-    });\n-\n-    /* ajax form submission */\n-    $(\'#recordsContainer\').on(\'submit\', \'#searchrow form\', function(e){\n-      var self = $(this);\n-      utils.loading.show();\n-      $(\'#recordsContainer\').load(\n-        $(\'body\').attr(\'data-base-url\') + \'?\' + self.serialize() + \' #recordsTable\',\n-        function(){\n-          $(\'#spinner\').hide();\n-          $(\'#searchrow input[name="q"]\').trigger(\'keypress\');\n-          Registry.scan($(\'#recordsTable\'));\n-          loadModals();\n-          utils.loading.hide();\n-        }\n-      );\n-      e.preventDefault();\n-      return false;\n-    });\n-\n-    /* force submit on select change */\n-    $(\'#recordsContainer\').on(\'change\', \'#searchrow select\', function(){\n-      $(\'#searchrow form#registry-filter\').trigger(\'submit\');\n-    });\n-\n-    /* some init */\n-    $(\'#searchrow input[name="q"]\').trigger(\'keypress\');\n-  });\n-\n-});\ndiff --git a/plone/app/registry/browser/templates/records.pt b/plone/app/registry/browser/templates/records.pt\nindex 54b0cb8..64f3aa9 100644\n--- a/plone/app/registry/browser/templates/records.pt\n+++ b/plone/app/registry/browser/templates/records.pt\n@@ -10,8 +10,6 @@\n <tal:defines tal:define="dummy python:request.set(\'disable_border\', 1);\n                          disable_column_one python:request.set(\'disable_plone.leftcolumn\', 1);\n                          disable_column_two python:request.set(\'disable_plone.rightcolumn\', 0);"/>\n-    <link rel="stylesheet" type="text/css"\n-          tal:attributes="href string:${context/portal_url}/++resource++plone.app.registry/style.css" />\n </metal:block>\n \n <body>\n@@ -31,7 +29,7 @@\n            data-pat-autotoc="section:.tab;levels:h2;">\n         <div id="recordsContainer" class="tab">\n           <h2 i18n:translate="heading_records">Records</h2>\n-          <div id="recordsTable">\n+          <div id="recordsTable" class="pat-registry">\n \n             <div id="searchrow">\n \n@@ -77,7 +75,7 @@\n                     <div class="mb-3 col-auto">\n                       <form id="clear-filter">\n                           <button class="btn btn-secondary"\n-                            type="submit"\n+                            type="reset"\n                             i18n:translate="clear_filter">\n                               Clear filter\n                           </button>\n@@ -171,8 +169,6 @@\n           </metal:block>\n         </div>\n       </div>\n-      <script type="text/javascript" src="${context/portal_url}/++resource++plone.app.registry/registry.js">\n-      </script>\n     </div>\n </article>\n </body>\n'

