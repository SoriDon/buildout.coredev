Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2023-10-19T16:05:43+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/64bd82d178dab961d3d9ba4a4fa851957243b88d

Fix problem when adding a Plone site with a custom INonInstallable utility without a getNonInstallableProfiles method.

Fixes: #3862.

Files changed:
A news/3862.bugfix
M Products/CMFPlone/browser/admin.py

b'diff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 679c160383..44714defb8 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -176,7 +176,11 @@ def profiles(self):\n         ]\n         utils = getAllUtilitiesRegisteredFor(INonInstallable)\n         for util in utils:\n-            not_installable.extend(util.getNonInstallableProfiles())\n+            not_installable.extend(\n+                util.getNonInstallableProfiles()\n+                if hasattr(util, "getNonInstallableProfiles")\n+                else []\n+            )\n \n         for info in profile_registry.listProfileInfo():\n             if info.get("type") == EXTENSION and info.get("for") in (\ndiff --git a/news/3862.bugfix b/news/3862.bugfix\nnew file mode 100644\nindex 0000000000..a9e0e6be6d\n--- /dev/null\n+++ b/news/3862.bugfix\n@@ -0,0 +1,3 @@\n+Fix problem when adding a Plone site with a custom INonInstallable utility without a getNonInstallableProfiles method.\n+\n+Fixes: #3862.\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2023-10-25T13:01:52+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/Products.CMFPlone/commit/0e122c0ac5aa4641390ad90076bf10d67138194c

Merge pull request #3864 from plone/fix-addsite-no-getnoninstallableprofiles-master

Fix problem when adding a Plone site with a custom INonInstallable utâ€¦

Files changed:
A news/3862.bugfix
M Products/CMFPlone/browser/admin.py

b'diff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 679c160383..44714defb8 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -176,7 +176,11 @@ def profiles(self):\n         ]\n         utils = getAllUtilitiesRegisteredFor(INonInstallable)\n         for util in utils:\n-            not_installable.extend(util.getNonInstallableProfiles())\n+            not_installable.extend(\n+                util.getNonInstallableProfiles()\n+                if hasattr(util, "getNonInstallableProfiles")\n+                else []\n+            )\n \n         for info in profile_registry.listProfileInfo():\n             if info.get("type") == EXTENSION and info.get("for") in (\ndiff --git a/news/3862.bugfix b/news/3862.bugfix\nnew file mode 100644\nindex 0000000000..a9e0e6be6d\n--- /dev/null\n+++ b/news/3862.bugfix\n@@ -0,0 +1,3 @@\n+Fix problem when adding a Plone site with a custom INonInstallable utility without a getNonInstallableProfiles method.\n+\n+Fixes: #3862.\n'

