Repository: plone.app.registry


Branch: refs/heads/master
Date: 2022-01-14T16:23:14+01:00
Author: Markus Hilbert (iham) <markus.hilbert@iham.at>
Commit: https://github.com/plone/plone.app.registry/commit/9e4c29cbaa68e63df1e507cc238d79a10f4fa280

Ignoring dotted files in registry directories.

Files changed:
A news/3990.bugfix
M plone/app/registry/exportimport/handler.py
M plone/app/registry/tests/test_exportimport.py

b'diff --git a/news/3990.bugfix b/news/3990.bugfix\nnew file mode 100644\nindex 0000000..d1be039\n--- /dev/null\n+++ b/news/3990.bugfix\n@@ -0,0 +1 @@\n+Ignoring dotted files in registry directories. [iham]\n\\ No newline at end of file\ndiff --git a/plone/app/registry/exportimport/handler.py b/plone/app/registry/exportimport/handler.py\nindex f34cf5e..70c1229 100644\n--- a/plone/app/registry/exportimport/handler.py\n+++ b/plone/app/registry/exportimport/handler.py\n@@ -69,7 +69,8 @@ def importRegistry(context):\n     filepaths = [\'registry.xml\']\n     if context.isDirectory(\'registry\'):\n         for filename in context.listDirectory(\'registry\'):\n-            filepaths.append(\'registry/\' + filename)\n+            if not(filename.startswith(\'.\')):\n+                filepaths.append(\'registry/\' + filename)\n \n     importer = RegistryImporter(registry, context)\n     for filepath in filepaths:\ndiff --git a/plone/app/registry/tests/test_exportimport.py b/plone/app/registry/tests/test_exportimport.py\nindex 76ab24b..b09a40b 100644\n--- a/plone/app/registry/tests/test_exportimport.py\n+++ b/plone/app/registry/tests/test_exportimport.py\n@@ -1173,6 +1173,7 @@ def test_import_folder(self):\n         context = DummyImportContext(self.site, purge=False)\n         context._files = {\n             "registry.xml": xml1,\n+            ".ignored_file" : "",\n             "registry/foo2.xml": xml2,\n             "registry/foo3.xml": xml3,\n         }\n@@ -1180,6 +1181,7 @@ def test_import_folder(self):\n             "registry": [\n                 "foo2.xml",\n                 "foo3.xml",\n+                ".ignored_file",\n             ]\n         }\n         importRegistry(context)\n'

Repository: plone.app.registry


Branch: refs/heads/master
Date: 2022-01-14T16:39:11+01:00
Author: Markus Hilbert (iham) <markus.hilbert@iham.at>
Commit: https://github.com/plone/plone.app.registry/commit/f08f21a50e428171684bb02c8c92e94e4f739ef8

using "not ..." keyword instead of function call "not(...)"

Files changed:
M plone/app/registry/exportimport/handler.py

b"diff --git a/plone/app/registry/exportimport/handler.py b/plone/app/registry/exportimport/handler.py\nindex 70c1229..2ff876f 100644\n--- a/plone/app/registry/exportimport/handler.py\n+++ b/plone/app/registry/exportimport/handler.py\n@@ -69,7 +69,7 @@ def importRegistry(context):\n     filepaths = ['registry.xml']\n     if context.isDirectory('registry'):\n         for filename in context.listDirectory('registry'):\n-            if not(filename.startswith('.')):\n+            if not filename.startswith('.'):\n                 filepaths.append('registry/' + filename)\n \n     importer = RegistryImporter(registry, context)\n"

Repository: plone.app.registry


Branch: refs/heads/master
Date: 2022-01-14T18:01:46+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.registry/commit/64499d84d5a8ac975e8f0cd6bcc22cc00a8b4715

Merge pull request #59 from plone/issue_3390

Ignoring dotted files in registry directories.

Files changed:
A news/3990.bugfix
M plone/app/registry/exportimport/handler.py
M plone/app/registry/tests/test_exportimport.py

b'diff --git a/news/3990.bugfix b/news/3990.bugfix\nnew file mode 100644\nindex 0000000..d1be039\n--- /dev/null\n+++ b/news/3990.bugfix\n@@ -0,0 +1 @@\n+Ignoring dotted files in registry directories. [iham]\n\\ No newline at end of file\ndiff --git a/plone/app/registry/exportimport/handler.py b/plone/app/registry/exportimport/handler.py\nindex f34cf5e..2ff876f 100644\n--- a/plone/app/registry/exportimport/handler.py\n+++ b/plone/app/registry/exportimport/handler.py\n@@ -69,7 +69,8 @@ def importRegistry(context):\n     filepaths = [\'registry.xml\']\n     if context.isDirectory(\'registry\'):\n         for filename in context.listDirectory(\'registry\'):\n-            filepaths.append(\'registry/\' + filename)\n+            if not filename.startswith(\'.\'):\n+                filepaths.append(\'registry/\' + filename)\n \n     importer = RegistryImporter(registry, context)\n     for filepath in filepaths:\ndiff --git a/plone/app/registry/tests/test_exportimport.py b/plone/app/registry/tests/test_exportimport.py\nindex 76ab24b..b09a40b 100644\n--- a/plone/app/registry/tests/test_exportimport.py\n+++ b/plone/app/registry/tests/test_exportimport.py\n@@ -1173,6 +1173,7 @@ def test_import_folder(self):\n         context = DummyImportContext(self.site, purge=False)\n         context._files = {\n             "registry.xml": xml1,\n+            ".ignored_file" : "",\n             "registry/foo2.xml": xml2,\n             "registry/foo3.xml": xml3,\n         }\n@@ -1180,6 +1181,7 @@ def test_import_folder(self):\n             "registry": [\n                 "foo2.xml",\n                 "foo3.xml",\n+                ".ignored_file",\n             ]\n         }\n         importRegistry(context)\n'

