Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-26T01:22:23-03:00
Author: wesleybl (wesleybl) <wesleybl@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/aac2a6f29bc7742ca07068fb355fd0d65b85075c

Revert PR #1471

PR #1471 depends on a version of plone.app.uuid, which has not been
released yet. This fixes the broken tests.

Files changed:
M src/plone/restapi/serializer/utils.py

b'diff --git a/src/plone/restapi/serializer/utils.py b/src/plone/restapi/serializer/utils.py\nindex c3d9f6db1..15b37a41a 100644\n--- a/src/plone/restapi/serializer/utils.py\n+++ b/src/plone/restapi/serializer/utils.py\n@@ -1,4 +1,4 @@\n-from plone.app.uuid.utils import uuidToObject\n+from plone.outputfilters.browser.resolveuid import uuidToObject\n from plone.outputfilters.browser.resolveuid import uuidToURL\n from plone.restapi.interfaces import IObjectPrimaryFieldTarget\n from zope.component import queryMultiAdapter\n@@ -8,7 +8,7 @@\n \n RESOLVEUID_RE = re.compile("^[./]*resolve[Uu]id/([^/]*)/?(.*)$")\n \n-# Takes the resolveID URL and returns a URL to the actual object\n+\n def uid_to_url(path):\n     if not path:\n         return ""\n@@ -23,10 +23,7 @@ def uid_to_url(path):\n     if suffix:\n         href += "/" + suffix\n     else:\n-        # Pass unrestricted flag as true so the object is accessible.\n-        # At uuidToObject(), this leads to unrestrictedTraverse() to be invoked instead of restrictedTraverse().\n-        \n-        target_object = uuidToObject(uid, unrestricted=True)\n+        target_object = uuidToObject(uid)\n         if target_object:\n             adapter = queryMultiAdapter(\n                 (target_object, target_object.REQUEST), IObjectPrimaryFieldTarget\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-26T09:26:46-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.restapi/commit/6ee10d83c72eb07891b7752635d74b77d0234886

Revert the changelog entry too

Files changed:
D news/1448.bugfix

b'diff --git a/news/1448.bugfix b/news/1448.bugfix\ndeleted file mode 100644\nindex 9bf359bb6..000000000\n--- a/news/1448.bugfix\n+++ /dev/null\n@@ -1,2 +0,0 @@\n-Fix for test cases failing when deprecating uuidToObject() from `plone.outputfilters.browser.resolveuid`.\n-[anirudhhkashyap]\n\\ No newline at end of file\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-26T09:28:36-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.restapi/commit/a103fb3587f221833d9222964597f2bc5288c6de

Merge pull request #1475 from plone/revert_broken

Revert PR #1471

Files changed:
M src/plone/restapi/serializer/utils.py
D news/1448.bugfix

b'diff --git a/news/1448.bugfix b/news/1448.bugfix\ndeleted file mode 100644\nindex 9bf359bb6..000000000\n--- a/news/1448.bugfix\n+++ /dev/null\n@@ -1,2 +0,0 @@\n-Fix for test cases failing when deprecating uuidToObject() from `plone.outputfilters.browser.resolveuid`.\n-[anirudhhkashyap]\n\\ No newline at end of file\ndiff --git a/src/plone/restapi/serializer/utils.py b/src/plone/restapi/serializer/utils.py\nindex c3d9f6db1..15b37a41a 100644\n--- a/src/plone/restapi/serializer/utils.py\n+++ b/src/plone/restapi/serializer/utils.py\n@@ -1,4 +1,4 @@\n-from plone.app.uuid.utils import uuidToObject\n+from plone.outputfilters.browser.resolveuid import uuidToObject\n from plone.outputfilters.browser.resolveuid import uuidToURL\n from plone.restapi.interfaces import IObjectPrimaryFieldTarget\n from zope.component import queryMultiAdapter\n@@ -8,7 +8,7 @@\n \n RESOLVEUID_RE = re.compile("^[./]*resolve[Uu]id/([^/]*)/?(.*)$")\n \n-# Takes the resolveID URL and returns a URL to the actual object\n+\n def uid_to_url(path):\n     if not path:\n         return ""\n@@ -23,10 +23,7 @@ def uid_to_url(path):\n     if suffix:\n         href += "/" + suffix\n     else:\n-        # Pass unrestricted flag as true so the object is accessible.\n-        # At uuidToObject(), this leads to unrestrictedTraverse() to be invoked instead of restrictedTraverse().\n-        \n-        target_object = uuidToObject(uid, unrestricted=True)\n+        target_object = uuidToObject(uid)\n         if target_object:\n             adapter = queryMultiAdapter(\n                 (target_object, target_object.REQUEST), IObjectPrimaryFieldTarget\n'

