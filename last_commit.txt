Repository: plonetheme.barceloneta


Branch: refs/heads/master
Date: 2023-03-04T15:17:16+01:00
Author: Sébastien Verbois (sverbois) <sebastien.verbois@gmail.com>
Commit: https://github.com/plone/plonetheme.barceloneta/commit/73c592e68b322c84b0489d0e3df233006fa011b6

Fix Diazo rule problem with undefined footer_portlets and footer_portlets_count variables.

See: https://community.plone.org/t/error-theme-inherited-from-barceloneta-footer-portlets-count/8455

Files changed:
A news/239.bugfix
M plonetheme/barceloneta/theme/rules.xml

b'diff --git a/news/239.bugfix b/news/239.bugfix\nnew file mode 100644\nindex 00000000..6c4a4652\n--- /dev/null\n+++ b/news/239.bugfix\n@@ -0,0 +1,3 @@\n+Fix Diazo rule problem with undefined footer_portlets and footer_portlets_count variables.\n+\n+See: https://community.plone.org/t/error-theme-inherited-from-barceloneta-footer-portlets-count/8455\ndiff --git a/plonetheme/barceloneta/theme/rules.xml b/plonetheme/barceloneta/theme/rules.xml\nindex b05fb69f..9f54b9d7 100644\n--- a/plonetheme/barceloneta/theme/rules.xml\n+++ b/plonetheme/barceloneta/theme/rules.xml\n@@ -67,10 +67,6 @@\n   <!-- manage-portlets Footer portlets -->\n   <after css:theme-children="#portal-footer-wrapper" css:content-children="#portal-footer-wrapper" css:if-content="#portal-footer-wrapper #portletmanager-plone-footerportlets"></after>\n \n-  <!-- Footer -->\n-  <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n-  <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n-\n   <!-- Replace footer information with Plone version. -->\n   <replace\n       css:theme-children="#portal-footer .copyright > div"\n@@ -94,6 +90,8 @@\n \n   <!-- Move all other footer portlets into doormat area. -->\n   <replace css:theme-children="#portal-footer .doormat">\n+    <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n+    <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n     <xsl:variable name="columns">\n       <xsl:if test="$footer_portlets_count=1">col-md-12</xsl:if>\n       <xsl:if test="$footer_portlets_count=2">col-md-6</xsl:if>\n'

Repository: plonetheme.barceloneta


Branch: refs/heads/master
Date: 2023-03-04T18:28:49+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plonetheme.barceloneta/commit/e17b3df8fd83b604b5e73e7d3e3202b473e08421

Merge pull request #322 from plone/sverbois-patch-1--60

Fix Diazo rule problem with undefined footer_portlets and footer_port…

Files changed:
A news/239.bugfix
M plonetheme/barceloneta/theme/rules.xml

b'diff --git a/news/239.bugfix b/news/239.bugfix\nnew file mode 100644\nindex 00000000..6c4a4652\n--- /dev/null\n+++ b/news/239.bugfix\n@@ -0,0 +1,3 @@\n+Fix Diazo rule problem with undefined footer_portlets and footer_portlets_count variables.\n+\n+See: https://community.plone.org/t/error-theme-inherited-from-barceloneta-footer-portlets-count/8455\ndiff --git a/plonetheme/barceloneta/theme/rules.xml b/plonetheme/barceloneta/theme/rules.xml\nindex b05fb69f..9f54b9d7 100644\n--- a/plonetheme/barceloneta/theme/rules.xml\n+++ b/plonetheme/barceloneta/theme/rules.xml\n@@ -67,10 +67,6 @@\n   <!-- manage-portlets Footer portlets -->\n   <after css:theme-children="#portal-footer-wrapper" css:content-children="#portal-footer-wrapper" css:if-content="#portal-footer-wrapper #portletmanager-plone-footerportlets"></after>\n \n-  <!-- Footer -->\n-  <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n-  <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n-\n   <!-- Replace footer information with Plone version. -->\n   <replace\n       css:theme-children="#portal-footer .copyright > div"\n@@ -94,6 +90,8 @@\n \n   <!-- Move all other footer portlets into doormat area. -->\n   <replace css:theme-children="#portal-footer .doormat">\n+    <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n+    <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n     <xsl:variable name="columns">\n       <xsl:if test="$footer_portlets_count=1">col-md-12</xsl:if>\n       <xsl:if test="$footer_portlets_count=2">col-md-6</xsl:if>\n'

