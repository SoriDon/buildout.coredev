Repository: plone.app.textfield


Branch: refs/heads/master
Date: 2018-09-30T21:34:24-04:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.app.textfield/commit/c99b7404ddd4b3cfc984ff5be4236f1abd2aa437

Add getSize method to RichTextValue

Files changed:
M plone/app/textfield/tests.py
M plone/app/textfield/value.py

b"diff --git a/plone/app/textfield/tests.py b/plone/app/textfield/tests.py\nindex a48386f..ec07325 100644\n--- a/plone/app/textfield/tests.py\n+++ b/plone/app/textfield/tests.py\n@@ -344,6 +344,11 @@ class Context(PortalContent):\n         self.failUnless('text/html' in allowed)\n         self.failUnless('text/structured' in allowed)\n \n+    def test_getSize(self):\n+        from plone.app.textfield.value import RichTextValue\n+        value = RichTextValue(u'\\u2603')\n+        self.assertEqual(3, value.getSize())\n+\n \n class Py23DocChecker(doctest.OutputChecker):\n \ndiff --git a/plone/app/textfield/value.py b/plone/app/textfield/value.py\nindex 4c038fa..d363648 100644\n--- a/plone/app/textfield/value.py\n+++ b/plone/app/textfield/value.py\n@@ -127,3 +127,6 @@ def __ne__(self, other):\n         if equal is NotImplemented:\n             return NotImplemented\n         return not equal\n+\n+    def getSize(self):\n+        return len(safe_unicode(self.raw).encode('utf-8'))\n"

Repository: plone.app.textfield


Branch: refs/heads/master
Date: 2018-09-30T21:36:34-04:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.app.textfield/commit/9a3cd2fe605a05f2a6301296922462ba486d8122

changelog

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 1fc5a16..dd5c537 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -13,6 +13,9 @@ New features:\n - Python 3 fixes, needs plone.rfc822>=2.0b1.\n   [jensens]\n \n+- Add getSize method to get the size of a RichTextValue in bytes\n+  [davisagli]\n+\n Bug fixes:\n \n - Fix doctests tests in py3\n'

Repository: plone.app.textfield


Branch: refs/heads/master
Date: 2018-10-01T13:25:27+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.textfield/commit/80f651e23932954069af6c58cbb2b236170f479e

Merge pull request #32 from plone/getSize

Add getSize method to RichTextValue

Files changed:
M CHANGES.rst
M plone/app/textfield/tests.py
M plone/app/textfield/value.py

b"diff --git a/CHANGES.rst b/CHANGES.rst\nindex 1fc5a16..dd5c537 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -13,6 +13,9 @@ New features:\n - Python 3 fixes, needs plone.rfc822>=2.0b1.\n   [jensens]\n \n+- Add getSize method to get the size of a RichTextValue in bytes\n+  [davisagli]\n+\n Bug fixes:\n \n - Fix doctests tests in py3\ndiff --git a/plone/app/textfield/tests.py b/plone/app/textfield/tests.py\nindex a48386f..ec07325 100644\n--- a/plone/app/textfield/tests.py\n+++ b/plone/app/textfield/tests.py\n@@ -344,6 +344,11 @@ class Context(PortalContent):\n         self.failUnless('text/html' in allowed)\n         self.failUnless('text/structured' in allowed)\n \n+    def test_getSize(self):\n+        from plone.app.textfield.value import RichTextValue\n+        value = RichTextValue(u'\\u2603')\n+        self.assertEqual(3, value.getSize())\n+\n \n class Py23DocChecker(doctest.OutputChecker):\n \ndiff --git a/plone/app/textfield/value.py b/plone/app/textfield/value.py\nindex 4c038fa..d363648 100644\n--- a/plone/app/textfield/value.py\n+++ b/plone/app/textfield/value.py\n@@ -127,3 +127,6 @@ def __ne__(self, other):\n         if equal is NotImplemented:\n             return NotImplemented\n         return not equal\n+\n+    def getSize(self):\n+        return len(safe_unicode(self.raw).encode('utf-8'))\n"

