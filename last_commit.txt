Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-03-22T14:10:31+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/53c38bd4da5fc6315e17e9591f5bcc2966435033

Update list of upgraded core profiles (#3457)

* Updated the list of core profiles that are upgraded during a Plone upgrade.

Added `Products.PlonePAS` and `plone.session`, and the optional `plone.restapi` and `plone.volto`.

* Robot tests: install plone.app.iterate.default profile instead of its deprecated alias.

Co-authored-by: Jens W. Klein &lt;jk@kleinundpartner.at&gt;

Files changed:
A news/3453.bugfix
M Products/CMFPlone/MigrationTool.py
M Products/CMFPlone/tests/robot/robodoc/README.rst
M Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot

b"diff --git a/Products/CMFPlone/MigrationTool.py b/Products/CMFPlone/MigrationTool.py\nindex 9dca5b740c..2697706dca 100644\n--- a/Products/CMFPlone/MigrationTool.py\n+++ b/Products/CMFPlone/MigrationTool.py\n@@ -93,6 +93,7 @@ def upgrade_all(self, context):\n         profile_id='Products.CMFPlacefulWorkflow:CMFPlacefulWorkflow',\n         check_module='Products.CMFPlacefulWorkflow'\n     ),\n+    Addon(profile_id='Products.PlonePAS:PlonePAS'),\n     Addon(\n         profile_id='plone.app.caching:default',\n         check_module='plone.app.caching'\n@@ -109,7 +110,16 @@ def upgrade_all(self, context):\n     Addon(profile_id='plone.app.querystring:default'),\n     Addon(profile_id='plone.app.theming:default'),\n     Addon(profile_id='plone.app.users:default'),\n+    Addon(\n+        profile_id='plone.restapi:default',\n+        check_module='plone.restapi'\n+    ),\n+    Addon(profile_id='plone.session:default'),\n     Addon(profile_id='plone.staticresources:default'),\n+    Addon(\n+        profile_id='plone.volto:default',\n+        check_module='plone.volto'\n+    ),\n ])\n \n \ndiff --git a/Products/CMFPlone/tests/robot/robodoc/README.rst b/Products/CMFPlone/tests/robot/robodoc/README.rst\nindex 225c445d98..d25585bf30 100644\n--- a/Products/CMFPlone/tests/robot/robodoc/README.rst\n+++ b/Products/CMFPlone/tests/robot/robodoc/README.rst\n@@ -62,7 +62,7 @@ or\n \n .. code:: bash\n \n-   $\xc2\xa0CONFIGURE_PACKAGES=plone.app.iterate APPLY_PROFILES=plone.app.contenttypes:plone-content,plone.app.iterate:plone.app.iterate bin/robot-server plone.app.robotframework.PLONE_ROBOT_TESTING\n+   $\xc2\xa0CONFIGURE_PACKAGES=plone.app.iterate APPLY_PROFILES=plone.app.contenttypes:plone-content,plone.app.iterate:default bin/robot-server plone.app.robotframework.PLONE_ROBOT_TESTING\n \n and\n \ndiff --git a/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot b/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot\nindex 797e17ee51..6677e9cb83 100644\n--- a/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot\n+++ b/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot\n@@ -8,7 +8,7 @@ Suite Teardown  Common Suite Teardown\n *** Variables ***\n \n @{CONFIGURE_PACKAGES}  plone.app.iterate\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content  plone.app.iterate:plone.app.iterate\n+@{APPLY_PROFILES}  plone.app.contenttypes:plone-content  plone.app.iterate:default\n # ${REGISTER_TRANSLATIONS}  ${CURDIR}/../../_locales\n \n *** Test Cases ***\ndiff --git a/news/3453.bugfix b/news/3453.bugfix\nnew file mode 100644\nindex 0000000000..cfbfe6ca99\n--- /dev/null\n+++ b/news/3453.bugfix\n@@ -0,0 +1,3 @@\n+Updated the list of core profiles that are upgraded during a Plone upgrade.\n+Added ``Products.PlonePAS`` and ``plone.session``, and the optional ``plone.restapi`` and ``plone.volto``.\n+[maurits]\n"

