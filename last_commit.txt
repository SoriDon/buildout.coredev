Repository: plone.app.event


Branch: refs/heads/master
Date: 2023-04-13T17:07:07+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.event/commit/a32d819a037af0101eab6021706fbc6c1a0e5f05

re-apply plone/meta and cleanup dependnecies

Files changed:
A news/0b0246aa.internal
M .meta.toml
M .pre-commit-config.yaml
M pyproject.toml
M setup.cfg
M setup.py
M tox.ini

b'diff --git a/.meta.toml b/.meta.toml\nindex 5848075c3..357e28781 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -2,4 +2,4 @@\n # https://github.com/plone/meta/tree/master/config/default\n [meta]\n template = "default"\n-commit-id = "e380661b"\n+commit-id = "0b0246aa"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex 449e951ab..fdafec1c2 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -15,7 +15,7 @@ repos:\n     hooks:\n     -   id: isort\n -   repo: https://github.com/psf/black\n-    rev: 23.1.0\n+    rev: 23.3.0\n     hooks:\n     -   id: black\n -   repo: https://github.com/collective/zpretty\n@@ -27,7 +27,7 @@ repos:\n     hooks:\n     -   id: flake8\n -   repo: https://github.com/codespell-project/codespell\n-    rev: v2.2.2\n+    rev: v2.2.4\n     hooks:\n     -   id: codespell\n         additional_dependencies:\ndiff --git a/news/0b0246aa.internal b/news/0b0246aa.internal\nnew file mode 100644\nindex 000000000..c08f53991\n--- /dev/null\n+++ b/news/0b0246aa.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 1d549d839..92c3af949 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -48,17 +48,36 @@ Zope = [\n   \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n   \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n   \'Zope2\', \'webdav\', \'zmi\',\n+  # ExtensionClass own provided namespaces\n+  \'ExtensionClass\', \'ComputedAttribute\', \'MethodObject\',\n   # Zope dependencies\n-  \'Acquisition\', \'DateTime\', \'transaction\', \'zExceptions\', \'ZODB\', \'zope.component\',\n-  \'zope.configuration\', \'zope.container\', \'zope.deferredimport\', \'zope.event\',\n-  \'zope.exceptions\', \'zope.globalrequest\', \'zope.i18n\', \'zope.i18nmessageid\',\n-  \'zope.interface\', \'zope.lifecycleevent\', \'zope.location\', \'zope.publisher\',\n-  \'zope.schema\', \'zope.security\', \'zope.site\', \'zope.traversing\', \'AccessControl\',\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\', \'six\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n ]\n \'plone.base\' = [\n-  \'AccessControl\', \'Products.BTreeFolder2\', \'Products.CMFCore\',\n-  \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n ]\n python-dateutil = [\'dateutil\']\n-ExtensionClass = [\'ComputedAttribute\']\n-ignore-packages = [\'Products.DateRecurringIndex\']\ndiff --git a/setup.cfg b/setup.cfg\nindex 57b008638..272dd75e1 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -16,7 +16,7 @@ ignore =\n     E231,\n \n per-file-ignores =\n-    plone/app/event/ical/__init__.py:F401\n+    src/plone/app.event/ical/__init__.py:F401\n \n [check-manifest]\n ignore =\ndiff --git a/setup.py b/setup.py\nindex 219ae30c5..36b71d263 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -46,18 +46,12 @@\n     install_requires=[\n         "setuptools",\n         "plone.base",\n-        "ExtensionClass",\n-        "Products.DateRecurringIndex",\n         "Products.statusmessages",\n         "icalendar",  # >4.0.2\n-        "Products.GenericSetup",\n         "Products.ZCatalog",\n-        "persistent",\n         "plone.app.contenttypes",\n         "plone.app.uuid",\n         "plone.resource",\n-        "zope.annotation",\n-        "zope.contentprovider",\n         "plone.app.contentlisting",\n         "plone.app.dexterity",\n         "plone.app.layout",\n@@ -78,7 +72,6 @@\n         "plone.memoize",\n         "plone.namedfile",\n         "plone.portlets",\n-        "plone.registry",\n         "plone.supermodel",\n         "plone.uuid",\n         "plone.z3cform",\ndiff --git a/tox.ini b/tox.ini\nindex 59995ab70..78414250d 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -44,10 +44,25 @@ commands =\n [testenv:test]\n usedevelop = true\n constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n deps =\n     zope.testrunner\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n commands =\n-    zope-testrunner --test-path={toxinidir} -s plone.app.event\n+    zope-testrunner --all --test-path={toxinidir} -s plone.app.event {posargs}\n+extras =\n+    test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s plone.app.event {posargs}\n+    coverage report -m --format markdown\n extras =\n     test\n'

Repository: plone.app.event


Branch: refs/heads/master
Date: 2023-04-13T17:14:08+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.event/commit/b5348df041f643ddb4448bbad56d2e67e0363be0

import navroot from plone.base

Files changed:
M plone/app/event/base.py

b'diff --git a/plone/app/event/base.py b/plone/app/event/base.py\nindex fb3989bf..0890a194 100644\n--- a/plone/app/event/base.py\n+++ b/plone/app/event/base.py\n@@ -7,8 +7,8 @@\n from DateTime import DateTime\n from persistent.dict import PersistentDict\n from plone.app.event.interfaces import ISO_DATE_FORMAT\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n-from plone.app.layout.navigation.root import getNavigationRootObject\n+from plone.base.interfaces import INavigationRoot\n+from plone.base.navigationroot import get_navigation_root_object\n from plone.base.i18nl10n import ulocalized_time as orig_ulocalized_time\n from plone.base.interfaces.siteroot import IPloneSiteRoot\n from plone.base.utils import safe_callable\n@@ -129,7 +129,7 @@ def get_events(\n     if "path" not in kw:\n         # limit to the current navigation root, usually (not always) site\n         portal = getSite()\n-        navroot = getNavigationRootObject(context, portal)\n+        navroot = get_navigation_root_object(context, portal)\n         query["path"] = "/".join(navroot.getPhysicalPath())\n     else:\n         query["path"] = kw["path"]\n'

Repository: plone.app.event


Branch: refs/heads/master
Date: 2023-04-13T17:18:59+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.event/commit/a0cc1405d31832a47d38c46d4bafc0d485f7fb0b

soft dependency on plone.app.layout only now,

Files changed:
M .meta.toml
M plone/app/event/profiles/default/registry.xml
M pyproject.toml
M setup.py

b'diff --git a/.meta.toml b/.meta.toml\nindex 357e2878..657bbce0 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -3,3 +3,4 @@\n [meta]\n template = "default"\n commit-id = "0b0246aa"\n+dependencies_ignores = ["plone.app.layout"]\n\\ No newline at end of file\ndiff --git a/plone/app/event/profiles/default/registry.xml b/plone/app/event/profiles/default/registry.xml\nindex c5afb6a6..021b919f 100644\n--- a/plone/app/event/profiles/default/registry.xml\n+++ b/plone/app/event/profiles/default/registry.xml\n@@ -1,7 +1,7 @@\n <?xml version="1.0" encoding="utf-8"?>\n <registry>\n \n-  <records interface="Products.CMFPlone.interfaces.IBundleRegistry"\n+  <records interface="plone.base.interfaces.IBundleRegistry"\n            prefix="plone.bundles/eventedit"\n   >\n     <value key="enabled">True</value>\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 92c3af94..51f119e0 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -81,3 +81,4 @@ Zope = [\n   \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n ]\n python-dateutil = [\'dateutil\']\n+ignore-packages = ["plone.app.layout"]\n\\ No newline at end of file\ndiff --git a/setup.py b/setup.py\nindex 36b71d26..c6902dcf 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -54,7 +54,6 @@\n         "plone.resource",\n         "plone.app.contentlisting",\n         "plone.app.dexterity",\n-        "plone.app.layout",\n         "plone.app.portlets >= 2.5.1",\n         "plone.app.querystring",\n         "plone.app.registry",\n'

Repository: plone.app.event


Branch: refs/heads/master
Date: 2023-04-13T17:20:55+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.event/commit/64b7a1396d8f4a2699e51b512351a3a358c57676

flake8 ignore

Files changed:
M plone/app/event/base.py
M setup.cfg

b'diff --git a/plone/app/event/base.py b/plone/app/event/base.py\nindex 0890a194..aa8c9864 100644\n--- a/plone/app/event/base.py\n+++ b/plone/app/event/base.py\n@@ -7,10 +7,10 @@\n from DateTime import DateTime\n from persistent.dict import PersistentDict\n from plone.app.event.interfaces import ISO_DATE_FORMAT\n-from plone.base.interfaces import INavigationRoot\n-from plone.base.navigationroot import get_navigation_root_object\n from plone.base.i18nl10n import ulocalized_time as orig_ulocalized_time\n+from plone.base.interfaces import INavigationRoot\n from plone.base.interfaces.siteroot import IPloneSiteRoot\n+from plone.base.navigationroot import get_navigation_root_object\n from plone.base.utils import safe_callable\n from plone.event.interfaces import IEvent\n from plone.event.interfaces import IEventAccessor\ndiff --git a/setup.cfg b/setup.cfg\nindex 272dd75e..57b00863 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -16,7 +16,7 @@ ignore =\n     E231,\n \n per-file-ignores =\n-    src/plone/app.event/ical/__init__.py:F401\n+    plone/app/event/ical/__init__.py:F401\n \n [check-manifest]\n ignore =\n'

Repository: plone.app.event


Branch: refs/heads/master
Date: 2023-04-13T19:00:01+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.event/commit/c7be74ad9475046501d7f9991cf03f5c98892b91

Merge pull request #372 from plone/jensens-config-with-meta

re-apply config with meta

Files changed:
A news/0b0246aa.internal
M .meta.toml
M .pre-commit-config.yaml
M plone/app/event/base.py
M plone/app/event/profiles/default/registry.xml
M pyproject.toml
M setup.py
M tox.ini

b'diff --git a/.meta.toml b/.meta.toml\nindex 5848075c3..657bbce05 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -2,4 +2,5 @@\n # https://github.com/plone/meta/tree/master/config/default\n [meta]\n template = "default"\n-commit-id = "e380661b"\n+commit-id = "0b0246aa"\n+dependencies_ignores = ["plone.app.layout"]\n\\ No newline at end of file\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex 449e951ab..fdafec1c2 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -15,7 +15,7 @@ repos:\n     hooks:\n     -   id: isort\n -   repo: https://github.com/psf/black\n-    rev: 23.1.0\n+    rev: 23.3.0\n     hooks:\n     -   id: black\n -   repo: https://github.com/collective/zpretty\n@@ -27,7 +27,7 @@ repos:\n     hooks:\n     -   id: flake8\n -   repo: https://github.com/codespell-project/codespell\n-    rev: v2.2.2\n+    rev: v2.2.4\n     hooks:\n     -   id: codespell\n         additional_dependencies:\ndiff --git a/news/0b0246aa.internal b/news/0b0246aa.internal\nnew file mode 100644\nindex 000000000..c08f53991\n--- /dev/null\n+++ b/news/0b0246aa.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/plone/app/event/base.py b/plone/app/event/base.py\nindex fb3989bf1..aa8c9864a 100644\n--- a/plone/app/event/base.py\n+++ b/plone/app/event/base.py\n@@ -7,10 +7,10 @@\n from DateTime import DateTime\n from persistent.dict import PersistentDict\n from plone.app.event.interfaces import ISO_DATE_FORMAT\n-from plone.app.layout.navigation.interfaces import INavigationRoot\n-from plone.app.layout.navigation.root import getNavigationRootObject\n from plone.base.i18nl10n import ulocalized_time as orig_ulocalized_time\n+from plone.base.interfaces import INavigationRoot\n from plone.base.interfaces.siteroot import IPloneSiteRoot\n+from plone.base.navigationroot import get_navigation_root_object\n from plone.base.utils import safe_callable\n from plone.event.interfaces import IEvent\n from plone.event.interfaces import IEventAccessor\n@@ -129,7 +129,7 @@ def get_events(\n     if "path" not in kw:\n         # limit to the current navigation root, usually (not always) site\n         portal = getSite()\n-        navroot = getNavigationRootObject(context, portal)\n+        navroot = get_navigation_root_object(context, portal)\n         query["path"] = "/".join(navroot.getPhysicalPath())\n     else:\n         query["path"] = kw["path"]\ndiff --git a/plone/app/event/profiles/default/registry.xml b/plone/app/event/profiles/default/registry.xml\nindex c5afb6a66..021b919f1 100644\n--- a/plone/app/event/profiles/default/registry.xml\n+++ b/plone/app/event/profiles/default/registry.xml\n@@ -1,7 +1,7 @@\n <?xml version="1.0" encoding="utf-8"?>\n <registry>\n \n-  <records interface="Products.CMFPlone.interfaces.IBundleRegistry"\n+  <records interface="plone.base.interfaces.IBundleRegistry"\n            prefix="plone.bundles/eventedit"\n   >\n     <value key="enabled">True</value>\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 1d549d839..51f119e07 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -48,17 +48,37 @@ Zope = [\n   \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n   \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n   \'Zope2\', \'webdav\', \'zmi\',\n+  # ExtensionClass own provided namespaces\n+  \'ExtensionClass\', \'ComputedAttribute\', \'MethodObject\',\n   # Zope dependencies\n-  \'Acquisition\', \'DateTime\', \'transaction\', \'zExceptions\', \'ZODB\', \'zope.component\',\n-  \'zope.configuration\', \'zope.container\', \'zope.deferredimport\', \'zope.event\',\n-  \'zope.exceptions\', \'zope.globalrequest\', \'zope.i18n\', \'zope.i18nmessageid\',\n-  \'zope.interface\', \'zope.lifecycleevent\', \'zope.location\', \'zope.publisher\',\n-  \'zope.schema\', \'zope.security\', \'zope.site\', \'zope.traversing\', \'AccessControl\',\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\', \'six\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n ]\n \'plone.base\' = [\n-  \'AccessControl\', \'Products.BTreeFolder2\', \'Products.CMFCore\',\n-  \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n ]\n python-dateutil = [\'dateutil\']\n-ExtensionClass = [\'ComputedAttribute\']\n-ignore-packages = [\'Products.DateRecurringIndex\']\n+ignore-packages = ["plone.app.layout"]\n\\ No newline at end of file\ndiff --git a/setup.py b/setup.py\nindex 219ae30c5..c6902dcf6 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -46,21 +46,14 @@\n     install_requires=[\n         "setuptools",\n         "plone.base",\n-        "ExtensionClass",\n-        "Products.DateRecurringIndex",\n         "Products.statusmessages",\n         "icalendar",  # >4.0.2\n-        "Products.GenericSetup",\n         "Products.ZCatalog",\n-        "persistent",\n         "plone.app.contenttypes",\n         "plone.app.uuid",\n         "plone.resource",\n-        "zope.annotation",\n-        "zope.contentprovider",\n         "plone.app.contentlisting",\n         "plone.app.dexterity",\n-        "plone.app.layout",\n         "plone.app.portlets >= 2.5.1",\n         "plone.app.querystring",\n         "plone.app.registry",\n@@ -78,7 +71,6 @@\n         "plone.memoize",\n         "plone.namedfile",\n         "plone.portlets",\n-        "plone.registry",\n         "plone.supermodel",\n         "plone.uuid",\n         "plone.z3cform",\ndiff --git a/tox.ini b/tox.ini\nindex 59995ab70..78414250d 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -44,10 +44,25 @@ commands =\n [testenv:test]\n usedevelop = true\n constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n deps =\n     zope.testrunner\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n commands =\n-    zope-testrunner --test-path={toxinidir} -s plone.app.event\n+    zope-testrunner --all --test-path={toxinidir} -s plone.app.event {posargs}\n+extras =\n+    test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s plone.app.event {posargs}\n+    coverage report -m --format markdown\n extras =\n     test\n'

