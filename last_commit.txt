Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-03-31T18:43:38+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/183f56657ba576d77435a4e5e6700d00e25eb892

show traceback pre-formatted (same as in error_message.pt)

Files changed:
M Products/CMFPlone/browser/templates/basic_error_message.pt

diff --git a/Products/CMFPlone/browser/templates/basic_error_message.pt b/Products/CMFPlone/browser/templates/basic_error_message.pt
index 11acb313e..ec4e34987 100644
--- a/Products/CMFPlone/browser/templates/basic_error_message.pt
+++ b/Products/CMFPlone/browser/templates/basic_error_message.pt
@@ -22,8 +22,8 @@
   <h2 class="documentFirstHeading"
       tal:condition="isManager">${options/error_type}</h2>
 
-  <tal:block condition="isManager"
-             replace="structure options/error_tb" />
+  <pre tal:condition="isManager"
+       tal:content="options/error_tb" />
 
   <tal:noentry condition="not:isManager">
       <p i18n:translate="description_site_error_mail_site_admin">


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-03-31T18:49:03+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/0c6622708a381a27edba5bc14e41a1266148b981

add changelog

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index a50b7b636..85bf346bb 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -25,7 +25,7 @@ Breaking changes:
 - Remove old PlacelessTranslationService.
   [jensens, ksuess]
 
-- Fix controlpanel quickinstaller view: 
+- Fix controlpanel quickinstaller view:
   A not yet installed product must not return any upgrade info.
   [jensens]
 
@@ -58,12 +58,13 @@ New Features:
 
 Bug Fixes:
 - Do not show TinyMCE menu items with no subitems, Fixes #2245.
-  [mrsaicharan1]  
+  [mrsaicharan1]
 
 - Fix Exception-View when main_template can't be rendered. Fixes #2325.
   [pbauer]
 
 - Render exceptions as text, not html to fix format of infos after traceback.
+  Display as <pre> for basic and normal error templates.
   [pbauer]
 
 - Removed extra methods and tests for CMFQuickInstallerTool.


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-04-03T14:29:25+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/85730424df7a0756a6bf120d283543232dbb4894

Merge branch 'master' into improve_traceback_display

Files changed:
M Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot

diff --git a/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot b/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot
index 6d600c36e..acd9963e8 100644
--- a/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot
+++ b/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot
@@ -8,17 +8,28 @@ Suite Teardown  Common Suite Teardown
 
 *** Test Cases ***
 
-Show TinyMCE
+Create sample content
     Go to  ${PLONE_URL}
+
+    ${item} =  Create content  type=Document
+    ...  id=samplepage  title=Sample Page
+    ...  description=The long wait is now over
+    ...  text=<p>Our new site is built with Plone.</p>
+
+
+Show TinyMCE
+    Go to  ${PLONE_URL}/samplepage
     Click element  css=#contentview-edit a
     Wait until element is visible
     ...  css=#mceu_16-body
+    Click element  css=#mceu_2-open
+    Click element  css=#mceu_2-open
     Capture and crop page screenshot
     ...  ${CURDIR}/_robot/tinymce.png
-    ...  css=div.mce-container
+    ...  css=#mceu_16
 
 Show TinyMCE image
-    Go to  ${PLONE_URL}
+    Go to  ${PLONE_URL}/samplepage
     Click element  css=#contentview-edit a
     Wait until element is visible
     ...  css=#mceu_16-body
@@ -27,12 +38,18 @@ Show TinyMCE image
     ...  css=#mceu_15
 
     Click element  css=#mceu_15 button
+    Wait until element is visible
+    ...  css=h2.plone-modal-title
+    Wait until element is visible
+    ...  css=div.common-controls
+    
     Capture and crop page screenshot
     ...  ${CURDIR}/_robot/tinymce-imgdialog.png
+    ...  css=div.outer-wrapper
     ...  css=div.plone-modal-content
 
 Show TinyMCE insert links
-    Go to  ${PLONE_URL}
+    Go to  ${PLONE_URL}/samplepage
     Click element  css=#contentview-edit a
     Wait until element is visible
     ...  css=#mceu_16-body
@@ -43,16 +60,20 @@ Show TinyMCE insert links
     Click element  css=#mceu_14 button
     Capture and crop page screenshot
     ...  ${CURDIR}/_robot/tinymce-linkdialog.png
+    ...  css=div.outer-wrapper
     ...  css=div.plone-modal-content
 
 Show TinyMCE insert tables
-    Go to  ${PLONE_URL}
+    Go to  ${PLONE_URL}/samplepage
     Click element  css=#contentview-edit a
     Wait until element is visible
     ...  css=#mceu_16-body
 
-    Click element  css=#mceu_21 button
-    Mouse over  css=#mceu_44
+    Click element  css=#mceu_22-open
+    Click element  css=#mceu_42-text
+    Wait until element is visible
+    ...  css=#mceu_42-text
+    Mouse over  css=#mceu_42-text
     Capture and crop page screenshot
     ...  ${CURDIR}/_robot/tinymce-table.png
-    ...  css=#content
\ No newline at end of file
+    ...  css=div.outer-wrappper
\ No newline at end of file


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-04-03T23:20:07+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/1075b406801e937cd9db16e675f48b7e03fa50ce

Merge pull request #2369 from plone/improve_traceback_display

show traceback pre-formatted (same as in error_message.pt)

Files changed:
M CHANGES.rst
M Products/CMFPlone/browser/templates/basic_error_message.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index a50b7b636..85bf346bb 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -25,7 +25,7 @@ Breaking changes:
 - Remove old PlacelessTranslationService.
   [jensens, ksuess]
 
-- Fix controlpanel quickinstaller view: 
+- Fix controlpanel quickinstaller view:
   A not yet installed product must not return any upgrade info.
   [jensens]
 
@@ -58,12 +58,13 @@ New Features:
 
 Bug Fixes:
 - Do not show TinyMCE menu items with no subitems, Fixes #2245.
-  [mrsaicharan1]  
+  [mrsaicharan1]
 
 - Fix Exception-View when main_template can't be rendered. Fixes #2325.
   [pbauer]
 
 - Render exceptions as text, not html to fix format of infos after traceback.
+  Display as <pre> for basic and normal error templates.
   [pbauer]
 
 - Removed extra methods and tests for CMFQuickInstallerTool.
diff --git a/Products/CMFPlone/browser/templates/basic_error_message.pt b/Products/CMFPlone/browser/templates/basic_error_message.pt
index 11acb313e..ec4e34987 100644
--- a/Products/CMFPlone/browser/templates/basic_error_message.pt
+++ b/Products/CMFPlone/browser/templates/basic_error_message.pt
@@ -22,8 +22,8 @@
   <h2 class="documentFirstHeading"
       tal:condition="isManager">${options/error_type}</h2>
 
-  <tal:block condition="isManager"
-             replace="structure options/error_tb" />
+  <pre tal:condition="isManager"
+       tal:content="options/error_tb" />
 
   <tal:noentry condition="not:isManager">
       <p i18n:translate="description_site_error_mail_site_admin">


