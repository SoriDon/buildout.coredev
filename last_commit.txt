Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-04-12T00:57:45+02:00
Author: Joni Orponen (Rotonen) <joni.orponen@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/24b01e326d2539e77a452a2b1c93e21cb3b8c624

Move the gtbn_funcglobals patch security test to functional tests.

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/testSecurity.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 85bf346bb..1735203a0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -57,6 +57,10 @@ New Features:
   [thet]
 
 Bug Fixes:
+
+- Unflakied a unit test.
+  [Rotonen]
+
 - Do not show TinyMCE menu items with no subitems, Fixes #2245.
   [mrsaicharan1]
 
diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 1d2bcaab3..8eb2c843c 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -12,15 +12,6 @@
 
 class TestAttackVectorsUnit(unittest.TestCase):
 
-    def test_gtbn_funcglobals(self):
-        from Products.CMFPlone.utils import getToolByName
-        try:
-            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
-        except TypeError:
-            pass
-        else:
-            self.fail('getToolByName should block access to non CMF tools')
-
     def test_setHeader_drops_LF(self):
         from ZPublisher.HTTPResponse import HTTPResponse
         response = HTTPResponse()
@@ -63,6 +54,15 @@ def test_get_request_var_or_attr_disallowed(self):
 
 class TestAttackVectorsFunctional(PloneTestCase):
 
+    def test_gtbn_funcglobals(self):
+        from Products.CMFPlone.utils import getToolByName
+        try:
+            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
+        except TypeError:
+            pass
+        else:
+            self.fail('getToolByName should block access to non CMF tools')
+
     def test_widget_traversal_1(self):
         res = self.publish(
             '/plone/@@discussion-settings/++widget++moderator_email')


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-04-12T08:22:14+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/651e2761070122d4f147551c91aeb8683e227098

Merge pull request #2379 from plone/roto-move-test-master

Move the gtbn_funcglobals patch security test to functional tests

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/testSecurity.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 85bf346bb..1735203a0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -57,6 +57,10 @@ New Features:
   [thet]
 
 Bug Fixes:
+
+- Unflakied a unit test.
+  [Rotonen]
+
 - Do not show TinyMCE menu items with no subitems, Fixes #2245.
   [mrsaicharan1]
 
diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 1d2bcaab3..8eb2c843c 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -12,15 +12,6 @@
 
 class TestAttackVectorsUnit(unittest.TestCase):
 
-    def test_gtbn_funcglobals(self):
-        from Products.CMFPlone.utils import getToolByName
-        try:
-            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
-        except TypeError:
-            pass
-        else:
-            self.fail('getToolByName should block access to non CMF tools')
-
     def test_setHeader_drops_LF(self):
         from ZPublisher.HTTPResponse import HTTPResponse
         response = HTTPResponse()
@@ -63,6 +54,15 @@ def test_get_request_var_or_attr_disallowed(self):
 
 class TestAttackVectorsFunctional(PloneTestCase):
 
+    def test_gtbn_funcglobals(self):
+        from Products.CMFPlone.utils import getToolByName
+        try:
+            getToolByName(self.assertTrue, 'func_globals')['__builtins__']
+        except TypeError:
+            pass
+        else:
+            self.fail('getToolByName should block access to non CMF tools')
+
     def test_widget_traversal_1(self):
         res = self.publish(
             '/plone/@@discussion-settings/++widget++moderator_email')


