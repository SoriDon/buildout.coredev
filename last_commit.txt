Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-09T14:44:33+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.isurlinportal/commit/a62e7ea389aa1281c7e88521b8456863d36a0482

Configuring with plone/meta

Files changed:
A .editorconfig
A .meta.toml
A .pre-commit-config.yaml
A news/3333c742.internal
M pyproject.toml
M setup.cfg
M tox.ini

b'diff --git a/.editorconfig b/.editorconfig\nnew file mode 100644\nindex 0000000..b4158b8\n--- /dev/null\n+++ b/.editorconfig\n@@ -0,0 +1,39 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+#\n+# EditorConfig Configuration file, for more details see:\n+# http://EditorConfig.org\n+# EditorConfig is a convention description, that could be interpreted\n+# by multiple editors to enforce common coding conventions for specific\n+# file types\n+\n+# top-most EditorConfig file:\n+# Will ignore other EditorConfig files in Home directory or upper tree level.\n+root = true\n+\n+\n+[*]  # For All Files\n+# Unix-style newlines with a newline ending every file\n+end_of_line = lf\n+insert_final_newline = true\n+trim_trailing_whitespace = true\n+# Set default charset\n+charset = utf-8\n+# Indent style default\n+indent_style = space\n+# Max Line Length - a hard line wrap, should be disabled\n+max_line_length = off\n+\n+[*.{py,cfg,ini}]\n+# 4 space indentation\n+indent_size = 4\n+\n+[*.{yml,zpt,pt,dtml,zcml}]\n+# 2 space indentation\n+indent_size = 2\n+\n+[{Makefile,.gitmodules}]\n+# Tab indentation (no size specified, but view as 4 spaces)\n+indent_style = tab\n+indent_size = unset\n+tab_width = unset\ndiff --git a/.meta.toml b/.meta.toml\nnew file mode 100644\nindex 0000000..d915ae9\n--- /dev/null\n+++ b/.meta.toml\n@@ -0,0 +1,5 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+[meta]\n+template = "default"\n+commit-id = "3333c742"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 0000000..fdafec1\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,42 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.3.1\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.12.0\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 23.3.0\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.0.3\n+    hooks:\n+    -   id: zpretty\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 6.0.0\n+    hooks:\n+    -   id: flake8\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.4\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\ndiff --git a/news/3333c742.internal b/news/3333c742.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/3333c742.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615d..9eb73f3 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,3 +1,5 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [tool.towncrier]\n filename = "CHANGES.rst"\n directory = "news/"\n@@ -18,3 +20,43 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+[tool.isort]\n+profile = "plone"\n+\n+[tool.black]\n+target-version = ["py38"]\n+\n+[tool.dependencychecker]\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # Zope dependencies\n+  \'Acquisition\', \'DateTime\', \'transaction\', \'zExceptions\', \'ZODB\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.deferredimport\', \'zope.event\',\n+  \'zope.exceptions\', \'zope.globalrequest\', \'zope.i18n\', \'zope.i18nmessageid\',\n+  \'zope.interface\', \'zope.lifecycleevent\', \'zope.location\', \'zope.publisher\',\n+  \'zope.schema\', \'zope.security\', \'zope.site\', \'zope.traversing\', \'AccessControl\',\n+]\n+\'plone.base\' = [\n+  \'AccessControl\', \'Products.BTreeFolder2\', \'Products.CMFCore\',\n+  \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n+]\n+python-dateutil = [\'dateutil\']\ndiff --git a/setup.cfg b/setup.cfg\nindex e6d0f89..0da8f8f 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -1,8 +1,23 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [bdist_wheel]\n-universal = 1\n+universal = 0\n+\n+[flake8]\n+doctests = 1\n+ignore =\n+    # black takes care of line length\n+    E501,\n+    # black takes care of where to break lines\n+    W503,\n+    # black takes care of spaces within slicing (list[:])\n+    E203,\n+    # black takes care of spaces after commas\n+    E231,\n \n [check-manifest]\n ignore =\n-    buildout.cfg\n-    requirements.txt\n+    .editorconfig\n+    .meta.toml\n+    .pre-commit-config.yaml\n     tox.ini\ndiff --git a/tox.ini b/tox.ini\nindex e16622e..acb4618 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,39 +1,68 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n envlist =\n-    plone60-py38\n-    plone60-py39\n-    plone60-py310\n-    plone60-py311\n+    format\n+    lint\n+    test\n \n [testenv]\n-commands =\n-    cp {toxinidir}/buildout.cfg {envdir}/buildout.cfg\n-    sed -ie "s/test-6.0.x.cfg/test-{env:PLONE_VERSION}.x.cfg/" {envdir}/buildout.cfg\n-    {envbindir}/buildout -c {envdir}/buildout.cfg buildout:directory={envdir} buildout:develop={toxinidir} install test\n-    {envbindir}/test\n+allowlist_externals =\n+    sh\n+\n+[testenv:format]\n+description = automatically reformat code\n skip_install = true\n deps =\n-    -rrequirements.txt\n-allowlist_externals =\n-    cp\n-    sed\n+    pre-commit\n+commands =\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n \n-[testenv:plone60-py38]\n-basepython = python3.8\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:lint]\n+description = run linters that will help improve the code style\n+skip_install = true\n+deps =\n+    pre-commit\n+commands =\n+    pre-commit run -a\n \n-[testenv:plone60-py39]\n-basepython = python3.9\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:dependencies]\n+description = check if the package defines all its dependencies and generate a graph out of them\n+deps =\n+    z3c.dependencychecker==2.11\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n+commands =\n+    dependencychecker\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n \n-[testenv:plone60-py310]\n-basepython = python3.10\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:test]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    zope-testrunner --all --test-path={toxinidir} -s Products.isurlinportal {posargs}\n+extras =\n+    test\n \n-[testenv:plone60-py311]\n-basepython = python3.11\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s Products.isurlinportal {posargs}\n+    coverage report -m --format markdown\n+extras =\n+    test\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-09T14:49:09+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.isurlinportal/commit/ac0b360fb8dc96eccd545b0bc5ac030f99fc6021

cleanup: use generic workflow

Files changed:
D .github/workflows/tests.yml
D buildout.cfg
D requirements.txt

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\ndeleted file mode 100644\nindex 720ef8c..0000000\n--- a/.github/workflows/tests.yml\n+++ /dev/null\n@@ -1,54 +0,0 @@\n-name: tests\n-\n-on:\n-  push:\n-    branches: [ master ]\n-  pull_request:\n-  workflow_dispatch:\n-\n-jobs:\n-  build:\n-    strategy:\n-      matrix:\n-        config:\n-        # [Python version, tox env]\n-        - ["3.8",   "plone60-py38"]\n-        - ["3.9",   "plone60-py39"]\n-        - ["3.10",   "plone60-py310"]\n-        - ["3.11",   "plone60-py311"]\n-\n-    runs-on: ubuntu-latest\n-    name: ${{ matrix.config[1] }}\n-    steps:\n-    - uses: actions/checkout@v3\n-    - name: Set up Python\n-      uses: actions/setup-python@v3\n-      with:\n-        python-version: ${{ matrix.config[0] }}\n-    - name: Pip cache\n-      uses: actions/cache@v3\n-      with:\n-        path: ~/.cache/pip\n-        key: ${{ runner.os }}-pip-${{ matrix.config[0] }}-${{ hashFiles(\'setup.*\', \'tox.ini\') }}\n-        restore-keys: |\n-          ${{ runner.os }}-pip-${{ matrix.config[0] }}-\n-          ${{ runner.os }}-pip-\n-    - name: Buildout cache\n-      uses: actions/cache@v3\n-      with:\n-        path: ~/.buildout/eggs\n-        key: ${{ runner.os }}-buildout-${{ matrix.config[1] }}-${{ hashFiles(\'setup.*\', \'tox.ini\', \'*cfg\') }}\n-        restore-keys: |\n-          ${{ runner.os }}-buildout-${{ matrix.config[1] }}-\n-          ${{ runner.os }}-buildout-\n-    - name: Setup Buildout to cache eggs\n-      run: |\n-        mkdir -p ~/.buildout/eggs\n-        echo "[buildout]" > ~/.buildout/default.cfg\n-        echo "eggs-directory = $(realpath ~/.buildout/eggs)" >> ~/.buildout/default.cfg\n-    - name: Install dependencies\n-      run: |\n-        python -m pip install --upgrade pip\n-        pip install tox\n-    - name: Test\n-      run: tox -e ${{ matrix.config[1] }}\ndiff --git a/buildout.cfg b/buildout.cfg\ndeleted file mode 100644\nindex 800a083..0000000\n--- a/buildout.cfg\n+++ /dev/null\n@@ -1,13 +0,0 @@\n-[buildout]\n-extends =\n-    https://raw.githubusercontent.com/collective/buildout.plonetest/master/test-6.0.x.cfg\n-\n-package-name = Products.isurlinportal\n-\n-[versions]\n-pip =\n-setuptools =\n-wheel =\n-zc.buildout =\n-# Use development version:\n-Products.isurlinportal =\ndiff --git a/requirements.txt b/requirements.txt\ndeleted file mode 100644\nindex eed370c..0000000\n--- a/requirements.txt\n+++ /dev/null\n@@ -1,4 +0,0 @@\n-pip==22.3.1\n-setuptools==65.7.0\n-wheel==0.38.4\n-zc.buildout==3.0.1\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-09T14:49:52+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.isurlinportal/commit/4d6a41d5ed83671f658bb1c708ea54b5e1dcb34f

chore: isort

Files changed:
M Products/isurlinportal/__init__.py

b'diff --git a/Products/isurlinportal/__init__.py b/Products/isurlinportal/__init__.py\nindex 768497d..8c935ee 100644\n--- a/Products/isurlinportal/__init__.py\n+++ b/Products/isurlinportal/__init__.py\n@@ -2,6 +2,7 @@\n from plone.base.interfaces import ILoginSchema\n from plone.registry.interfaces import IRegistry\n from posixpath import normpath\n+\n # This is the class we will patch:\n from Products.CMFPlone.URLTool import URLTool\n from urllib.parse import urljoin\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-09T14:50:55+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.isurlinportal/commit/7b447af53bbb446e19da998fc08330537bada58e

feat: configure codespell

Files changed:
M pyproject.toml

b'diff --git a/pyproject.toml b/pyproject.toml\nindex 9eb73f3..78ab968 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -60,3 +60,6 @@ Zope = [\n   \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n ]\n python-dateutil = [\'dateutil\']\n+\n+[tool.codespell]\n+ignore-words-list = "noo"\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-09T14:55:18+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.isurlinportal/commit/0fa32d4060c66a5e7c44b3215d2ade0251a18fc6

feat: declare dependencies

Files changed:
M setup.py

b'diff --git a/setup.py b/setup.py\nindex 25d2a74..30d4f03 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -36,5 +36,10 @@\n     include_package_data=True,\n     zip_safe=False,\n     python_requires=">=3.8",\n-    install_requires=["setuptools"],\n+    install_requires=[\n+        "Products.CMFPlone",\n+        "setuptools",\n+        "plone.base",\n+        "plone.registry",\n+    ],\n )\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-13T16:11:17+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.isurlinportal/commit/d8d161f25f8693309996e3a6a6bea39576e96e7f

Random change to trigger GHA

Files changed:
M tox.ini

b'diff --git a/tox.ini b/tox.ini\nindex acb4618..9c8d6e9 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -20,8 +20,8 @@ deps =\n commands =\n     pre-commit run -a pyupgrade\n     pre-commit run -a isort\n-    pre-commit run -a black\n     pre-commit run -a zpretty\n+    pre-commit run -a black\n \n [testenv:lint]\n description = run linters that will help improve the code style\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-18T00:17:11+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.isurlinportal/commit/0e3b7d0b8a7d6242edd93d29fe6a216c1e3f1f42

Configuring with plone/meta

Files changed:
M .meta.toml
M pyproject.toml
M tox.ini

b'diff --git a/.meta.toml b/.meta.toml\nindex d915ae9..c510cbe 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -2,4 +2,7 @@\n # https://github.com/plone/meta/tree/master/config/default\n [meta]\n template = "default"\n-commit-id = "3333c742"\n+commit-id = "d7d930a5"\n+\n+[codespell]\n+additional-ignores = "noo"\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 78ab968..4bfea99 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -42,24 +42,45 @@ profile = "plone"\n [tool.black]\n target-version = ["py38"]\n \n+[tool.codespell]\n+ignore-words-list = "noo"\n+\n [tool.dependencychecker]\n Zope = [\n   # Zope own provided namespaces\n   \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n   \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n   \'Zope2\', \'webdav\', \'zmi\',\n+  # ExtensionClass own provided namespaces\n+  \'ExtensionClass\', \'ComputedAttribute\', \'MethodObject\',\n   # Zope dependencies\n-  \'Acquisition\', \'DateTime\', \'transaction\', \'zExceptions\', \'ZODB\', \'zope.component\',\n-  \'zope.configuration\', \'zope.container\', \'zope.deferredimport\', \'zope.event\',\n-  \'zope.exceptions\', \'zope.globalrequest\', \'zope.i18n\', \'zope.i18nmessageid\',\n-  \'zope.interface\', \'zope.lifecycleevent\', \'zope.location\', \'zope.publisher\',\n-  \'zope.schema\', \'zope.security\', \'zope.site\', \'zope.traversing\', \'AccessControl\',\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n ]\n \'plone.base\' = [\n-  \'AccessControl\', \'Products.BTreeFolder2\', \'Products.CMFCore\',\n-  \'Products.CMFDynamicViewFTI\', \'zope.deprecation\',\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n ]\n python-dateutil = [\'dateutil\']\n-\n-[tool.codespell]\n-ignore-words-list = "noo"\ndiff --git a/tox.ini b/tox.ini\nindex 9c8d6e9..acb4618 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -20,8 +20,8 @@ deps =\n commands =\n     pre-commit run -a pyupgrade\n     pre-commit run -a isort\n-    pre-commit run -a zpretty\n     pre-commit run -a black\n+    pre-commit run -a zpretty\n \n [testenv:lint]\n description = run linters that will help improve the code style\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-18T00:21:25+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.isurlinportal/commit/418de5a26190b4f5e723a5e6b296fd2be5bed9a9

Moved Products.CMFPlone to requirements in new test extra.

Files changed:
M .meta.toml
M pyproject.toml
M setup.py

b'diff --git a/.meta.toml b/.meta.toml\nindex c510cbe..473f4ed 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -4,5 +4,8 @@\n template = "default"\n commit-id = "d7d930a5"\n \n+[dependencies]\n+ignores = "[\'Products.CMFPlone\']"\n+\n [codespell]\n additional-ignores = "noo"\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 4bfea99..a2bcbed 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -84,3 +84,4 @@ Zope = [\n   \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n ]\n python-dateutil = [\'dateutil\']\n+ignore-packages = [\'Products.CMFPlone\']\ndiff --git a/setup.py b/setup.py\nindex 30d4f03..64e388b 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -37,9 +37,12 @@\n     zip_safe=False,\n     python_requires=">=3.8",\n     install_requires=[\n-        "Products.CMFPlone",\n         "setuptools",\n         "plone.base",\n-        "plone.registry",\n     ],\n+    extras_require={\n+        "test": [\n+            "Products.CMFPlone",\n+        ]\n+    },\n )\n'

Repository: Products.isurlinportal


Branch: refs/heads/master
Date: 2023-04-18T14:32:37+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.isurlinportal/commit/8da42cac4248d61c68bb8eddc91189817eb42bc0

Merge pull request #11 from plone/config-with-default-template-79b64ed3

Config with default template

Files changed:
A .editorconfig
A .meta.toml
A .pre-commit-config.yaml
A news/3333c742.internal
M Products/isurlinportal/__init__.py
M pyproject.toml
M setup.cfg
M setup.py
M tox.ini
D .github/workflows/tests.yml
D buildout.cfg
D requirements.txt

b'diff --git a/.editorconfig b/.editorconfig\nnew file mode 100644\nindex 0000000..b4158b8\n--- /dev/null\n+++ b/.editorconfig\n@@ -0,0 +1,39 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+#\n+# EditorConfig Configuration file, for more details see:\n+# http://EditorConfig.org\n+# EditorConfig is a convention description, that could be interpreted\n+# by multiple editors to enforce common coding conventions for specific\n+# file types\n+\n+# top-most EditorConfig file:\n+# Will ignore other EditorConfig files in Home directory or upper tree level.\n+root = true\n+\n+\n+[*]  # For All Files\n+# Unix-style newlines with a newline ending every file\n+end_of_line = lf\n+insert_final_newline = true\n+trim_trailing_whitespace = true\n+# Set default charset\n+charset = utf-8\n+# Indent style default\n+indent_style = space\n+# Max Line Length - a hard line wrap, should be disabled\n+max_line_length = off\n+\n+[*.{py,cfg,ini}]\n+# 4 space indentation\n+indent_size = 4\n+\n+[*.{yml,zpt,pt,dtml,zcml}]\n+# 2 space indentation\n+indent_size = 2\n+\n+[{Makefile,.gitmodules}]\n+# Tab indentation (no size specified, but view as 4 spaces)\n+indent_style = tab\n+indent_size = unset\n+tab_width = unset\ndiff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\ndeleted file mode 100644\nindex 720ef8c..0000000\n--- a/.github/workflows/tests.yml\n+++ /dev/null\n@@ -1,54 +0,0 @@\n-name: tests\n-\n-on:\n-  push:\n-    branches: [ master ]\n-  pull_request:\n-  workflow_dispatch:\n-\n-jobs:\n-  build:\n-    strategy:\n-      matrix:\n-        config:\n-        # [Python version, tox env]\n-        - ["3.8",   "plone60-py38"]\n-        - ["3.9",   "plone60-py39"]\n-        - ["3.10",   "plone60-py310"]\n-        - ["3.11",   "plone60-py311"]\n-\n-    runs-on: ubuntu-latest\n-    name: ${{ matrix.config[1] }}\n-    steps:\n-    - uses: actions/checkout@v3\n-    - name: Set up Python\n-      uses: actions/setup-python@v3\n-      with:\n-        python-version: ${{ matrix.config[0] }}\n-    - name: Pip cache\n-      uses: actions/cache@v3\n-      with:\n-        path: ~/.cache/pip\n-        key: ${{ runner.os }}-pip-${{ matrix.config[0] }}-${{ hashFiles(\'setup.*\', \'tox.ini\') }}\n-        restore-keys: |\n-          ${{ runner.os }}-pip-${{ matrix.config[0] }}-\n-          ${{ runner.os }}-pip-\n-    - name: Buildout cache\n-      uses: actions/cache@v3\n-      with:\n-        path: ~/.buildout/eggs\n-        key: ${{ runner.os }}-buildout-${{ matrix.config[1] }}-${{ hashFiles(\'setup.*\', \'tox.ini\', \'*cfg\') }}\n-        restore-keys: |\n-          ${{ runner.os }}-buildout-${{ matrix.config[1] }}-\n-          ${{ runner.os }}-buildout-\n-    - name: Setup Buildout to cache eggs\n-      run: |\n-        mkdir -p ~/.buildout/eggs\n-        echo "[buildout]" > ~/.buildout/default.cfg\n-        echo "eggs-directory = $(realpath ~/.buildout/eggs)" >> ~/.buildout/default.cfg\n-    - name: Install dependencies\n-      run: |\n-        python -m pip install --upgrade pip\n-        pip install tox\n-    - name: Test\n-      run: tox -e ${{ matrix.config[1] }}\ndiff --git a/.meta.toml b/.meta.toml\nnew file mode 100644\nindex 0000000..473f4ed\n--- /dev/null\n+++ b/.meta.toml\n@@ -0,0 +1,11 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+[meta]\n+template = "default"\n+commit-id = "d7d930a5"\n+\n+[dependencies]\n+ignores = "[\'Products.CMFPlone\']"\n+\n+[codespell]\n+additional-ignores = "noo"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 0000000..fdafec1\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,42 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.3.1\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.12.0\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 23.3.0\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.0.3\n+    hooks:\n+    -   id: zpretty\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 6.0.0\n+    hooks:\n+    -   id: flake8\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.4\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\ndiff --git a/Products/isurlinportal/__init__.py b/Products/isurlinportal/__init__.py\nindex 768497d..8c935ee 100644\n--- a/Products/isurlinportal/__init__.py\n+++ b/Products/isurlinportal/__init__.py\n@@ -2,6 +2,7 @@\n from plone.base.interfaces import ILoginSchema\n from plone.registry.interfaces import IRegistry\n from posixpath import normpath\n+\n # This is the class we will patch:\n from Products.CMFPlone.URLTool import URLTool\n from urllib.parse import urljoin\ndiff --git a/buildout.cfg b/buildout.cfg\ndeleted file mode 100644\nindex 800a083..0000000\n--- a/buildout.cfg\n+++ /dev/null\n@@ -1,13 +0,0 @@\n-[buildout]\n-extends =\n-    https://raw.githubusercontent.com/collective/buildout.plonetest/master/test-6.0.x.cfg\n-\n-package-name = Products.isurlinportal\n-\n-[versions]\n-pip =\n-setuptools =\n-wheel =\n-zc.buildout =\n-# Use development version:\n-Products.isurlinportal =\ndiff --git a/news/3333c742.internal b/news/3333c742.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/3333c742.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615d..a2bcbed 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,3 +1,5 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [tool.towncrier]\n filename = "CHANGES.rst"\n directory = "news/"\n@@ -18,3 +20,68 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+[tool.isort]\n+profile = "plone"\n+\n+[tool.black]\n+target-version = ["py38"]\n+\n+[tool.codespell]\n+ignore-words-list = "noo"\n+\n+[tool.dependencychecker]\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # ExtensionClass own provided namespaces\n+  \'ExtensionClass\', \'ComputedAttribute\', \'MethodObject\',\n+  # Zope dependencies\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n+]\n+\'plone.base\' = [\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n+]\n+python-dateutil = [\'dateutil\']\n+ignore-packages = [\'Products.CMFPlone\']\ndiff --git a/requirements.txt b/requirements.txt\ndeleted file mode 100644\nindex eed370c..0000000\n--- a/requirements.txt\n+++ /dev/null\n@@ -1,4 +0,0 @@\n-pip==22.3.1\n-setuptools==65.7.0\n-wheel==0.38.4\n-zc.buildout==3.0.1\ndiff --git a/setup.cfg b/setup.cfg\nindex e6d0f89..0da8f8f 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -1,8 +1,23 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [bdist_wheel]\n-universal = 1\n+universal = 0\n+\n+[flake8]\n+doctests = 1\n+ignore =\n+    # black takes care of line length\n+    E501,\n+    # black takes care of where to break lines\n+    W503,\n+    # black takes care of spaces within slicing (list[:])\n+    E203,\n+    # black takes care of spaces after commas\n+    E231,\n \n [check-manifest]\n ignore =\n-    buildout.cfg\n-    requirements.txt\n+    .editorconfig\n+    .meta.toml\n+    .pre-commit-config.yaml\n     tox.ini\ndiff --git a/setup.py b/setup.py\nindex 25d2a74..64e388b 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -36,5 +36,13 @@\n     include_package_data=True,\n     zip_safe=False,\n     python_requires=">=3.8",\n-    install_requires=["setuptools"],\n+    install_requires=[\n+        "setuptools",\n+        "plone.base",\n+    ],\n+    extras_require={\n+        "test": [\n+            "Products.CMFPlone",\n+        ]\n+    },\n )\ndiff --git a/tox.ini b/tox.ini\nindex e16622e..acb4618 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,39 +1,68 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n envlist =\n-    plone60-py38\n-    plone60-py39\n-    plone60-py310\n-    plone60-py311\n+    format\n+    lint\n+    test\n \n [testenv]\n-commands =\n-    cp {toxinidir}/buildout.cfg {envdir}/buildout.cfg\n-    sed -ie "s/test-6.0.x.cfg/test-{env:PLONE_VERSION}.x.cfg/" {envdir}/buildout.cfg\n-    {envbindir}/buildout -c {envdir}/buildout.cfg buildout:directory={envdir} buildout:develop={toxinidir} install test\n-    {envbindir}/test\n+allowlist_externals =\n+    sh\n+\n+[testenv:format]\n+description = automatically reformat code\n skip_install = true\n deps =\n-    -rrequirements.txt\n-allowlist_externals =\n-    cp\n-    sed\n+    pre-commit\n+commands =\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n \n-[testenv:plone60-py38]\n-basepython = python3.8\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:lint]\n+description = run linters that will help improve the code style\n+skip_install = true\n+deps =\n+    pre-commit\n+commands =\n+    pre-commit run -a\n \n-[testenv:plone60-py39]\n-basepython = python3.9\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:dependencies]\n+description = check if the package defines all its dependencies and generate a graph out of them\n+deps =\n+    z3c.dependencychecker==2.11\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n+commands =\n+    dependencychecker\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n \n-[testenv:plone60-py310]\n-basepython = python3.10\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:test]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    zope-testrunner --all --test-path={toxinidir} -s Products.isurlinportal {posargs}\n+extras =\n+    test\n \n-[testenv:plone60-py311]\n-basepython = python3.11\n-setenv =\n-    PLONE_VERSION=6.0\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s Products.isurlinportal {posargs}\n+    coverage report -m --format markdown\n+extras =\n+    test\n'

