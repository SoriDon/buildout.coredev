Repository: mockup


Branch: refs/heads/master
Date: 2016-04-06T09:40:42-05:00
Author: nathan.vangheem () <nathan.vangheem@wildcardcorp.com>
Commit: https://github.com/plone/mockup/commit/f8e85e2db269e1e591316200057574519fbd76f8

fix paste button not working fixes #655

Files changed:
M CHANGES.rst
M mockup/patterns/structure/js/views/app.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 82ddb0e..2efd95d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -31,6 +31,9 @@ New:
 
 Fixes:
 
+- Fix paste button not working
+  [vangheem]
+
 - Re-add missing ``mockup-patterns-autotoc`` and ``mockup-patterns-modal`` dependencies to TinyMCE link modal.
   [thet]
 
diff --git a/mockup/patterns/structure/js/views/app.js b/mockup/patterns/structure/js/views/app.js
index 87825a7..246ca34 100644
--- a/mockup/patterns/structure/js/views/app.js
+++ b/mockup/patterns/structure/js/views/app.js
@@ -43,7 +43,7 @@ define([
       BaseView.prototype.initialize.apply(self, [options]);
       self.loading = new utils.Loading();
       self.loading.show();
-      self.pasteAllowed = $.cookie('__cp');
+      self.pasteAllowed = !!$.cookie('__cp');
 
       /* close popovers when clicking away */
       $(document).click(function(e) {
@@ -209,6 +209,8 @@ define([
           self.keyEvent = e;
         });
       }
+
+      self.togglePasteBtn();
     },
     updateButtons: function() {
       var self = this;
@@ -220,7 +222,11 @@ define([
         self.buttons.disable();
       }
 
-      if ('paste' in self.buttons) {
+      self.togglePasteBtn();
+    },
+    togglePasteBtn: function(){
+      var self = this;
+      if (_.find(self.buttons.items, function(btn){ return btn.id === 'paste'; })) {
         self.pasteAllowed = !!$.cookie('__cp');
         if (self.pasteAllowed) {
           self.buttons.get('paste').enable();


Repository: mockup


Branch: refs/heads/master
Date: 2016-04-06T17:47:42+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/mockup/commit/e20d17460bbe8ecd4d44d259daff792beb515b21

Merge pull request #656 from plone/fix-paste-btn

fix paste button not working

Files changed:
M CHANGES.rst
M mockup/patterns/structure/js/views/app.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 82ddb0e..2efd95d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -31,6 +31,9 @@ New:
 
 Fixes:
 
+- Fix paste button not working
+  [vangheem]
+
 - Re-add missing ``mockup-patterns-autotoc`` and ``mockup-patterns-modal`` dependencies to TinyMCE link modal.
   [thet]
 
diff --git a/mockup/patterns/structure/js/views/app.js b/mockup/patterns/structure/js/views/app.js
index 87825a7..246ca34 100644
--- a/mockup/patterns/structure/js/views/app.js
+++ b/mockup/patterns/structure/js/views/app.js
@@ -43,7 +43,7 @@ define([
       BaseView.prototype.initialize.apply(self, [options]);
       self.loading = new utils.Loading();
       self.loading.show();
-      self.pasteAllowed = $.cookie('__cp');
+      self.pasteAllowed = !!$.cookie('__cp');
 
       /* close popovers when clicking away */
       $(document).click(function(e) {
@@ -209,6 +209,8 @@ define([
           self.keyEvent = e;
         });
       }
+
+      self.togglePasteBtn();
     },
     updateButtons: function() {
       var self = this;
@@ -220,7 +222,11 @@ define([
         self.buttons.disable();
       }
 
-      if ('paste' in self.buttons) {
+      self.togglePasteBtn();
+    },
+    togglePasteBtn: function(){
+      var self = this;
+      if (_.find(self.buttons.items, function(btn){ return btn.id === 'paste'; })) {
         self.pasteAllowed = !!$.cookie('__cp');
         if (self.pasteAllowed) {
           self.buttons.get('paste').enable();


