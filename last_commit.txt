Repository: plone.restapi


Branch: refs/heads/master
Date: 2021-10-27T07:26:40+02:00
Author: Timo Stollenwerk (tisto) <stollenwerk@kitconcept.com>
Commit: https://github.com/plone/plone.restapi/commit/5a9aae54854e3df503fab061d303c58bcfc38aac

Add perf test for basic querystring search

Files changed:
M performance.jmx

b'diff --git a/performance.jmx b/performance.jmx\nindex 96ee11f5f..dec7d854d 100644\n--- a/performance.jmx\n+++ b/performance.jmx\n@@ -922,14 +922,7 @@\n       <hashTree>\n         <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Request Defaults" enabled="true">\n           <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="true">\n-            <collectionProp name="Arguments.arguments">\n-              <elementProp name="" elementType="HTTPArgument">\n-                <boolProp name="HTTPArgument.always_encode">false</boolProp>\n-                <stringProp name="Argument.value"></stringProp>\n-                <stringProp name="Argument.metadata">=</stringProp>\n-                <boolProp name="HTTPArgument.use_equals">true</boolProp>\n-              </elementProp>\n-            </collectionProp>\n+            <collectionProp name="Arguments.arguments"/>\n           </elementProp>\n           <stringProp name="HTTPSampler.domain">localhost</stringProp>\n           <stringProp name="HTTPSampler.port">12345</stringProp>\n@@ -947,6 +940,10 @@\n               <stringProp name="Header.name">Accept</stringProp>\n               <stringProp name="Header.value">application/json</stringProp>\n             </elementProp>\n+            <elementProp name="" elementType="Header">\n+              <stringProp name="Header.name">Content-Type</stringProp>\n+              <stringProp name="Header.value">application/json</stringProp>\n+            </elementProp>\n           </collectionProp>\n         </HeaderManager>\n         <hashTree/>\n@@ -1247,6 +1244,33 @@\n           <stringProp name="HTTPSampler.response_timeout"></stringProp>\n         </HTTPSamplerProxy>\n         <hashTree/>\n+        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Folder with 10k items" enabled="true">\n+          <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="Benutzer definierte Variablen" enabled="true">\n+            <collectionProp name="Arguments.arguments">\n+              <elementProp name="Accept" elementType="HTTPArgument">\n+                <boolProp name="HTTPArgument.always_encode">false</boolProp>\n+                <stringProp name="Argument.value">application/json</stringProp>\n+                <stringProp name="Argument.metadata">=</stringProp>\n+                <boolProp name="HTTPArgument.use_equals">true</boolProp>\n+                <stringProp name="Argument.name">Accept</stringProp>\n+              </elementProp>\n+            </collectionProp>\n+          </elementProp>\n+          <stringProp name="HTTPSampler.domain"></stringProp>\n+          <stringProp name="HTTPSampler.port"></stringProp>\n+          <stringProp name="HTTPSampler.protocol"></stringProp>\n+          <stringProp name="HTTPSampler.contentEncoding"></stringProp>\n+          <stringProp name="HTTPSampler.path">/Plone/${testfolder-read}/folder-with-10k-items</stringProp>\n+          <stringProp name="HTTPSampler.method">GET</stringProp>\n+          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>\n+          <boolProp name="HTTPSampler.auto_redirects">false</boolProp>\n+          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>\n+          <boolProp name="HTTPSampler.DO_MULTIPART_POST">false</boolProp>\n+          <stringProp name="HTTPSampler.embedded_url_re"></stringProp>\n+          <stringProp name="HTTPSampler.connect_timeout"></stringProp>\n+          <stringProp name="HTTPSampler.response_timeout"></stringProp>\n+        </HTTPSamplerProxy>\n+        <hashTree/>\n         <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Collection" enabled="true">\n           <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="Benutzer definierte Variablen" enabled="true">\n             <collectionProp name="Arguments.arguments">\n@@ -1328,6 +1352,41 @@\n           <stringProp name="HTTPSampler.response_timeout"></stringProp>\n         </HTTPSamplerProxy>\n         <hashTree/>\n+        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Querystring Search" enabled="true">\n+          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>\n+          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">\n+            <collectionProp name="Arguments.arguments">\n+              <elementProp name="" elementType="HTTPArgument">\n+                <boolProp name="HTTPArgument.always_encode">false</boolProp>\n+                <stringProp name="Argument.value">{&#xd;\n+\t&quot;query&quot;: [&#xd;\n+\t\t{&#xd;\n+\t\t\t&quot;i&quot;: &quot;portal_type&quot;, &#xd;\n+\t\t\t&quot;o&quot;: &quot;plone.app.querystring.operation.selection.any&quot;, &#xd;\n+\t\t\t&quot;v&quot;: [&quot;Document&quot;]&#xd;\n+\t\t}&#xd;\n+\t]&#xd;\n+}</stringProp>\n+                <stringProp name="Argument.metadata">=</stringProp>\n+              </elementProp>\n+            </collectionProp>\n+          </elementProp>\n+          <stringProp name="HTTPSampler.domain"></stringProp>\n+          <stringProp name="HTTPSampler.port"></stringProp>\n+          <stringProp name="HTTPSampler.protocol"></stringProp>\n+          <stringProp name="HTTPSampler.contentEncoding"></stringProp>\n+          <stringProp name="HTTPSampler.path">/Plone/@querystring-search</stringProp>\n+          <stringProp name="HTTPSampler.method">POST</stringProp>\n+          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>\n+          <boolProp name="HTTPSampler.auto_redirects">false</boolProp>\n+          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>\n+          <boolProp name="HTTPSampler.DO_MULTIPART_POST">false</boolProp>\n+          <boolProp name="HTTPSampler.BROWSER_COMPATIBLE_MULTIPART">true</boolProp>\n+          <stringProp name="HTTPSampler.embedded_url_re"></stringProp>\n+          <stringProp name="HTTPSampler.connect_timeout"></stringProp>\n+          <stringProp name="HTTPSampler.response_timeout"></stringProp>\n+        </HTTPSamplerProxy>\n+        <hashTree/>\n         <ResultCollector guiclass="StatGraphVisualizer" testclass="ResultCollector" testname="Aggregate Graph" enabled="true">\n           <boolProp name="ResultCollector.error_logging">false</boolProp>\n           <objProp>\n@@ -1394,33 +1453,6 @@\n           <stringProp name="filename"></stringProp>\n         </ResultCollector>\n         <hashTree/>\n-        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Folder with 10k items" enabled="true">\n-          <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="Benutzer definierte Variablen" enabled="true">\n-            <collectionProp name="Arguments.arguments">\n-              <elementProp name="Accept" elementType="HTTPArgument">\n-                <boolProp name="HTTPArgument.always_encode">false</boolProp>\n-                <stringProp name="Argument.value">application/json</stringProp>\n-                <stringProp name="Argument.metadata">=</stringProp>\n-                <boolProp name="HTTPArgument.use_equals">true</boolProp>\n-                <stringProp name="Argument.name">Accept</stringProp>\n-              </elementProp>\n-            </collectionProp>\n-          </elementProp>\n-          <stringProp name="HTTPSampler.domain"></stringProp>\n-          <stringProp name="HTTPSampler.port"></stringProp>\n-          <stringProp name="HTTPSampler.protocol"></stringProp>\n-          <stringProp name="HTTPSampler.contentEncoding"></stringProp>\n-          <stringProp name="HTTPSampler.path">/Plone/${testfolder-read}/folder-with-10k-items</stringProp>\n-          <stringProp name="HTTPSampler.method">GET</stringProp>\n-          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>\n-          <boolProp name="HTTPSampler.auto_redirects">false</boolProp>\n-          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>\n-          <boolProp name="HTTPSampler.DO_MULTIPART_POST">false</boolProp>\n-          <stringProp name="HTTPSampler.embedded_url_re"></stringProp>\n-          <stringProp name="HTTPSampler.connect_timeout"></stringProp>\n-          <stringProp name="HTTPSampler.response_timeout"></stringProp>\n-        </HTTPSamplerProxy>\n-        <hashTree/>\n       </hashTree>\n       <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="Volto Images (Read)" enabled="false">\n         <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>\n'

