Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-06T16:14:31+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/7e514ae3bd718f12ae53d4dddc0a10aefbc65af6

fix some deprecation warnings

Files changed:
M Products/CMFPlone/Portal.py
M Products/CMFPlone/RegistrationTool.py
M Products/CMFPlone/events.py
M Products/CMFPlone/resources/utils.py

b'diff --git a/Products/CMFPlone/Portal.py b/Products/CMFPlone/Portal.py\nindex de02c143f2..a3057b0a6a 100644\n--- a/Products/CMFPlone/Portal.py\n+++ b/Products/CMFPlone/Portal.py\n@@ -5,6 +5,15 @@\n from ComputedAttribute import ComputedAttribute\n from five.localsitemanager.registry import PersistentComponents\n from OFS.ObjectManager import REPLACEABLE\n+from plone.base import PloneMessageFactory as _\n+from plone.base.interfaces.siteroot import IPloneSiteRoot\n+from plone.base.interfaces.syndication import ISyndicatable\n+from plone.base.permissions import AddPortalContent\n+from plone.base.permissions import AddPortalFolders\n+from plone.base.permissions import ListPortalMembers\n+from plone.base.permissions import ModifyPortalContent\n+from plone.base.permissions import ReplyToItem\n+from plone.base.permissions import View\n from plone.dexterity.content import Container\n from Products.CMFCore import permissions\n from Products.CMFCore.interfaces import IContentish\n@@ -23,21 +32,12 @@\n from Products.CMFCore.utils import getToolByName\n from Products.CMFCore.utils import UniqueObject\n from Products.CMFPlone import bbb\n-from Products.CMFPlone import PloneMessageFactory as _\n-from plone.base.interfaces.siteroot import IPloneSiteRoot\n-from plone.base.interfaces.syndication import ISyndicatable\n-from Products.CMFPlone.permissions import AddPortalContent\n-from Products.CMFPlone.permissions import AddPortalFolders\n-from Products.CMFPlone.permissions import ListPortalMembers\n-from Products.CMFPlone.permissions import ModifyPortalContent\n-from Products.CMFPlone.permissions import ReplyToItem\n-from Products.CMFPlone.permissions import View\n from Products.Five.component.interfaces import IObjectManagerSite\n-from zope.interface.interfaces import ComponentLookupError\n from zope.event import notify\n from zope.interface import classImplementsOnly\n from zope.interface import implementedBy\n from zope.interface import implementer\n+from zope.interface.interfaces import ComponentLookupError\n from zope.traversing.interfaces import BeforeTraverseEvent\n \n \ndiff --git a/Products/CMFPlone/RegistrationTool.py b/Products/CMFPlone/RegistrationTool.py\nindex 663c967d51..fa17f700ad 100644\n--- a/Products/CMFPlone/RegistrationTool.py\n+++ b/Products/CMFPlone/RegistrationTool.py\n@@ -9,6 +9,8 @@\n from Acquisition import aq_chain\n from email import message_from_string\n from hashlib import md5\n+from plone.base import PloneMessageFactory as _\n+from plone.base.interfaces import ISecuritySchema\n from plone.base.permissions import ManagePortal\n from plone.registry.interfaces import IRegistry\n from Products.CMFCore.interfaces import ISiteRoot\n@@ -16,11 +18,9 @@\n from Products.CMFCore.RegistrationTool import RegistrationTool as BaseTool\n from Products.CMFCore.utils import _checkPermission\n from Products.CMFCore.utils import getToolByName\n-from Products.CMFPlone import PloneMessageFactory as _\n-from plone.base.interfaces import ISecuritySchema\n from Products.CMFPlone.PloneBaseTool import PloneBaseTool\n from Products.CMFPlone.PloneTool import EMAIL_RE\n-from Products.PluggableAuthService.interfaces.authservice import IPluggableAuthService  # noqa: E501\n+from Products.PluggableAuthService.interfaces.authservice import IPluggableAuthService\n from Products.PluggableAuthService.interfaces.plugins import IValidationPlugin\n from Products.PluggableAuthService.permissions import SetOwnPassword\n from smtplib import SMTPException\ndiff --git a/Products/CMFPlone/events.py b/Products/CMFPlone/events.py\nindex b9c04fd830..e8ffce63ac 100644\n--- a/Products/CMFPlone/events.py\n+++ b/Products/CMFPlone/events.py\n@@ -1,14 +1,12 @@\n+from plone.base.interfaces import IReorderedEvent\n+from plone.base.interfaces import ISiteManagerCreatedEvent\n+from plone.base.utils import get_installer\n from zope.interface import implementer\n from zope.interface.interfaces import ObjectEvent\n-from Products.CMFPlone.utils import get_installer\n-\n-from .interfaces import ISiteManagerCreatedEvent\n-from .interfaces import IReorderedEvent\n \n \n @implementer(ISiteManagerCreatedEvent)\n class SiteManagerCreatedEvent(ObjectEvent):\n-\n     pass\n \n \ndiff --git a/Products/CMFPlone/resources/utils.py b/Products/CMFPlone/resources/utils.py\nindex ec2e7fb9e0..8a856ae004 100644\n--- a/Products/CMFPlone/resources/utils.py\n+++ b/Products/CMFPlone/resources/utils.py\n@@ -1,11 +1,11 @@\n from Acquisition import aq_base\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n+from plone.base.interfaces.resources import OVERRIDE_RESOURCE_DIRECTORY_NAME\n from plone.resource.file import FilesystemFile\n from plone.resource.interfaces import IResourceDirectory\n from Products.CMFCore.Expression import createExprContext\n from Products.CMFCore.utils import getToolByName\n-from Products.CMFPlone.interfaces.resources import OVERRIDE_RESOURCE_DIRECTORY_NAME\n from zExceptions import NotFound\n from zope.component import queryUtility\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-06T16:29:36+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/0ec3e69fdf3acfaf348430dd139837db2c20c1b0

say in future

Files changed:
M Products/CMFPlone/configure.zcml
M Products/CMFPlone/interfaces/__init__.py

b'diff --git a/Products/CMFPlone/configure.zcml b/Products/CMFPlone/configure.zcml\nindex d4ab0a8a9d..6a4901f637 100644\n--- a/Products/CMFPlone/configure.zcml\n+++ b/Products/CMFPlone/configure.zcml\n@@ -61,7 +61,6 @@\n   <include package=".browser" />\n   <include package=".exportimport" />\n \n-  <include file="deprecated.zcml"/>\n   <include file="profiles.zcml"/>\n   <include file="catalog.zcml" />\n \ndiff --git a/Products/CMFPlone/interfaces/__init__.py b/Products/CMFPlone/interfaces/__init__.py\nindex b860e138ca..f5e6813e6b 100644\n--- a/Products/CMFPlone/interfaces/__init__.py\n+++ b/Products/CMFPlone/interfaces/__init__.py\n@@ -1,7 +1,7 @@\n from zope.deferredimport import deprecated\n \n deprecated(\n-    "Moved to plone.base.interfaces, import from there instead (removed in Plone 7).",\n+    "Moved to plone.base.interfaces, import from there instead (will be removed in Plone 7).",\n     IPloneBaseTool="plone.base.interfaces.basetool:IPloneBaseTool",\n     IPloneCatalogTool="plone.base.interfaces.basetool:IPloneCatalogTool",\n     IPloneTool="plone.base.interfaces.basetool:IPloneTool",\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-06T16:31:08+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/660112df2e605dfeafb6420ca607852372323052

remove looong (4.0) deprecated registration

Files changed:
D Products/CMFPlone/deprecated.zcml

b'diff --git a/Products/CMFPlone/deprecated.zcml b/Products/CMFPlone/deprecated.zcml\ndeleted file mode 100644\nindex e93a741095..0000000000\n--- a/Products/CMFPlone/deprecated.zcml\n+++ /dev/null\n@@ -1,16 +0,0 @@\n-<configure xmlns="http://namespaces.zope.org/zope"\n-           xmlns:browser="http://namespaces.zope.org/browser"\n-           xmlns:five="http://namespaces.zope.org/five"\n-           xmlns:zcml="http://namespaces.zope.org/zcml"\n-           i18n_domain="plone">\n-\n-  <!-- The following declarations are deprecated and will be removed in\n-       Plone 4.0. -->\n-\n-  <five:deprecatedManageAddDelete\n-      class=".Portal.PloneSite" />\n-\n-  <five:deprecatedManageAddDelete\n-      class=".CatalogTool.CatalogTool" />\n-\n-</configure>\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-06T16:32:57+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/cadf496d14e705141fa9675691d46ff8e0ce9473

bbb zcml for CMFDefault

Files changed:
D Products/CMFPlone/meta-bbb.zcml

b'diff --git a/Products/CMFPlone/meta-bbb.zcml b/Products/CMFPlone/meta-bbb.zcml\ndeleted file mode 100644\nindex 67d7ca3cf5..0000000000\n--- a/Products/CMFPlone/meta-bbb.zcml\n+++ /dev/null\n@@ -1,13 +0,0 @@\n-<configure\n-    xmlns="http://namespaces.zope.org/zope"\n-    xmlns:zcml="http://namespaces.zope.org/zcml"\n-    xmlns:meta="http://namespaces.zope.org/meta">\n-\n-    <configure zcml:condition="installed Products.CMFDefault.browser">\n-        <exclude package="Products.CMFDefault.browser" file="configure.zcml" />\n-        <exclude package="Products.CMFDefault.formlib" file="configure.zcml" />\n-        <exclude package="Products.CMFDefault.upgrade" file="configure.zcml" />\n-    </configure>\n-\n-</configure>\n-\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-06T16:36:13+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/9f30659be9d9b35ae0c3cf97e78805c6d4dc27ea

add newsfile

Files changed:
A news/3485.breaking

b'diff --git a/news/3485.breaking b/news/3485.breaking\nnew file mode 100644\nindex 0000000000..dde718747b\n--- /dev/null\n+++ b/news/3485.breaking\n@@ -0,0 +1,2 @@\n+Remove `deprecated.zcml` and `meta-bbb.zcml`.\n+[jensens, pbauer]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-06T17:32:35+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/e07ffaeedcca3ac2af781797c708f0a0f49a3bae

Merge pull request #3485 from plone/remove-deprecation-warnings

fix some deprecation warnings

Files changed:
A news/3485.breaking
M Products/CMFPlone/Portal.py
M Products/CMFPlone/RegistrationTool.py
M Products/CMFPlone/configure.zcml
M Products/CMFPlone/events.py
M Products/CMFPlone/interfaces/__init__.py
M Products/CMFPlone/resources/utils.py
D Products/CMFPlone/deprecated.zcml
D Products/CMFPlone/meta-bbb.zcml

b'diff --git a/Products/CMFPlone/Portal.py b/Products/CMFPlone/Portal.py\nindex de02c143f2..a3057b0a6a 100644\n--- a/Products/CMFPlone/Portal.py\n+++ b/Products/CMFPlone/Portal.py\n@@ -5,6 +5,15 @@\n from ComputedAttribute import ComputedAttribute\n from five.localsitemanager.registry import PersistentComponents\n from OFS.ObjectManager import REPLACEABLE\n+from plone.base import PloneMessageFactory as _\n+from plone.base.interfaces.siteroot import IPloneSiteRoot\n+from plone.base.interfaces.syndication import ISyndicatable\n+from plone.base.permissions import AddPortalContent\n+from plone.base.permissions import AddPortalFolders\n+from plone.base.permissions import ListPortalMembers\n+from plone.base.permissions import ModifyPortalContent\n+from plone.base.permissions import ReplyToItem\n+from plone.base.permissions import View\n from plone.dexterity.content import Container\n from Products.CMFCore import permissions\n from Products.CMFCore.interfaces import IContentish\n@@ -23,21 +32,12 @@\n from Products.CMFCore.utils import getToolByName\n from Products.CMFCore.utils import UniqueObject\n from Products.CMFPlone import bbb\n-from Products.CMFPlone import PloneMessageFactory as _\n-from plone.base.interfaces.siteroot import IPloneSiteRoot\n-from plone.base.interfaces.syndication import ISyndicatable\n-from Products.CMFPlone.permissions import AddPortalContent\n-from Products.CMFPlone.permissions import AddPortalFolders\n-from Products.CMFPlone.permissions import ListPortalMembers\n-from Products.CMFPlone.permissions import ModifyPortalContent\n-from Products.CMFPlone.permissions import ReplyToItem\n-from Products.CMFPlone.permissions import View\n from Products.Five.component.interfaces import IObjectManagerSite\n-from zope.interface.interfaces import ComponentLookupError\n from zope.event import notify\n from zope.interface import classImplementsOnly\n from zope.interface import implementedBy\n from zope.interface import implementer\n+from zope.interface.interfaces import ComponentLookupError\n from zope.traversing.interfaces import BeforeTraverseEvent\n \n \ndiff --git a/Products/CMFPlone/RegistrationTool.py b/Products/CMFPlone/RegistrationTool.py\nindex 663c967d51..fa17f700ad 100644\n--- a/Products/CMFPlone/RegistrationTool.py\n+++ b/Products/CMFPlone/RegistrationTool.py\n@@ -9,6 +9,8 @@\n from Acquisition import aq_chain\n from email import message_from_string\n from hashlib import md5\n+from plone.base import PloneMessageFactory as _\n+from plone.base.interfaces import ISecuritySchema\n from plone.base.permissions import ManagePortal\n from plone.registry.interfaces import IRegistry\n from Products.CMFCore.interfaces import ISiteRoot\n@@ -16,11 +18,9 @@\n from Products.CMFCore.RegistrationTool import RegistrationTool as BaseTool\n from Products.CMFCore.utils import _checkPermission\n from Products.CMFCore.utils import getToolByName\n-from Products.CMFPlone import PloneMessageFactory as _\n-from plone.base.interfaces import ISecuritySchema\n from Products.CMFPlone.PloneBaseTool import PloneBaseTool\n from Products.CMFPlone.PloneTool import EMAIL_RE\n-from Products.PluggableAuthService.interfaces.authservice import IPluggableAuthService  # noqa: E501\n+from Products.PluggableAuthService.interfaces.authservice import IPluggableAuthService\n from Products.PluggableAuthService.interfaces.plugins import IValidationPlugin\n from Products.PluggableAuthService.permissions import SetOwnPassword\n from smtplib import SMTPException\ndiff --git a/Products/CMFPlone/configure.zcml b/Products/CMFPlone/configure.zcml\nindex d4ab0a8a9d..6a4901f637 100644\n--- a/Products/CMFPlone/configure.zcml\n+++ b/Products/CMFPlone/configure.zcml\n@@ -61,7 +61,6 @@\n   <include package=".browser" />\n   <include package=".exportimport" />\n \n-  <include file="deprecated.zcml"/>\n   <include file="profiles.zcml"/>\n   <include file="catalog.zcml" />\n \ndiff --git a/Products/CMFPlone/deprecated.zcml b/Products/CMFPlone/deprecated.zcml\ndeleted file mode 100644\nindex e93a741095..0000000000\n--- a/Products/CMFPlone/deprecated.zcml\n+++ /dev/null\n@@ -1,16 +0,0 @@\n-<configure xmlns="http://namespaces.zope.org/zope"\n-           xmlns:browser="http://namespaces.zope.org/browser"\n-           xmlns:five="http://namespaces.zope.org/five"\n-           xmlns:zcml="http://namespaces.zope.org/zcml"\n-           i18n_domain="plone">\n-\n-  <!-- The following declarations are deprecated and will be removed in\n-       Plone 4.0. -->\n-\n-  <five:deprecatedManageAddDelete\n-      class=".Portal.PloneSite" />\n-\n-  <five:deprecatedManageAddDelete\n-      class=".CatalogTool.CatalogTool" />\n-\n-</configure>\ndiff --git a/Products/CMFPlone/events.py b/Products/CMFPlone/events.py\nindex b9c04fd830..e8ffce63ac 100644\n--- a/Products/CMFPlone/events.py\n+++ b/Products/CMFPlone/events.py\n@@ -1,14 +1,12 @@\n+from plone.base.interfaces import IReorderedEvent\n+from plone.base.interfaces import ISiteManagerCreatedEvent\n+from plone.base.utils import get_installer\n from zope.interface import implementer\n from zope.interface.interfaces import ObjectEvent\n-from Products.CMFPlone.utils import get_installer\n-\n-from .interfaces import ISiteManagerCreatedEvent\n-from .interfaces import IReorderedEvent\n \n \n @implementer(ISiteManagerCreatedEvent)\n class SiteManagerCreatedEvent(ObjectEvent):\n-\n     pass\n \n \ndiff --git a/Products/CMFPlone/interfaces/__init__.py b/Products/CMFPlone/interfaces/__init__.py\nindex b860e138ca..f5e6813e6b 100644\n--- a/Products/CMFPlone/interfaces/__init__.py\n+++ b/Products/CMFPlone/interfaces/__init__.py\n@@ -1,7 +1,7 @@\n from zope.deferredimport import deprecated\n \n deprecated(\n-    "Moved to plone.base.interfaces, import from there instead (removed in Plone 7).",\n+    "Moved to plone.base.interfaces, import from there instead (will be removed in Plone 7).",\n     IPloneBaseTool="plone.base.interfaces.basetool:IPloneBaseTool",\n     IPloneCatalogTool="plone.base.interfaces.basetool:IPloneCatalogTool",\n     IPloneTool="plone.base.interfaces.basetool:IPloneTool",\ndiff --git a/Products/CMFPlone/meta-bbb.zcml b/Products/CMFPlone/meta-bbb.zcml\ndeleted file mode 100644\nindex 67d7ca3cf5..0000000000\n--- a/Products/CMFPlone/meta-bbb.zcml\n+++ /dev/null\n@@ -1,13 +0,0 @@\n-<configure\n-    xmlns="http://namespaces.zope.org/zope"\n-    xmlns:zcml="http://namespaces.zope.org/zcml"\n-    xmlns:meta="http://namespaces.zope.org/meta">\n-\n-    <configure zcml:condition="installed Products.CMFDefault.browser">\n-        <exclude package="Products.CMFDefault.browser" file="configure.zcml" />\n-        <exclude package="Products.CMFDefault.formlib" file="configure.zcml" />\n-        <exclude package="Products.CMFDefault.upgrade" file="configure.zcml" />\n-    </configure>\n-\n-</configure>\n-\ndiff --git a/Products/CMFPlone/resources/utils.py b/Products/CMFPlone/resources/utils.py\nindex ec2e7fb9e0..8a856ae004 100644\n--- a/Products/CMFPlone/resources/utils.py\n+++ b/Products/CMFPlone/resources/utils.py\n@@ -1,11 +1,11 @@\n from Acquisition import aq_base\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n+from plone.base.interfaces.resources import OVERRIDE_RESOURCE_DIRECTORY_NAME\n from plone.resource.file import FilesystemFile\n from plone.resource.interfaces import IResourceDirectory\n from Products.CMFCore.Expression import createExprContext\n from Products.CMFCore.utils import getToolByName\n-from Products.CMFPlone.interfaces.resources import OVERRIDE_RESOURCE_DIRECTORY_NAME\n from zExceptions import NotFound\n from zope.component import queryUtility\n \ndiff --git a/news/3485.breaking b/news/3485.breaking\nnew file mode 100644\nindex 0000000000..dde718747b\n--- /dev/null\n+++ b/news/3485.breaking\n@@ -0,0 +1,2 @@\n+Remove `deprecated.zcml` and `meta-bbb.zcml`.\n+[jensens, pbauer]\n'

