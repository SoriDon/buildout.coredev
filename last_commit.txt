Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-06-11T22:19:36+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/00970340749c8b5dc0fb97e74da0827fc9f61273

Removed docstrings from PropertyManager methods to avoid publishing them.

Files changed:
M CHANGES.rst
M Products/CMFPlone/patches/publishing.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 30690f2..a833d78 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -41,6 +41,8 @@ New features:
 
 Bug fixes:
 
+- Removed docstrings from PropertyManager methods to avoid publishing them.  [maurits]
+
 - Added publishing patch from Products.PloneHotfix20160419.
   This avoids publishing some methods inherited from Zope or CMF.  [maurits]
 
diff --git a/Products/CMFPlone/patches/publishing.py b/Products/CMFPlone/patches/publishing.py
index 3eae7e0..baec076 100644
--- a/Products/CMFPlone/patches/publishing.py
+++ b/Products/CMFPlone/patches/publishing.py
@@ -1,4 +1,6 @@
 # From Products.PloneHotfix20160419
+# Plus extras for properties.
+from OFS.PropertyManager import PropertyManager
 from OFS.ZDOM import Document
 from OFS.ZDOM import Node
 from Products.CMFPlone.Portal import PloneSite
@@ -62,3 +64,21 @@ class ATCTBTreeFolder(object):
         if (method is not None and hasattr(method, 'im_func') and
                 hasattr(method.im_func, '__doc__')):
             del method.im_func.__doc__
+
+property_methods = (
+    'getProperty',
+    'propertyValues',
+    'propertyItems',
+    'propertyMap',
+    'hasProperty',
+    'getPropertyType',
+    'propertyIds',
+    'propertyLabel',
+    'propertyDescription'
+)
+
+for method_name in property_methods:
+    method = getattr(PropertyManager, method_name, None)
+    if (method is not None and hasattr(method, 'im_func') and
+            hasattr(method.im_func, '__doc__')):
+        del method.im_func.__doc__


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-06-12T14:49:45+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/b495ffaffafef6781d925a496214cd77e1271f20

Merge pull request #1634 from plone/maurits-patch-propertymanager-docstrings

Removed docstrings from PropertyManager methods to avoid publishing [5.1]

Files changed:
M CHANGES.rst
M Products/CMFPlone/patches/publishing.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 30690f2..a833d78 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -41,6 +41,8 @@ New features:
 
 Bug fixes:
 
+- Removed docstrings from PropertyManager methods to avoid publishing them.  [maurits]
+
 - Added publishing patch from Products.PloneHotfix20160419.
   This avoids publishing some methods inherited from Zope or CMF.  [maurits]
 
diff --git a/Products/CMFPlone/patches/publishing.py b/Products/CMFPlone/patches/publishing.py
index 3eae7e0..baec076 100644
--- a/Products/CMFPlone/patches/publishing.py
+++ b/Products/CMFPlone/patches/publishing.py
@@ -1,4 +1,6 @@
 # From Products.PloneHotfix20160419
+# Plus extras for properties.
+from OFS.PropertyManager import PropertyManager
 from OFS.ZDOM import Document
 from OFS.ZDOM import Node
 from Products.CMFPlone.Portal import PloneSite
@@ -62,3 +64,21 @@ class ATCTBTreeFolder(object):
         if (method is not None and hasattr(method, 'im_func') and
                 hasattr(method.im_func, '__doc__')):
             del method.im_func.__doc__
+
+property_methods = (
+    'getProperty',
+    'propertyValues',
+    'propertyItems',
+    'propertyMap',
+    'hasProperty',
+    'getPropertyType',
+    'propertyIds',
+    'propertyLabel',
+    'propertyDescription'
+)
+
+for method_name in property_methods:
+    method = getattr(PropertyManager, method_name, None)
+    if (method is not None and hasattr(method, 'im_func') and
+            hasattr(method.im_func, '__doc__')):
+        del method.im_func.__doc__


