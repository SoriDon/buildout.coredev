Repository: plone.app.dexterity


Branch: refs/heads/master
Date: 2015-12-02T16:49:23+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.dexterity/commit/7ed171cc2fe583e69f4752e777222dbaed7fd4fb

fix wrong usage of MessageFactory

Files changed:
M plone/app/dexterity/__init__.py
M plone/app/dexterity/browser/overview.py
M plone/app/dexterity/browser/types.py
M plone/app/dexterity/interfaces.py

diff --git a/plone/app/dexterity/__init__.py b/plone/app/dexterity/__init__.py
index 1936adc..ebe5018 100644
--- a/plone/app/dexterity/__init__.py
+++ b/plone/app/dexterity/__init__.py
@@ -1,5 +1,13 @@
 # -*- coding: utf-8 -*-
-from zope.i18nmessageid import MessageFactory
+from zope.i18nmessageid import MessageFactory as ZMessageFactory
+import warnings
 
+_ = ZMessageFactory('plone')
 
-_ = MessageFactory('plone')
+
+def MessageFactory(*args, **kwargs):
+    # BBB Remove in Plone 5.2
+    warnings.warn(
+        "Name clash, now use '_' as usal. Will be removed in Plone 5.2",
+        DeprecationWarning)
+    return _(*args, **kwargs)
diff --git a/plone/app/dexterity/browser/overview.py b/plone/app/dexterity/browser/overview.py
index 5de9880..1203560 100644
--- a/plone/app/dexterity/browser/overview.py
+++ b/plone/app/dexterity/browser/overview.py
@@ -1,8 +1,8 @@
 # -*- coding: utf-8 -*-
-from Products.CMFCore.interfaces import IFolderish
-from plone.app.dexterity import MessageFactory as _
+from plone.app.dexterity import _
 from plone.app.dexterity.browser.layout import TypeFormLayout
 from plone.app.dexterity.interfaces import ITypeSettings
+from Products.CMFCore.interfaces import IFolderish
 from z3c.form import form, field
 from zope.browserpage.viewpagetemplatefile import ViewPageTemplateFile
 from zope.dottedname.resolve import resolve as resolveDottedName
diff --git a/plone/app/dexterity/browser/types.py b/plone/app/dexterity/browser/types.py
index 5900e42..deb8a41 100644
--- a/plone/app/dexterity/browser/types.py
+++ b/plone/app/dexterity/browser/types.py
@@ -4,23 +4,24 @@
 from Products.Five.browser.pagetemplatefile \
     import ViewPageTemplateFile as FiveViewPageTemplateFile
 from ZPublisher.BaseRequest import DefaultPublishTraverse
-from plone.app.dexterity import MessageFactory as _
+from plone.app.dexterity import _
 from plone.app.dexterity.browser.utils import UTF8Property
 from plone.app.dexterity.interfaces import ITypeSchemaContext
+from plone.app.dexterity.interfaces import ITypesContext
 from plone.app.dexterity.interfaces import ITypeSettings
 from plone.app.dexterity.interfaces import ITypeStats
-from plone.app.dexterity.interfaces import ITypesContext
 from plone.dexterity.interfaces import IDexterityFTI
 from plone.dexterity.utils import getAdditionalSchemata
 from plone.schemaeditor.browser.schema.traversal import SchemaContext
 from plone.z3cform import layout
 from plone.z3cform.crud import crud
 from plone.z3cform.layout import FormWrapper
-from z3c.form import field, button
+from z3c.form import button
+from z3c.form import field
 from zope.browserpage.viewpagetemplatefile import ViewPageTemplateFile
 from zope.cachedescriptors.property import Lazy as lazy_property
-from zope.component import ComponentLookupError
 from zope.component import adapter
+from zope.component import ComponentLookupError
 from zope.component import getAllUtilitiesRegisteredFor
 from zope.component import getUtility
 from zope.interface import implementer
diff --git a/plone/app/dexterity/interfaces.py b/plone/app/dexterity/interfaces.py
index 407310b..f08743c 100644
--- a/plone/app/dexterity/interfaces.py
+++ b/plone/app/dexterity/interfaces.py
@@ -1,11 +1,13 @@
 # -*- coding: utf-8 -*-
 from Acquisition import aq_base
 from Products.CMFCore.utils import getToolByName
-from plone.app.dexterity import MessageFactory as _
+from plone.app.dexterity import _
 from plone.app.widgets.interfaces import IFileFactory
 from z3c.form import validator
 from zope import schema
-from zope.interface import Interface, Attribute, Invalid
+from zope.interface import Attribute
+from zope.interface import Interface
+from zope.interface import Invalid
 from zope.publisher.interfaces.browser import IBrowserPage
 import re
 
@@ -40,7 +42,6 @@ def isValidId(value):
 class ITypeSettings(Interface):
     """ Define the fields for the content type add form
     """
-
     title = schema.TextLine(
         title=_(u'Type Name'),
     )


