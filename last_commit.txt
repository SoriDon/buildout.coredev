Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-11-12T14:32:41+01:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/5f498d8f75e7b0b4bd104889c976e91c8343c6af

fix test to use document_view as default view for site root

Files changed:
M Products/CMFPlone/tests/testBrowserDefault.py

b"diff --git a/Products/CMFPlone/tests/testBrowserDefault.py b/Products/CMFPlone/tests/testBrowserDefault.py\nindex 3d8bc83e4d..45557b5150 100644\n--- a/Products/CMFPlone/tests/testBrowserDefault.py\n+++ b/Products/CMFPlone/tests/testBrowserDefault.py\n@@ -278,10 +278,10 @@ def testCall(self):\n         self.assertFalseDiff(resolved, target)\n \n     def testDefaultViews(self):\n-        self.assertEqual(self.portal.getLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getLayout(), 'document_view')\n         self.assertEqual(self.portal.getDefaultPage(), 'front-page')\n         self.assertEqual(self.portal.defaultView(), 'front-page')\n-        self.assertEqual(self.portal.getDefaultLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getDefaultLayout(), 'document_view')\n         layoutKeys = [v[0] for v in self.portal.getAvailableLayouts()]\n         self.assertTrue('listing_view' in layoutKeys)\n         self.assertEqual(self.portal.__browser_default__(None),\n@@ -297,7 +297,7 @@ def testSetLayout(self):\n         self.assertEqual(self.portal.getLayout(), 'summary_view')\n         self.assertEqual(self.portal.getDefaultPage(), None)\n         self.assertEqual(self.portal.defaultView(), 'summary_view')\n-        self.assertEqual(self.portal.getDefaultLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getDefaultLayout(), 'document_view')\n         layoutKeys = [v[0] for v in self.portal.getAvailableLayouts()]\n         self.assertTrue('summary_view' in layoutKeys)\n \n@@ -327,8 +327,8 @@ def testSetDefaultPage(self):\n                          (self.portal, ['ad', ]))\n \n         # still have layout settings\n-        self.assertEqual(self.portal.getLayout(), 'listing_view')\n-        self.assertEqual(self.portal.getDefaultLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getLayout(), 'document_view')\n+        self.assertEqual(self.portal.getDefaultLayout(), 'document_view')\n         layoutKeys = [v[0] for v in self.portal.getAvailableLayouts()]\n         self.assertTrue('listing_view' in layoutKeys)\n \n@@ -373,13 +373,13 @@ def testSetLayoutUnsetsDefaultPage(self):\n \n     def testMissingTemplatesIgnored(self):\n         self.portal.getTypeInfo() \\\n-            .manage_changeProperties(view_methods=['listing_view', 'foo'])\n+            .manage_changeProperties(view_methods=['document_view', 'foo'])\n         views = [v[0] for v in self.portal.getAvailableLayouts()]\n-        self.assertTrue(views == ['listing_view'])\n+        self.assertTrue(views == ['document_view'])\n \n     def testMissingPageIgnored(self):\n         self.portal.setDefaultPage('inexistent')\n         self.assertEqual(self.portal.getDefaultPage(), None)\n-        self.assertEqual(self.portal.defaultView(), 'listing_view')\n+        self.assertEqual(self.portal.defaultView(), 'document_view')\n         self.assertEqual(self.portal.__browser_default__(None),\n-                         (self.portal, ['listing_view', ]))\n+                         (self.portal, ['document_view', ]))\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-11-12T14:35:45+01:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/394d998208173fa71243948b38f4e879fa137785

add news

Files changed:
A news/3354.bugfix

b'diff --git a/news/3354.bugfix b/news/3354.bugfix\nnew file mode 100644\nindex 0000000000..6a6279cae9\n--- /dev/null\n+++ b/news/3354.bugfix\n@@ -0,0 +1,2 @@\n+Use document_view as default for site root.\n+[agitator]\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-11-16T10:51:27+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/95dfd4c1291619b0c4eb4f55f76337dd59e96a31

Merge branch 'master' into agttr-dxsiteroot-view

Files changed:
A news/3356.bugfix
M setup.py

b"diff --git a/news/3356.bugfix b/news/3356.bugfix\nnew file mode 100644\nindex 0000000000..5578a59bfa\n--- /dev/null\n+++ b/news/3356.bugfix\n@@ -0,0 +1 @@\n+Add missing lxml dependency [MrTango]\n\\ No newline at end of file\ndiff --git a/setup.py b/setup.py\nindex 81de028e2e..6f4f544436 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -42,6 +42,7 @@\n         'ExtensionClass',\n         'five.customerize',\n         'five.localsitemanager',\n+        'lxml',\n         'mockup',\n         'Pillow',\n         'plone.api >= 1.4.4',\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-11-16T10:51:36+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/92555b25102c2c6368eec8ad60535948ee88f63c

Merge pull request #3354 from plone/agttr-dxsiteroot-view

fix test to use document_view as default view for site root

Files changed:
A news/3354.bugfix
M Products/CMFPlone/tests/testBrowserDefault.py

b"diff --git a/Products/CMFPlone/tests/testBrowserDefault.py b/Products/CMFPlone/tests/testBrowserDefault.py\nindex 3d8bc83e4d..45557b5150 100644\n--- a/Products/CMFPlone/tests/testBrowserDefault.py\n+++ b/Products/CMFPlone/tests/testBrowserDefault.py\n@@ -278,10 +278,10 @@ def testCall(self):\n         self.assertFalseDiff(resolved, target)\n \n     def testDefaultViews(self):\n-        self.assertEqual(self.portal.getLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getLayout(), 'document_view')\n         self.assertEqual(self.portal.getDefaultPage(), 'front-page')\n         self.assertEqual(self.portal.defaultView(), 'front-page')\n-        self.assertEqual(self.portal.getDefaultLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getDefaultLayout(), 'document_view')\n         layoutKeys = [v[0] for v in self.portal.getAvailableLayouts()]\n         self.assertTrue('listing_view' in layoutKeys)\n         self.assertEqual(self.portal.__browser_default__(None),\n@@ -297,7 +297,7 @@ def testSetLayout(self):\n         self.assertEqual(self.portal.getLayout(), 'summary_view')\n         self.assertEqual(self.portal.getDefaultPage(), None)\n         self.assertEqual(self.portal.defaultView(), 'summary_view')\n-        self.assertEqual(self.portal.getDefaultLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getDefaultLayout(), 'document_view')\n         layoutKeys = [v[0] for v in self.portal.getAvailableLayouts()]\n         self.assertTrue('summary_view' in layoutKeys)\n \n@@ -327,8 +327,8 @@ def testSetDefaultPage(self):\n                          (self.portal, ['ad', ]))\n \n         # still have layout settings\n-        self.assertEqual(self.portal.getLayout(), 'listing_view')\n-        self.assertEqual(self.portal.getDefaultLayout(), 'listing_view')\n+        self.assertEqual(self.portal.getLayout(), 'document_view')\n+        self.assertEqual(self.portal.getDefaultLayout(), 'document_view')\n         layoutKeys = [v[0] for v in self.portal.getAvailableLayouts()]\n         self.assertTrue('listing_view' in layoutKeys)\n \n@@ -373,13 +373,13 @@ def testSetLayoutUnsetsDefaultPage(self):\n \n     def testMissingTemplatesIgnored(self):\n         self.portal.getTypeInfo() \\\n-            .manage_changeProperties(view_methods=['listing_view', 'foo'])\n+            .manage_changeProperties(view_methods=['document_view', 'foo'])\n         views = [v[0] for v in self.portal.getAvailableLayouts()]\n-        self.assertTrue(views == ['listing_view'])\n+        self.assertTrue(views == ['document_view'])\n \n     def testMissingPageIgnored(self):\n         self.portal.setDefaultPage('inexistent')\n         self.assertEqual(self.portal.getDefaultPage(), None)\n-        self.assertEqual(self.portal.defaultView(), 'listing_view')\n+        self.assertEqual(self.portal.defaultView(), 'document_view')\n         self.assertEqual(self.portal.__browser_default__(None),\n-                         (self.portal, ['listing_view', ]))\n+                         (self.portal, ['document_view', ]))\ndiff --git a/news/3354.bugfix b/news/3354.bugfix\nnew file mode 100644\nindex 0000000000..6a6279cae9\n--- /dev/null\n+++ b/news/3354.bugfix\n@@ -0,0 +1,2 @@\n+Use document_view as default for site root.\n+[agitator]\n\\ No newline at end of file\n"

