Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-03-12T07:57:02+01:00
Author: Saicharan Reddy (mrsaicharan1) <saicharan.reddy1@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/16471124f1eecb5b4b2a8976336afbd4731a0958

Fixed TinyMCE disability issue  (#2335)

* Removed the alignment items

* Changelog entry fir TinyMCE issue

* Changelog entry for TinyMCE issue

* Fixed TinyMCE rendering option issue

* Changelog entry for TinyMCE issue

* Returning style_formats only if present

* Changelog entry update and whitespace deletions

* Changelog entry update and whitespace deletions

* Used flake8 to remove whitespaces

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/tinymce.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 5c32a569f..48238c72a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -37,6 +37,8 @@ New Features:
   [thet]
 
 Bug Fixes:
+- Do not show TinyMCE menu items with no subitems, Fixes #2245.
+  [mrsaicharan1]  
 
 - Fix Exception-View when main_template can't be rendered. Fixes #2325.
   [pbauer]
diff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py
index c7bdab7ba..d3592cf30 100644
--- a/Products/CMFPlone/patterns/tinymce.py
+++ b/Products/CMFPlone/patterns/tinymce.py
@@ -88,7 +88,7 @@ def get_all_style_formats(self):
         inline_styles = self.settings.inline_styles or []
         alignment_styles = self.settings.alignment_styles or []
         table_styles = self.settings.table_styles or []
-        return [{
+        style_formats = [{
             'title': 'Headers',
             'items': self.get_styles(header_styles)
         }, {
@@ -105,6 +105,7 @@ def get_all_style_formats(self):
             'items': self.get_styles(
                 table_styles, 'classes', {'selector': 'table'})
         }]
+        return [sf for sf in style_formats if sf['items']]
 
     def get_tiny_config(self):
         settings = self.settings


