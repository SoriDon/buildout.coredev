Repository: mockup


Branch: refs/heads/master
Date: 2017-09-04T12:22:34+02:00
Author: Asko Soukka (datakurre) <asko.soukka@iki.fi>
Commit: https://github.com/plone/mockup/commit/b57ae7cc96dc4686f54c6fa76f25d98f074c2c6d

Fix issue where TinyMCE pattern raised exception when importcss_file_filter was already a function (#798)

Files changed:
M CHANGES.rst
M mockup/patterns/tinymce/pattern.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 40de828c..d9117825 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,12 @@ New features:
 
 Bug fixes: 
 
-- * Add items here * 
+- TinyMCE: Fix seen issue where pattern failed, because importcss_file_filter
+  was already a function
+  [datakurre]
+
+- Translate "Title" for the table template
+  [cillianderoiste]
 
 Incompatibilies:
 
@@ -42,10 +47,6 @@ Bug fixes:
   This fixes an issue where it was impossible to select items when many items were filtered out.
   [thet]
 
-- Translate "Title" for the table template
-  [cillianderoiste]
-
-
 2.5.0 (2017-07-03)
 ------------------
 
diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js
index 54f36387..74b0b7a8 100644
--- a/mockup/patterns/tinymce/pattern.js
+++ b/mockup/patterns/tinymce/pattern.js
@@ -371,7 +371,9 @@ define([
           self.$el.hide();
         }
 
-        if(tinyOptions.importcss_file_filter && tinyOptions.importcss_file_filter.indexOf(',') !== -1){
+        if(tinyOptions.importcss_file_filter &&
+           typeof tinyOptions.importcss_file_filter.indexOf === 'function' &&
+           tinyOptions.importcss_file_filter.indexOf(',') !== -1){
           // need a custom function to check now
           var files = tinyOptions.importcss_file_filter.split(',');
 


