Repository: plone.app.layout


Branch: refs/heads/master
Date: 2022-09-18T20:21:26+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/plone.app.layout/commit/ce2eec154b8aa5dfa3ad4e4d7a7775ee6695eee8

show full datetime

Files changed:
A news/325.bugfix
M plone/app/layout/viewlets/menu.pt

b'diff --git a/news/325.bugfix b/news/325.bugfix\nnew file mode 100644\nindex 00000000..3b83ceff\n--- /dev/null\n+++ b/news/325.bugfix\n@@ -0,0 +1,2 @@\n+Show modification datetime in toolbar with full datetime according to locale format\n+[erral]\ndiff --git a/plone/app/layout/viewlets/menu.pt b/plone/app/layout/viewlets/menu.pt\nindex 64958e1f..13c66cc0 100644\n--- a/plone/app/layout/viewlets/menu.pt\n+++ b/plone/app/layout/viewlets/menu.pt\n@@ -23,7 +23,7 @@\n             <span class="toolbar-label">\n               <time\n                 class="pat-display-time"\n-                data-pat-display-time="from-now: true"\n+                data-pat-display-time="output-format: L LTS"\n                 datetime="${context/ModificationDate}"\n                 tal:content="">${context/ModificationDate}</time>\n             </span>\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2022-09-19T12:57:11+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.layout/commit/6d519ad61c90442cf79b12148e07c3f49ebff6a5

Merge branch 'master' into erral-issue-325

Files changed:
A news/327.bugfix
M plone/app/layout/testing.py
M plone/app/layout/viewlets/tests/history.txt
M plone/app/layout/viewlets/tests/test_content.py
M plone/app/layout/viewlets/tests/test_history.py

b'diff --git a/news/327.bugfix b/news/327.bugfix\nnew file mode 100644\nindex 00000000..2d767944\n--- /dev/null\n+++ b/news/327.bugfix\n@@ -0,0 +1 @@\n+- Use longer password in tests. [davisagli]\ndiff --git a/plone/app/layout/testing.py b/plone/app/layout/testing.py\nindex 3974d941..0c95f1cd 100644\n--- a/plone/app/layout/testing.py\n+++ b/plone/app/layout/testing.py\n@@ -3,6 +3,7 @@\n from plone.app.testing import IntegrationTesting\n from plone.app.testing import PloneSandboxLayer\n from plone.app.testing import TEST_USER_ID\n+from plone.app.testing import TEST_USER_PASSWORD\n from Products.CMFPlone.utils import _createObjectByType\n \n \ndiff --git a/plone/app/layout/viewlets/tests/history.txt b/plone/app/layout/viewlets/tests/history.txt\nindex b195c103..bc7eaf3d 100644\n--- a/plone/app/layout/viewlets/tests/history.txt\n+++ b/plone/app/layout/viewlets/tests/history.txt\n@@ -11,9 +11,10 @@ Open a browser logged in as a Manager.\n \n     >>> app = layer[\'app\']\n     >>> from plone.testing.zope import Browser\n+    >>> from plone.app.testing import TEST_USER_PASSWORD\n     >>> browser = Browser(app)\n     >>> browser.handleErrors = False\n-    >>> browser.addHeader(\'Authorization\', \'Basic admin:secret\')\n+    >>> browser.addHeader(\'Authorization\', f\'Basic admin:{TEST_USER_PASSWORD}\')\n     >>> portal_url = \'http://nohost/plone\'\n \n By default, only HTTP error codes (e.g. 500 Server Side Error) are shown when an\ndiff --git a/plone/app/layout/viewlets/tests/test_content.py b/plone/app/layout/viewlets/tests/test_content.py\nindex cb8f6201..eae647f5 100644\n--- a/plone/app/layout/viewlets/tests/test_content.py\n+++ b/plone/app/layout/viewlets/tests/test_content.py\n@@ -6,6 +6,7 @@\n from plone.app.testing import logout\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n+from plone.app.testing import TEST_USER_PASSWORD\n from plone.locking.interfaces import ILockable\n from plone.registry.interfaces import IRegistry\n from plone.base.interfaces import ISecuritySchema\n@@ -70,7 +71,7 @@ def test_get_url_path(self):\n \n         # users with a slash in the userid will have a different URL\n         portal_membership = getToolByName(self.portal, "portal_membership")\n-        portal_membership.addMember("foo/bar", "secret", ["Member"], "")\n+        portal_membership.addMember("foo/bar", TEST_USER_PASSWORD, ["Member"], "")\n         self.assertEqual(viewlet.get_url_path("foo/bar"), "author/?author=foo%2Fbar")\n \n     def test_get_fullname(self):\n@@ -83,7 +84,7 @@ def test_get_fullname(self):\n         # otherwise we will return the fullname property\n         portal_membership = getToolByName(self.portal, "portal_membership")\n         portal_membership.addMember(\n-            "foo/bar", "secret", ["Member"], "", properties={"fullname": "Foo Bar"}\n+            "foo/bar", TEST_USER_PASSWORD, ["Member"], "", properties={"fullname": "Foo Bar"}\n         )\n         self.assertEqual(viewlet.get_fullname("foo/bar"), "Foo Bar")\n \ndiff --git a/plone/app/layout/viewlets/tests/test_history.py b/plone/app/layout/viewlets/tests/test_history.py\nindex cf81fcfc..9add9c8c 100644\n--- a/plone/app/layout/viewlets/tests/test_history.py\n+++ b/plone/app/layout/viewlets/tests/test_history.py\n@@ -6,6 +6,7 @@\n from plone.app.testing import setRoles\n from plone.app.testing import TEST_USER_ID\n from plone.app.testing import TEST_USER_NAME\n+from plone.app.testing import TEST_USER_PASSWORD\n \n \n class TestWorkflowHistoryViewlet(ViewletsFunctionalTestCase):\n@@ -16,7 +17,7 @@ def setUp(self):\n         self.folder.invokeFactory("Document", "d1")\n \n     def addMember(self, username, roles=("Member",)):\n-        self.portal.portal_membership.addMember(username, "secret", roles, [])\n+        self.portal.portal_membership.addMember(username, TEST_USER_PASSWORD, roles, [])\n \n     def delMember(self, username):\n         self.portal.portal_membership.deleteMembers([username])\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2022-09-19T13:12:32-03:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/223a9b7ce0cf83042857f91a3a1c6edeb14577a2

Merge pull request #326 from plone/erral-issue-325

show full datetime in toolbar modification time

Files changed:
A news/325.bugfix
M plone/app/layout/viewlets/menu.pt

b'diff --git a/news/325.bugfix b/news/325.bugfix\nnew file mode 100644\nindex 00000000..3b83ceff\n--- /dev/null\n+++ b/news/325.bugfix\n@@ -0,0 +1,2 @@\n+Show modification datetime in toolbar with full datetime according to locale format\n+[erral]\ndiff --git a/plone/app/layout/viewlets/menu.pt b/plone/app/layout/viewlets/menu.pt\nindex 64958e1f..13c66cc0 100644\n--- a/plone/app/layout/viewlets/menu.pt\n+++ b/plone/app/layout/viewlets/menu.pt\n@@ -23,7 +23,7 @@\n             <span class="toolbar-label">\n               <time\n                 class="pat-display-time"\n-                data-pat-display-time="from-now: true"\n+                data-pat-display-time="output-format: L LTS"\n                 datetime="${context/ModificationDate}"\n                 tal:content="">${context/ModificationDate}</time>\n             </span>\n'

