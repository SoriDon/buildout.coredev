Repository: mockup


Branch: refs/heads/master
Date: 2022-05-13T08:59:11+02:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/mockup/commit/1676271d9e877a7ac7e41a961514c8ed658baee3

fix(pat navigationmarker): Only mark the 'Home' entry in nav when at root. fixes gh-1164

Files changed:
M src/pat/navigationmarker/navigationmarker.js

b'diff --git a/src/pat/navigationmarker/navigationmarker.js b/src/pat/navigationmarker/navigationmarker.js\nindex a55c70921..7b724067a 100644\n--- a/src/pat/navigationmarker/navigationmarker.js\n+++ b/src/pat/navigationmarker/navigationmarker.js\n@@ -7,6 +7,7 @@ export default Base.extend({\n     parser: "mockup",\n     init: function () {\n         var self = this;\n+        const portal_url = document.body.dataset.portalUrl;\n         var href =\n             document.querySelector(\'head link[rel="canonical"]\').href ||\n             window.location.href;\n@@ -34,6 +35,10 @@ export default Base.extend({\n                         inPath = true;\n                     }\n                 }\n+                if ((navlink === portal_url) && (href !== portal_url)) {\n+                    // Avoid marking "Home" with "inPath", when not actually there\n+                    inPath = false;\n+                }\n                 if (inPath) {\n                     parent.addClass("inPath");\n                 }\n'

