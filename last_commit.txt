Repository: plone.outputfilters


Branch: refs/heads/master
Date: 2015-12-09T17:26:45+01:00
Author: Gagaro (Gagaro) <gagaro42@gmail.com>
Commit: https://github.com/plone/plone.outputfilters/commit/6250a03f16297480722c9945e2e0dac77d46bce2

fix: handle error when resolving uid if object is not a content

Files changed:
M CHANGES.rst
M plone/outputfilters/filters/resolveuid_and_caption.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8852ab3..77a1213 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,8 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
-
+- Fixed error when uid resolving if object got didn't have
+  absolute_url method.
+  [Gagaro]
 
 2.1.1 (2015-11-25)
 ------------------
diff --git a/plone/outputfilters/filters/resolveuid_and_caption.py b/plone/outputfilters/filters/resolveuid_and_caption.py
index 26b7599..9f2c949 100644
--- a/plone/outputfilters/filters/resolveuid_and_caption.py
+++ b/plone/outputfilters/filters/resolveuid_and_caption.py
@@ -249,7 +249,10 @@ def traverse_path(base, path):
         if image is None:
             return None, None, src, description
         
-        url = image.absolute_url()
+        try:
+            url = image.absolute_url()
+        except AttributeError:
+            return None, None, src, description
         if isinstance(url, unicode):
             url = url.encode('utf8')
         src = url + appendix


Repository: plone.outputfilters


Branch: refs/heads/master
Date: 2015-12-10T09:41:06+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.outputfilters/commit/8b1db516e00558c64905ca1ccf21b16ff4741acc

Merge pull request #15 from plone/fix-resolveuid-object

fix: handle error when resolving uid if object is not a content

Files changed:
M CHANGES.rst
M plone/outputfilters/filters/resolveuid_and_caption.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8852ab3..77a1213 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,8 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
-
+- Fixed error when uid resolving if object got didn't have
+  absolute_url method.
+  [Gagaro]
 
 2.1.1 (2015-11-25)
 ------------------
diff --git a/plone/outputfilters/filters/resolveuid_and_caption.py b/plone/outputfilters/filters/resolveuid_and_caption.py
index 26b7599..9f2c949 100644
--- a/plone/outputfilters/filters/resolveuid_and_caption.py
+++ b/plone/outputfilters/filters/resolveuid_and_caption.py
@@ -249,7 +249,10 @@ def traverse_path(base, path):
         if image is None:
             return None, None, src, description
         
-        url = image.absolute_url()
+        try:
+            url = image.absolute_url()
+        except AttributeError:
+            return None, None, src, description
         if isinstance(url, unicode):
             url = url.encode('utf8')
         src = url + appendix


