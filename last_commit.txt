Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-01-31T11:58:56Z
Author: Thomas Schorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/Products.Archetypes/commit/cc7b30847ababcf93d769939387e747189f23c2c

manage_reindexIndex requires index names

Files changed:
M Products/Archetypes/setuphandlers.py

diff --git a/Products/Archetypes/setuphandlers.py b/Products/Archetypes/setuphandlers.py
index ed73bd0..1275566 100644
--- a/Products/Archetypes/setuphandlers.py
+++ b/Products/Archetypes/setuphandlers.py
@@ -43,18 +43,15 @@ def install_uidcatalog(out, site, rebuild=False):
             catalog.addColumn(metadata)
             reindex = True
     if reindex:
-        catalog.manage_reindexIndex()
+        catalog.manage_reindexIndex(index_defs)
 
 
 def install_referenceCatalog(out, site, rebuild=False):
     catalog = getToolByName(site, REFERENCE_CATALOG)
     reindex = False
 
-    for indexName, indexType in (('UID', 'FieldIndex'),
-                                 ('sourceUID', 'FieldIndex'),
-                                 ('targetUID', 'FieldIndex'),
-                                 ('relationship', 'FieldIndex'),
-                                 ('targetId', 'FieldIndex'),):
+    index_names = ('UID', 'sourceUID', 'targetUID', 'relationship', 'targetId')
+    for indexName, indexType in zip(index_names, ('FieldIndex',) * 5):
         if indexName not in catalog.indexes():
             catalog.addIndex(indexName, indexType, extra=None)
             reindex = True
@@ -62,7 +59,7 @@ def install_referenceCatalog(out, site, rebuild=False):
             catalog.addColumn(indexName)
             reindex = True
     if reindex:
-        catalog.manage_reindexIndex()
+        catalog.manage_reindexIndex(index_names)
 
 
 def install_templates(out, site):


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-01-31T17:30:55+01:00
Author: Thomas Schorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/Products.Archetypes/commit/f69bb607deeb603b86e504fcd25e398d956c2112

manage_reindexIndex requires index names

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 37eb39e..3c60727 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- manage_reindexIndex requires index names (Zope4).
+  [tschorr]
 
 Bug fixes:
 


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-01-31T17:32:59+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.Archetypes/commit/e1ea7188f0f626a608370542840da227c8e71a2d

PTS is no longer used in Archetypes

Files changed:
M CHANGES.rst
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 3c60727..8846286 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -12,6 +12,8 @@ New features:
 
 - manage_reindexIndex requires index names (Zope4).
   [tschorr]
+- Remove Products.PlacelessTranslationService as dependency b/c it is not used in Archetypes.
+  [jensens]
 
 Bug fixes:
 
diff --git a/setup.py b/setup.py
index 3a29739..374bbc0 100644
--- a/setup.py
+++ b/setup.py
@@ -54,7 +54,6 @@
           'Products.DCWorkflow',
           'Products.GenericSetup>=1.8.3',
           'Products.MimetypesRegistry>=2.0.3',
-          'Products.PlacelessTranslationService',
           'Products.PortalTransforms',
           'Products.ZSQLMethods',
           'Products.statusmessages',


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-01-31T17:32:59+01:00
Author: Thomas Schorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/Products.Archetypes/commit/e88cd498a72bc895d146bf0032d73f82ca66c9b1

manage_reindexIndex requires index names

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 8846286..70c8efe 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,8 @@ New features:
   [tschorr]
 - Remove Products.PlacelessTranslationService as dependency b/c it is not used in Archetypes.
   [jensens]
+- manage_reindexIndex requires index names (Zope4).
+  [tschorr]
 
 Bug fixes:
 


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-01-31T17:32:59+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.Archetypes/commit/fca567764b1390f4dd7382afcb1ad6bce8ac5a5d

bump version

Files changed:
M CHANGES.rst
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 70c8efe..3573f23 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -1,7 +1,7 @@
 Changelog
 =========
 
-1.12.1 (unreleased)
+1.13.0 (unreleased)
 -------------------
 
 Breaking changes:
@@ -14,6 +14,7 @@ New features:
   [tschorr]
 - Remove Products.PlacelessTranslationService as dependency b/c it is not used in Archetypes.
   [jensens]
+
 - manage_reindexIndex requires index names (Zope4).
   [tschorr]
 
diff --git a/setup.py b/setup.py
index 374bbc0..5d2dbb6 100644
--- a/setup.py
+++ b/setup.py
@@ -1,6 +1,6 @@
 from setuptools import setup, find_packages
 
-version = '1.12.1.dev0'
+version = '1.13.0.dev0'
 
 setup(name='Products.Archetypes',
       version=version,


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-01-31T17:41:14+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.Archetypes/commit/dbaec6a761604296387f98a4e9a8333a11b537b2

Merge branch 'master' into plonezope4

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 3573f23..0280c31 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -12,12 +12,10 @@ New features:
 
 - manage_reindexIndex requires index names (Zope4).
   [tschorr]
+
 - Remove Products.PlacelessTranslationService as dependency b/c it is not used in Archetypes.
   [jensens]
 
-- manage_reindexIndex requires index names (Zope4).
-  [tschorr]
-
 Bug fixes:
 
 - Fix tests to work with latest plone.app.widgets 2.1.


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-01-31T18:37:39+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.Archetypes/commit/67ebe7e73c5f551a914ee99c3a9e04b57806f1d8

Merge pull request #75 from plone/plonezope4

manage_reindexIndex requires index names

Files changed:
M CHANGES.rst
M Products/Archetypes/setuphandlers.py
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 6f61725..0280c31 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -1,7 +1,7 @@
 Changelog
 =========
 
-1.12.1 (unreleased)
+1.13.0 (unreleased)
 -------------------
 
 Breaking changes:
@@ -10,6 +10,9 @@ Breaking changes:
 
 New features:
 
+- manage_reindexIndex requires index names (Zope4).
+  [tschorr]
+
 - Remove Products.PlacelessTranslationService as dependency b/c it is not used in Archetypes.
   [jensens]
 
diff --git a/Products/Archetypes/setuphandlers.py b/Products/Archetypes/setuphandlers.py
index ed73bd0..1275566 100644
--- a/Products/Archetypes/setuphandlers.py
+++ b/Products/Archetypes/setuphandlers.py
@@ -43,18 +43,15 @@ def install_uidcatalog(out, site, rebuild=False):
             catalog.addColumn(metadata)
             reindex = True
     if reindex:
-        catalog.manage_reindexIndex()
+        catalog.manage_reindexIndex(index_defs)
 
 
 def install_referenceCatalog(out, site, rebuild=False):
     catalog = getToolByName(site, REFERENCE_CATALOG)
     reindex = False
 
-    for indexName, indexType in (('UID', 'FieldIndex'),
-                                 ('sourceUID', 'FieldIndex'),
-                                 ('targetUID', 'FieldIndex'),
-                                 ('relationship', 'FieldIndex'),
-                                 ('targetId', 'FieldIndex'),):
+    index_names = ('UID', 'sourceUID', 'targetUID', 'relationship', 'targetId')
+    for indexName, indexType in zip(index_names, ('FieldIndex',) * 5):
         if indexName not in catalog.indexes():
             catalog.addIndex(indexName, indexType, extra=None)
             reindex = True
@@ -62,7 +59,7 @@ def install_referenceCatalog(out, site, rebuild=False):
             catalog.addColumn(indexName)
             reindex = True
     if reindex:
-        catalog.manage_reindexIndex()
+        catalog.manage_reindexIndex(index_names)
 
 
 def install_templates(out, site):
diff --git a/setup.py b/setup.py
index 374bbc0..5d2dbb6 100644
--- a/setup.py
+++ b/setup.py
@@ -1,6 +1,6 @@
 from setuptools import setup, find_packages
 
-version = '1.12.1.dev0'
+version = '1.13.0.dev0'
 
 setup(name='Products.Archetypes',
       version=version,


