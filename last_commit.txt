Repository: plone.volto


Branch: refs/heads/main
Date: 2022-01-25T17:38:05+01:00
Author: Víctor Fernández de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/ec02e320479de24fa82f95d90a878228bf16b704

Bring back the draftJS as default, until Slate is integrated in full in Volto (#45)

Files changed:
M CHANGES.rst
M README.rst
M src/plone/volto/profiles.zcml
M src/plone/volto/setuphandlers.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex bce5d0f..2634097 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -4,7 +4,8 @@ Changelog\n 4.0.0a2 (unreleased)\n --------------------\n \n-- Nothing changed yet.\n+- Bring back the draftJS as default, until Slate is integrated in full in Volto\n+  [sneridagh]\n \n \n 4.0.0a1 (2022-01-25)\ndiff --git a/README.rst b/README.rst\nindex 0b995d0..2a6f4b8 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -121,10 +121,10 @@ e.g. in your GS ``metadata.xml`` along with your other dependencies::\n   </dependencies>\n   </metadata>\n \n-**NOTE**: From ``plone.volto`` above version 4.0.0, the default block for creating the\n-default content in the root (or corresponding Language Root Folders) is "slate". If you\n-want still to create draftJS blocks, you need to use the ``default-homepage-drafjs`` profile.\n-\n+**NOTE**: The default block for creating the default content in the root (or\n+corresponding Language Root Folders) is "draftJS" text block. ``plone.volto`` provides a\n+profile if you want to create Slate blocks: you need to use the ``default-homepage-slate``\n+profile.\n \n Document Content Type\n ---------------------\ndiff --git a/src/plone/volto/profiles.zcml b/src/plone/volto/profiles.zcml\nindex 99f116f..b5c8ef3 100644\n--- a/src/plone/volto/profiles.zcml\n+++ b/src/plone/volto/profiles.zcml\n@@ -29,7 +29,7 @@\n       description="Creates a default page for the site"\n       provides="Products.GenericSetup.interfaces.EXTENSION"\n       directory="profiles/homepage"\n-      post_handler=".setuphandlers.create_default_homepage"\n+      post_handler=".setuphandlers.create_default_homepage_draftjs"\n       />\n \n   <genericsetup:registerProfile\n@@ -41,6 +41,15 @@\n       post_handler=".setuphandlers.create_default_homepage_draftjs"\n       />\n \n+  <genericsetup:registerProfile\n+      name="default-homepage-slate"\n+      title="Plone 6 Frontend (Default content on homepage with slate blocks)"\n+      description="Creates a default page for the site using slate blocks"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      directory="profiles/homepage"\n+      post_handler=".setuphandlers.create_default_homepage_slate"\n+      />\n+\n   <genericsetup:registerProfile\n       name="demo"\n       title="plone.volto demo special requirements"\ndiff --git a/src/plone/volto/setuphandlers.py b/src/plone/volto/setuphandlers.py\nindex ea36cbd..efeabcd 100644\n--- a/src/plone/volto/setuphandlers.py\n+++ b/src/plone/volto/setuphandlers.py\n@@ -219,6 +219,10 @@ def create_default_homepage_draftjs(context):\n     create_default_homepage(context, block_type="draftJS")\n \n \n+def create_default_homepage_slate(context):\n+    create_default_homepage(context, block_type="slate")\n+\n+\n def create_default_homepage(context, default_home=default_lrf_home, block_type=None):\n     """This method allows to pass a dict with the homepage blocks and blocks_layout keys"""\n     portal = api.portal.get()\n'

