Repository: plone.resource


Branch: refs/heads/master
Date: 2018-10-03T15:19:18+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.resource/commit/ff33ed248d5705af5219881c3329208a212bc7bf

fix testisolation by using FunctionalTesting for DemoTraverser

Files changed:
M plone/resource/testing.py
M plone/resource/tests/test_manifest.py
M plone/resource/tests/test_traversal.py
M plone/resource/tests/test_utils.py
M plone/resource/tests/test_zip_download.py

b'diff --git a/plone/resource/testing.py b/plone/resource/testing.py\nindex 83a23fd..4af003d 100644\n--- a/plone/resource/testing.py\n+++ b/plone/resource/testing.py\n@@ -3,16 +3,17 @@\n from plone.app.testing import IntegrationTesting\n from plone.app.testing import PLONE_FIXTURE\n from plone.app.testing import PloneSandboxLayer\n+from plone.testing.zope import FunctionalTesting\n+from plone.testing.zope import STARTUP\n from plone.resource.traversal import ResourceTraverser\n from plone.testing import Layer\n from plone.testing import publisher\n-from plone.testing import z2\n from plone.testing import zca\n from zope.configuration import xmlconfig\n \n \n class DemoTraverser(Layer):\n-    defaultBases = (z2.STARTUP, publisher.PUBLISHER_DIRECTIVES)\n+    defaultBases = (STARTUP, publisher.PUBLISHER_DIRECTIVES)\n \n     def setUp(self):\n         # Stack a new configuration context\n@@ -29,9 +30,9 @@ def tearDown(self):\n \n \n DEMO_TRAVERSER_FIXTURE = DemoTraverser()\n-DEMO_TRAVERSER_INTEGRATION_TESTING = z2.IntegrationTesting(\n+DEMO_TRAVERSER_FUNCTIONAL_TESTING = FunctionalTesting(\n     bases=(DEMO_TRAVERSER_FIXTURE,),\n-    name="plone.resource:DemoTraverser"\n+    name="plone.resource:DemoTraverserFunctional"\n )\n \n \ndiff --git a/plone/resource/tests/test_manifest.py b/plone/resource/tests/test_manifest.py\nindex 7c0eeb6..3bcae53 100644\n--- a/plone/resource/tests/test_manifest.py\n+++ b/plone/resource/tests/test_manifest.py\n@@ -7,7 +7,7 @@\n from plone.resource.manifest import getManifest\n from plone.resource.manifest import getZODBResources\n from plone.resource.manifest import ManifestFormat\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n from zope.component import provideUtility\n@@ -24,7 +24,7 @@\n TEST_FORMAT_PARAMS = ManifestFormat(\'demo\', [\'title\', \'description\', \'bar\'], {\'bar\': \'baz\'}, [\'params\'])\n \n class TestManifest(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         zca.pushGlobalRegistry()\ndiff --git a/plone/resource/tests/test_traversal.py b/plone/resource/tests/test_traversal.py\nindex 8ca1b13..963e34d 100644\n--- a/plone/resource/tests/test_traversal.py\n+++ b/plone/resource/tests/test_traversal.py\n@@ -4,7 +4,7 @@\n from plone.resource.file import FilesystemFile\n from plone.resource.interfaces import IResourceDirectory\n from plone.resource.interfaces import IUniqueResourceRequest\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import z2\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n@@ -21,7 +21,7 @@\n \n \n class TraversalTestCase(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.app = self.layer.get(\'app\')\ndiff --git a/plone/resource/tests/test_utils.py b/plone/resource/tests/test_utils.py\nindex 46f9c70..9b8f000 100644\n--- a/plone/resource/tests/test_utils.py\n+++ b/plone/resource/tests/test_utils.py\n@@ -2,7 +2,7 @@\n from plone.resource.directory import FilesystemResourceDirectory\n from plone.resource.directory import PersistentResourceDirectory\n from plone.resource.interfaces import IResourceDirectory\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n from zope.component import provideUtility\n@@ -16,7 +16,7 @@\n \n \n class TraversalTestCase(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.app = self.layer.get(\'app\')\ndiff --git a/plone/resource/tests/test_zip_download.py b/plone/resource/tests/test_zip_download.py\nindex e4a7229..b6fd122 100644\n--- a/plone/resource/tests/test_zip_download.py\n+++ b/plone/resource/tests/test_zip_download.py\n@@ -4,7 +4,7 @@\n from plone.resource.directory import FilesystemResourceDirectory\n from plone.resource.directory import PersistentResourceDirectory\n from plone.resource.interfaces import IResourceDirectory\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n from zope.component import provideUtility\n@@ -19,7 +19,7 @@\n \n \n class ZipDownloadTestCase(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.app = self.layer.get(\'app\')\n'

Repository: plone.resource


Branch: refs/heads/master
Date: 2018-10-14T13:17:17+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.resource/commit/1397d0ba070d87e9659afb6f7b778421bd8fb42b

fix imports

Files changed:
M plone/resource/testing.py

b'diff --git a/plone/resource/testing.py b/plone/resource/testing.py\nindex 4af003d..b1f6be2 100644\n--- a/plone/resource/testing.py\n+++ b/plone/resource/testing.py\n@@ -3,12 +3,12 @@\n from plone.app.testing import IntegrationTesting\n from plone.app.testing import PLONE_FIXTURE\n from plone.app.testing import PloneSandboxLayer\n-from plone.testing.zope import FunctionalTesting\n-from plone.testing.zope import STARTUP\n from plone.resource.traversal import ResourceTraverser\n from plone.testing import Layer\n from plone.testing import publisher\n from plone.testing import zca\n+from plone.testing.z2 import FunctionalTesting\n+from plone.testing.z2 import STARTUP\n from zope.configuration import xmlconfig\n \n \n'

Repository: plone.resource


Branch: refs/heads/master
Date: 2018-10-14T15:26:50+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.resource/commit/c987944fe55227d2f325afbb3e4879eb8f5f531f

Merge pull request #27 from plone/fix_testisolation

fix testisolation by using FunctionalTesting for DemoTraverser

Files changed:
M plone/resource/testing.py
M plone/resource/tests/test_manifest.py
M plone/resource/tests/test_traversal.py
M plone/resource/tests/test_utils.py
M plone/resource/tests/test_zip_download.py

b'diff --git a/plone/resource/testing.py b/plone/resource/testing.py\nindex 83a23fd..b1f6be2 100644\n--- a/plone/resource/testing.py\n+++ b/plone/resource/testing.py\n@@ -6,13 +6,14 @@\n from plone.resource.traversal import ResourceTraverser\n from plone.testing import Layer\n from plone.testing import publisher\n-from plone.testing import z2\n from plone.testing import zca\n+from plone.testing.z2 import FunctionalTesting\n+from plone.testing.z2 import STARTUP\n from zope.configuration import xmlconfig\n \n \n class DemoTraverser(Layer):\n-    defaultBases = (z2.STARTUP, publisher.PUBLISHER_DIRECTIVES)\n+    defaultBases = (STARTUP, publisher.PUBLISHER_DIRECTIVES)\n \n     def setUp(self):\n         # Stack a new configuration context\n@@ -29,9 +30,9 @@ def tearDown(self):\n \n \n DEMO_TRAVERSER_FIXTURE = DemoTraverser()\n-DEMO_TRAVERSER_INTEGRATION_TESTING = z2.IntegrationTesting(\n+DEMO_TRAVERSER_FUNCTIONAL_TESTING = FunctionalTesting(\n     bases=(DEMO_TRAVERSER_FIXTURE,),\n-    name="plone.resource:DemoTraverser"\n+    name="plone.resource:DemoTraverserFunctional"\n )\n \n \ndiff --git a/plone/resource/tests/test_manifest.py b/plone/resource/tests/test_manifest.py\nindex 7c0eeb6..3bcae53 100644\n--- a/plone/resource/tests/test_manifest.py\n+++ b/plone/resource/tests/test_manifest.py\n@@ -7,7 +7,7 @@\n from plone.resource.manifest import getManifest\n from plone.resource.manifest import getZODBResources\n from plone.resource.manifest import ManifestFormat\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n from zope.component import provideUtility\n@@ -24,7 +24,7 @@\n TEST_FORMAT_PARAMS = ManifestFormat(\'demo\', [\'title\', \'description\', \'bar\'], {\'bar\': \'baz\'}, [\'params\'])\n \n class TestManifest(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         zca.pushGlobalRegistry()\ndiff --git a/plone/resource/tests/test_traversal.py b/plone/resource/tests/test_traversal.py\nindex 8ca1b13..963e34d 100644\n--- a/plone/resource/tests/test_traversal.py\n+++ b/plone/resource/tests/test_traversal.py\n@@ -4,7 +4,7 @@\n from plone.resource.file import FilesystemFile\n from plone.resource.interfaces import IResourceDirectory\n from plone.resource.interfaces import IUniqueResourceRequest\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import z2\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n@@ -21,7 +21,7 @@\n \n \n class TraversalTestCase(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.app = self.layer.get(\'app\')\ndiff --git a/plone/resource/tests/test_utils.py b/plone/resource/tests/test_utils.py\nindex 46f9c70..9b8f000 100644\n--- a/plone/resource/tests/test_utils.py\n+++ b/plone/resource/tests/test_utils.py\n@@ -2,7 +2,7 @@\n from plone.resource.directory import FilesystemResourceDirectory\n from plone.resource.directory import PersistentResourceDirectory\n from plone.resource.interfaces import IResourceDirectory\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n from zope.component import provideUtility\n@@ -16,7 +16,7 @@\n \n \n class TraversalTestCase(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.app = self.layer.get(\'app\')\ndiff --git a/plone/resource/tests/test_zip_download.py b/plone/resource/tests/test_zip_download.py\nindex e4a7229..b6fd122 100644\n--- a/plone/resource/tests/test_zip_download.py\n+++ b/plone/resource/tests/test_zip_download.py\n@@ -4,7 +4,7 @@\n from plone.resource.directory import FilesystemResourceDirectory\n from plone.resource.directory import PersistentResourceDirectory\n from plone.resource.interfaces import IResourceDirectory\n-from plone.resource.testing import DEMO_TRAVERSER_INTEGRATION_TESTING\n+from plone.resource.testing import DEMO_TRAVERSER_FUNCTIONAL_TESTING\n from plone.testing import zca\n from Products.BTreeFolder2.BTreeFolder2 import BTreeFolder2\n from zope.component import provideUtility\n@@ -19,7 +19,7 @@\n \n \n class ZipDownloadTestCase(unittest.TestCase):\n-    layer = DEMO_TRAVERSER_INTEGRATION_TESTING\n+    layer = DEMO_TRAVERSER_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.app = self.layer.get(\'app\')\n'

