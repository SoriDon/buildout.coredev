Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-05-22T17:39:21+02:00
Author: Jesse Stippel (Netroxen) <jesse.stippel@operun.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/a48263b48e0b1ccac4d2e17cccbae5c54d2af4ad

fixed self closing script tags and comments

Files changed:
M Products/CMFPlone/resources/browser/scripts.pt

b'diff --git a/Products/CMFPlone/resources/browser/scripts.pt b/Products/CMFPlone/resources/browser/scripts.pt\nindex 3549e18f1..d3d762fd7 100644\n--- a/Products/CMFPlone/resources/browser/scripts.pt\n+++ b/Products/CMFPlone/resources/browser/scripts.pt\n@@ -1,26 +1,38 @@\n <script tal:content="string:PORTAL_URL = \'${view/site_url}\';"></script>\n-<tal:scripts repeat="script view/scripts"><tal:block define="condcomment script/conditionalcomment; resetrjs script/resetrjs|nothing"><tal:if condition="resetrjs">\n-  <tal:openreset content=\'structure string:&lt;script&gt;\'/>\n-      /* reset requirejs definitions so that people who put requirejs in legacy compilation do not get errors */\n+\n+<tal:scripts repeat="script view/scripts">\n+  <tal:block define="condcomment script/conditionalcomment; resetrjs script/resetrjs|nothing">\n+\n+    <tal:if condition="resetrjs">\n+      <tal:openreset content=\'structure string:&lt;script&gt;\'></tal:openreset>\n+\n+      <tal:comment tal:replace="nothing">\n+        Reset RequireJS definitions so that people who put RequireJS in a legacy compilation do not get errors\n+      </tal:comment>\n+\n       var _old_define = define;\n       var _old_require = require;\n       define = undefined;\n       require = undefined;\n-  <tal:endreset content=\'structure string:&lt;/script&gt;\'/>\n-</tal:if><tal:if condition="condcomment">\n-    <tal:opencc tal:replace="structure string:&lt;!--[if ${condcomment}]&gt;" />\n-</tal:if>\n-  <script type="text/javascript"\n-      tal:attributes="\n-        src script/src;\n-        data-bundle script/bundle;\n-        async script/async|nothing;\n-        defer script/defer|nothing"/>\n-<tal:if condition="condcomment">\n-  <tal:closecc tal:condition="condcomment" tal:replace="structure string:&lt;![endif]--&gt;" />\n-</tal:if><tal:if condition="resetrjs">\n-  <tal:openredefine content=\'structure string:&lt;script&gt;\'/>\n+      <tal:endreset content=\'structure string:&lt;/script&gt;\'></tal:endreset>\n+    </tal:if>\n+\n+    <tal:if condition="condcomment">\n+      <tal:opencc tal:replace="structure string:&lt;!--[if ${condcomment}]&gt;"></tal:opencc>\n+    </tal:if>\n+\n+    <script type="text/javascript" tal:attributes="src script/src; data-bundle script/bundle; async script/async|nothing; defer script/defer|nothing"></script>\n+\n+    <tal:if condition="condcomment">\n+      <tal:closecc tal:condition="condcomment" tal:replace="structure string:&lt;![endif]--&gt;"></tal:closecc>\n+    </tal:if>\n+\n+    <tal:if condition="resetrjs">\n+      <tal:openredefine content=\'structure string:&lt;script&gt;\'></tal:openredefine>\n       define = _old_define;\n       require = _old_require;\n-  <tal:endredefine content=\'structure string:&lt;/script&gt;\'/>\n-</tal:if></tal:block></tal:scripts>\n+      <tal:endredefine content=\'structure string:&lt;/script&gt;\'></tal:endredefine>\n+    </tal:if>\n+\n+  </tal:block>\n+</tal:scripts>\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-05-22T17:49:43+02:00
Author: Jesse Stippel (Netroxen) <jesse.stippel@operun.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/487c8021b6b5650de7ed8732ecd8280f9ca3ff31

update changes

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 22bd9f9ab..7d9386090 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -41,7 +41,7 @@ Bug fixes:\n - Fix DeprecationWarning in syndication-view. [jensens] (#2831)\n - Fix malformed url when redirecting to external login. [ericof] (#2842)\n - Make navigation (CatalogNavigationTabs) subclassing easier. [iham] (#2849)\n-\n+- Fix script resource parsing error because of self closing tags. [netroxen] (#2870)\n \n 5.2rc2 (2019-03-21)\n -------------------\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-05-24T11:02:33+02:00
Author: Jesse Stippel (Netroxen) <jesse.stippel@operun.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/28b1b990255b10c1638d4002b799a6abc7f2fdc3

revert changes

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 7d9386090..22bd9f9ab 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -41,7 +41,7 @@ Bug fixes:\n - Fix DeprecationWarning in syndication-view. [jensens] (#2831)\n - Fix malformed url when redirecting to external login. [ericof] (#2842)\n - Make navigation (CatalogNavigationTabs) subclassing easier. [iham] (#2849)\n-- Fix script resource parsing error because of self closing tags. [netroxen] (#2870)\n+\n \n 5.2rc2 (2019-03-21)\n -------------------\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-05-24T11:26:38+02:00
Author: Jesse Stippel (Netroxen) <jesse.stippel@operun.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/69fa3dacfcbdf48658a85d72fc08eb39fe4e36ea

added news change

Files changed:
A news/2870.bugfix

b'diff --git a/news/2870.bugfix b/news/2870.bugfix\nnew file mode 100644\nindex 000000000..c87b0a312\n--- /dev/null\n+++ b/news/2870.bugfix\n@@ -0,0 +1,2 @@\n+Fix script resource parsing error because of self closing tags.\n+[Netroxen]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2019-05-27T00:10:32+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/cfa56163281a965c46eebea1ab25951b786fc0cc

Merge pull request #2871 from Netroxen/fix_script_resource_template

Fix scripts.pt Parsing Errors &amp; Self-Closing Tags

Files changed:
A news/2870.bugfix
M Products/CMFPlone/resources/browser/scripts.pt

b'diff --git a/Products/CMFPlone/resources/browser/scripts.pt b/Products/CMFPlone/resources/browser/scripts.pt\nindex 3549e18f1..d3d762fd7 100644\n--- a/Products/CMFPlone/resources/browser/scripts.pt\n+++ b/Products/CMFPlone/resources/browser/scripts.pt\n@@ -1,26 +1,38 @@\n <script tal:content="string:PORTAL_URL = \'${view/site_url}\';"></script>\n-<tal:scripts repeat="script view/scripts"><tal:block define="condcomment script/conditionalcomment; resetrjs script/resetrjs|nothing"><tal:if condition="resetrjs">\n-  <tal:openreset content=\'structure string:&lt;script&gt;\'/>\n-      /* reset requirejs definitions so that people who put requirejs in legacy compilation do not get errors */\n+\n+<tal:scripts repeat="script view/scripts">\n+  <tal:block define="condcomment script/conditionalcomment; resetrjs script/resetrjs|nothing">\n+\n+    <tal:if condition="resetrjs">\n+      <tal:openreset content=\'structure string:&lt;script&gt;\'></tal:openreset>\n+\n+      <tal:comment tal:replace="nothing">\n+        Reset RequireJS definitions so that people who put RequireJS in a legacy compilation do not get errors\n+      </tal:comment>\n+\n       var _old_define = define;\n       var _old_require = require;\n       define = undefined;\n       require = undefined;\n-  <tal:endreset content=\'structure string:&lt;/script&gt;\'/>\n-</tal:if><tal:if condition="condcomment">\n-    <tal:opencc tal:replace="structure string:&lt;!--[if ${condcomment}]&gt;" />\n-</tal:if>\n-  <script type="text/javascript"\n-      tal:attributes="\n-        src script/src;\n-        data-bundle script/bundle;\n-        async script/async|nothing;\n-        defer script/defer|nothing"/>\n-<tal:if condition="condcomment">\n-  <tal:closecc tal:condition="condcomment" tal:replace="structure string:&lt;![endif]--&gt;" />\n-</tal:if><tal:if condition="resetrjs">\n-  <tal:openredefine content=\'structure string:&lt;script&gt;\'/>\n+      <tal:endreset content=\'structure string:&lt;/script&gt;\'></tal:endreset>\n+    </tal:if>\n+\n+    <tal:if condition="condcomment">\n+      <tal:opencc tal:replace="structure string:&lt;!--[if ${condcomment}]&gt;"></tal:opencc>\n+    </tal:if>\n+\n+    <script type="text/javascript" tal:attributes="src script/src; data-bundle script/bundle; async script/async|nothing; defer script/defer|nothing"></script>\n+\n+    <tal:if condition="condcomment">\n+      <tal:closecc tal:condition="condcomment" tal:replace="structure string:&lt;![endif]--&gt;"></tal:closecc>\n+    </tal:if>\n+\n+    <tal:if condition="resetrjs">\n+      <tal:openredefine content=\'structure string:&lt;script&gt;\'></tal:openredefine>\n       define = _old_define;\n       require = _old_require;\n-  <tal:endredefine content=\'structure string:&lt;/script&gt;\'/>\n-</tal:if></tal:block></tal:scripts>\n+      <tal:endredefine content=\'structure string:&lt;/script&gt;\'></tal:endredefine>\n+    </tal:if>\n+\n+  </tal:block>\n+</tal:scripts>\ndiff --git a/news/2870.bugfix b/news/2870.bugfix\nnew file mode 100644\nindex 000000000..c87b0a312\n--- /dev/null\n+++ b/news/2870.bugfix\n@@ -0,0 +1,2 @@\n+Fix script resource parsing error because of self closing tags.\n+[Netroxen]\n'

