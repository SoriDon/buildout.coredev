Repository: mockup


Branch: refs/heads/master
Date: 2019-06-05T19:42:54+02:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/mockup/commit/ec1f5537a2f057ef9cc5fb70acda7394e70c3be8

Fix marking of parents as inPath

Files changed:
M mockup/patterns/navigationmarker/pattern.js

b'diff --git a/mockup/patterns/navigationmarker/pattern.js b/mockup/patterns/navigationmarker/pattern.js\nindex bd1d72969..5a3bdfeb1 100644\n--- a/mockup/patterns/navigationmarker/pattern.js\n+++ b/mockup/patterns/navigationmarker/pattern.js\n@@ -12,18 +12,18 @@\n define([\n     \'jquery\',\n     \'pat-base\'\n-], function($, Base) {\n+], function ($, Base) {\n \n     var Navigation = Base.extend({\n         name: \'navigationmarker\',\n         trigger: \'.pat-navigationmarker\',\n         parser: \'mockup\',\n-        init: function() {\n+        init: function () {\n             var self = this;\n             var href = document.querySelector(\'head link[rel="canonical"]\').href || window.location.href;\n \n             $(\'a\', this.$el).each(function () {\n-                var navlink = this.href.replace(\'/view\',\'\')\n+                var navlink = this.href.replace(\'/view\', \'\')\n                 if (href.indexOf(navlink) !== -1) {\n                     var parent = $(this).parent();\n \n@@ -34,7 +34,21 @@ define([\n                     }\n \n                     // set "inPath" to all nav items which are within the current path\n-                    parent.addClass(\'inPath\');\n+                    if (href.includes(navlink)) {\n+                        // check if parts of navlink are in canonical url parts\n+                        var hrefParts = href.split(\'/\')\n+                        var navParts = navlink.split(\'/\')\n+                        for (var i = 0, size = navParts.length; i < size; i++) {\n+                            var inPath = false\n+                            if (navParts[i] === hrefParts[i]) {\n+                                inPath = true;\n+                            }\n+                        }\n+                        if (inPath) {\n+                            parent.addClass(\'inPath\');\n+                        }\n+                    }\n+\n                     // set "current" to the current selected nav item, if it is in the navigation structure.\n                     if (href === navlink) {\n                         parent.addClass(\'current\');\n@@ -45,4 +59,4 @@ define([\n     });\n \n     return Navigation;\n-});\n+});\n\\ No newline at end of file\n'

Repository: mockup


Branch: refs/heads/master
Date: 2019-06-05T19:48:48+02:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/mockup/commit/aa109dc9ae942d8aaf9ff2f66be3bb129e9363b4

add news

Files changed:
A news/906.fix

b'diff --git a/news/906.fix b/news/906.fix\nnew file mode 100644\nindex 000000000..3dc129b40\n--- /dev/null\n+++ b/news/906.fix\n@@ -0,0 +1,2 @@\n+- Fix marking of navigation parents as inPath\n+  [agitator]\n\\ No newline at end of file\n'

Repository: mockup


Branch: refs/heads/master
Date: 2019-06-17T16:46:08+02:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/mockup/commit/406cb81b9f071eb9e8d876c891ea1c318ac460fa

remove unused check

Files changed:
M mockup/patterns/navigationmarker/pattern.js

b'diff --git a/mockup/patterns/navigationmarker/pattern.js b/mockup/patterns/navigationmarker/pattern.js\nindex 5a3bdfeb1..4eb24a785 100644\n--- a/mockup/patterns/navigationmarker/pattern.js\n+++ b/mockup/patterns/navigationmarker/pattern.js\n@@ -34,20 +34,18 @@ define([\n                     }\n \n                     // set "inPath" to all nav items which are within the current path\n-                    if (href.includes(navlink)) {\n-                        // check if parts of navlink are in canonical url parts\n-                        var hrefParts = href.split(\'/\')\n-                        var navParts = navlink.split(\'/\')\n-                        for (var i = 0, size = navParts.length; i < size; i++) {\n-                            var inPath = false\n-                            if (navParts[i] === hrefParts[i]) {\n-                                inPath = true;\n-                            }\n-                        }\n-                        if (inPath) {\n-                            parent.addClass(\'inPath\');\n+                    // check if parts of navlink are in canonical url parts\n+                    var hrefParts = href.split(\'/\')\n+                    var navParts = navlink.split(\'/\')\n+                    for (var i = 0, size = navParts.length; i < size; i++) {\n+                        var inPath = false\n+                        if (navParts[i] === hrefParts[i]) {\n+                            inPath = true;\n                         }\n                     }\n+                    if (inPath) {\n+                        parent.addClass(\'inPath\');\n+                    }\n \n                     // set "current" to the current selected nav item, if it is in the navigation structure.\n                     if (href === navlink) {\n'

Repository: mockup


Branch: refs/heads/master
Date: 2019-06-18T09:16:42+02:00
Author: agitator (agitator) <agitator@users.noreply.github.com>
Commit: https://github.com/plone/mockup/commit/8e11df2e930779e2c34dddf83767ef6f2de86284

Merge pull request #906 from plone/fix-inpath-class

Fix marking of parent as inPath

Files changed:
A news/906.fix
M mockup/patterns/navigationmarker/pattern.js

b'diff --git a/mockup/patterns/navigationmarker/pattern.js b/mockup/patterns/navigationmarker/pattern.js\nindex bd1d72969..4eb24a785 100644\n--- a/mockup/patterns/navigationmarker/pattern.js\n+++ b/mockup/patterns/navigationmarker/pattern.js\n@@ -12,18 +12,18 @@\n define([\n     \'jquery\',\n     \'pat-base\'\n-], function($, Base) {\n+], function ($, Base) {\n \n     var Navigation = Base.extend({\n         name: \'navigationmarker\',\n         trigger: \'.pat-navigationmarker\',\n         parser: \'mockup\',\n-        init: function() {\n+        init: function () {\n             var self = this;\n             var href = document.querySelector(\'head link[rel="canonical"]\').href || window.location.href;\n \n             $(\'a\', this.$el).each(function () {\n-                var navlink = this.href.replace(\'/view\',\'\')\n+                var navlink = this.href.replace(\'/view\', \'\')\n                 if (href.indexOf(navlink) !== -1) {\n                     var parent = $(this).parent();\n \n@@ -34,7 +34,19 @@ define([\n                     }\n \n                     // set "inPath" to all nav items which are within the current path\n-                    parent.addClass(\'inPath\');\n+                    // check if parts of navlink are in canonical url parts\n+                    var hrefParts = href.split(\'/\')\n+                    var navParts = navlink.split(\'/\')\n+                    for (var i = 0, size = navParts.length; i < size; i++) {\n+                        var inPath = false\n+                        if (navParts[i] === hrefParts[i]) {\n+                            inPath = true;\n+                        }\n+                    }\n+                    if (inPath) {\n+                        parent.addClass(\'inPath\');\n+                    }\n+\n                     // set "current" to the current selected nav item, if it is in the navigation structure.\n                     if (href === navlink) {\n                         parent.addClass(\'current\');\n@@ -45,4 +57,4 @@ define([\n     });\n \n     return Navigation;\n-});\n+});\n\\ No newline at end of file\ndiff --git a/news/906.fix b/news/906.fix\nnew file mode 100644\nindex 000000000..3dc129b40\n--- /dev/null\n+++ b/news/906.fix\n@@ -0,0 +1,2 @@\n+- Fix marking of navigation parents as inPath\n+  [agitator]\n\\ No newline at end of file\n'

