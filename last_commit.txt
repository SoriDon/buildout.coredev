Repository: plone.formwidget.recurrence


Branch: refs/heads/master
Date: 2015-11-18T11:01:12+01:00
Author: Julian Handl (julianhandl) <julian.handl@gmail.com>
Commit: https://github.com/plone/plone.formwidget.recurrence/commit/b6f08e9e71d4fc1b041265bf9f25e7dda6bafe79

Fix index out of range bug for current batch

Files changed:
M plone/formwidget/recurrence/browser/json_recurrence.py

diff --git a/plone/formwidget/recurrence/browser/json_recurrence.py b/plone/formwidget/recurrence/browser/json_recurrence.py
index 1356ec0..a3ba94c 100644
--- a/plone/formwidget/recurrence/browser/json_recurrence.py
+++ b/plone/formwidget/recurrence/browser/json_recurrence.py
@@ -171,6 +171,10 @@ def json_string(self):
             ((x * batch_size) + 1, (x + 1) * batch_size)
             for x in range(first_batch, last_batch + 1)
         ]
+        # cur_batch must be set relative to first_batch as the batches array
+        # is cut down, but the cur_batch variable is not. With this we prevent
+        # a list index out of range error
+        cur_batch = cur_batch - first_batch
         # correct number of occurrences in current batch
         (cur_batch_start, cur_batch_end) = batches[cur_batch]
         if cur_batch_end > len(occurrences):


Repository: plone.formwidget.recurrence


Branch: refs/heads/master
Date: 2015-11-18T11:06:11+01:00
Author: Julian Handl (julianhandl) <julian.handl@gmail.com>
Commit: https://github.com/plone/plone.formwidget.recurrence/commit/2abc01b3aa51fefefcf719e04550dd9b9caa0824

Update CHANGES.rst

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 50f37db..3c2e3d6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,8 @@ Fixes:
 
 - Removed unittest2 dependency.
   [gforcada]
+- Fix list index out of range at pagination.
+  [julianhandl]
 
 
 2.0.1 (2015-06-05)


Repository: plone.formwidget.recurrence


Branch: refs/heads/master
Date: 2015-12-04T00:24:50+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.formwidget.recurrence/commit/9991a0c38b57d0dce457df663e6fa1fbf809293c

Merge pull request #18 from julianhandl/master

Fix index out of range bug for current batch

Files changed:
M CHANGES.rst
M plone/formwidget/recurrence/browser/json_recurrence.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 50f37db..3c2e3d6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,8 @@ Fixes:
 
 - Removed unittest2 dependency.
   [gforcada]
+- Fix list index out of range at pagination.
+  [julianhandl]
 
 
 2.0.1 (2015-06-05)
diff --git a/plone/formwidget/recurrence/browser/json_recurrence.py b/plone/formwidget/recurrence/browser/json_recurrence.py
index 1356ec0..a3ba94c 100644
--- a/plone/formwidget/recurrence/browser/json_recurrence.py
+++ b/plone/formwidget/recurrence/browser/json_recurrence.py
@@ -171,6 +171,10 @@ def json_string(self):
             ((x * batch_size) + 1, (x + 1) * batch_size)
             for x in range(first_batch, last_batch + 1)
         ]
+        # cur_batch must be set relative to first_batch as the batches array
+        # is cut down, but the cur_batch variable is not. With this we prevent
+        # a list index out of range error
+        cur_batch = cur_batch - first_batch
         # correct number of occurrences in current batch
         (cur_batch_start, cur_batch_end) = batches[cur_batch]
         if cur_batch_end > len(occurrences):


