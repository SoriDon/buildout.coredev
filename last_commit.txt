Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-27T17:27:19+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/ccbf261a702f7652c84db67f186478ad98045215

fix for iconresolver

Files changed:
A news/3500.bugfix
M Products/CMFPlone/browser/icons.py

b'diff --git a/Products/CMFPlone/browser/icons.py b/Products/CMFPlone/browser/icons.py\nindex 1bb25e7d58..4b4a4495ba 100644\n--- a/Products/CMFPlone/browser/icons.py\n+++ b/Products/CMFPlone/browser/icons.py\n@@ -64,9 +64,13 @@ class IconsView(BrowserView):\n \n     prefix = "plone.icon."\n     defaulticon = "++plone++icons/plone.svg"\n+    name = ""\n \n     def publishTraverse(self, request, name):\n-        self.name = name\n+        if self.name:\n+            # fix traversing to eg. "contenttype/document"\n+            self.name += "/"\n+        self.name += name\n         return self\n \n     def __call__(self):\ndiff --git a/news/3500.bugfix b/news/3500.bugfix\nnew file mode 100644\nindex 0000000000..cd758e0f65\n--- /dev/null\n+++ b/news/3500.bugfix\n@@ -0,0 +1,2 @@\n+fix `@@iconresolver` to resolve names with "/" correctly (eg. "contenttype/document")\n+[petschki]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-04-27T23:16:45+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/19f845d8a40f10abd50bd2f44a82a2f1a8896802

Merge pull request #3512 from plone/petschki-iconresolver

Fix @@iconresolver resolving subpaths (eg. "contenttype/document")

Files changed:
A news/3500.bugfix
M Products/CMFPlone/browser/icons.py

b'diff --git a/Products/CMFPlone/browser/icons.py b/Products/CMFPlone/browser/icons.py\nindex 1bb25e7d58..4b4a4495ba 100644\n--- a/Products/CMFPlone/browser/icons.py\n+++ b/Products/CMFPlone/browser/icons.py\n@@ -64,9 +64,13 @@ class IconsView(BrowserView):\n \n     prefix = "plone.icon."\n     defaulticon = "++plone++icons/plone.svg"\n+    name = ""\n \n     def publishTraverse(self, request, name):\n-        self.name = name\n+        if self.name:\n+            # fix traversing to eg. "contenttype/document"\n+            self.name += "/"\n+        self.name += name\n         return self\n \n     def __call__(self):\ndiff --git a/news/3500.bugfix b/news/3500.bugfix\nnew file mode 100644\nindex 0000000000..cd758e0f65\n--- /dev/null\n+++ b/news/3500.bugfix\n@@ -0,0 +1,2 @@\n+fix `@@iconresolver` to resolve names with "/" correctly (eg. "contenttype/document")\n+[petschki]\n'

