Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-02T21:18:54+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/0fbff88df7370bb3fac12d00de79dcd6920ec097

Fixed html validation: bad value menu for attribute role on element section.

This is in the footer actions portlet, which contains links to
Sitemap, Accessibility, and Contact.

Also, when the header is not shown, you get this warning:
Section lacks heading.

Also, when the header *is* shown, we get an error:
The element 'header' must not appear as a descendant of the 'footer' element.

Also, the section with class portletContent is always lacking a header.

Solutions in this fix:
- Removed the role from this section.
- Changed all sections to divs.

Files changed:
M plone/app/portlets/portlets/actions.pt

diff --git a/plone/app/portlets/portlets/actions.pt b/plone/app/portlets/portlets/actions.pt
index 1189441..63bca23 100644
--- a/plone/app/portlets/portlets/actions.pt
+++ b/plone/app/portlets/portlets/actions.pt
@@ -4,15 +4,15 @@
       tal:omit-tag=""
       i18n:domain="plone">
 
-<section class="portlet portletActions" role="menu"
+<aside class="portlet portletActions"
     tal:define="portal_url context/@@plone_portal_state/portal_url;">
 
-  <header class="portletHeader" tal:condition="view/showTitle">
+  <div class="portletHeader" tal:condition="view/showTitle">
         <span tal:condition="view/title" tal:content="view/title">
           Title
         </span>
-  </header>
-  <section class="portletContent">
+  </div>
+  <div class="portletContent">
     <ul>
       <tal:loop tal:repeat="link view/actionLinks">
         <li class="portletItem"
@@ -39,6 +39,6 @@
         </li>
       </tal:loop>
     </ul>
-  </section>
-</section>
+  </div>
+</aside>
 </html>


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-02T21:18:54+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/c6ca0d51d5aa33fa8ff90caa7e43be5b34bb5fa7

Fixed html validation: Attribute alt not allowed on element input at this point.

Fixed this in the login portlet.
For the submit input, changed the alt to a title.
The other inputs already have a label.

Files changed:
M plone/app/portlets/portlets/login.pt

diff --git a/plone/app/portlets/portlets/login.pt b/plone/app/portlets/portlets/login.pt
index 606737f..f843a0b 100644
--- a/plone/app/portlets/portlets/login.pt
+++ b/plone/app/portlets/portlets/login.pt
@@ -39,10 +39,8 @@
                 <br />
                 <input type="text"
                        size="10"
-                       alt="Login Name"
                        tal:attributes="name ac_name; id ac_name;
-                                       value python:request.get(ac_name, '');"
-                       i18n:attributes="alt label_login_name;"/>
+                                       value python:request.get(ac_name, '');" />
               </tal:loginname>
               <tal:email condition="use_email_as_login">
                 <label for=""
@@ -51,10 +49,8 @@
                 <br />
                 <input type="text"
                        size="10"
-                       alt="E-mail"
                        tal:attributes="name ac_name; id ac_name;
-                                       value python:request.get(ac_name, '');"
-                       i18n:attributes="alt label_email;"/>
+                                       value python:request.get(ac_name, '');" />
               </tal:email>
             </div>
 
@@ -65,9 +61,7 @@
                 <br />
                 <input type="password"
                        size="10"
-                       alt="Password"
-                       tal:attributes="name ac_password; id ac_password;"
-                       i18n:attributes="alt label_password;"/>
+                       tal:attributes="name ac_password; id ac_password;" />
             </div>
 
             <div class="cookiesMessage portalMessage warning"
@@ -87,8 +81,8 @@
                        type="submit"
                        name="submit"
                        value="Log in"
-                       alt="Log in"
-                       i18n:attributes="value label_log_in; alt label_log_in;"/>
+                       title="Log in"
+                       i18n:attributes="value label_log_in; title label_log_in;"/>
             </div>
         </form>
       </div>


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-02T21:18:55+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/c4ccd9903b80a6c24471f44721652981706b0516

Removed role 'section' from section.

A section is already a section, so there is no need for a role with this name/
Also, no such role exists.
If no role is given explicitly, the default 'region' role is used,
and such a default role should not be set, as browsers do that themselves.

See http://w3c.github.io/html/sections.html#the-section-element

Files changed:
M plone/app/portlets/portlets/language.pt
M plone/app/portlets/portlets/login.pt
M plone/app/portlets/portlets/news.pt
M plone/app/portlets/portlets/recent.pt
M plone/app/portlets/portlets/review.pt
M plone/app/portlets/portlets/rss.pt

diff --git a/plone/app/portlets/portlets/language.pt b/plone/app/portlets/portlets/language.pt
index 27fe9ac..77c249e 100644
--- a/plone/app/portlets/portlets/language.pt
+++ b/plone/app/portlets/portlets/language.pt
@@ -1,6 +1,6 @@
 <tal:block i18n:domain="plone">
 
-<section class="portlet portletLanguage" role="section">
+<section class="portlet portletLanguage">
     <header class="portletHeader">
         <span class="tile" i18n:translate="box_languages">Languages</span>
     </header>
diff --git a/plone/app/portlets/portlets/login.pt b/plone/app/portlets/portlets/login.pt
index f843a0b..645e4a8 100644
--- a/plone/app/portlets/portlets/login.pt
+++ b/plone/app/portlets/portlets/login.pt
@@ -1,7 +1,7 @@
 <tal:block condition="view/show"
            i18n:domain="plone">
 
-<section class="portlet portletLogin"  role="section"
+<section class="portlet portletLogin"
     tal:condition="view/available">
 
   <header class="portletHeader">
diff --git a/plone/app/portlets/portlets/news.pt b/plone/app/portlets/portlets/news.pt
index 72c8052..39eb9e3 100644
--- a/plone/app/portlets/portlets/news.pt
+++ b/plone/app/portlets/portlets/news.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletNews"  role="section"
+<section class="portlet portletNews"
     i18n:domain="plone">
 
   <header class="portletHeader">
diff --git a/plone/app/portlets/portlets/recent.pt b/plone/app/portlets/portlets/recent.pt
index 4403b0f..53b06f9 100644
--- a/plone/app/portlets/portlets/recent.pt
+++ b/plone/app/portlets/portlets/recent.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletRecent" role="section"
+<section class="portlet portletRecent"
     i18n:domain="plone">
 
     <header class="portletHeader">
diff --git a/plone/app/portlets/portlets/review.pt b/plone/app/portlets/portlets/review.pt
index e63ae8f..b3b40b2 100644
--- a/plone/app/portlets/portlets/review.pt
+++ b/plone/app/portlets/portlets/review.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletWorkflowReview" role="section"
+<section class="portlet portletWorkflowReview"
     i18n:domain="plone">
 
   <header class="portletHeader">
diff --git a/plone/app/portlets/portlets/rss.pt b/plone/app/portlets/portlets/rss.pt
index 48a362b..687dd27 100644
--- a/plone/app/portlets/portlets/rss.pt
+++ b/plone/app/portlets/portlets/rss.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletRss" role="section"
+<section class="portlet portletRss"
     i18n:domain="plone"
     tal:condition="view/enabled">
 


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-02T21:18:55+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/fcb77d6e4f183a5749907a4829749d1dc959aa96

Changed section.portletContent into div.

These have no heading, and a heading makes no sense here anyway, so they should be divs.

Files changed:
M plone/app/portlets/portlets/language.pt
M plone/app/portlets/portlets/login.pt
M plone/app/portlets/portlets/news.pt
M plone/app/portlets/portlets/recent.pt
M plone/app/portlets/portlets/review.pt
M plone/app/portlets/portlets/rss.pt
M plone/app/portlets/portlets/search.pt

diff --git a/plone/app/portlets/portlets/language.pt b/plone/app/portlets/portlets/language.pt
index 77c249e..a5e3c23 100644
--- a/plone/app/portlets/portlets/language.pt
+++ b/plone/app/portlets/portlets/language.pt
@@ -4,7 +4,7 @@
     <header class="portletHeader">
         <span class="tile" i18n:translate="box_languages">Languages</span>
     </header>
-    <section class="portletContent">
+    <div class="portletContent">
         <ul tal:define="showFlags view/showFlags">
             <li class="portletItem" tal:repeat="lang view/languages">
                 <span tal:define="code lang/code;
@@ -30,7 +30,7 @@
                 </span>
             </li>
         </ul>
-    </section>
+    </div>
 
 </section>
 </tal:block>
diff --git a/plone/app/portlets/portlets/login.pt b/plone/app/portlets/portlets/login.pt
index 645e4a8..c4d72c3 100644
--- a/plone/app/portlets/portlets/login.pt
+++ b/plone/app/portlets/portlets/login.pt
@@ -10,7 +10,7 @@
            tal:attributes="href view/login_form"
            i18n:translate="box_sign_in">Log in</a>
   </header>
-  <section class="portletContent">
+  <div class="portletContent">
     <div
         tal:define="ac_name view/login_name;
                     ac_password view/login_password">
@@ -86,7 +86,7 @@
             </div>
         </form>
       </div>
-  </section>
+  </div>
   <footer class="portletFooter">
     <div tal:condition="view/can_request_password">
         <a href="mail_password_form"
diff --git a/plone/app/portlets/portlets/news.pt b/plone/app/portlets/portlets/news.pt
index 39eb9e3..bdebaf5 100644
--- a/plone/app/portlets/portlets/news.pt
+++ b/plone/app/portlets/portlets/news.pt
@@ -13,7 +13,7 @@
            tal:attributes="href all_news_link"
            i18n:translate="box_news">News</a>
   </header>
-  <section class="portletContent">
+  <div class="portletContent">
     <ul>
       <tal:newsitems  tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime;
                                   plone_layout context/@@plone_layout"
@@ -25,11 +25,11 @@
             class="tile"
             tal:attributes="href obj/getURL;
                              title obj/Description">
-            <img class="image-icon" 
+            <img class="image-icon"
                tal:define="getIcon python:obj.getURL()+'/@@images/image/icon'"
-               tal:condition="python:  obj.getIcon"                          
+               tal:condition="python:  obj.getIcon"
                tal:attributes="href obj/getURL;
-                               src  string:$getIcon">                                        
+                               src  string:$getIcon">
            <span tal:replace="obj/pretty_title_or_id">
              Plone 5.1 announced!
            </span>
@@ -40,7 +40,7 @@
       </li>
       </tal:newsitems>
     </ul>
-  </section>
+  </div>
   <footer class="portletFooter"
          tal:condition="view/all_news_link">
         <a href=""
diff --git a/plone/app/portlets/portlets/recent.pt b/plone/app/portlets/portlets/recent.pt
index 53b06f9..d07e9da 100644
--- a/plone/app/portlets/portlets/recent.pt
+++ b/plone/app/portlets/portlets/recent.pt
@@ -11,7 +11,7 @@
             i18n:translate=""
             tal:content="view/title" />
     </header>
-    <section class="portletContent"
+    <div class="portletContent"
         tal:condition="view/recent_items">
       <ul>
         <tal:items tal:define="plone_view context/@@plone;
@@ -31,11 +31,11 @@
                                 class string:$item_wf_state_class tile $item_class">
                   <img class="image-icon"
                     tal:define="getIcon python:obj.getURL()+'/@@images/image/icon'"
-                    tal:condition="python:  obj.getIcon"                          
+                    tal:condition="python:  obj.getIcon"
                     tal:attributes="href obj/getURL;
-                              src  string:$getIcon">        
+                              src  string:$getIcon">
                   <span tal:content="obj/pretty_title_or_id">
-                     Title                    
+                     Title
                  </span>
 
              </a>
@@ -45,12 +45,12 @@
           </li>
         </tal:items>
       </ul>
-    </section>
+    </div>
 
-    <section class="portletContent"
+    <div class="portletContent"
         tal:condition="not: view/recent_items">
         <p i18n:translate="box_recent_no_items">No items changed yet.</p>
-    </section>
+    </div>
 
     <footer class="portletFooter">
         <a href="#"
diff --git a/plone/app/portlets/portlets/review.pt b/plone/app/portlets/portlets/review.pt
index b3b40b2..bd303a2 100644
--- a/plone/app/portlets/portlets/review.pt
+++ b/plone/app/portlets/portlets/review.pt
@@ -14,7 +14,7 @@
            i18n:translate=""
            tal:content="view/title" />
   </header>
-  <section class="portletContent">
+  <div class="portletContent">
     <ul>
       <tal:items tal:repeat="o view/review_items">
           <li class="portletItem"
@@ -29,14 +29,14 @@
                                  class string:$review_state_class tile $item_class">
       	            <img class="image-icon"
                   tal:define="getIcon string:${o/path}/@@images/image/icon"
-                  tal:condition="o/hasImage"                        
+                  tal:condition="o/hasImage"
                   tal:attributes="href string:${o/path}/view;
                                src  string:$getIcon">
                   <span tal:replace="o/title">
                       Title
                   </span>
               </a>
- 	
+
                   <span class="portletItemDetails">
                       <span tal:replace="o/creator">Jim Smith</span> &mdash;
                       <time tal:replace="o/mod_date"> May 5</time>
@@ -45,7 +45,7 @@
           </li>
       </tal:items>
     </ul>
-  </section>
+  </div>
 
   <footer class="portletFooter"
         tal:define="full_review_link view/full_review_link"
diff --git a/plone/app/portlets/portlets/rss.pt b/plone/app/portlets/portlets/rss.pt
index 687dd27..f5e0c31 100644
--- a/plone/app/portlets/portlets/rss.pt
+++ b/plone/app/portlets/portlets/rss.pt
@@ -15,7 +15,7 @@
       Tags
     </a>
   </header>
-  <section class="portletContent" >
+  <div class="portletContent" >
     <ul tal:condition="view/feedAvailable">
       <tal:rss
                   tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime"
@@ -38,7 +38,7 @@
           </li>
       </tal:rss>
     </ul>
-  </section>
+  </div>
   <footer class="portletFooter" tal:condition="view/feedAvailable">
         <a href=""
            tal:condition="view/siteurl"
diff --git a/plone/app/portlets/portlets/search.pt b/plone/app/portlets/portlets/search.pt
index 7ccfed6..b589f06 100644
--- a/plone/app/portlets/portlets/search.pt
+++ b/plone/app/portlets/portlets/search.pt
@@ -17,7 +17,7 @@
       </a>
   </header>
 
-  <section class="portletContent">
+  <div class="portletContent">
       <form id="searchform" action="search"
             tal:define="livesearch view/enable_livesearch;"
             tal:attributes="action view/search_action;
@@ -45,7 +45,7 @@
           </div>
         </div>
       </form>
-    </section>
+  </div>
 
     <footer class="portletFooter">
         <a href="#"


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-02T21:18:55+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/360fcaa16c37f63e63f5e59103ec473e5febee69

Changed main portlet sections into divs.

These have no heading, so they should be divs.
They have a *header*, but that is not a *heading*: those are h1-h6.

Files changed:
M plone/app/portlets/portlets/language.pt
M plone/app/portlets/portlets/login.pt
M plone/app/portlets/portlets/navigation.pt
M plone/app/portlets/portlets/news.pt
M plone/app/portlets/portlets/recent.pt
M plone/app/portlets/portlets/review.pt
M plone/app/portlets/portlets/rss.pt
M plone/app/portlets/portlets/search.pt

diff --git a/plone/app/portlets/portlets/language.pt b/plone/app/portlets/portlets/language.pt
index a5e3c23..14ef484 100644
--- a/plone/app/portlets/portlets/language.pt
+++ b/plone/app/portlets/portlets/language.pt
@@ -1,6 +1,6 @@
 <tal:block i18n:domain="plone">
 
-<section class="portlet portletLanguage">
+<aside class="portlet portletLanguage">
     <header class="portletHeader">
         <span class="tile" i18n:translate="box_languages">Languages</span>
     </header>
@@ -32,5 +32,5 @@
         </ul>
     </div>
 
-</section>
+</aside>
 </tal:block>
diff --git a/plone/app/portlets/portlets/login.pt b/plone/app/portlets/portlets/login.pt
index c4d72c3..0debbbf 100644
--- a/plone/app/portlets/portlets/login.pt
+++ b/plone/app/portlets/portlets/login.pt
@@ -1,7 +1,7 @@
 <tal:block condition="view/show"
            i18n:domain="plone">
 
-<section class="portlet portletLogin"
+<aside class="portlet portletLogin"
     tal:condition="view/available">
 
   <header class="portletHeader">
@@ -106,9 +106,9 @@
         </a>
     </div>
   </footer>
-</section>
+</aside>
 
-<section class="portlet portletLogin"
+<aside class="portlet portletLogin"
     tal:condition="not:view/available">
 
     <header class="portletHeader">
@@ -123,6 +123,6 @@
         Login portlet not available.
     </div>
 
-</section>
+</aside>
 
 </tal:block>
diff --git a/plone/app/portlets/portlets/navigation.pt b/plone/app/portlets/portlets/navigation.pt
index 5532abd..1b498f8 100644
--- a/plone/app/portlets/portlets/navigation.pt
+++ b/plone/app/portlets/portlets/navigation.pt
@@ -1,5 +1,5 @@
 <tal:block i18n:domain="plone">
-<section class="portlet portletNavigationTree"
+<aside class="portlet portletNavigationTree"
     role="navigation"
     tal:define="root view/navigation_root">
 
@@ -43,5 +43,5 @@
             </li>
         </ul>
     </nav>
-</section>
+</aside>
 </tal:block>
diff --git a/plone/app/portlets/portlets/news.pt b/plone/app/portlets/portlets/news.pt
index bdebaf5..4d62e1f 100644
--- a/plone/app/portlets/portlets/news.pt
+++ b/plone/app/portlets/portlets/news.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletNews"
+<aside class="portlet portletNews"
     i18n:domain="plone">
 
   <header class="portletHeader">
@@ -51,5 +51,5 @@
   </footer>
   <footer class="portletFooter" tal:condition="not:view/all_news_link">
   </footer>
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/recent.pt b/plone/app/portlets/portlets/recent.pt
index d07e9da..e5ad74d 100644
--- a/plone/app/portlets/portlets/recent.pt
+++ b/plone/app/portlets/portlets/recent.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletRecent"
+<aside class="portlet portletRecent"
     i18n:domain="plone">
 
     <header class="portletHeader">
@@ -61,5 +61,5 @@
         </a>
     </footer>
 
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/review.pt b/plone/app/portlets/portlets/review.pt
index bd303a2..b5fe4bc 100644
--- a/plone/app/portlets/portlets/review.pt
+++ b/plone/app/portlets/portlets/review.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletWorkflowReview"
+<aside class="portlet portletWorkflowReview"
     i18n:domain="plone">
 
   <header class="portletHeader">
@@ -55,5 +55,5 @@
            tal:attributes="href full_review_link"
            i18n:translate="box_full_review_list">Full review list&hellip;</a>
   </footer>
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/rss.pt b/plone/app/portlets/portlets/rss.pt
index f5e0c31..64d7f24 100644
--- a/plone/app/portlets/portlets/rss.pt
+++ b/plone/app/portlets/portlets/rss.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletRss"
+<aside class="portlet portletRss"
     i18n:domain="plone"
     tal:condition="view/enabled">
 
@@ -47,5 +47,5 @@
            <span i18n:translate="box_morelink">More&hellip;</span>
         </a>
   </footer>
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/search.pt b/plone/app/portlets/portlets/search.pt
index b589f06..852339e 100644
--- a/plone/app/portlets/portlets/search.pt
+++ b/plone/app/portlets/portlets/search.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletSearch" role="search"
+<aside class="portlet portletSearch" role="search"
     i18n:domain="plone">
 
   <header class="portletHeader">
@@ -55,5 +55,5 @@
         Advanced Search&hellip;
         </a>
     </footer>
-</section>
+</aside>
 </html>


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-02T21:18:55+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/74cf25b151ca96e8368a8f737c42ec7677f56453

Added changelog entry for html validation fixes.

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index df44bf9..3d4b616 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,13 @@ New:
 
 Fixes:
 
-- *add item here*
+- Fixed html validation:
+  - section lacks heading
+  - bad value 'menu' for attribute role on element section
+  - bad value 'section' for attribute role on element section
+  - attribute alt not allowed on element input at this point
+  - bad value menu for attribute role on element section.
+  [maurits]
 
 
 3.1.3 (2015-11-25)


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-02T21:18:55+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/88fe86e8dff7f3bc1a3a1cada31fcc0d166f6b16

Added incompatibility note for changed html elements.

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 3d4b616..b488416 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,16 @@ Changelog
 3.1.4 (unreleased)
 ------------------
 
+Incompatibilities:
+
+- Changed these ``section`` elements to ``div`` elements:
+  ``.portletHeader``, ``.portletContent``.  Changed these ``section``
+  elements to ``aside`` elements: ``.portletActions``,
+  ``.portletLanguage``, ``.portletLogin``, ``.portletNavigationTree``,
+  ``.portletNews``, ``.portletRecent``, ``.portletWorkflowReview``,
+  ``.portletRss``, ``.portletSearch``.  This might affect your custom
+  styling or javascript or robot tests.  [maurits]
+
 New:
 
 - *add item here*


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-11T12:58:12+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/868b1bd4d04de90cb48d8c0791f22871c76a8705

pushed version according to http://semver.org/#spec-item-8

Files changed:
M CHANGES.rst
M README.rst
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b488416..0b5c64f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -1,7 +1,7 @@
 Changelog
 =========
 
-3.1.4 (unreleased)
+4.0.0 (unreleased)
 ------------------
 
 Incompatibilities:
diff --git a/README.rst b/README.rst
index a578b63..6c10947 100644
--- a/README.rst
+++ b/README.rst
@@ -11,3 +11,4 @@ Compatibility
 plone.app.portlets 2.4.x is for Plone 4.3.
 plone.app.portlets 2.5.x is for Plone 4.3 with plone.app.event (makes the calendar- and events-portlets use the p.a.event implementation)
 plone.app.portlets 3.x is for Plone 5.
+plone.app.portlets 4.x is for Plone 5.1
diff --git a/setup.py b/setup.py
index 62d930c..238e4b0 100644
--- a/setup.py
+++ b/setup.py
@@ -1,39 +1,42 @@
-from setuptools import setup, find_packages
+# -*- coding: utf-8 -*-
+from setuptools import find_packages
+from setuptools import setup
 
-version = '3.1.4.dev0'
+version = '4.0.0.dev0'
 
-setup(name='plone.app.portlets',
-      version=version,
-      description="Plone integration for the basic plone.portlets package",
-      long_description=open("README.rst").read() + "\n" +
-                       open("CHANGES.rst").read(),
-      classifiers=[
-          "Environment :: Web Environment",
-          "Framework :: Plone",
-          "Framework :: Plone :: 5.0",
-          "Framework :: Zope2",
-          "License :: OSI Approved :: GNU General Public License (GPL)",
-          "Operating System :: OS Independent",
-          "Programming Language :: Python",
-          "Programming Language :: Python :: 2.7",
+setup(
+    name='plone.app.portlets',
+    version=version,
+    description="Plone integration for the basic plone.portlets package",
+    long_description=open("README.rst").read() + "\n" +
+    open("CHANGES.rst").read(),
+    classifiers=[
+        "Environment :: Web Environment",
+        "Framework :: Plone",
+        "Framework :: Plone :: 5.0",
+        "Framework :: Zope2",
+        "License :: OSI Approved :: GNU General Public License (GPL)",
+        "Operating System :: OS Independent",
+        "Programming Language :: Python",
+        "Programming Language :: Python :: 2.7",
+    ],
+    keywords='portlets viewlets plone',
+    author='Plone Foundation',
+    author_email='plone-developers@lists.sourceforge.net',
+    url='https://pypi.python.org/pypi/plone.app.portlets',
+    license='GPL version 2',
+    packages=find_packages(exclude=['ez_setup']),
+    namespace_packages=['plone', 'plone.app'],
+    include_package_data=True,
+    zip_safe=False,
+    extras_require=dict(
+        test=[
+            'Products.ATContentTypes',
+            'plone.app.blob',
+            'plone.app.testing',
         ],
-      keywords='portlets viewlets plone',
-      author='Plone Foundation',
-      author_email='plone-developers@lists.sourceforge.net',
-      url='https://pypi.python.org/pypi/plone.app.portlets',
-      license='GPL version 2',
-      packages=find_packages(exclude=['ez_setup']),
-      namespace_packages = ['plone', 'plone.app'],
-      include_package_data=True,
-      zip_safe=False,
-      extras_require=dict(
-          test=[
-              'Products.ATContentTypes',
-              'plone.app.blob',
-              'plone.app.testing',
-          ],
-      ),
-      install_requires=[
+    ),
+    install_requires=[
         'setuptools',
         'five.customerize',
         'plone.i18n',
@@ -67,5 +70,5 @@
         'DateTime',
         'Zope2 >= 2.12.3',
         'feedparser',
-      ],
-      )
+    ],
+)


Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2016-03-11T13:05:01+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/c7d6a522ca73778e70a3d634d71e521da487115d

Merge pull request #64 from plone/maurits-fix-html-validation

Fix html validation

Files changed:
M CHANGES.rst
M README.rst
M plone/app/portlets/portlets/actions.pt
M plone/app/portlets/portlets/language.pt
M plone/app/portlets/portlets/login.pt
M plone/app/portlets/portlets/navigation.pt
M plone/app/portlets/portlets/news.pt
M plone/app/portlets/portlets/recent.pt
M plone/app/portlets/portlets/review.pt
M plone/app/portlets/portlets/rss.pt
M plone/app/portlets/portlets/search.pt
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index df44bf9..0b5c64f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -1,16 +1,32 @@
 Changelog
 =========
 
-3.1.4 (unreleased)
+4.0.0 (unreleased)
 ------------------
 
+Incompatibilities:
+
+- Changed these ``section`` elements to ``div`` elements:
+  ``.portletHeader``, ``.portletContent``.  Changed these ``section``
+  elements to ``aside`` elements: ``.portletActions``,
+  ``.portletLanguage``, ``.portletLogin``, ``.portletNavigationTree``,
+  ``.portletNews``, ``.portletRecent``, ``.portletWorkflowReview``,
+  ``.portletRss``, ``.portletSearch``.  This might affect your custom
+  styling or javascript or robot tests.  [maurits]
+
 New:
 
 - *add item here*
 
 Fixes:
 
-- *add item here*
+- Fixed html validation:
+  - section lacks heading
+  - bad value 'menu' for attribute role on element section
+  - bad value 'section' for attribute role on element section
+  - attribute alt not allowed on element input at this point
+  - bad value menu for attribute role on element section.
+  [maurits]
 
 
 3.1.3 (2015-11-25)
diff --git a/README.rst b/README.rst
index a578b63..6c10947 100644
--- a/README.rst
+++ b/README.rst
@@ -11,3 +11,4 @@ Compatibility
 plone.app.portlets 2.4.x is for Plone 4.3.
 plone.app.portlets 2.5.x is for Plone 4.3 with plone.app.event (makes the calendar- and events-portlets use the p.a.event implementation)
 plone.app.portlets 3.x is for Plone 5.
+plone.app.portlets 4.x is for Plone 5.1
diff --git a/plone/app/portlets/portlets/actions.pt b/plone/app/portlets/portlets/actions.pt
index 1189441..63bca23 100644
--- a/plone/app/portlets/portlets/actions.pt
+++ b/plone/app/portlets/portlets/actions.pt
@@ -4,15 +4,15 @@
       tal:omit-tag=""
       i18n:domain="plone">
 
-<section class="portlet portletActions" role="menu"
+<aside class="portlet portletActions"
     tal:define="portal_url context/@@plone_portal_state/portal_url;">
 
-  <header class="portletHeader" tal:condition="view/showTitle">
+  <div class="portletHeader" tal:condition="view/showTitle">
         <span tal:condition="view/title" tal:content="view/title">
           Title
         </span>
-  </header>
-  <section class="portletContent">
+  </div>
+  <div class="portletContent">
     <ul>
       <tal:loop tal:repeat="link view/actionLinks">
         <li class="portletItem"
@@ -39,6 +39,6 @@
         </li>
       </tal:loop>
     </ul>
-  </section>
-</section>
+  </div>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/language.pt b/plone/app/portlets/portlets/language.pt
index 27fe9ac..14ef484 100644
--- a/plone/app/portlets/portlets/language.pt
+++ b/plone/app/portlets/portlets/language.pt
@@ -1,10 +1,10 @@
 <tal:block i18n:domain="plone">
 
-<section class="portlet portletLanguage" role="section">
+<aside class="portlet portletLanguage">
     <header class="portletHeader">
         <span class="tile" i18n:translate="box_languages">Languages</span>
     </header>
-    <section class="portletContent">
+    <div class="portletContent">
         <ul tal:define="showFlags view/showFlags">
             <li class="portletItem" tal:repeat="lang view/languages">
                 <span tal:define="code lang/code;
@@ -30,7 +30,7 @@
                 </span>
             </li>
         </ul>
-    </section>
+    </div>
 
-</section>
+</aside>
 </tal:block>
diff --git a/plone/app/portlets/portlets/login.pt b/plone/app/portlets/portlets/login.pt
index 606737f..0debbbf 100644
--- a/plone/app/portlets/portlets/login.pt
+++ b/plone/app/portlets/portlets/login.pt
@@ -1,7 +1,7 @@
 <tal:block condition="view/show"
            i18n:domain="plone">
 
-<section class="portlet portletLogin"  role="section"
+<aside class="portlet portletLogin"
     tal:condition="view/available">
 
   <header class="portletHeader">
@@ -10,7 +10,7 @@
            tal:attributes="href view/login_form"
            i18n:translate="box_sign_in">Log in</a>
   </header>
-  <section class="portletContent">
+  <div class="portletContent">
     <div
         tal:define="ac_name view/login_name;
                     ac_password view/login_password">
@@ -39,10 +39,8 @@
                 <br />
                 <input type="text"
                        size="10"
-                       alt="Login Name"
                        tal:attributes="name ac_name; id ac_name;
-                                       value python:request.get(ac_name, '');"
-                       i18n:attributes="alt label_login_name;"/>
+                                       value python:request.get(ac_name, '');" />
               </tal:loginname>
               <tal:email condition="use_email_as_login">
                 <label for=""
@@ -51,10 +49,8 @@
                 <br />
                 <input type="text"
                        size="10"
-                       alt="E-mail"
                        tal:attributes="name ac_name; id ac_name;
-                                       value python:request.get(ac_name, '');"
-                       i18n:attributes="alt label_email;"/>
+                                       value python:request.get(ac_name, '');" />
               </tal:email>
             </div>
 
@@ -65,9 +61,7 @@
                 <br />
                 <input type="password"
                        size="10"
-                       alt="Password"
-                       tal:attributes="name ac_password; id ac_password;"
-                       i18n:attributes="alt label_password;"/>
+                       tal:attributes="name ac_password; id ac_password;" />
             </div>
 
             <div class="cookiesMessage portalMessage warning"
@@ -87,12 +81,12 @@
                        type="submit"
                        name="submit"
                        value="Log in"
-                       alt="Log in"
-                       i18n:attributes="value label_log_in; alt label_log_in;"/>
+                       title="Log in"
+                       i18n:attributes="value label_log_in; title label_log_in;"/>
             </div>
         </form>
       </div>
-  </section>
+  </div>
   <footer class="portletFooter">
     <div tal:condition="view/can_request_password">
         <a href="mail_password_form"
@@ -112,9 +106,9 @@
         </a>
     </div>
   </footer>
-</section>
+</aside>
 
-<section class="portlet portletLogin"
+<aside class="portlet portletLogin"
     tal:condition="not:view/available">
 
     <header class="portletHeader">
@@ -129,6 +123,6 @@
         Login portlet not available.
     </div>
 
-</section>
+</aside>
 
 </tal:block>
diff --git a/plone/app/portlets/portlets/navigation.pt b/plone/app/portlets/portlets/navigation.pt
index 5532abd..1b498f8 100644
--- a/plone/app/portlets/portlets/navigation.pt
+++ b/plone/app/portlets/portlets/navigation.pt
@@ -1,5 +1,5 @@
 <tal:block i18n:domain="plone">
-<section class="portlet portletNavigationTree"
+<aside class="portlet portletNavigationTree"
     role="navigation"
     tal:define="root view/navigation_root">
 
@@ -43,5 +43,5 @@
             </li>
         </ul>
     </nav>
-</section>
+</aside>
 </tal:block>
diff --git a/plone/app/portlets/portlets/news.pt b/plone/app/portlets/portlets/news.pt
index 72c8052..4d62e1f 100644
--- a/plone/app/portlets/portlets/news.pt
+++ b/plone/app/portlets/portlets/news.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletNews"  role="section"
+<aside class="portlet portletNews"
     i18n:domain="plone">
 
   <header class="portletHeader">
@@ -13,7 +13,7 @@
            tal:attributes="href all_news_link"
            i18n:translate="box_news">News</a>
   </header>
-  <section class="portletContent">
+  <div class="portletContent">
     <ul>
       <tal:newsitems  tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime;
                                   plone_layout context/@@plone_layout"
@@ -25,11 +25,11 @@
             class="tile"
             tal:attributes="href obj/getURL;
                              title obj/Description">
-            <img class="image-icon" 
+            <img class="image-icon"
                tal:define="getIcon python:obj.getURL()+'/@@images/image/icon'"
-               tal:condition="python:  obj.getIcon"                          
+               tal:condition="python:  obj.getIcon"
                tal:attributes="href obj/getURL;
-                               src  string:$getIcon">                                        
+                               src  string:$getIcon">
            <span tal:replace="obj/pretty_title_or_id">
              Plone 5.1 announced!
            </span>
@@ -40,7 +40,7 @@
       </li>
       </tal:newsitems>
     </ul>
-  </section>
+  </div>
   <footer class="portletFooter"
          tal:condition="view/all_news_link">
         <a href=""
@@ -51,5 +51,5 @@
   </footer>
   <footer class="portletFooter" tal:condition="not:view/all_news_link">
   </footer>
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/recent.pt b/plone/app/portlets/portlets/recent.pt
index 4403b0f..e5ad74d 100644
--- a/plone/app/portlets/portlets/recent.pt
+++ b/plone/app/portlets/portlets/recent.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletRecent" role="section"
+<aside class="portlet portletRecent"
     i18n:domain="plone">
 
     <header class="portletHeader">
@@ -11,7 +11,7 @@
             i18n:translate=""
             tal:content="view/title" />
     </header>
-    <section class="portletContent"
+    <div class="portletContent"
         tal:condition="view/recent_items">
       <ul>
         <tal:items tal:define="plone_view context/@@plone;
@@ -31,11 +31,11 @@
                                 class string:$item_wf_state_class tile $item_class">
                   <img class="image-icon"
                     tal:define="getIcon python:obj.getURL()+'/@@images/image/icon'"
-                    tal:condition="python:  obj.getIcon"                          
+                    tal:condition="python:  obj.getIcon"
                     tal:attributes="href obj/getURL;
-                              src  string:$getIcon">        
+                              src  string:$getIcon">
                   <span tal:content="obj/pretty_title_or_id">
-                     Title                    
+                     Title
                  </span>
 
              </a>
@@ -45,12 +45,12 @@
           </li>
         </tal:items>
       </ul>
-    </section>
+    </div>
 
-    <section class="portletContent"
+    <div class="portletContent"
         tal:condition="not: view/recent_items">
         <p i18n:translate="box_recent_no_items">No items changed yet.</p>
-    </section>
+    </div>
 
     <footer class="portletFooter">
         <a href="#"
@@ -61,5 +61,5 @@
         </a>
     </footer>
 
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/review.pt b/plone/app/portlets/portlets/review.pt
index e63ae8f..b5fe4bc 100644
--- a/plone/app/portlets/portlets/review.pt
+++ b/plone/app/portlets/portlets/review.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletWorkflowReview" role="section"
+<aside class="portlet portletWorkflowReview"
     i18n:domain="plone">
 
   <header class="portletHeader">
@@ -14,7 +14,7 @@
            i18n:translate=""
            tal:content="view/title" />
   </header>
-  <section class="portletContent">
+  <div class="portletContent">
     <ul>
       <tal:items tal:repeat="o view/review_items">
           <li class="portletItem"
@@ -29,14 +29,14 @@
                                  class string:$review_state_class tile $item_class">
       	            <img class="image-icon"
                   tal:define="getIcon string:${o/path}/@@images/image/icon"
-                  tal:condition="o/hasImage"                        
+                  tal:condition="o/hasImage"
                   tal:attributes="href string:${o/path}/view;
                                src  string:$getIcon">
                   <span tal:replace="o/title">
                       Title
                   </span>
               </a>
- 	
+
                   <span class="portletItemDetails">
                       <span tal:replace="o/creator">Jim Smith</span> &mdash;
                       <time tal:replace="o/mod_date"> May 5</time>
@@ -45,7 +45,7 @@
           </li>
       </tal:items>
     </ul>
-  </section>
+  </div>
 
   <footer class="portletFooter"
         tal:define="full_review_link view/full_review_link"
@@ -55,5 +55,5 @@
            tal:attributes="href full_review_link"
            i18n:translate="box_full_review_list">Full review list&hellip;</a>
   </footer>
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/rss.pt b/plone/app/portlets/portlets/rss.pt
index 48a362b..64d7f24 100644
--- a/plone/app/portlets/portlets/rss.pt
+++ b/plone/app/portlets/portlets/rss.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletRss" role="section"
+<aside class="portlet portletRss"
     i18n:domain="plone"
     tal:condition="view/enabled">
 
@@ -15,7 +15,7 @@
       Tags
     </a>
   </header>
-  <section class="portletContent" >
+  <div class="portletContent" >
     <ul tal:condition="view/feedAvailable">
       <tal:rss
                   tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime"
@@ -38,7 +38,7 @@
           </li>
       </tal:rss>
     </ul>
-  </section>
+  </div>
   <footer class="portletFooter" tal:condition="view/feedAvailable">
         <a href=""
            tal:condition="view/siteurl"
@@ -47,5 +47,5 @@
            <span i18n:translate="box_morelink">More&hellip;</span>
         </a>
   </footer>
-</section>
+</aside>
 </html>
diff --git a/plone/app/portlets/portlets/search.pt b/plone/app/portlets/portlets/search.pt
index 7ccfed6..852339e 100644
--- a/plone/app/portlets/portlets/search.pt
+++ b/plone/app/portlets/portlets/search.pt
@@ -2,7 +2,7 @@
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       tal:omit-tag="">
-<section class="portlet portletSearch" role="search"
+<aside class="portlet portletSearch" role="search"
     i18n:domain="plone">
 
   <header class="portletHeader">
@@ -17,7 +17,7 @@
       </a>
   </header>
 
-  <section class="portletContent">
+  <div class="portletContent">
       <form id="searchform" action="search"
             tal:define="livesearch view/enable_livesearch;"
             tal:attributes="action view/search_action;
@@ -45,7 +45,7 @@
           </div>
         </div>
       </form>
-    </section>
+  </div>
 
     <footer class="portletFooter">
         <a href="#"
@@ -55,5 +55,5 @@
         Advanced Search&hellip;
         </a>
     </footer>
-</section>
+</aside>
 </html>
diff --git a/setup.py b/setup.py
index 62d930c..238e4b0 100644
--- a/setup.py
+++ b/setup.py
@@ -1,39 +1,42 @@
-from setuptools import setup, find_packages
+# -*- coding: utf-8 -*-
+from setuptools import find_packages
+from setuptools import setup
 
-version = '3.1.4.dev0'
+version = '4.0.0.dev0'
 
-setup(name='plone.app.portlets',
-      version=version,
-      description="Plone integration for the basic plone.portlets package",
-      long_description=open("README.rst").read() + "\n" +
-                       open("CHANGES.rst").read(),
-      classifiers=[
-          "Environment :: Web Environment",
-          "Framework :: Plone",
-          "Framework :: Plone :: 5.0",
-          "Framework :: Zope2",
-          "License :: OSI Approved :: GNU General Public License (GPL)",
-          "Operating System :: OS Independent",
-          "Programming Language :: Python",
-          "Programming Language :: Python :: 2.7",
+setup(
+    name='plone.app.portlets',
+    version=version,
+    description="Plone integration for the basic plone.portlets package",
+    long_description=open("README.rst").read() + "\n" +
+    open("CHANGES.rst").read(),
+    classifiers=[
+        "Environment :: Web Environment",
+        "Framework :: Plone",
+        "Framework :: Plone :: 5.0",
+        "Framework :: Zope2",
+        "License :: OSI Approved :: GNU General Public License (GPL)",
+        "Operating System :: OS Independent",
+        "Programming Language :: Python",
+        "Programming Language :: Python :: 2.7",
+    ],
+    keywords='portlets viewlets plone',
+    author='Plone Foundation',
+    author_email='plone-developers@lists.sourceforge.net',
+    url='https://pypi.python.org/pypi/plone.app.portlets',
+    license='GPL version 2',
+    packages=find_packages(exclude=['ez_setup']),
+    namespace_packages=['plone', 'plone.app'],
+    include_package_data=True,
+    zip_safe=False,
+    extras_require=dict(
+        test=[
+            'Products.ATContentTypes',
+            'plone.app.blob',
+            'plone.app.testing',
         ],
-      keywords='portlets viewlets plone',
-      author='Plone Foundation',
-      author_email='plone-developers@lists.sourceforge.net',
-      url='https://pypi.python.org/pypi/plone.app.portlets',
-      license='GPL version 2',
-      packages=find_packages(exclude=['ez_setup']),
-      namespace_packages = ['plone', 'plone.app'],
-      include_package_data=True,
-      zip_safe=False,
-      extras_require=dict(
-          test=[
-              'Products.ATContentTypes',
-              'plone.app.blob',
-              'plone.app.testing',
-          ],
-      ),
-      install_requires=[
+    ),
+    install_requires=[
         'setuptools',
         'five.customerize',
         'plone.i18n',
@@ -67,5 +70,5 @@
         'DateTime',
         'Zope2 >= 2.12.3',
         'feedparser',
-      ],
-      )
+    ],
+)


