Repository: plone.i18n


Branch: refs/heads/master
Date: 2021-09-07T17:12:09+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.i18n/commit/838e2b953420fb6fe5d2b2f97f56de14cfd9564d

Support Cyrillic and Latin character sets for Serbian.

See https://github.com/collective/plone.app.locales/issues/326.

This is a forward port of https://github.com/plone/plone.i18n/pull/37 from 4.x to master.

Files changed:
A news/326.feature
M plone/i18n/locales/languages.py

b'diff --git a/news/326.feature b/news/326.feature\nnew file mode 100644\nindex 0000000..784a46f\n--- /dev/null\n+++ b/news/326.feature\n@@ -0,0 +1,3 @@\n+Support Cyrillic and Latin character sets for Serbian.\n+See `locales issue 326 <https://github.com/collective/plone.app.locales/issues/326>`_.\n+[maurits, fredvd]\ndiff --git a/plone/i18n/locales/languages.py b/plone/i18n/locales/languages.py\nindex ea0b7ec..817f5e1 100644\n--- a/plone/i18n/locales/languages.py\n+++ b/plone/i18n/locales/languages.py\n@@ -3,6 +3,8 @@\n from plone.i18n.locales.interfaces import IMetadataLanguageAvailability\n from zope.interface import implementer\n \n+import os\n+\n \n @implementer(ILanguageAvailability)\n class LanguageAvailability:\n@@ -460,6 +462,10 @@ class MetadataLanguageAvailability(LanguageAvailability):\n         "flag": "/++resource++country-flags/al.gif",\n     },\n     "sr": {\n+        # Note: we support two character sets for this language.\n+        # See zope_i18n_allowed_languages below.\n+        # TODO: in Plone 6.0 native should become \'Srpski\',\n+        # but that requires copying sr@Latn to sr in plone.app.locales.\n         "native": "\xd1\x81\xd1\x80\xd0\xbf\xd1\x81\xd0\xba\xd0\xb8",\n         "name": "Serbian",\n         "flag": "/++resource++country-flags/cs.gif",\n@@ -553,6 +559,23 @@ class MetadataLanguageAvailability(LanguageAvailability):\n     },\n }\n \n+# Character sets are a thing now.\n+# See https://github.com/collective/plone.app.locales/issues/326\n+# At the moment only for Serbian.\n+_zope_i18n_allowed_languages = os.environ.get("zope_i18n_allowed_languages", "")\n+if "sr@Latn" in _zope_i18n_allowed_languages:\n+    _languagelist["sr"] = {\n+        "native": "Srpski",\n+        "name": "Serbian (Latin)",\n+        "flag": "/++resource++country-flags/cs.gif",\n+    }\n+elif "sr@Cyrl" in _zope_i18n_allowed_languages:\n+    _languagelist["sr"] = {\n+        "native": "\xd1\x81\xd1\x80\xd0\xbf\xd1\x81\xd0\xba\xd0\xb8",\n+        "name": "Serbian (Cyrillic)",\n+        "flag": "/++resource++country-flags/cs.gif",\n+    }\n+\n # convert the utf-8 encoded values to unicode\n for code in _languagelist:\n     value = _languagelist[code]\n'

Repository: plone.i18n


Branch: refs/heads/master
Date: 2021-10-14T12:40:18+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.i18n/commit/e9589cfd416bf254918782f5ae1ab3e5f0e2cbe6

Merge pull request #38 from plone/maurits/serbian-master

Support Cyrillic and Latin character sets for Serbian. [master]

Files changed:
A news/326.feature
M plone/i18n/locales/languages.py

b'diff --git a/news/326.feature b/news/326.feature\nnew file mode 100644\nindex 0000000..784a46f\n--- /dev/null\n+++ b/news/326.feature\n@@ -0,0 +1,3 @@\n+Support Cyrillic and Latin character sets for Serbian.\n+See `locales issue 326 <https://github.com/collective/plone.app.locales/issues/326>`_.\n+[maurits, fredvd]\ndiff --git a/plone/i18n/locales/languages.py b/plone/i18n/locales/languages.py\nindex ea0b7ec..817f5e1 100644\n--- a/plone/i18n/locales/languages.py\n+++ b/plone/i18n/locales/languages.py\n@@ -3,6 +3,8 @@\n from plone.i18n.locales.interfaces import IMetadataLanguageAvailability\n from zope.interface import implementer\n \n+import os\n+\n \n @implementer(ILanguageAvailability)\n class LanguageAvailability:\n@@ -460,6 +462,10 @@ class MetadataLanguageAvailability(LanguageAvailability):\n         "flag": "/++resource++country-flags/al.gif",\n     },\n     "sr": {\n+        # Note: we support two character sets for this language.\n+        # See zope_i18n_allowed_languages below.\n+        # TODO: in Plone 6.0 native should become \'Srpski\',\n+        # but that requires copying sr@Latn to sr in plone.app.locales.\n         "native": "\xd1\x81\xd1\x80\xd0\xbf\xd1\x81\xd0\xba\xd0\xb8",\n         "name": "Serbian",\n         "flag": "/++resource++country-flags/cs.gif",\n@@ -553,6 +559,23 @@ class MetadataLanguageAvailability(LanguageAvailability):\n     },\n }\n \n+# Character sets are a thing now.\n+# See https://github.com/collective/plone.app.locales/issues/326\n+# At the moment only for Serbian.\n+_zope_i18n_allowed_languages = os.environ.get("zope_i18n_allowed_languages", "")\n+if "sr@Latn" in _zope_i18n_allowed_languages:\n+    _languagelist["sr"] = {\n+        "native": "Srpski",\n+        "name": "Serbian (Latin)",\n+        "flag": "/++resource++country-flags/cs.gif",\n+    }\n+elif "sr@Cyrl" in _zope_i18n_allowed_languages:\n+    _languagelist["sr"] = {\n+        "native": "\xd1\x81\xd1\x80\xd0\xbf\xd1\x81\xd0\xba\xd0\xb8",\n+        "name": "Serbian (Cyrillic)",\n+        "flag": "/++resource++country-flags/cs.gif",\n+    }\n+\n # convert the utf-8 encoded values to unicode\n for code in _languagelist:\n     value = _languagelist[code]\n'

