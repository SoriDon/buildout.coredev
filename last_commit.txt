Repository: plone.app.content


Branch: refs/heads/master
Date: 2022-08-24T12:44:30+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.content/commit/16fdb5f3094dc42d955c85b778c7272174ae41a0

Fix TypeError: 'NoneType' object is not subscriptable in reference browser widget.

Files changed:
A news/2921.bugfix
M plone/app/content/browser/vocabulary.py

b'diff --git a/news/2921.bugfix b/news/2921.bugfix\nnew file mode 100644\nindex 0000000..e9976da\n--- /dev/null\n+++ b/news/2921.bugfix\n@@ -0,0 +1,2 @@\n+Fix TypeError: \'NoneType\' object is not subscriptable in reference browser widget.\n+[maurits]\ndiff --git a/plone/app/content/browser/vocabulary.py b/plone/app/content/browser/vocabulary.py\nindex 3052fe9..f7693cd 100644\n--- a/plone/app/content/browser/vocabulary.py\n+++ b/plone/app/content/browser/vocabulary.py\n@@ -233,7 +233,7 @@ def __call__(self):\n                             val = val()\n                         else:\n                             continue\n-                    if key == "path":\n+                    if key == "path" and val is not None:\n                         val = val[len(base_path) :]\n                     if key not in translate_ignored and isinstance(val, str):\n                         val = translate(_(safe_text(val)), context=self.request)\n'

Repository: plone.app.content


Branch: refs/heads/master
Date: 2022-08-24T15:38:12+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.content/commit/dd8959307bd55674bc7023e8da6b060fd1e74b68

Merge pull request #252 from plone/maurits-issue-2921-60

Fix TypeError: 'NoneType' object is not subscriptable [6.0]

Files changed:
A news/2921.bugfix
M plone/app/content/browser/vocabulary.py

b'diff --git a/news/2921.bugfix b/news/2921.bugfix\nnew file mode 100644\nindex 0000000..e9976da\n--- /dev/null\n+++ b/news/2921.bugfix\n@@ -0,0 +1,2 @@\n+Fix TypeError: \'NoneType\' object is not subscriptable in reference browser widget.\n+[maurits]\ndiff --git a/plone/app/content/browser/vocabulary.py b/plone/app/content/browser/vocabulary.py\nindex 3052fe9..f7693cd 100644\n--- a/plone/app/content/browser/vocabulary.py\n+++ b/plone/app/content/browser/vocabulary.py\n@@ -233,7 +233,7 @@ def __call__(self):\n                             val = val()\n                         else:\n                             continue\n-                    if key == "path":\n+                    if key == "path" and val is not None:\n                         val = val[len(base_path) :]\n                     if key not in translate_ignored and isinstance(val, str):\n                         val = translate(_(safe_text(val)), context=self.request)\n'

