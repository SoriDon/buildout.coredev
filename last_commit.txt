Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/ed40d393542e19160b0f8bc7c34a66c9c4a44ea3

Move fiddeling with layout (hide empty sub menu) to template.

Files changed:
M docs/_static/searchtools.js
M docs/_templates/page.html
M docs/_templates/search.html

b'diff --git a/docs/_static/searchtools.js b/docs/_static/searchtools.js\nindex 23ed8bf5..be383c53 100644\n--- a/docs/_static/searchtools.js\n+++ b/docs/_static/searchtools.js\n@@ -544,9 +544,6 @@ var Search = {\n \n $(document).ready(function() {\n   Search.init();\n-  if ($.trim($(".topbar-contents .bd-toc").html()) === "") {\n-    $(".topbar-contents .bd-toc").css("visibility", "hidden");\n-  }\n   $(\'select[name="doc_section"]\').change(function() {\n     this.form.submit();\n   });\ndiff --git a/docs/_templates/page.html b/docs/_templates/page.html\nindex 24f36497..156d0bdb 100644\n--- a/docs/_templates/page.html\n+++ b/docs/_templates/page.html\n@@ -7,9 +7,11 @@\n {% block footer %}\n     <script type="text/javascript">\n         $(document).ready(function() {\n+            // Hide empty sub menu.\n             if ($.trim($(".topbar-contents .bd-toc").html()) === "") {\n                 $(".topbar-contents .bd-toc").css("visibility", "hidden");\n             }\n+            // Add toggle to exercise solutions (admonition with class \'toggle\')\n             $(".toggle > *").hide();\n             $(".toggle .admonition-title").show();\n             $(".toggle .admonition-title").click(function() {\ndiff --git a/docs/_templates/search.html b/docs/_templates/search.html\nindex f9362cf5..e18f6456 100644\n--- a/docs/_templates/search.html\n+++ b/docs/_templates/search.html\n@@ -51,9 +51,9 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n         <option value="all">All Documentation</option>\n         {% for id, title in \n           [\n-          ["backend","Backend"],\n-          ["classic-ui","Classic UI"],\n-          ["contributing","Contributing"],\n+            ["backend","Backend"],\n+            ["classic-ui","Classic UI"],\n+            ["contributing","Contributing"],\n           ] %}\n           <option value="{{id}}">{{ title }}</option>\n         {% endfor %}\n@@ -76,3 +76,16 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n     </div>\n   {% endblock %}\n {% endblock %}\n+\n+\n+{% block footer %}\n+    <script type="text/javascript">\n+        $(document).ready(function() {\n+            // Hide empty sub menu.\n+            if ($.trim($(".topbar-contents .bd-toc").html()) === "") {\n+                $(".topbar-contents .bd-toc").css("visibility", "hidden");\n+            }\n+        });\n+    </script>\n+\n+{% endblock %}\n\\ No newline at end of file\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/5df26424db55ad7275883173352098ad75a0b824

Add breadcrumbs to search results

Files changed:
M docs/_static/searchtools.js

b'diff --git a/docs/_static/searchtools.js b/docs/_static/searchtools.js\nindex be383c53..a94be322 100644\n--- a/docs/_static/searchtools.js\n+++ b/docs/_static/searchtools.js\n@@ -9,6 +9,7 @@\n  *\n  */\n \n+var title_documentation = \'Plone Documentation\';\n \n if (!Scorer) {\n   /**\n@@ -199,10 +200,6 @@ var Search = {\n     }\n     var highlightstring = \'?highlight=\' + $.urlencode(hlterms.join(" "));\n \n-    // console.debug(\'SEARCH: searching for:\');\n-    // console.info(\'required: \', searchterms);\n-    // console.info(\'excluded: \', excluded);\n-\n     // prepare search\n     var terms = this._index.terms;\n     var titleterms = this._index.titleterms;\n@@ -257,8 +254,28 @@ var Search = {\n       }\n     });\n \n+    function _getBreadcrumbs(item, linkUrl) {\n+      let path = item[0];\n+      let parentTitles = item[6];\n+      let markup = path.split(\'/\')\n+        .slice(0, -1);\n+      markup = markup.map((el, index) => {\n+        return {\n+          "path": markup.slice(0, index+1).join(\'/\'),\n+          "title": parentTitles[index]\n+        }\n+      })\n+      markup = markup\n+        .map((el) => {\n+            let foo = `<a href="/${el.path}"> ${el.title}</a>`\n+            return foo;\n+          })\n+      markup.push(`<span class="lastbreadcrumb">${item[1]}</span>`)\n+      markup = markup.join(\'<span class="pathseparator">&gt;</span>\');\n+      return markup\n+    }\n \n-    // print the results\n+    // Print the results.\n     var resultCount = results.length;\n     function displayNextItem() {\n       // results left, load the summary and display it\n@@ -283,11 +300,16 @@ var Search = {\n           requestUrl = DOCUMENTATION_OPTIONS.URL_ROOT + item[0] + DOCUMENTATION_OPTIONS.FILE_SUFFIX;\n           linkUrl = item[0] + DOCUMENTATION_OPTIONS.LINK_SUFFIX;\n         }\n-        listItem.append($(\'<a/>\').attr(\'href\',\n-            linkUrl +\n-            highlightstring + item[2]).html(item[1]));\n+        let breadcrumbs = _getBreadcrumbs(item, linkUrl);\n+        breadcrumbs = $("<div class=\'breadcrumbs\'>" + breadcrumbs + "</div>");\n+        listItem.append(breadcrumbs);\n+        let headline = $(\'<h3/>\');\n+        headline.append($(\'<a/>\').attr(\'href\',\n+          linkUrl +\n+          highlightstring + item[2]).html(item[1]));\n         \n-        listItem.append($(\'<span class="title_doc_section">\' + item[6] + \'</span>\'));\n+        // headline.append($(\'<span class="title_doc_section">\' + item[6] + \'</span>\'));\n+        listItem.append(headline);\n \n         if (item[3]) {\n           listItem.append($(\'<span> (\' + item[3] + \')</span>\'));\n@@ -321,9 +343,9 @@ var Search = {\n         Search.stopPulse();\n         Search.title.text(_(\'Search Results\'));\n         if (!resultCount)\n-          Search.status.text(_(\'Your search did not match any documents. Please make sure that all words are spelled correctly and that you\\\'ve selected enough categories.\'));\n+          Search.status.text(_(\'Your search did not match any documents. Please make sure that all words are spelled correctly. Searching for multiple words only shows matches that contain all words.\'));\n         else\n-            Search.status.text(_(\'Search finished, found %s page(s) matching the search query.\').replace(\'%s\', resultCount));\n+            Search.status.text(_(\'Found %s page(s) matching the search query.\').replace(\'%s\', resultCount));\n         Search.status.fadeIn(500);\n       }\n     }\n@@ -344,7 +366,9 @@ var Search = {\n     var results = [];\n \n     for (var prefix in objects) {\n-      for (var name in objects[prefix]) {\n+      for (var iMatch = 0; iMatch != objects[prefix].length; ++iMatch) {\n+        var match = objects[prefix][iMatch];\n+        var name = match[4];\n         var fullname = (prefix ? prefix + \'.\' : \'\') + name;\n         var fullnameLower = fullname.toLowerCase()\n         if (fullnameLower.indexOf(object) > -1) {\n@@ -358,7 +382,6 @@ var Search = {\n           } else if (parts[parts.length - 1].indexOf(object) > -1) {\n             score += Scorer.objPartialMatch;\n           }\n-          var match = objects[prefix][name];\n           var objname = objnames[match[1]][2];\n           var title = titles[match[0]];\n           // If more than one term searched for, we require other words to be\n@@ -496,19 +519,41 @@ var Search = {\n           break;\n         }\n       }\n-\n       // if we have still a valid result we can add it to the result list\n       if (valid) {\n+        /**\n+         * file: index\n+         * docnames: array of paths\n+         * titles: array of titles\n+         */\n+\n         // select one (max) score for the file.\n         // for better ranking, we should calculate ranking by using words statistics like basic tf-idf...\n         var score = $u.max($u.map(fileMap[file], function(w){return scoreMap[file][w]}));\n-        function getParentTitle(f) {\n+\n+        function get1stLevelAncestor(f) {\n           let parentdocname = docnames[f].split(\'/\')[0] + \'/index\';\n           let parentID = docnames.indexOf(parentdocname);\n-          let title = parentID === -1 ? \'Plone Documentation\' : titles[parentID];\n+          let title = parentID === -1 ? title_documentation : titles[parentID];\n           return title\n         }\n-        results.push([docnames[file], titles[file], \'\', null, score, filenames[file], getParentTitle(file)]);\n+        function getParentTitles(idx) {\n+          let path = docnames[idx]\n+\n+          let foo = path.split(\'/\').slice(0, -1);\n+          foo = foo.map((el, index) => {\n+            return `${foo.slice(0, index+1).join(\'/\')}/index`\n+          })\n+      \n+          let parentTitles = foo.map(el => {\n+            let parentId = docnames.indexOf(el);\n+            let title = parentId === -1 ? title_documentation : titles[parentId];\n+            return title\n+          })\n+          return parentTitles\n+        }\n+\n+        results.push([docnames[file], titles[file], \'\', null, score, filenames[file], getParentTitles(file)]);\n       }\n     }\n     return results;\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/3ef4356cf933f8a1d47b3523cf8b65b0e3534257

Make search form nice with bootstrap.

Files changed:
M docs/_templates/search.html

b'diff --git a/docs/_templates/search.html b/docs/_templates/search.html\nindex e18f6456..46e9eabc 100644\n--- a/docs/_templates/search.html\n+++ b/docs/_templates/search.html\n@@ -40,24 +40,40 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n     </p>\n   {% endblock %}\n   {% block searchbox %}\n-    <form action="" method="get" id="search-form">\n-      <label for="q" class="visuallyhidden">Search string</label>\n-      <input type="text" name="q" id="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>\n-      \n-      <input type="submit" value="{{ _(\'search\') }}" />\n+    <form\n+      action=""\n+      method="get"\n+      id="search-form"\n+      class="form-inline"\n+      >\n+      <div class="input-group mr-2 mb-1">\n+        <input\n+          type="text" name="q" id="q"\n+          class="form-control"\n+          placeholder="Search the docs\xe2\x80\xa6"\n+          aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>\n+        <label for="q" class="sr-only">Search string</label>\n+          <div class="input-group-append">\n+            <button type="submit" class="btn btn-primary">{{ _(\'search\') }}</button>\n+          </div>\n+      </div>\n+\n+      <div class="form-group mb-1">\n+        <label for="doc_section" class="sr-only">Filter by section</label>\n+        <select name="doc_section" id="doc_section" class="custom-select" >\n+          <option value="all">All Documentation</option>\n+          {% for id, title in\n+            [\n+              ["backend","Backend"],\n+              ["classic-ui","Classic UI"],\n+              ["volto","Frontend"],\n+              ["contributing","Contributing"],\n+            ] %}\n+            <option value="{{id}}">{{ title }}</option>\n+          {% endfor %}\n+        </select>\n+      </div>\n \n-      <label for="doc_section" class="visuallyhidden">Filter by section</label>\n-      <select name="doc_section" id="doc_section">\n-        <option value="all">All Documentation</option>\n-        {% for id, title in \n-          [\n-            ["backend","Backend"],\n-            ["classic-ui","Classic UI"],\n-            ["contributing","Contributing"],\n-          ] %}\n-          <option value="{{id}}">{{ title }}</option>\n-        {% endfor %}\n-      </select>\n       <span id="search-progress" style="padding-left: 10px"></span>\n     </form>\n   {% endblock %}\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/38fb89486924a84ee16f1667a8953613802a25a8

Replace 'file' icon with Plone icon for search results.

Files changed:
A docs/_static/file.png

b'diff --git a/docs/_static/file.png b/docs/_static/file.png\nnew file mode 100644\nindex 00000000..bf6cf158\nBinary files /dev/null and b/docs/_static/file.png differ\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/05d9303fc656207bea7f02ba64e1dbbe2ea61aa1

Theming search results and form

Files changed:
M docs/_static/custom.css

b'diff --git a/docs/_static/custom.css b/docs/_static/custom.css\nindex 10b49498..59f17ab3 100644\n--- a/docs/_static/custom.css\n+++ b/docs/_static/custom.css\n@@ -48,6 +48,9 @@ span.linenos {\n p.ploneorglink img {\n   vertical-align: bottom;\n }\n+dt:target, span.highlighted {\n+  background-color: #7ddf4493;\n+}\n \n .bd-sidebar .nav ul {\n   padding: 0 0 0 1rem;\n@@ -126,36 +129,60 @@ div.admonition.admonition-todo > .admonition-title::before {\n   font-weight: bold;\n }\n \n-#search-form {\n-  display: flex;\n-  flex-direction: row;\n-  align-items: baseline;\n-  flex-wrap: wrap;\n-}\n-#search-form select,\n-#search-form input[type="text"] {\n-  height: 2rem;\n-  margin-right: 1rem;\n-  margin-bottom: 1rem;\n-  background-color: white;\n-  border: 1px solid darkgrey;\n+\n+/* Bootstrap */\n+.btn-primary {\n+  color: #fff;\n+  background-color: #2980b9;\n+  border-color: #2980b9;\n }\n-#search-form input[type="submit"] {\n-  margin-right: 1rem;\n+.btn-primary {\n+  background-color: #1f86ca;\n+  border-color: #2980b9;\n }\n-ul.search .title_doc_section::before {\n-  content: \' \xe2\x80\x93 \';\n+\n+/* Search */\n+ul.search {\n+  margin-left: 0;\n }\n p.search-summary {\n-  margin-top: 1em;\n+  margin: 1em 0 2rem 0;\n }\n #search-results ul {\n   list-style-type: none;\n   padding-left: 0;\n }\n #search-results ul li {\n-  margin-bottom: 1em;\n+  margin-bottom: 2rem;\n+  padding: 2px 0 5px 2rem;\n+}\n+#search-results ul li h3 {\n+  margin: 0.75rem 0 .5rem;\n+  font-size: 1.5rem;\n }\n+#search-results ul li .breadcrumbs {\n+  display: flex;\n+  flex-direction: row;\n+  flex-wrap: wrap;\n+}\n+#search-results ul li .breadcrumbs a {\n+  font-weight: normal;\n+}\n+#search-results ul li .breadcrumbs .lastbreadcrumb {\n+  white-space: nowrap;\n+  display: inline-block;\n+  max-width: 12rem;\n+  overflow: hidden;              /* "overflow"-Wert darf nicht "visible" sein */\n+\n+  text-overflow: ellipsis;\n+}\n+ul.search li p.context {\n+  margin-left: 0;\n+}\n+.pathseparator {\n+  padding: 0 0.7rem;\n+}\n+\n \n /* submenu */\n .bd-toc {\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/45a6666a88817fade83b3680076449ad5ad6ce99

Remove unused code. Documentation.

Files changed:
M docs/_static/searchtools.js

b'diff --git a/docs/_static/searchtools.js b/docs/_static/searchtools.js\nindex a94be322..7ac6fea2 100644\n--- a/docs/_static/searchtools.js\n+++ b/docs/_static/searchtools.js\n@@ -308,7 +308,6 @@ var Search = {\n           linkUrl +\n           highlightstring + item[2]).html(item[1]));\n         \n-        // headline.append($(\'<span class="title_doc_section">\' + item[6] + \'</span>\'));\n         listItem.append(headline);\n \n         if (item[3]) {\n@@ -531,12 +530,11 @@ var Search = {\n         // for better ranking, we should calculate ranking by using words statistics like basic tf-idf...\n         var score = $u.max($u.map(fileMap[file], function(w){return scoreMap[file][w]}));\n \n-        function get1stLevelAncestor(f) {\n-          let parentdocname = docnames[f].split(\'/\')[0] + \'/index\';\n-          let parentID = docnames.indexOf(parentdocname);\n-          let title = parentID === -1 ? title_documentation : titles[parentID];\n-          return title\n-        }\n+        /**\n+         * Return array with titles of ancestors of file.\n+         * @param {number} idx - The index of the result item in global list of files\n+         * @returns array\n+         */\n         function getParentTitles(idx) {\n           let path = docnames[idx]\n \n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/e69fac5448c2a95ec0b3509e467ff384f592d6fd

Search: Replace dropdown with radio buttons. Add reset button.

Files changed:
M docs/_static/custom.css
M docs/_static/searchtools.js
M docs/_templates/search.html

b'diff --git a/docs/_static/custom.css b/docs/_static/custom.css\nindex 59f17ab3..fddd609b 100644\n--- a/docs/_static/custom.css\n+++ b/docs/_static/custom.css\n@@ -152,10 +152,6 @@ p.search-summary {\n   list-style-type: none;\n   padding-left: 0;\n }\n-#search-results ul li {\n-  margin-bottom: 2rem;\n-  padding: 2px 0 5px 2rem;\n-}\n #search-results ul li h3 {\n   margin: 0.75rem 0 .5rem;\n   font-size: 1.5rem;\n@@ -176,6 +172,17 @@ p.search-summary {\n \n   text-overflow: ellipsis;\n }\n+#search-results ul li,\n+ul.search li {\n+  margin-bottom: 2rem;\n+  padding: 2px 0 5px 4rem;\n+  background-image: url(file.svg);\n+  background-blend-mode: hue;\n+  background-color: violetred;\n+  background-repeat: no-repeat;\n+  background-position: 0px 8px;\n+  background-size: 56px;\n+}\n ul.search li p.context {\n   margin-left: 0;\n }\ndiff --git a/docs/_static/searchtools.js b/docs/_static/searchtools.js\nindex 7ac6fea2..c3876e15 100644\n--- a/docs/_static/searchtools.js\n+++ b/docs/_static/searchtools.js\n@@ -75,14 +75,12 @@ var Search = {\n \n   init : function() {\n       var params = $.getQueryParameters();\n+      let doc_section = params.doc_section ? params.doc_section[0] : \'all\';\n+      $(\'input[id="doc_section_\' + doc_section + \'"]\').prop("checked", true)\n       if (params.q) {\n           var query = params.q[0];\n           $(\'input[name="q"]\')[0].value = query;\n           $(\'input[name="q"]\')[1].value = query;\n-          if (params.doc_section) {\n-            var doc_section = params.doc_section[0];\n-            $(\'select[name="doc_section"]\')[0].value = doc_section;\n-          }\n           this.performSearch(query, doc_section);\n       }\n   },\n@@ -234,7 +232,7 @@ var Search = {\n \n     // Enrich item with parent doc_section title\n     for (i = 0; i < results.length; i++) \n-      results[i][6] = results[i][6] || \'TODO Documentation title\';\n+      results[i][6] = results[i][6] || \'Plone Documentation\';\n \n     // now sort the results by score (in opposite order of appearance, since the\n     // display function below uses pop() to retrieve items) and then\n@@ -255,24 +253,21 @@ var Search = {\n     });\n \n     function _getBreadcrumbs(item, linkUrl) {\n-      let path = item[0];\n       let parentTitles = item[6];\n-      let markup = path.split(\'/\')\n+      let path = item[0].split(\'/\')\n         .slice(0, -1);\n-      markup = markup.map((el, index) => {\n+      path = path.map((el, index) => {\n         return {\n-          "path": markup.slice(0, index+1).join(\'/\'),\n+          "path": path.slice(0, index+1).join(\'/\'),\n           "title": parentTitles[index]\n         }\n       })\n-      markup = markup\n-        .map((el) => {\n-            let foo = `<a href="/${el.path}"> ${el.title}</a>`\n-            return foo;\n+      let markup = path\n+        .map((el, idx) => {\n+            return idx===0 ? `<a href="/${el.path}"><b>${el.title}</b></a>` : `<a href="/${el.path}">${el.title}</a>` \n           })\n       markup.push(`<span class="lastbreadcrumb">${item[1]}</span>`)\n-      markup = markup.join(\'<span class="pathseparator">&gt;</span>\');\n-      return markup\n+      return markup.join(\'<span class="pathseparator">&gt;</span>\');\n     }\n \n     // Print the results.\n@@ -587,7 +582,14 @@ var Search = {\n \n $(document).ready(function() {\n   Search.init();\n-  $(\'select[name="doc_section"]\').change(function() {\n+  $(\'#q\').focus();\n+  $(\'input[name="doc_section"]\').change(function() {\n     this.form.submit();\n   });\n+  \n+  function clearSearchField() {\n+    $(\'#q\').val(\'\');\n+    this.form.submit();\n+  }\n+  $( "button.clear_search" ).on( "click", clearSearchField );\n });\ndiff --git a/docs/_templates/search.html b/docs/_templates/search.html\nindex 46e9eabc..291973e7 100644\n--- a/docs/_templates/search.html\n+++ b/docs/_templates/search.html\n@@ -44,24 +44,37 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n       action=""\n       method="get"\n       id="search-form"\n-      class="form-inline"\n+      class=""\n       >\n-      <div class="input-group mr-2 mb-1">\n-        <input\n-          type="text" name="q" id="q"\n-          class="form-control"\n-          placeholder="Search the docs\xe2\x80\xa6"\n-          aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>\n-        <label for="q" class="sr-only">Search string</label>\n+      <div class="row">\n+        <div class="input-group col-sm-6 mb-2">\n+          <input\n+            type="text" name="q" id="q"\n+            class="form-control"\n+            placeholder="Search the docs\xe2\x80\xa6"\n+            aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>\n+          <label for="q" class="sr-only">Search string</label>\n           <div class="input-group-append">\n             <button type="submit" class="btn btn-primary">{{ _(\'search\') }}</button>\n           </div>\n+          <div class="input-group-append">\n+            <button\n+              type="button"\n+              class="clear_search btn btn-primary"\n+            >{{ _(\'clear\') }}</button>\n+          </div>\n+        </div>\n       </div>\n \n-      <div class="form-group mb-1">\n-        <label for="doc_section" class="sr-only">Filter by section</label>\n-        <select name="doc_section" id="doc_section" class="custom-select" >\n-          <option value="all">All Documentation</option>\n+      <div class="form-row mb-2">\n+        <label for="doc_section" class="col">Filter by section</label>\n+        <div class="col-sm-10">\n+          <div class="form-check">\n+            <input class="form-check-input" type="radio" name="doc_section" id="doc_section_all" value="all">\n+            <label class="form-check-label" for="doc_section_all">\n+              All Documentation\n+            </label>\n+          </div>\n           {% for id, title in\n             [\n               ["backend","Backend"],\n@@ -69,9 +82,14 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n               ["volto","Frontend"],\n               ["contributing","Contributing"],\n             ] %}\n-            <option value="{{id}}">{{ title }}</option>\n+            <div class="form-check">\n+              <input class="form-check-input" type="radio" name="doc_section" id="doc_section_{{id}}" value="{{id}}">\n+              <label class="form-check-label" for="doc_section_{{id}}">\n+                {{title}}\n+              </label>\n+            </div>\n           {% endfor %}\n-        </select>\n+        </div>\n       </div>\n \n       <span id="search-progress" style="padding-left: 10px"></span>\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/75f3edb30fe185a070967d724cc7dec4c40f1252

Search: Replace search result icon.

Files changed:
A docs/_static/file.sketch
A docs/_static/file.svg
A docs/_static/file_original.png
A docs/_static/plone_mini.png
D docs/_static/file.png

b'diff --git a/docs/_static/file.sketch b/docs/_static/file.sketch\nnew file mode 100644\nindex 00000000..c8e2b6f2\nBinary files /dev/null and b/docs/_static/file.sketch differ\ndiff --git a/docs/_static/file.svg b/docs/_static/file.svg\nnew file mode 100644\nindex 00000000..0f727c70\n--- /dev/null\n+++ b/docs/_static/file.svg\n@@ -0,0 +1,10 @@\n+<?xml version="1.0" encoding="UTF-8"?>\n+<svg width="30px" height="30px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n+    <title>file</title>\n+    <g id="file" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n+        <g id="plone" transform="translate(4.000000, 0.000000)" fill="#1C95D3">\n+            <path d="M0,-1.77635684e-15 L0,30 L22.001,30 L22.001,8.586 L13.414,-1.77635684e-15 L0,-1.77635684e-15 Z M2.001,2 L12.001,2 L12.001,10 L20.001,10 L20.001,28 L2.001,28 L2.001,2 Z M14,3.414 L18.586,8 L14,8 L14,3.414 Z" id="Shape"></path>\n+            <path d="M4.0004,23.9997 L18.0004,23.9997 L18.0004,21.9997 L4.0004,21.9997 L4.0004,23.9997 Z M4.0004,19.9997 L18.0004,19.9997 L18.0004,17.9997 L4.0004,17.9997 L4.0004,19.9997 Z M4.0004,15.9997 L11.0004,15.9997 L11.0004,13.9997 L4.0004,13.9997 L4.0004,15.9997 Z" id="Shape"></path>\n+        </g>\n+    </g>\n+</svg>\n\\ No newline at end of file\ndiff --git a/docs/_static/file_original.png b/docs/_static/file_original.png\nnew file mode 100644\nindex 00000000..a858a410\nBinary files /dev/null and b/docs/_static/file_original.png differ\ndiff --git a/docs/_static/file.png b/docs/_static/plone_mini.png\nsimilarity index 100%\nrename from docs/_static/file.png\nrename to docs/_static/plone_mini.png\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/ab4b7c69a89ece0444b3d6795ea0f23d0a63fcde

Fix search field width.

Files changed:
M docs/_templates/search.html

b'diff --git a/docs/_templates/search.html b/docs/_templates/search.html\nindex 291973e7..8a63ac35 100644\n--- a/docs/_templates/search.html\n+++ b/docs/_templates/search.html\n@@ -47,7 +47,7 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n       class=""\n       >\n       <div class="row">\n-        <div class="input-group col-sm-6 mb-2">\n+        <div class="input-group col-xl-8 mb-2">\n           <input\n             type="text" name="q" id="q"\n             class="form-control"\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/4309b4f35c24932e3882a49d9d4956d3cf57ffb4

Rename reset button to "reset".

Files changed:
M docs/_templates/search.html

b'diff --git a/docs/_templates/search.html b/docs/_templates/search.html\nindex 8a63ac35..816eaf19 100644\n--- a/docs/_templates/search.html\n+++ b/docs/_templates/search.html\n@@ -60,8 +60,8 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n           <div class="input-group-append">\n             <button\n               type="button"\n-              class="clear_search btn btn-primary"\n-            >{{ _(\'clear\') }}</button>\n+              class="clear_search btn btn-secondary"\n+            >{{ _(\'reset\') }}</button>\n           </div>\n         </div>\n       </div>\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T10:52:29+01:00
Author: ksuess (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/1df3efdcc15e15a1e29ace520c5672fc2d65ce3e

Theming search form

Files changed:
M docs/_static/custom.css
M docs/_static/searchtools.js
M docs/_templates/search.html

b'diff --git a/docs/_static/custom.css b/docs/_static/custom.css\nindex fddd609b..6f0fdc9c 100644\n--- a/docs/_static/custom.css\n+++ b/docs/_static/custom.css\n@@ -14,12 +14,15 @@ pre {\n   box-shadow: none;\n }\n a,\n-a:visited {\n+a:visited,\n+main.bd-content #main-content a,\n+main.bd-content #main-content a:visited {\n   color: #2980b9;\n }\n-a:hover {\n-  color: #176aa1;\n-  text-decoration: underline;\n+a:hover,\n+main.bd-content #main-content a:hover {\n+  color: #1a567e;\n+  text-decoration: none;\n }\n ul {\n   list-style-type: square;\n@@ -152,8 +155,14 @@ p.search-summary {\n   list-style-type: none;\n   padding-left: 0;\n }\n+#search-results ul li,\n+ul.search li {\n+  margin-bottom: 2rem;\n+  padding: 0;\n+  background-image: none;\n+}\n #search-results ul li h3 {\n-  margin: 0.75rem 0 .5rem;\n+  margin: 0.4rem 0 .5rem;\n   font-size: 1.5rem;\n }\n #search-results ul li .breadcrumbs {\n@@ -172,17 +181,6 @@ p.search-summary {\n \n   text-overflow: ellipsis;\n }\n-#search-results ul li,\n-ul.search li {\n-  margin-bottom: 2rem;\n-  padding: 2px 0 5px 4rem;\n-  background-image: url(file.svg);\n-  background-blend-mode: hue;\n-  background-color: violetred;\n-  background-repeat: no-repeat;\n-  background-position: 0px 8px;\n-  background-size: 56px;\n-}\n ul.search li p.context {\n   margin-left: 0;\n }\ndiff --git a/docs/_static/searchtools.js b/docs/_static/searchtools.js\nindex c3876e15..835e47a2 100644\n--- a/docs/_static/searchtools.js\n+++ b/docs/_static/searchtools.js\n@@ -264,7 +264,7 @@ var Search = {\n       })\n       let markup = path\n         .map((el, idx) => {\n-            return idx===0 ? `<a href="/${el.path}"><b>${el.title}</b></a>` : `<a href="/${el.path}">${el.title}</a>` \n+            return `<a href="/${el.path}">${el.title}</a>` \n           })\n       markup.push(`<span class="lastbreadcrumb">${item[1]}</span>`)\n       return markup.join(\'<span class="pathseparator">&gt;</span>\');\ndiff --git a/docs/_templates/search.html b/docs/_templates/search.html\nindex 816eaf19..bc19ae04 100644\n--- a/docs/_templates/search.html\n+++ b/docs/_templates/search.html\n@@ -66,9 +66,9 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n         </div>\n       </div>\n \n-      <div class="form-row mb-2">\n-        <label for="doc_section" class="col">Filter by section</label>\n-        <div class="col-sm-10">\n+      <div class="form row mb-2">\n+        <label for="doc_section" class="col sr-only">Filter by section</label>\n+        <div class="col">\n           <div class="form-check">\n             <input class="form-check-input" type="radio" name="doc_section" id="doc_section_all" value="all">\n             <label class="form-check-label" for="doc_section_all">\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-10T11:04:35+01:00
Author: Katja Süss (ksuess) <k.suess@rohberg.ch>
Commit: https://github.com/plone/documentation/commit/2ab570341813ae2cf5e5957bd5607503fed97963

Merge pull request #1176 from plone/searching

- Add breadcrumbs to search results
- Add reset button to search form
- Search form nicer with bootstrap
- Search results without type icon

Files changed:
A docs/_static/file.sketch
A docs/_static/file.svg
A docs/_static/file_original.png
A docs/_static/plone_mini.png
M docs/_static/custom.css
M docs/_static/searchtools.js
M docs/_templates/page.html
M docs/_templates/search.html

b'diff --git a/docs/_static/custom.css b/docs/_static/custom.css\nindex 10b49498..6f0fdc9c 100644\n--- a/docs/_static/custom.css\n+++ b/docs/_static/custom.css\n@@ -14,12 +14,15 @@ pre {\n   box-shadow: none;\n }\n a,\n-a:visited {\n+a:visited,\n+main.bd-content #main-content a,\n+main.bd-content #main-content a:visited {\n   color: #2980b9;\n }\n-a:hover {\n-  color: #176aa1;\n-  text-decoration: underline;\n+a:hover,\n+main.bd-content #main-content a:hover {\n+  color: #1a567e;\n+  text-decoration: none;\n }\n ul {\n   list-style-type: square;\n@@ -48,6 +51,9 @@ span.linenos {\n p.ploneorglink img {\n   vertical-align: bottom;\n }\n+dt:target, span.highlighted {\n+  background-color: #7ddf4493;\n+}\n \n .bd-sidebar .nav ul {\n   padding: 0 0 0 1rem;\n@@ -126,36 +132,62 @@ div.admonition.admonition-todo > .admonition-title::before {\n   font-weight: bold;\n }\n \n-#search-form {\n-  display: flex;\n-  flex-direction: row;\n-  align-items: baseline;\n-  flex-wrap: wrap;\n-}\n-#search-form select,\n-#search-form input[type="text"] {\n-  height: 2rem;\n-  margin-right: 1rem;\n-  margin-bottom: 1rem;\n-  background-color: white;\n-  border: 1px solid darkgrey;\n+\n+/* Bootstrap */\n+.btn-primary {\n+  color: #fff;\n+  background-color: #2980b9;\n+  border-color: #2980b9;\n }\n-#search-form input[type="submit"] {\n-  margin-right: 1rem;\n+.btn-primary {\n+  background-color: #1f86ca;\n+  border-color: #2980b9;\n }\n-ul.search .title_doc_section::before {\n-  content: \' \xe2\x80\x93 \';\n+\n+/* Search */\n+ul.search {\n+  margin-left: 0;\n }\n p.search-summary {\n-  margin-top: 1em;\n+  margin: 1em 0 2rem 0;\n }\n #search-results ul {\n   list-style-type: none;\n   padding-left: 0;\n }\n-#search-results ul li {\n-  margin-bottom: 1em;\n+#search-results ul li,\n+ul.search li {\n+  margin-bottom: 2rem;\n+  padding: 0;\n+  background-image: none;\n+}\n+#search-results ul li h3 {\n+  margin: 0.4rem 0 .5rem;\n+  font-size: 1.5rem;\n }\n+#search-results ul li .breadcrumbs {\n+  display: flex;\n+  flex-direction: row;\n+  flex-wrap: wrap;\n+}\n+#search-results ul li .breadcrumbs a {\n+  font-weight: normal;\n+}\n+#search-results ul li .breadcrumbs .lastbreadcrumb {\n+  white-space: nowrap;\n+  display: inline-block;\n+  max-width: 12rem;\n+  overflow: hidden;              /* "overflow"-Wert darf nicht "visible" sein */\n+\n+  text-overflow: ellipsis;\n+}\n+ul.search li p.context {\n+  margin-left: 0;\n+}\n+.pathseparator {\n+  padding: 0 0.7rem;\n+}\n+\n \n /* submenu */\n .bd-toc {\ndiff --git a/docs/_static/file.sketch b/docs/_static/file.sketch\nnew file mode 100644\nindex 00000000..c8e2b6f2\nBinary files /dev/null and b/docs/_static/file.sketch differ\ndiff --git a/docs/_static/file.svg b/docs/_static/file.svg\nnew file mode 100644\nindex 00000000..0f727c70\n--- /dev/null\n+++ b/docs/_static/file.svg\n@@ -0,0 +1,10 @@\n+<?xml version="1.0" encoding="UTF-8"?>\n+<svg width="30px" height="30px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n+    <title>file</title>\n+    <g id="file" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n+        <g id="plone" transform="translate(4.000000, 0.000000)" fill="#1C95D3">\n+            <path d="M0,-1.77635684e-15 L0,30 L22.001,30 L22.001,8.586 L13.414,-1.77635684e-15 L0,-1.77635684e-15 Z M2.001,2 L12.001,2 L12.001,10 L20.001,10 L20.001,28 L2.001,28 L2.001,2 Z M14,3.414 L18.586,8 L14,8 L14,3.414 Z" id="Shape"></path>\n+            <path d="M4.0004,23.9997 L18.0004,23.9997 L18.0004,21.9997 L4.0004,21.9997 L4.0004,23.9997 Z M4.0004,19.9997 L18.0004,19.9997 L18.0004,17.9997 L4.0004,17.9997 L4.0004,19.9997 Z M4.0004,15.9997 L11.0004,15.9997 L11.0004,13.9997 L4.0004,13.9997 L4.0004,15.9997 Z" id="Shape"></path>\n+        </g>\n+    </g>\n+</svg>\n\\ No newline at end of file\ndiff --git a/docs/_static/file_original.png b/docs/_static/file_original.png\nnew file mode 100644\nindex 00000000..a858a410\nBinary files /dev/null and b/docs/_static/file_original.png differ\ndiff --git a/docs/_static/plone_mini.png b/docs/_static/plone_mini.png\nnew file mode 100644\nindex 00000000..bf6cf158\nBinary files /dev/null and b/docs/_static/plone_mini.png differ\ndiff --git a/docs/_static/searchtools.js b/docs/_static/searchtools.js\nindex 23ed8bf5..835e47a2 100644\n--- a/docs/_static/searchtools.js\n+++ b/docs/_static/searchtools.js\n@@ -9,6 +9,7 @@\n  *\n  */\n \n+var title_documentation = \'Plone Documentation\';\n \n if (!Scorer) {\n   /**\n@@ -74,14 +75,12 @@ var Search = {\n \n   init : function() {\n       var params = $.getQueryParameters();\n+      let doc_section = params.doc_section ? params.doc_section[0] : \'all\';\n+      $(\'input[id="doc_section_\' + doc_section + \'"]\').prop("checked", true)\n       if (params.q) {\n           var query = params.q[0];\n           $(\'input[name="q"]\')[0].value = query;\n           $(\'input[name="q"]\')[1].value = query;\n-          if (params.doc_section) {\n-            var doc_section = params.doc_section[0];\n-            $(\'select[name="doc_section"]\')[0].value = doc_section;\n-          }\n           this.performSearch(query, doc_section);\n       }\n   },\n@@ -199,10 +198,6 @@ var Search = {\n     }\n     var highlightstring = \'?highlight=\' + $.urlencode(hlterms.join(" "));\n \n-    // console.debug(\'SEARCH: searching for:\');\n-    // console.info(\'required: \', searchterms);\n-    // console.info(\'excluded: \', excluded);\n-\n     // prepare search\n     var terms = this._index.terms;\n     var titleterms = this._index.titleterms;\n@@ -237,7 +232,7 @@ var Search = {\n \n     // Enrich item with parent doc_section title\n     for (i = 0; i < results.length; i++) \n-      results[i][6] = results[i][6] || \'TODO Documentation title\';\n+      results[i][6] = results[i][6] || \'Plone Documentation\';\n \n     // now sort the results by score (in opposite order of appearance, since the\n     // display function below uses pop() to retrieve items) and then\n@@ -257,8 +252,25 @@ var Search = {\n       }\n     });\n \n+    function _getBreadcrumbs(item, linkUrl) {\n+      let parentTitles = item[6];\n+      let path = item[0].split(\'/\')\n+        .slice(0, -1);\n+      path = path.map((el, index) => {\n+        return {\n+          "path": path.slice(0, index+1).join(\'/\'),\n+          "title": parentTitles[index]\n+        }\n+      })\n+      let markup = path\n+        .map((el, idx) => {\n+            return `<a href="/${el.path}">${el.title}</a>` \n+          })\n+      markup.push(`<span class="lastbreadcrumb">${item[1]}</span>`)\n+      return markup.join(\'<span class="pathseparator">&gt;</span>\');\n+    }\n \n-    // print the results\n+    // Print the results.\n     var resultCount = results.length;\n     function displayNextItem() {\n       // results left, load the summary and display it\n@@ -283,11 +295,15 @@ var Search = {\n           requestUrl = DOCUMENTATION_OPTIONS.URL_ROOT + item[0] + DOCUMENTATION_OPTIONS.FILE_SUFFIX;\n           linkUrl = item[0] + DOCUMENTATION_OPTIONS.LINK_SUFFIX;\n         }\n-        listItem.append($(\'<a/>\').attr(\'href\',\n-            linkUrl +\n-            highlightstring + item[2]).html(item[1]));\n+        let breadcrumbs = _getBreadcrumbs(item, linkUrl);\n+        breadcrumbs = $("<div class=\'breadcrumbs\'>" + breadcrumbs + "</div>");\n+        listItem.append(breadcrumbs);\n+        let headline = $(\'<h3/>\');\n+        headline.append($(\'<a/>\').attr(\'href\',\n+          linkUrl +\n+          highlightstring + item[2]).html(item[1]));\n         \n-        listItem.append($(\'<span class="title_doc_section">\' + item[6] + \'</span>\'));\n+        listItem.append(headline);\n \n         if (item[3]) {\n           listItem.append($(\'<span> (\' + item[3] + \')</span>\'));\n@@ -321,9 +337,9 @@ var Search = {\n         Search.stopPulse();\n         Search.title.text(_(\'Search Results\'));\n         if (!resultCount)\n-          Search.status.text(_(\'Your search did not match any documents. Please make sure that all words are spelled correctly and that you\\\'ve selected enough categories.\'));\n+          Search.status.text(_(\'Your search did not match any documents. Please make sure that all words are spelled correctly. Searching for multiple words only shows matches that contain all words.\'));\n         else\n-            Search.status.text(_(\'Search finished, found %s page(s) matching the search query.\').replace(\'%s\', resultCount));\n+            Search.status.text(_(\'Found %s page(s) matching the search query.\').replace(\'%s\', resultCount));\n         Search.status.fadeIn(500);\n       }\n     }\n@@ -344,7 +360,9 @@ var Search = {\n     var results = [];\n \n     for (var prefix in objects) {\n-      for (var name in objects[prefix]) {\n+      for (var iMatch = 0; iMatch != objects[prefix].length; ++iMatch) {\n+        var match = objects[prefix][iMatch];\n+        var name = match[4];\n         var fullname = (prefix ? prefix + \'.\' : \'\') + name;\n         var fullnameLower = fullname.toLowerCase()\n         if (fullnameLower.indexOf(object) > -1) {\n@@ -358,7 +376,6 @@ var Search = {\n           } else if (parts[parts.length - 1].indexOf(object) > -1) {\n             score += Scorer.objPartialMatch;\n           }\n-          var match = objects[prefix][name];\n           var objname = objnames[match[1]][2];\n           var title = titles[match[0]];\n           // If more than one term searched for, we require other words to be\n@@ -496,19 +513,40 @@ var Search = {\n           break;\n         }\n       }\n-\n       // if we have still a valid result we can add it to the result list\n       if (valid) {\n+        /**\n+         * file: index\n+         * docnames: array of paths\n+         * titles: array of titles\n+         */\n+\n         // select one (max) score for the file.\n         // for better ranking, we should calculate ranking by using words statistics like basic tf-idf...\n         var score = $u.max($u.map(fileMap[file], function(w){return scoreMap[file][w]}));\n-        function getParentTitle(f) {\n-          let parentdocname = docnames[f].split(\'/\')[0] + \'/index\';\n-          let parentID = docnames.indexOf(parentdocname);\n-          let title = parentID === -1 ? \'Plone Documentation\' : titles[parentID];\n-          return title\n+\n+        /**\n+         * Return array with titles of ancestors of file.\n+         * @param {number} idx - The index of the result item in global list of files\n+         * @returns array\n+         */\n+        function getParentTitles(idx) {\n+          let path = docnames[idx]\n+\n+          let foo = path.split(\'/\').slice(0, -1);\n+          foo = foo.map((el, index) => {\n+            return `${foo.slice(0, index+1).join(\'/\')}/index`\n+          })\n+      \n+          let parentTitles = foo.map(el => {\n+            let parentId = docnames.indexOf(el);\n+            let title = parentId === -1 ? title_documentation : titles[parentId];\n+            return title\n+          })\n+          return parentTitles\n         }\n-        results.push([docnames[file], titles[file], \'\', null, score, filenames[file], getParentTitle(file)]);\n+\n+        results.push([docnames[file], titles[file], \'\', null, score, filenames[file], getParentTitles(file)]);\n       }\n     }\n     return results;\n@@ -544,10 +582,14 @@ var Search = {\n \n $(document).ready(function() {\n   Search.init();\n-  if ($.trim($(".topbar-contents .bd-toc").html()) === "") {\n-    $(".topbar-contents .bd-toc").css("visibility", "hidden");\n-  }\n-  $(\'select[name="doc_section"]\').change(function() {\n+  $(\'#q\').focus();\n+  $(\'input[name="doc_section"]\').change(function() {\n     this.form.submit();\n   });\n+  \n+  function clearSearchField() {\n+    $(\'#q\').val(\'\');\n+    this.form.submit();\n+  }\n+  $( "button.clear_search" ).on( "click", clearSearchField );\n });\ndiff --git a/docs/_templates/page.html b/docs/_templates/page.html\nindex 24f36497..156d0bdb 100644\n--- a/docs/_templates/page.html\n+++ b/docs/_templates/page.html\n@@ -7,9 +7,11 @@\n {% block footer %}\n     <script type="text/javascript">\n         $(document).ready(function() {\n+            // Hide empty sub menu.\n             if ($.trim($(".topbar-contents .bd-toc").html()) === "") {\n                 $(".topbar-contents .bd-toc").css("visibility", "hidden");\n             }\n+            // Add toggle to exercise solutions (admonition with class \'toggle\')\n             $(".toggle > *").hide();\n             $(".toggle .admonition-title").show();\n             $(".toggle .admonition-title").click(function() {\ndiff --git a/docs/_templates/search.html b/docs/_templates/search.html\nindex f9362cf5..bc19ae04 100644\n--- a/docs/_templates/search.html\n+++ b/docs/_templates/search.html\n@@ -40,24 +40,58 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n     </p>\n   {% endblock %}\n   {% block searchbox %}\n-    <form action="" method="get" id="search-form">\n-      <label for="q" class="visuallyhidden">Search string</label>\n-      <input type="text" name="q" id="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>\n-      \n-      <input type="submit" value="{{ _(\'search\') }}" />\n+    <form\n+      action=""\n+      method="get"\n+      id="search-form"\n+      class=""\n+      >\n+      <div class="row">\n+        <div class="input-group col-xl-8 mb-2">\n+          <input\n+            type="text" name="q" id="q"\n+            class="form-control"\n+            placeholder="Search the docs\xe2\x80\xa6"\n+            aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>\n+          <label for="q" class="sr-only">Search string</label>\n+          <div class="input-group-append">\n+            <button type="submit" class="btn btn-primary">{{ _(\'search\') }}</button>\n+          </div>\n+          <div class="input-group-append">\n+            <button\n+              type="button"\n+              class="clear_search btn btn-secondary"\n+            >{{ _(\'reset\') }}</button>\n+          </div>\n+        </div>\n+      </div>\n+\n+      <div class="form row mb-2">\n+        <label for="doc_section" class="col sr-only">Filter by section</label>\n+        <div class="col">\n+          <div class="form-check">\n+            <input class="form-check-input" type="radio" name="doc_section" id="doc_section_all" value="all">\n+            <label class="form-check-label" for="doc_section_all">\n+              All Documentation\n+            </label>\n+          </div>\n+          {% for id, title in\n+            [\n+              ["backend","Backend"],\n+              ["classic-ui","Classic UI"],\n+              ["volto","Frontend"],\n+              ["contributing","Contributing"],\n+            ] %}\n+            <div class="form-check">\n+              <input class="form-check-input" type="radio" name="doc_section" id="doc_section_{{id}}" value="{{id}}">\n+              <label class="form-check-label" for="doc_section_{{id}}">\n+                {{title}}\n+              </label>\n+            </div>\n+          {% endfor %}\n+        </div>\n+      </div>\n \n-      <label for="doc_section" class="visuallyhidden">Filter by section</label>\n-      <select name="doc_section" id="doc_section">\n-        <option value="all">All Documentation</option>\n-        {% for id, title in \n-          [\n-          ["backend","Backend"],\n-          ["classic-ui","Classic UI"],\n-          ["contributing","Contributing"],\n-          ] %}\n-          <option value="{{id}}">{{ title }}</option>\n-        {% endfor %}\n-      </select>\n       <span id="search-progress" style="padding-left: 10px"></span>\n     </form>\n   {% endblock %}\n@@ -76,3 +110,16 @@ <h1 id="search-documentation">{{ _(\'Search\') }}</h1>\n     </div>\n   {% endblock %}\n {% endblock %}\n+\n+\n+{% block footer %}\n+    <script type="text/javascript">\n+        $(document).ready(function() {\n+            // Hide empty sub menu.\n+            if ($.trim($(".topbar-contents .bd-toc").html()) === "") {\n+                $(".topbar-contents .bd-toc").css("visibility", "hidden");\n+            }\n+        });\n+    </script>\n+\n+{% endblock %}\n\\ No newline at end of file\n'

