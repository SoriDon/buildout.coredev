Repository: plone.app.theming


Branch: refs/heads/master
Date: 2018-12-31T00:04:45+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.theming/commit/98e8285f9c22700414671a1cdb191e4f903ef3f5

Fixed DeprecationWarning about SafeConfigParser class on Python 3.

Files changed:
A news/152.bugfix
M src/plone/app/theming/plugins/utils.py
M src/plone/app/theming/utils.py

b"diff --git a/news/152.bugfix b/news/152.bugfix\nnew file mode 100644\nindex 0000000..ac278ac\n--- /dev/null\n+++ b/news/152.bugfix\n@@ -0,0 +1,2 @@\n+Fixed DeprecationWarning about SafeConfigParser class on Python 3.\n+[maurits]\ndiff --git a/src/plone/app/theming/plugins/utils.py b/src/plone/app/theming/plugins/utils.py\nindex 4ec6ef9..8e1cd95 100644\n--- a/src/plone/app/theming/plugins/utils.py\n+++ b/src/plone/app/theming/plugins/utils.py\n@@ -3,11 +3,20 @@\n from plone.app.theming.interfaces import THEME_RESOURCE_NAME\n from plone.memoize.ram import cache\n from plone.resource.manifest import MANIFEST_FILENAME\n-from six.moves.configparser import SafeConfigParser\n from zope.component import getUtilitiesFor\n \n import six\n \n+try:\n+    # Python 3.  Watch out for DeprecationWarning:\n+    # The SafeConfigParser class has been renamed to ConfigParser in\n+    # Python 3.2. This alias will be removed in future versions.\n+    # Use ConfigParser directly instead.\n+    from configparser import ConfigParser as SafeConfigParser\n+except ImportError:\n+    # Python 2\n+    from ConfigParser import SafeConfigParser\n+\n \n def pluginsCacheKey(fun):\n     return len(list(getUtilitiesFor(IThemePlugin)))\ndiff --git a/src/plone/app/theming/utils.py b/src/plone/app/theming/utils.py\nindex 93fe249..82fbeec 100644\n--- a/src/plone/app/theming/utils.py\n+++ b/src/plone/app/theming/utils.py\n@@ -25,7 +25,6 @@\n from Products.CMFCore.interfaces import ISiteRoot\n from Products.CMFPlone.utils import safe_unicode\n from Products.PageTemplates.Expressions import getEngine\n-from six.moves.configparser import SafeConfigParser\n from six.moves.urllib.parse import urlsplit\n from zope.component import getUtility\n from zope.component import queryMultiAdapter\n@@ -36,6 +35,16 @@\n import pkg_resources\n import six\n \n+try:\n+    # Python 3.  Watch out for DeprecationWarning:\n+    # The SafeConfigParser class has been renamed to ConfigParser in\n+    # Python 3.2. This alias will be removed in future versions.\n+    # Use ConfigParser directly instead.\n+    from configparser import ConfigParser as SafeConfigParser\n+except ImportError:\n+    # Python 2\n+    from ConfigParser import SafeConfigParser\n+\n \n LOGGER = logging.getLogger('plone.app.theming')\n \n"

Repository: plone.app.theming


Branch: refs/heads/master
Date: 2019-01-01T20:56:04+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.theming/commit/1c44d615681cf256fd6f50be020b0965b4794267

Merge pull request #153 from plone/issue-152-safeconfigparser

Fixed DeprecationWarning about SafeConfigParser class on Python 3.

Files changed:
A news/152.bugfix
M src/plone/app/theming/plugins/utils.py
M src/plone/app/theming/utils.py

b"diff --git a/news/152.bugfix b/news/152.bugfix\nnew file mode 100644\nindex 0000000..ac278ac\n--- /dev/null\n+++ b/news/152.bugfix\n@@ -0,0 +1,2 @@\n+Fixed DeprecationWarning about SafeConfigParser class on Python 3.\n+[maurits]\ndiff --git a/src/plone/app/theming/plugins/utils.py b/src/plone/app/theming/plugins/utils.py\nindex 4ec6ef9..8e1cd95 100644\n--- a/src/plone/app/theming/plugins/utils.py\n+++ b/src/plone/app/theming/plugins/utils.py\n@@ -3,11 +3,20 @@\n from plone.app.theming.interfaces import THEME_RESOURCE_NAME\n from plone.memoize.ram import cache\n from plone.resource.manifest import MANIFEST_FILENAME\n-from six.moves.configparser import SafeConfigParser\n from zope.component import getUtilitiesFor\n \n import six\n \n+try:\n+    # Python 3.  Watch out for DeprecationWarning:\n+    # The SafeConfigParser class has been renamed to ConfigParser in\n+    # Python 3.2. This alias will be removed in future versions.\n+    # Use ConfigParser directly instead.\n+    from configparser import ConfigParser as SafeConfigParser\n+except ImportError:\n+    # Python 2\n+    from ConfigParser import SafeConfigParser\n+\n \n def pluginsCacheKey(fun):\n     return len(list(getUtilitiesFor(IThemePlugin)))\ndiff --git a/src/plone/app/theming/utils.py b/src/plone/app/theming/utils.py\nindex 93fe249..82fbeec 100644\n--- a/src/plone/app/theming/utils.py\n+++ b/src/plone/app/theming/utils.py\n@@ -25,7 +25,6 @@\n from Products.CMFCore.interfaces import ISiteRoot\n from Products.CMFPlone.utils import safe_unicode\n from Products.PageTemplates.Expressions import getEngine\n-from six.moves.configparser import SafeConfigParser\n from six.moves.urllib.parse import urlsplit\n from zope.component import getUtility\n from zope.component import queryMultiAdapter\n@@ -36,6 +35,16 @@\n import pkg_resources\n import six\n \n+try:\n+    # Python 3.  Watch out for DeprecationWarning:\n+    # The SafeConfigParser class has been renamed to ConfigParser in\n+    # Python 3.2. This alias will be removed in future versions.\n+    # Use ConfigParser directly instead.\n+    from configparser import ConfigParser as SafeConfigParser\n+except ImportError:\n+    # Python 2\n+    from ConfigParser import SafeConfigParser\n+\n \n LOGGER = logging.getLogger('plone.app.theming')\n \n"

