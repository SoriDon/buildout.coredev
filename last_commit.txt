Repository: plone.testing


Branch: refs/heads/master
Date: 2019-07-01T08:47:49+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.testing/commit/b417a74495d488dd8f9eab68f097e111aff3f73a

Revert "Fix injection of ZopeLite test configuration into the global Zope configuration."

Files changed:
M src/plone/testing/zope.py
D news/65.bugfix

b'diff --git a/news/65.bugfix b/news/65.bugfix\ndeleted file mode 100644\nindex 9d5ba42..0000000\n--- a/news/65.bugfix\n+++ /dev/null\n@@ -1,3 +0,0 @@\n-Fix injection of ZopeLite test configuration into the global Zope configuration.\n-Fixes #64\n-[thet]\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex b2f6c56..6af2c81 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -7,6 +7,7 @@\n from plone.testing import zca\n from plone.testing import zodb\n from plone.testing._z2_testbrowser import Browser  # noqa\n+from Testing.ZopeTestCase.ZopeLite import _patched as ZOPETESTCASEALERT\n from webtest.http import StopableWSGIServer\n from Zope2.App.schema import Zope2VocabularyRegistry\n from zope.schema.vocabulary import getVocabularyRegistry\n@@ -460,11 +461,6 @@ def setUpDatabase(self):\n         that the database that is opened by Zope 2 is in fact the top of\n         the resource stack.\n         """\n-\n-        # NOTE: Keep that import here.\n-        #       Having it on module-level has the side effect of injecting the\n-        #       ZopeLite test configuration into the global Zope configuration.\n-        from Testing.ZopeTestCase.ZopeLite import _patched as ZOPETESTCASEALERT\n         if ZOPETESTCASEALERT:\n             raise Exception(\'You try to run plone.testing tests together with \'\n                             \'ZopeTestCase tests. This will result in random \'\n'

Repository: plone.testing


Branch: refs/heads/master
Date: 2019-07-01T13:13:26+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.testing/commit/364f9782d8914f2787778f732b47c7b8f3d625d5

Merge pull request #66 from plone/revert-65-thet-fix-64

Revert "Fix injection of ZopeLite test configuration into the global Zope configuration."

Files changed:
M src/plone/testing/zope.py
D news/65.bugfix

b'diff --git a/news/65.bugfix b/news/65.bugfix\ndeleted file mode 100644\nindex 9d5ba42..0000000\n--- a/news/65.bugfix\n+++ /dev/null\n@@ -1,3 +0,0 @@\n-Fix injection of ZopeLite test configuration into the global Zope configuration.\n-Fixes #64\n-[thet]\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex b2f6c56..6af2c81 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -7,6 +7,7 @@\n from plone.testing import zca\n from plone.testing import zodb\n from plone.testing._z2_testbrowser import Browser  # noqa\n+from Testing.ZopeTestCase.ZopeLite import _patched as ZOPETESTCASEALERT\n from webtest.http import StopableWSGIServer\n from Zope2.App.schema import Zope2VocabularyRegistry\n from zope.schema.vocabulary import getVocabularyRegistry\n@@ -460,11 +461,6 @@ def setUpDatabase(self):\n         that the database that is opened by Zope 2 is in fact the top of\n         the resource stack.\n         """\n-\n-        # NOTE: Keep that import here.\n-        #       Having it on module-level has the side effect of injecting the\n-        #       ZopeLite test configuration into the global Zope configuration.\n-        from Testing.ZopeTestCase.ZopeLite import _patched as ZOPETESTCASEALERT\n         if ZOPETESTCASEALERT:\n             raise Exception(\'You try to run plone.testing tests together with \'\n                             \'ZopeTestCase tests. This will result in random \'\n'

