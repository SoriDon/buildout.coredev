Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-02-18T15:16:03+09:00
Author: Manabu TERADA (terapyon) <terada@cmscom.jp>
Commit: https://github.com/plone/Products.CMFPlone/commit/64c404a96b03953688f5737f949b44eef3c132d3

fix `aria-hidden` attribute control problem on toolbar
https://github.com/plone/Products.CMFPlone/issues/866

Files changed:
M CHANGES.rst
M Products/CMFPlone/static/patterns/toolbar/src/toolbar.js

diff --git a/CHANGES.rst b/CHANGES.rst
index dbd594e..8b82400 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -48,6 +48,10 @@ Fixes:
 
 - Mock MailHost on testing.py so that tests relying on mails can use it.
   [gforcada]
+  
+- Fix `aria-hidden` attribute control problem on toolbar
+  https://github.com/plone/Products.CMFPlone/issues/866
+  [terapyon]
 
 
 5.0.2 (2016-01-08)
diff --git a/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js b/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
index 561907d..dd745f1 100644
--- a/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
+++ b/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
@@ -128,6 +128,7 @@ define([
         }
         else {
           // close existing opened contentmenus
+          $('.' + active_class + '> ul', that.$container).attr("aria-hidden", "true");
           $('.' + active_class, that.$container).removeClass(active_class);
           // we need to close the more subset as well not just the content-menus
           // when we click on the personal bar
@@ -177,6 +178,7 @@ define([
       $content.css({
         'margin-top': Math.min(itemLocation, height - insideHeight)
       });
+      $content.attr("aria-hidden", "false");
     },
     isDesktop: function(){
       return $(window).width() > '768';


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-02-18T12:00:05-06:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/428e35249d98e326078c37266998dc8af841aee7

Merge pull request #1397 from plonejp/master

fix `aria-hidden` attribute control problem on toolbar

Files changed:
M CHANGES.rst
M Products/CMFPlone/static/patterns/toolbar/src/toolbar.js

diff --git a/CHANGES.rst b/CHANGES.rst
index dbd594e..8b82400 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -48,6 +48,10 @@ Fixes:
 
 - Mock MailHost on testing.py so that tests relying on mails can use it.
   [gforcada]
+  
+- Fix `aria-hidden` attribute control problem on toolbar
+  https://github.com/plone/Products.CMFPlone/issues/866
+  [terapyon]
 
 
 5.0.2 (2016-01-08)
diff --git a/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js b/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
index 561907d..dd745f1 100644
--- a/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
+++ b/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
@@ -128,6 +128,7 @@ define([
         }
         else {
           // close existing opened contentmenus
+          $('.' + active_class + '> ul', that.$container).attr("aria-hidden", "true");
           $('.' + active_class, that.$container).removeClass(active_class);
           // we need to close the more subset as well not just the content-menus
           // when we click on the personal bar
@@ -177,6 +178,7 @@ define([
       $content.css({
         'margin-top': Math.min(itemLocation, height - insideHeight)
       });
+      $content.attr("aria-hidden", "false");
     },
     isDesktop: function(){
       return $(window).width() > '768';


