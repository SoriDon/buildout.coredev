Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2022-02-17T16:37:38+02:00
Author: Miu Razvan (razvanMiu) <miu.razvan28@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/d6bfa9eebd390c356cb2d84ba5801f347f32f4d1

#180 Added 'View comments' permission

Files changed:
M plone/app/discussion/browser/configure.zcml
M plone/app/discussion/permissions.zcml
M plone/app/discussion/profiles/default/rolemap.xml

b'diff --git a/plone/app/discussion/browser/configure.zcml b/plone/app/discussion/browser/configure.zcml\nindex 9572de5b..15c015f3 100644\n--- a/plone/app/discussion/browser/configure.zcml\n+++ b/plone/app/discussion/browser/configure.zcml\n@@ -117,7 +117,7 @@\n         manager="plone.app.layout.viewlets.interfaces.IBelowContent"\n         view="plone.app.layout.globals.interfaces.IViewView"\n         class=".comments.CommentsViewlet"\n-        permission="zope2.View"\n+        permission="plone.app.discussion.ViewComments"\n         />\n \n     <!-- Conversation view -->\ndiff --git a/plone/app/discussion/permissions.zcml b/plone/app/discussion/permissions.zcml\nindex 39ff305a..8c05904f 100644\n--- a/plone/app/discussion/permissions.zcml\n+++ b/plone/app/discussion/permissions.zcml\n@@ -4,6 +4,11 @@\n \n     <!-- custom permissions are defined here -->\n \n+    <permission\n+        id="plone.app.discussion.ViewComments"\n+        title="View comments"\n+        />\n+\n     <permission\n         id="plone.app.discussion.ReviewComments"\n         title="Review comments"\ndiff --git a/plone/app/discussion/profiles/default/rolemap.xml b/plone/app/discussion/profiles/default/rolemap.xml\nindex e63aae62..44fa8439 100644\n--- a/plone/app/discussion/profiles/default/rolemap.xml\n+++ b/plone/app/discussion/profiles/default/rolemap.xml\n@@ -1,6 +1,9 @@\n <?xml version="1.0"?>\n <rolemap>\n     <permissions>\n+        <permission name="View comments" acquire="True">\n+            <role name="Anonymous"/>\n+        </permission>\n         <permission name="Review comments" acquire="True">\n             <role name="Manager"/>\n             <role name="Site Administrator"/>\n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2022-02-17T16:45:09+02:00
Author: Miu Razvan (razvanMiu) <miu.razvan28@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/d3c804e3ba6783ee00d06f143bbc1ba2d723258f

Changelog

Files changed:
A news/180.feature

b"diff --git a/news/180.feature b/news/180.feature\nnew file mode 100644\nindex 00000000..867361ad\n--- /dev/null\n+++ b/news/180.feature\n@@ -0,0 +1 @@\n+- Added 'View comments' permission. [@razvanMiu]\n\\ No newline at end of file\n"

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2022-03-01T13:07:27+02:00
Author: Miu Razvan (razvanMiu) <miu.razvan28@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/5beb67332132b57d13d1102f69a30e35bb56f0b3

Add upgrade step

Files changed:
M plone/app/discussion/profiles/default/metadata.xml
M plone/app/discussion/upgrades.zcml

b'diff --git a/plone/app/discussion/profiles/default/metadata.xml b/plone/app/discussion/profiles/default/metadata.xml\nindex 727c28c5..57deab7e 100644\n--- a/plone/app/discussion/profiles/default/metadata.xml\n+++ b/plone/app/discussion/profiles/default/metadata.xml\n@@ -1,5 +1,5 @@\n <metadata>\n- <version>1003</version>\n+ <version>1004</version>\n  <dependencies>\n   <dependency>profile-plone.resource:default</dependency>\n   <dependency>profile-plone.app.registry:default</dependency>\ndiff --git a/plone/app/discussion/upgrades.zcml b/plone/app/discussion/upgrades.zcml\nindex 4417858d..5cf6e436 100644\n--- a/plone/app/discussion/upgrades.zcml\n+++ b/plone/app/discussion/upgrades.zcml\n@@ -80,6 +80,13 @@\n       title="Update controlpanel icon"\n       import_steps="controlpanel" />\n \n+    <genericsetup:upgradeDepends\n+      source="1003"\n+      destination="1004"\n+      profile="plone.app.discussion:default"\n+      title="Add \'View comments\' permission"\n+      import_steps="controlpanel" />\n+\n \n \n </configure>\n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2022-03-01T13:09:03+02:00
Author: Miu Razvan (razvanMiu) <miu.razvan28@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/733efe3287d4aacd7d722cd87476b5651297dfef

Changed import_step to rolemap

Files changed:
M plone/app/discussion/upgrades.zcml

b'diff --git a/plone/app/discussion/upgrades.zcml b/plone/app/discussion/upgrades.zcml\nindex 5cf6e436..5ab5da53 100644\n--- a/plone/app/discussion/upgrades.zcml\n+++ b/plone/app/discussion/upgrades.zcml\n@@ -85,7 +85,7 @@\n       destination="1004"\n       profile="plone.app.discussion:default"\n       title="Add \'View comments\' permission"\n-      import_steps="controlpanel" />\n+      import_steps="rolemap" />\n \n \n \n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2022-03-14T22:23:25+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.discussion/commit/a86db1b8c298691d4b6f62724bee343bf3778b7c

Merge pull request #191 from plone/180_view_permissions

#180 Added 'View comments' permission

Files changed:
A news/180.feature
M plone/app/discussion/browser/configure.zcml
M plone/app/discussion/permissions.zcml
M plone/app/discussion/profiles/default/metadata.xml
M plone/app/discussion/profiles/default/rolemap.xml
M plone/app/discussion/upgrades.zcml

b'diff --git a/news/180.feature b/news/180.feature\nnew file mode 100644\nindex 00000000..867361ad\n--- /dev/null\n+++ b/news/180.feature\n@@ -0,0 +1 @@\n+- Added \'View comments\' permission. [@razvanMiu]\n\\ No newline at end of file\ndiff --git a/plone/app/discussion/browser/configure.zcml b/plone/app/discussion/browser/configure.zcml\nindex 9572de5b..15c015f3 100644\n--- a/plone/app/discussion/browser/configure.zcml\n+++ b/plone/app/discussion/browser/configure.zcml\n@@ -117,7 +117,7 @@\n         manager="plone.app.layout.viewlets.interfaces.IBelowContent"\n         view="plone.app.layout.globals.interfaces.IViewView"\n         class=".comments.CommentsViewlet"\n-        permission="zope2.View"\n+        permission="plone.app.discussion.ViewComments"\n         />\n \n     <!-- Conversation view -->\ndiff --git a/plone/app/discussion/permissions.zcml b/plone/app/discussion/permissions.zcml\nindex 39ff305a..8c05904f 100644\n--- a/plone/app/discussion/permissions.zcml\n+++ b/plone/app/discussion/permissions.zcml\n@@ -4,6 +4,11 @@\n \n     <!-- custom permissions are defined here -->\n \n+    <permission\n+        id="plone.app.discussion.ViewComments"\n+        title="View comments"\n+        />\n+\n     <permission\n         id="plone.app.discussion.ReviewComments"\n         title="Review comments"\ndiff --git a/plone/app/discussion/profiles/default/metadata.xml b/plone/app/discussion/profiles/default/metadata.xml\nindex 727c28c5..57deab7e 100644\n--- a/plone/app/discussion/profiles/default/metadata.xml\n+++ b/plone/app/discussion/profiles/default/metadata.xml\n@@ -1,5 +1,5 @@\n <metadata>\n- <version>1003</version>\n+ <version>1004</version>\n  <dependencies>\n   <dependency>profile-plone.resource:default</dependency>\n   <dependency>profile-plone.app.registry:default</dependency>\ndiff --git a/plone/app/discussion/profiles/default/rolemap.xml b/plone/app/discussion/profiles/default/rolemap.xml\nindex e63aae62..44fa8439 100644\n--- a/plone/app/discussion/profiles/default/rolemap.xml\n+++ b/plone/app/discussion/profiles/default/rolemap.xml\n@@ -1,6 +1,9 @@\n <?xml version="1.0"?>\n <rolemap>\n     <permissions>\n+        <permission name="View comments" acquire="True">\n+            <role name="Anonymous"/>\n+        </permission>\n         <permission name="Review comments" acquire="True">\n             <role name="Manager"/>\n             <role name="Site Administrator"/>\ndiff --git a/plone/app/discussion/upgrades.zcml b/plone/app/discussion/upgrades.zcml\nindex 4417858d..5ab5da53 100644\n--- a/plone/app/discussion/upgrades.zcml\n+++ b/plone/app/discussion/upgrades.zcml\n@@ -80,6 +80,13 @@\n       title="Update controlpanel icon"\n       import_steps="controlpanel" />\n \n+    <genericsetup:upgradeDepends\n+      source="1003"\n+      destination="1004"\n+      profile="plone.app.discussion:default"\n+      title="Add \'View comments\' permission"\n+      import_steps="rolemap" />\n+\n \n \n </configure>\n'

