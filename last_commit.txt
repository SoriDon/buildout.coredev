Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-06-10T15:22:32+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/73e5b2c8622e0c9d6947a62af072bcfe88db19bb

Tests: fixed order of roles in http examples.

Files changed:
M news/1327.feature
M src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp
M src/plone/restapi/tests/http-examples/users_filtered_by_username.resp

b'diff --git a/news/1327.feature b/news/1327.feature\nindex 7346890e3..38f27fa6e 100644\n--- a/news/1327.feature\n+++ b/news/1327.feature\n@@ -1 +1 @@\n-- Added \'View comments\' and \'Reply to item\' permission to discussion [@razvanMiu]\n+Added \'View comments\' and \'Reply to item\' permission to discussion [@razvanMiu]\ndiff --git a/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp b/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp\nindex 65ef80270..7ea2e78da 100644\n--- a/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp\n+++ b/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp\n@@ -26,8 +26,8 @@ Content-Type: application/json\n         "location": "Cambridge, MA",\n         "portrait": null,\n         "roles": [\n-            "Reviewer",\n-            "Member"\n+            "Member",\n+            "Reviewer"\n         ],\n         "username": "noam"\n     }\ndiff --git a/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp b/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp\nindex 282db7cf3..2c940f0a4 100644\n--- a/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp\n+++ b/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp\n@@ -26,8 +26,8 @@ Content-Type: application/json\n         "location": "Cambridge, MA",\n         "portrait": null,\n         "roles": [\n-            "Reviewer",\n-            "Member"\n+            "Member",\n+            "Reviewer"\n         ],\n         "username": "noam"\n     }\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-06-10T15:48:06+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/e6ad612a4b7e8cfd1751cd885286a69ae988631a

Sort the roles in the user serializer.

Files changed:
A news/1452.bugfix
M src/plone/restapi/serializer/user.py

b'diff --git a/news/1452.bugfix b/news/1452.bugfix\nnew file mode 100644\nindex 000000000..a90c2d7d4\n--- /dev/null\n+++ b/news/1452.bugfix\n@@ -0,0 +1,2 @@\n+Sort the roles in the user serializer.\n+[maurits]\ndiff --git a/src/plone/restapi/serializer/user.py b/src/plone/restapi/serializer/user.py\nindex a179601cf..e651f3167 100644\n--- a/src/plone/restapi/serializer/user.py\n+++ b/src/plone/restapi/serializer/user.py\n@@ -25,7 +25,7 @@ def __call__(self):\n         roles = user.getRoles()\n         # Anonymous and Authenticated are pseudo roles assign automatically\n         # to logged-in or logged-out users. They should not be exposed here\n-        roles = list(set(roles) - {"Anonymous", "Authenticated"})\n+        roles = sorted(list(set(roles) - {"Anonymous", "Authenticated"}))\n \n         data = {\n             "@id": f"{portal.absolute_url()}/@users/{user.id}",\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-06-10T18:33:03+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/157842d2f154a2faa8d6429983b63a77330cfa50

Merge pull request #1452 from plone/maurits-fix-37-52-documentation-tests

Tests: fixed order of roles in http examples.

Files changed:
A news/1452.bugfix
M news/1327.feature
M src/plone/restapi/serializer/user.py
M src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp
M src/plone/restapi/tests/http-examples/users_filtered_by_username.resp

b'diff --git a/news/1327.feature b/news/1327.feature\nindex 7346890e3..38f27fa6e 100644\n--- a/news/1327.feature\n+++ b/news/1327.feature\n@@ -1 +1 @@\n-- Added \'View comments\' and \'Reply to item\' permission to discussion [@razvanMiu]\n+Added \'View comments\' and \'Reply to item\' permission to discussion [@razvanMiu]\ndiff --git a/news/1452.bugfix b/news/1452.bugfix\nnew file mode 100644\nindex 000000000..a90c2d7d4\n--- /dev/null\n+++ b/news/1452.bugfix\n@@ -0,0 +1,2 @@\n+Sort the roles in the user serializer.\n+[maurits]\ndiff --git a/src/plone/restapi/serializer/user.py b/src/plone/restapi/serializer/user.py\nindex a179601cf..e651f3167 100644\n--- a/src/plone/restapi/serializer/user.py\n+++ b/src/plone/restapi/serializer/user.py\n@@ -25,7 +25,7 @@ def __call__(self):\n         roles = user.getRoles()\n         # Anonymous and Authenticated are pseudo roles assign automatically\n         # to logged-in or logged-out users. They should not be exposed here\n-        roles = list(set(roles) - {"Anonymous", "Authenticated"})\n+        roles = sorted(list(set(roles) - {"Anonymous", "Authenticated"}))\n \n         data = {\n             "@id": f"{portal.absolute_url()}/@users/{user.id}",\ndiff --git a/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp b/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp\nindex 65ef80270..7ea2e78da 100644\n--- a/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp\n+++ b/src/plone/restapi/tests/http-examples/users_filtered_by_groups.resp\n@@ -26,8 +26,8 @@ Content-Type: application/json\n         "location": "Cambridge, MA",\n         "portrait": null,\n         "roles": [\n-            "Reviewer",\n-            "Member"\n+            "Member",\n+            "Reviewer"\n         ],\n         "username": "noam"\n     }\ndiff --git a/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp b/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp\nindex 282db7cf3..2c940f0a4 100644\n--- a/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp\n+++ b/src/plone/restapi/tests/http-examples/users_filtered_by_username.resp\n@@ -26,8 +26,8 @@ Content-Type: application/json\n         "location": "Cambridge, MA",\n         "portrait": null,\n         "roles": [\n-            "Reviewer",\n-            "Member"\n+            "Member",\n+            "Reviewer"\n         ],\n         "username": "noam"\n     }\n'

