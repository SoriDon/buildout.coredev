Repository: plone.app.querystring


Branch: refs/heads/master
Date: 2017-04-05T18:02:01+02:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/plone.app.querystring/commit/e256c9602a0557cc21c963b5030b08ba2795bcab

Do not fail on empty empty or not existing querystrings while upgrading

Files changed:
M CHANGES.rst
M plone/app/querystring/upgrades.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ab154a6..34a3e87 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Do not fail on empty empty or not existing querystrings while upgrading.
+  [agitator]
 
 
 1.4.3 (2017-02-12)
diff --git a/plone/app/querystring/upgrades.py b/plone/app/querystring/upgrades.py
index 57d1389..cc8a085 100644
--- a/plone/app/querystring/upgrades.py
+++ b/plone/app/querystring/upgrades.py
@@ -43,7 +43,7 @@ def fix_select_all_existing_collections(context, query=None):
         changed = False
         obj = brain.getObject()
         fixed_querystring = list()
-        for querystring in obj.query:
+        for querystring in (obj.query or []):
             # transform querystring to dict
             if not isinstance(querystring, dict):
                 querystring = dict(querystring)


Repository: plone.app.querystring


Branch: refs/heads/master
Date: 2017-04-05T18:50:46+02:00
Author: agitator (agitator) <agitator@users.noreply.github.com>
Commit: https://github.com/plone/plone.app.querystring/commit/ff86912f857d390e3f4f7baa17164121e11d535e

Merge pull request #76 from plone/no-fail-on-empty-querystring

Do not fail on empty empty or not existing querystrings while upgrading

Files changed:
M CHANGES.rst
M plone/app/querystring/upgrades.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ab154a6..34a3e87 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Do not fail on empty empty or not existing querystrings while upgrading.
+  [agitator]
 
 
 1.4.3 (2017-02-12)
diff --git a/plone/app/querystring/upgrades.py b/plone/app/querystring/upgrades.py
index 57d1389..cc8a085 100644
--- a/plone/app/querystring/upgrades.py
+++ b/plone/app/querystring/upgrades.py
@@ -43,7 +43,7 @@ def fix_select_all_existing_collections(context, query=None):
         changed = False
         obj = brain.getObject()
         fixed_querystring = list()
-        for querystring in obj.query:
+        for querystring in (obj.query or []):
             # transform querystring to dict
             if not isinstance(querystring, dict):
                 querystring = dict(querystring)


