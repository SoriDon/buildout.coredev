Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2016-02-23T15:40:56+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.Archetypes/commit/3b031f61cddab34c1da23caed7f7b5d2606578d3

Replace deprecated zope.site.hooks import with zope.component.hooks.

Files changed:
M CHANGES.rst
M Products/Archetypes/fieldproperty.py
M Products/Archetypes/tests/traversal.txt
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 50414fe..0b7424a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,6 +10,9 @@ New:
 
 Fixes:
 
+- Replace deprecated ``zope.site.hooks`` import with ``zope.component.hooks``.
+  [thet]
+
 - Fix tinymce pattern-options merging to be compatible with change in
   p.a.widgets and p.a.z3cform.
   [alecm]
diff --git a/Products/Archetypes/fieldproperty.py b/Products/Archetypes/fieldproperty.py
index 575df73..575b2c0 100644
--- a/Products/Archetypes/fieldproperty.py
+++ b/Products/Archetypes/fieldproperty.py
@@ -2,11 +2,9 @@
 """
 
 from DateTime import DateTime
-from datetime import datetime
+from zope.component.hooks import getSite
 from zope.datetime import parseDatetimetz
 
-from zope.site.hooks import getSite
-
 
 class ATFieldProperty(object):
     """Field properties based on Archetypes schema
diff --git a/Products/Archetypes/tests/traversal.txt b/Products/Archetypes/tests/traversal.txt
index 71f279e..72016e3 100644
--- a/Products/Archetypes/tests/traversal.txt
+++ b/Products/Archetypes/tests/traversal.txt
@@ -177,7 +177,7 @@ We need to do some site magic, or our we end up with the SimpleView class
 being persisted in the local component registry. We really shouldn't do
 ZCML registrations in function tests.
 
-  >>> from zope.site.hooks import getSite, setSite
+  >>> from zope.component.hooks import getSite, setSite
   >>> site = getSite()
 
   >>> setSite(None)
diff --git a/setup.py b/setup.py
index e83e746..16873e4 100644
--- a/setup.py
+++ b/setup.py
@@ -46,7 +46,6 @@
           'zope.lifecycleevent',
           'zope.publisher',
           'zope.schema',
-          'zope.site',
           'zope.tal',
           'zope.viewlet',
           'Products.CMFCore',


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2016-02-24T00:20:52+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.Archetypes/commit/4ef388fbd499f874f7a11af29aa758282861ac84

Merge pull request #53 from plone/thet-rmzopesitehooks

Replace deprecated zope.site.hooks import with zope.component.hooks.

Files changed:
M CHANGES.rst
M Products/Archetypes/fieldproperty.py
M Products/Archetypes/tests/traversal.txt
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 50414fe..0b7424a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,6 +10,9 @@ New:
 
 Fixes:
 
+- Replace deprecated ``zope.site.hooks`` import with ``zope.component.hooks``.
+  [thet]
+
 - Fix tinymce pattern-options merging to be compatible with change in
   p.a.widgets and p.a.z3cform.
   [alecm]
diff --git a/Products/Archetypes/fieldproperty.py b/Products/Archetypes/fieldproperty.py
index 575df73..575b2c0 100644
--- a/Products/Archetypes/fieldproperty.py
+++ b/Products/Archetypes/fieldproperty.py
@@ -2,11 +2,9 @@
 """
 
 from DateTime import DateTime
-from datetime import datetime
+from zope.component.hooks import getSite
 from zope.datetime import parseDatetimetz
 
-from zope.site.hooks import getSite
-
 
 class ATFieldProperty(object):
     """Field properties based on Archetypes schema
diff --git a/Products/Archetypes/tests/traversal.txt b/Products/Archetypes/tests/traversal.txt
index 71f279e..72016e3 100644
--- a/Products/Archetypes/tests/traversal.txt
+++ b/Products/Archetypes/tests/traversal.txt
@@ -177,7 +177,7 @@ We need to do some site magic, or our we end up with the SimpleView class
 being persisted in the local component registry. We really shouldn't do
 ZCML registrations in function tests.
 
-  >>> from zope.site.hooks import getSite, setSite
+  >>> from zope.component.hooks import getSite, setSite
   >>> site = getSite()
 
   >>> setSite(None)
diff --git a/setup.py b/setup.py
index e83e746..16873e4 100644
--- a/setup.py
+++ b/setup.py
@@ -46,7 +46,6 @@
           'zope.lifecycleevent',
           'zope.publisher',
           'zope.schema',
-          'zope.site',
           'zope.tal',
           'zope.viewlet',
           'Products.CMFCore',


