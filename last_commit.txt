Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-28T16:38:30+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/07e9ecc0c2438f3b8b40c9d521957c04a81b1c35

Run tests with plone pip installation (buildout support is extensively tested by Jenkins.

Files changed:
M .github/workflows/tests.yml

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex b6c8957..ae8e477 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -6,8 +6,11 @@ jobs:\n     strategy:\n       fail-fast: false\n       matrix:\n-        python-version: [3.8]\n-        plone-version: ["6.0", "5.2"]\n+        python-version: [3.7, 3.8, 3.9]\n+        plone-version: ["6.0.0a1", "5.2.6"]\n+        exclude:\n+          - plone-version: "5.2.6"\n+            python-version: 3.9\n \n     steps:\n       # git checkout\n@@ -20,26 +23,34 @@ jobs:\n           python-version: ${{ matrix.python-version }}\n \n       # python cache\n-      - uses: actions/cache@v1\n+      - name: Setup cache\n+        id: cache\n+        uses: actions/cache@v2\n         with:\n-          path: ~/.cache/pip\n-          key: ${{ runner.os }}-pip-${{ hashFiles(\'**/requirements.txt\') }}\n+          path: |\n+            ~/.cache/pip\n+            ~/.cache/plone\n+          key: ${{ runner.os }}-pip-${{ matrix.python-version }}-${{ matrix.plone-version }}-${{ hashFiles(\'requirements/dev.txt\') }}\n           restore-keys: |\n-            ${{ runner.os }}-pip-\n+            ${{ runner.os }}-pip-${{ matrix.python-version }}-\n \n       # python install\n-      - run: pip install virtualenv\n-      - run: pip install wheel\n-      - name: pip install\n-        run: pip install -r requirements.txt\n+      - name: Create virtual environment\n+        run: |\n+          python -m venv .\n+          ./bin/pip install -U pip setuptools wheel\n \n-      - name: debug\n-        run: echo ${{ matrix.plone-version }}\n+      # Plone install\n+      - name: Install Plone\n+        run: |\n+          ./bin/pip install Plone -c https://dist.plone.org/release/${{ matrix.plone-version }}/constraints.txt  --use-deprecated legacy-resolver -f ~/.cache/plone\n \n-      # buildout\n-      - name: buildout\n-        run: buildout -t 10 -c plone-${{ matrix.plone-version }}.x.cfg\n+      # Install plone.volto with test extras\n+      - name: Install plone.volto\n+        run: |\n+          ./bin/pip install ".[test]" --use-deprecated legacy-resolver\n \n       # test\n       - name: test\n-        run: bin/test\n+        run: |\n+          ./bin/zope-testrunner --auto-color --auto-progress --test-path src/plone.volto/src/\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-28T16:44:58+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/586a1a7f553b3b3c958e8cefc10de4f070c5555c

Fix Github action test

Files changed:
M .github/workflows/tests.yml

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex ae8e477..07a4fbb 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -53,4 +53,4 @@ jobs:\n       # test\n       - name: test\n         run: |\n-          ./bin/zope-testrunner --auto-color --auto-progress --test-path src/plone.volto/src/\n+          ./bin/zope-testrunner --auto-color --auto-progress --test-path src/plone.volto/tests/\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-28T17:07:44+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/b82a3be4bf7f394fb4c2f6028986bd1483e48a57

Fix Github Actions test path

Files changed:
M .github/workflows/tests.yml

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex 07a4fbb..d809521 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -53,4 +53,4 @@ jobs:\n       # test\n       - name: test\n         run: |\n-          ./bin/zope-testrunner --auto-color --auto-progress --test-path src/plone.volto/tests/\n+          ./bin/zope-testrunner --auto-color --auto-progress --test-path src\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-28T17:11:55+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/a5f89193add27453695cdcca0ca12a817e7031fe

Add requirements folder to be used with pip installations.

Files changed:
A requirements/dev.txt
A requirements/plone-5.2.txt
A requirements/plone-6.0.txt
A requirements/prod.txt

b'diff --git a/requirements/dev.txt b/requirements/dev.txt\nnew file mode 100644\nindex 0000000..17e79de\n--- /dev/null\n+++ b/requirements/dev.txt\n@@ -0,0 +1 @@\n+-e ".[test]"\n\\ No newline at end of file\ndiff --git a/requirements/plone-5.2.txt b/requirements/plone-5.2.txt\nnew file mode 100644\nindex 0000000..cd1dfbb\n--- /dev/null\n+++ b/requirements/plone-5.2.txt\n@@ -0,0 +1,4 @@\n+-c https://dist.plone.org/release/5.2.6/constraints.txt\n+wheel\n+Plone\n+Paste\n\\ No newline at end of file\ndiff --git a/requirements/plone-6.0.txt b/requirements/plone-6.0.txt\nnew file mode 100644\nindex 0000000..e073f36\n--- /dev/null\n+++ b/requirements/plone-6.0.txt\n@@ -0,0 +1,3 @@\n+-c https://dist.plone.org/release/6.0.0a1/constraints.txt\n+wheel\n+Plone\n\\ No newline at end of file\ndiff --git a/requirements/prod.txt b/requirements/prod.txt\nnew file mode 100644\nindex 0000000..9c558e3\n--- /dev/null\n+++ b/requirements/prod.txt\n@@ -0,0 +1 @@\n+.\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-28T17:13:23+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/aa3e93e71ae5d8414f0b8d8e34a08a7563fd6816

Update Changelog.

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex feefcae..4c17cc9 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -4,8 +4,10 @@ Changelog\n 3.1.0a4 (unreleased)\n --------------------\n \n-- Nothing changed yet.\n+Internal:\n \n+- Initial support and tests using Github Actions for Plone with pip installations.\n+  [ericof]\n \n 3.1.0a3 (2021-10-25)\n --------------------\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-28T17:29:44+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/f13cb65ad6028a1147e2206509c9b4198fb79cd3

Remove unused .cache/plone

Files changed:
M .github/workflows/tests.yml

b"diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex d809521..839ca4a 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -29,7 +29,6 @@ jobs:\n         with:\n           path: |\n             ~/.cache/pip\n-            ~/.cache/plone\n           key: ${{ runner.os }}-pip-${{ matrix.python-version }}-${{ matrix.plone-version }}-${{ hashFiles('requirements/dev.txt') }}\n           restore-keys: |\n             ${{ runner.os }}-pip-${{ matrix.python-version }}-\n@@ -43,7 +42,7 @@ jobs:\n       # Plone install\n       - name: Install Plone\n         run: |\n-          ./bin/pip install Plone -c https://dist.plone.org/release/${{ matrix.plone-version }}/constraints.txt  --use-deprecated legacy-resolver -f ~/.cache/plone\n+          ./bin/pip install Plone -c https://dist.plone.org/release/${{ matrix.plone-version }}/constraints.txt  --use-deprecated legacy-resolver\n \n       # Install plone.volto with test extras\n       - name: Install plone.volto\n"

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-28T17:33:22+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/2281b9cb3d8c569439a9a979c87b327dd714d365

We do not need to hash requirements/dev.txt

Files changed:
M .github/workflows/tests.yml

b"diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex 839ca4a..ba7d6c2 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -29,7 +29,7 @@ jobs:\n         with:\n           path: |\n             ~/.cache/pip\n-          key: ${{ runner.os }}-pip-${{ matrix.python-version }}-${{ matrix.plone-version }}-${{ hashFiles('requirements/dev.txt') }}\n+          key: ${{ runner.os }}-pip-${{ matrix.python-version }}-${{ matrix.plone-version }}\n           restore-keys: |\n             ${{ runner.os }}-pip-${{ matrix.python-version }}-\n \n"

Repository: plone.volto


Branch: refs/heads/main
Date: 2021-10-29T11:34:18+02:00
Author: Érico Andrei (ericof) <ericof@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/295c924076777ed414c35fc0b40ab26f50cbe991

Merge pull request #18 from plone/plone-pip

Setup tests with Plone installed with Pip

Files changed:
A requirements/dev.txt
A requirements/plone-5.2.txt
A requirements/plone-6.0.txt
A requirements/prod.txt
M .github/workflows/tests.yml
M CHANGES.rst

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex b6c8957..ba7d6c2 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -6,8 +6,11 @@ jobs:\n     strategy:\n       fail-fast: false\n       matrix:\n-        python-version: [3.8]\n-        plone-version: ["6.0", "5.2"]\n+        python-version: [3.7, 3.8, 3.9]\n+        plone-version: ["6.0.0a1", "5.2.6"]\n+        exclude:\n+          - plone-version: "5.2.6"\n+            python-version: 3.9\n \n     steps:\n       # git checkout\n@@ -20,26 +23,33 @@ jobs:\n           python-version: ${{ matrix.python-version }}\n \n       # python cache\n-      - uses: actions/cache@v1\n+      - name: Setup cache\n+        id: cache\n+        uses: actions/cache@v2\n         with:\n-          path: ~/.cache/pip\n-          key: ${{ runner.os }}-pip-${{ hashFiles(\'**/requirements.txt\') }}\n+          path: |\n+            ~/.cache/pip\n+          key: ${{ runner.os }}-pip-${{ matrix.python-version }}-${{ matrix.plone-version }}\n           restore-keys: |\n-            ${{ runner.os }}-pip-\n+            ${{ runner.os }}-pip-${{ matrix.python-version }}-\n \n       # python install\n-      - run: pip install virtualenv\n-      - run: pip install wheel\n-      - name: pip install\n-        run: pip install -r requirements.txt\n+      - name: Create virtual environment\n+        run: |\n+          python -m venv .\n+          ./bin/pip install -U pip setuptools wheel\n \n-      - name: debug\n-        run: echo ${{ matrix.plone-version }}\n+      # Plone install\n+      - name: Install Plone\n+        run: |\n+          ./bin/pip install Plone -c https://dist.plone.org/release/${{ matrix.plone-version }}/constraints.txt  --use-deprecated legacy-resolver\n \n-      # buildout\n-      - name: buildout\n-        run: buildout -t 10 -c plone-${{ matrix.plone-version }}.x.cfg\n+      # Install plone.volto with test extras\n+      - name: Install plone.volto\n+        run: |\n+          ./bin/pip install ".[test]" --use-deprecated legacy-resolver\n \n       # test\n       - name: test\n-        run: bin/test\n+        run: |\n+          ./bin/zope-testrunner --auto-color --auto-progress --test-path src\ndiff --git a/CHANGES.rst b/CHANGES.rst\nindex feefcae..4c17cc9 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -4,8 +4,10 @@ Changelog\n 3.1.0a4 (unreleased)\n --------------------\n \n-- Nothing changed yet.\n+Internal:\n \n+- Initial support and tests using Github Actions for Plone with pip installations.\n+  [ericof]\n \n 3.1.0a3 (2021-10-25)\n --------------------\ndiff --git a/requirements/dev.txt b/requirements/dev.txt\nnew file mode 100644\nindex 0000000..17e79de\n--- /dev/null\n+++ b/requirements/dev.txt\n@@ -0,0 +1 @@\n+-e ".[test]"\n\\ No newline at end of file\ndiff --git a/requirements/plone-5.2.txt b/requirements/plone-5.2.txt\nnew file mode 100644\nindex 0000000..cd1dfbb\n--- /dev/null\n+++ b/requirements/plone-5.2.txt\n@@ -0,0 +1,4 @@\n+-c https://dist.plone.org/release/5.2.6/constraints.txt\n+wheel\n+Plone\n+Paste\n\\ No newline at end of file\ndiff --git a/requirements/plone-6.0.txt b/requirements/plone-6.0.txt\nnew file mode 100644\nindex 0000000..e073f36\n--- /dev/null\n+++ b/requirements/plone-6.0.txt\n@@ -0,0 +1,3 @@\n+-c https://dist.plone.org/release/6.0.0a1/constraints.txt\n+wheel\n+Plone\n\\ No newline at end of file\ndiff --git a/requirements/prod.txt b/requirements/prod.txt\nnew file mode 100644\nindex 0000000..9c558e3\n--- /dev/null\n+++ b/requirements/prod.txt\n@@ -0,0 +1 @@\n+.\n'

