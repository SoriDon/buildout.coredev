Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2019-05-23T20:39:11+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/70b02dc669749e0766b3840b5e9584d29ae0fcc7

fix issues during migration form Plone 4.3 to 5.2

Files changed:
M Products/CMFQuickInstallerTool/QuickInstallerTool.py

b"diff --git a/Products/CMFQuickInstallerTool/QuickInstallerTool.py b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\nindex a2c51fe..2275f55 100644\n--- a/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n+++ b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n@@ -475,9 +475,12 @@ def snapshotPortal(self, portal):\n         state['utilities'] = tuple(getSiteManager().registeredUtilities())\n \n         jstool = getToolByName(portal, 'portal_javascripts', None)\n-        state['resources_js'] = jstool and jstool.getResourceIds() or []\n         csstool = getToolByName(portal, 'portal_css', None)\n-        state['resources_css'] = csstool and csstool.getResourceIds() or []\n+        try:\n+            state['resources_js'] = jstool and jstool.getResourceIds() or []\n+            state['resources_css'] = csstool and csstool.getResourceIds() or []\n+        except AttributeError:\n+            pass\n         return state\n \n     @security.protected(ManagePortal)\n@@ -528,7 +531,7 @@ def deriveSettingsFromSnapshots(self, before, after):\n         )\n \n         jstool = getToolByName(self, 'portal_javascripts', None)\n-        if jstool is not None:\n+        if jstool is not None and 'resources_js' in after:\n             settings['resources_js'] = [\n                 r for r in after['resources_js']\n                 if r not in before['resources_js']\n"

Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2019-06-13T12:54:04+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/2372c4f951a2570a76a9666accf9d4a51e7db2e7

add changenote

Files changed:
A news/22.bugfix

b'diff --git a/news/22.bugfix b/news/22.bugfix\nnew file mode 100644\nindex 0000000..5d3b0d8\n--- /dev/null\n+++ b/news/22.bugfix\n@@ -0,0 +1,2 @@\n+Fix issues during migration form Plone 4.3 to 5.2.\n+[pbauer]\n\\ No newline at end of file\n'

Repository: Products.CMFQuickInstallerTool


Branch: refs/heads/master
Date: 2019-06-15T17:23:17+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFQuickInstallerTool/commit/5a7fa561b93bd3b59526b88c1b8ae805806f8f02

Merge pull request #22 from plone/fix_upgrade_from_plone4

fix issues during migration form Plone 4.3 to 5.2

Files changed:
A news/22.bugfix
M Products/CMFQuickInstallerTool/QuickInstallerTool.py

b"diff --git a/Products/CMFQuickInstallerTool/QuickInstallerTool.py b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\nindex a2c51fe..2275f55 100644\n--- a/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n+++ b/Products/CMFQuickInstallerTool/QuickInstallerTool.py\n@@ -475,9 +475,12 @@ def snapshotPortal(self, portal):\n         state['utilities'] = tuple(getSiteManager().registeredUtilities())\n \n         jstool = getToolByName(portal, 'portal_javascripts', None)\n-        state['resources_js'] = jstool and jstool.getResourceIds() or []\n         csstool = getToolByName(portal, 'portal_css', None)\n-        state['resources_css'] = csstool and csstool.getResourceIds() or []\n+        try:\n+            state['resources_js'] = jstool and jstool.getResourceIds() or []\n+            state['resources_css'] = csstool and csstool.getResourceIds() or []\n+        except AttributeError:\n+            pass\n         return state\n \n     @security.protected(ManagePortal)\n@@ -528,7 +531,7 @@ def deriveSettingsFromSnapshots(self, before, after):\n         )\n \n         jstool = getToolByName(self, 'portal_javascripts', None)\n-        if jstool is not None:\n+        if jstool is not None and 'resources_js' in after:\n             settings['resources_js'] = [\n                 r for r in after['resources_js']\n                 if r not in before['resources_js']\ndiff --git a/news/22.bugfix b/news/22.bugfix\nnew file mode 100644\nindex 0000000..5d3b0d8\n--- /dev/null\n+++ b/news/22.bugfix\n@@ -0,0 +1,2 @@\n+Fix issues during migration form Plone 4.3 to 5.2.\n+[pbauer]\n\\ No newline at end of file\n"

