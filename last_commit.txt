Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-03T08:50:45+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/ce0a47f848ad869fc141685db9c97f27c5b7acb0

set portal title in registry when creating a new Plone site

Files changed:
M Products/CMFPlone/factory.py

b'diff --git a/Products/CMFPlone/factory.py b/Products/CMFPlone/factory.py\nindex 6249a3bf43..550784c1a0 100644\n--- a/Products/CMFPlone/factory.py\n+++ b/Products/CMFPlone/factory.py\n@@ -149,6 +149,7 @@ def addPloneSite(context, site_id, title=\'Plone site\', description=\'\',\n         reg[\'plone.available_timezones\'] = [portal_timezone]\n         reg[\'plone.default_language\'] = default_language\n         reg[\'plone.available_languages\'] = [default_language]\n+        reg[\'plone.site_title\'] = title\n \n         # Install default content types profile if user do not select "example content"\n         # during site creation.\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-03T08:51:11+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/97f3bfa54b50804f6e7b3e6b047ee1b5f1bb5bf2

changelog

Files changed:
A news/3584.bugfix

b'diff --git a/news/3584.bugfix b/news/3584.bugfix\nnew file mode 100644\nindex 0000000000..b83dbc1f59\n--- /dev/null\n+++ b/news/3584.bugfix\n@@ -0,0 +1,2 @@\n+Set portal title in registry when creating a new Plone site\n+[erral]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-03T08:59:27+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/2ccd00b2caecd5ec30e85c1a0d9aab97444befb3

test

Files changed:
M Products/CMFPlone/tests/test_factory.py

b'diff --git a/Products/CMFPlone/tests/test_factory.py b/Products/CMFPlone/tests/test_factory.py\nindex e542972258..a797e54ad0 100644\n--- a/Products/CMFPlone/tests/test_factory.py\n+++ b/Products/CMFPlone/tests/test_factory.py\n@@ -3,6 +3,8 @@\n from Products.CMFPlone.utils import get_installer\n from Products.CMFPlone.testing import PRODUCTS_CMFPLONE_INTEGRATION_TESTING\n from zope.component import queryUtility\n+from zope.component import getUtility\n+from plone.registry.interfaces import IRegistry\n \n import unittest\n \n@@ -53,3 +55,10 @@ def test_site_creation_without_content_but_with_content_types(self):\n         # Folder\n         fti = queryUtility(IDexterityFTI, name=\'Folder\')\n         self.assertIsNotNone(fti)\n+\n+    def test_site_creation_title_is_set_in_registry(self):\n+        """ Plone site title should be stored in registry """\n+        ploneSite = addPloneSite(\n+            self.app, \'ploneFoo\', title=\'Foo\', setup_content=False)\n+        registry = getUtility(IRegistry, context=ploneSite)\n+        self.assertEqual(registry[\'plone.site_title\'], \'Foo\')\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-08-05T14:24:42+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/71ac03c1217b80e0b805f10d72626f1cb730a37d

Merge pull request #3585 from plone/erral-issue-3584

Set portal title in registry when creating a new Plone Site

Files changed:
A news/3584.bugfix
M Products/CMFPlone/factory.py
M Products/CMFPlone/tests/test_factory.py

b'diff --git a/Products/CMFPlone/factory.py b/Products/CMFPlone/factory.py\nindex 6249a3bf43..550784c1a0 100644\n--- a/Products/CMFPlone/factory.py\n+++ b/Products/CMFPlone/factory.py\n@@ -149,6 +149,7 @@ def addPloneSite(context, site_id, title=\'Plone site\', description=\'\',\n         reg[\'plone.available_timezones\'] = [portal_timezone]\n         reg[\'plone.default_language\'] = default_language\n         reg[\'plone.available_languages\'] = [default_language]\n+        reg[\'plone.site_title\'] = title\n \n         # Install default content types profile if user do not select "example content"\n         # during site creation.\ndiff --git a/Products/CMFPlone/tests/test_factory.py b/Products/CMFPlone/tests/test_factory.py\nindex e542972258..a797e54ad0 100644\n--- a/Products/CMFPlone/tests/test_factory.py\n+++ b/Products/CMFPlone/tests/test_factory.py\n@@ -3,6 +3,8 @@\n from Products.CMFPlone.utils import get_installer\n from Products.CMFPlone.testing import PRODUCTS_CMFPLONE_INTEGRATION_TESTING\n from zope.component import queryUtility\n+from zope.component import getUtility\n+from plone.registry.interfaces import IRegistry\n \n import unittest\n \n@@ -53,3 +55,10 @@ def test_site_creation_without_content_but_with_content_types(self):\n         # Folder\n         fti = queryUtility(IDexterityFTI, name=\'Folder\')\n         self.assertIsNotNone(fti)\n+\n+    def test_site_creation_title_is_set_in_registry(self):\n+        """ Plone site title should be stored in registry """\n+        ploneSite = addPloneSite(\n+            self.app, \'ploneFoo\', title=\'Foo\', setup_content=False)\n+        registry = getUtility(IRegistry, context=ploneSite)\n+        self.assertEqual(registry[\'plone.site_title\'], \'Foo\')\ndiff --git a/news/3584.bugfix b/news/3584.bugfix\nnew file mode 100644\nindex 0000000000..b83dbc1f59\n--- /dev/null\n+++ b/news/3584.bugfix\n@@ -0,0 +1,2 @@\n+Set portal title in registry when creating a new Plone site\n+[erral]\n'

