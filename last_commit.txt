Repository: plone.namedfile


Branch: refs/heads/master
Date: 2017-06-26T18:11:34+02:00
Author: Mauro Amico (mamico) <mauro.amico@gmail.com>
Commit: https://github.com/plone/plone.namedfile/commit/ef80ca0865b00942d39bb803bb3403bb13af3f18

different caching keys for different domains

Files changed:
M CHANGES.rst
M plone/namedfile/scaling.py

diff --git a/CHANGES.rst b/CHANGES.rst
index be4f708..1854889 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -17,6 +17,9 @@ Bug fixes:
 - Dont't break DefaultImageScalingFactory, if for any reason the fieldname isn't available on the context.
   [thet]
 
+- Different caching keys for different domains
+  [mamico]
+
 
 4.2.1 (2017-05-30)
 ------------------
diff --git a/plone/namedfile/scaling.py b/plone/namedfile/scaling.py
index 18c2423..53891ec 100644
--- a/plone/namedfile/scaling.py
+++ b/plone/namedfile/scaling.py
@@ -492,7 +492,7 @@ def tag(
 
 class NavigationRootScaling(ImageScaling):
     def _scale_cachekey(method, self, brain, fieldname, **kwargs):
-        return (brain.UID, brain.modified, fieldname, kwargs)
+        return (self.context.absolute_url(), brain.UID, brain.modified, fieldname, kwargs)
 
     @ram.cache(_scale_cachekey)
     def tag(self,


Repository: plone.namedfile


Branch: refs/heads/master
Date: 2017-06-27T14:03:18+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.namedfile/commit/640c265223e613405244fd7bec205d9a4cc29366

Merge pull request #54 from mamico/absolute_url

different caching keys for different domains

Files changed:
M CHANGES.rst
M plone/namedfile/scaling.py

diff --git a/CHANGES.rst b/CHANGES.rst
index be4f708..1854889 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -17,6 +17,9 @@ Bug fixes:
 - Dont't break DefaultImageScalingFactory, if for any reason the fieldname isn't available on the context.
   [thet]
 
+- Different caching keys for different domains
+  [mamico]
+
 
 4.2.1 (2017-05-30)
 ------------------
diff --git a/plone/namedfile/scaling.py b/plone/namedfile/scaling.py
index 18c2423..53891ec 100644
--- a/plone/namedfile/scaling.py
+++ b/plone/namedfile/scaling.py
@@ -492,7 +492,7 @@ def tag(
 
 class NavigationRootScaling(ImageScaling):
     def _scale_cachekey(method, self, brain, fieldname, **kwargs):
-        return (brain.UID, brain.modified, fieldname, kwargs)
+        return (self.context.absolute_url(), brain.UID, brain.modified, fieldname, kwargs)
 
     @ram.cache(_scale_cachekey)
     def tag(self,


