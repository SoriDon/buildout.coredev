Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-07-27T22:32:10+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/e31d6d4ba3e953e19249f9da214c8e9586c3bb77

Test fix: wait until the folder contents items are loaded.

With plone.app.content 4.0.0a3 this takes slightly longer because we call the safe html transform.

Files changed:
M Products/CMFPlone/tests/robot/test_folder_contents.robot
M Products/CMFPlone/tests/robot/test_linkintegrity.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex 960b9dc068..6e3275a58b 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -59,7 +59,8 @@ I click the \'${link_name}\' link\n     Click Link  ${link_name}\n \n I select all the elements\n-    Element should be visible  css=.pat-structure .select-all\n+    Wait until page contains element  css=.pat-structure .select-all\n+    Wait until page contains element  css=.itemRow\n     Click Element  css=.pat-structure .select-all\n \n the four elements got selected\ndiff --git a/Products/CMFPlone/tests/robot/test_linkintegrity.robot b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\nindex 348211668b..03d386a767 100644\n--- a/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n+++ b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n@@ -101,6 +101,8 @@ should show warning when deleting page\n should show warning when deleting page from folder_contents\n   Go To  ${PLONE_URL}/folder_contents\n   Wait until keyword succeeds  30  1  Page should contain element  css=tr[data-id="foo"] input\n+  # Might still take a bit before it is clickable.\n+  Sleep  1\n   Click Element  css=tr[data-id="foo"] input\n   Checkbox Should Be Selected  css=tr[data-id="foo"] input\n   Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n@@ -114,6 +116,8 @@ should show warning when deleting page from folder_contents\n should not show warning when deleting page from folder_contents\n   Go To  ${PLONE_URL}/folder_contents\n   Wait until page contains element  css=tr[data-id="foo"] input\n+  # Might still take a bit before it is clickable.\n+  Sleep  1\n   Click Element  css=tr[data-id="foo"] input\n   Checkbox Should Be Selected  css=tr[data-id="foo"] input\n   Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2021-07-28T08:45:32+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/Products.CMFPlone/commit/d833a216e1aa9374dab0a4fcda5a1f8650afa975

Merge pull request #3293 from plone/maurits/test-fix-robot-folder-contents

Test fix: wait until the folder contents items are loaded.

Files changed:
M Products/CMFPlone/tests/robot/test_folder_contents.robot
M Products/CMFPlone/tests/robot/test_linkintegrity.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex 960b9dc068..6e3275a58b 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -59,7 +59,8 @@ I click the \'${link_name}\' link\n     Click Link  ${link_name}\n \n I select all the elements\n-    Element should be visible  css=.pat-structure .select-all\n+    Wait until page contains element  css=.pat-structure .select-all\n+    Wait until page contains element  css=.itemRow\n     Click Element  css=.pat-structure .select-all\n \n the four elements got selected\ndiff --git a/Products/CMFPlone/tests/robot/test_linkintegrity.robot b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\nindex 348211668b..03d386a767 100644\n--- a/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n+++ b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n@@ -101,6 +101,8 @@ should show warning when deleting page\n should show warning when deleting page from folder_contents\n   Go To  ${PLONE_URL}/folder_contents\n   Wait until keyword succeeds  30  1  Page should contain element  css=tr[data-id="foo"] input\n+  # Might still take a bit before it is clickable.\n+  Sleep  1\n   Click Element  css=tr[data-id="foo"] input\n   Checkbox Should Be Selected  css=tr[data-id="foo"] input\n   Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n@@ -114,6 +116,8 @@ should show warning when deleting page from folder_contents\n should not show warning when deleting page from folder_contents\n   Go To  ${PLONE_URL}/folder_contents\n   Wait until page contains element  css=tr[data-id="foo"] input\n+  # Might still take a bit before it is clickable.\n+  Sleep  1\n   Click Element  css=tr[data-id="foo"] input\n   Checkbox Should Be Selected  css=tr[data-id="foo"] input\n   Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n'

