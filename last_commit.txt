Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2016-12-20T10:38:16-06:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/e518fd9d368bc325414d6b0c19254db36d7db1e9

RelatedItemsDataConverter fix
Fix RelatedItemsDataConverter with relation lists, where in an iteration a wrong value was checked to be existent.
Fixes failures in situations, where a ``None`` value was part of the relation list.

Files changed:
M CHANGES.rst
M plone/app/z3cform/converters.py

diff --git a/CHANGES.rst b/CHANGES.rst
index afc4207..573f10a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -16,7 +16,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix RelatedItemsDataConverter with relation lists, where in an iteration a wrong value was checked to be existent.
+  Fixes failures in situations, where a ``None`` value was part of the relation list.
+  [thet]
 
 
 2.1.2 (2016-12-02)
diff --git a/plone/app/z3cform/converters.py b/plone/app/z3cform/converters.py
index 7433782..050ec2a 100644
--- a/plone/app/z3cform/converters.py
+++ b/plone/app/z3cform/converters.py
@@ -228,7 +228,7 @@ def toWidgetValue(self, value):
             return self.field.missing_value
         separator = getattr(self.widget, 'separator', ';')
         if IRelationList.providedBy(self.field):
-            return separator.join([IUUID(o) for o in value if value])
+            return separator.join([IUUID(o) for o in value if o])
         else:
             return separator.join(v for v in value if v)
 


Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2016-12-20T20:43:48+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/a60cac20150d23e69924ade2b9106495977e014e

Merge pull request #55 from plone/thet-relationlistfix

RelatedItemsDataConverter fix

Files changed:
M CHANGES.rst
M plone/app/z3cform/converters.py

diff --git a/CHANGES.rst b/CHANGES.rst
index afc4207..573f10a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -16,7 +16,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix RelatedItemsDataConverter with relation lists, where in an iteration a wrong value was checked to be existent.
+  Fixes failures in situations, where a ``None`` value was part of the relation list.
+  [thet]
 
 
 2.1.2 (2016-12-02)
diff --git a/plone/app/z3cform/converters.py b/plone/app/z3cform/converters.py
index 7433782..050ec2a 100644
--- a/plone/app/z3cform/converters.py
+++ b/plone/app/z3cform/converters.py
@@ -228,7 +228,7 @@ def toWidgetValue(self, value):
             return self.field.missing_value
         separator = getattr(self.widget, 'separator', ';')
         if IRelationList.providedBy(self.field):
-            return separator.join([IUUID(o) for o in value if value])
+            return separator.join([IUUID(o) for o in value if o])
         else:
             return separator.join(v for v in value if v)
 


