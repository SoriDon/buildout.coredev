Repository: plone.app.layout


Branch: refs/heads/master
Date: 2016-03-01T00:23:07+01:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/plone.app.layout/commit/5d1afd0177d97945d609b498f0ed0e18fc0ed352

Fix test isolation problems

Fixes:
https://github.com/plone/plone.app.layout/issues/79

Files changed:
M CHANGES.rst
M plone/app/layout/links/tests/test_canonical_url.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8cdd33d..6faad97 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,11 @@ New:
 
 Fixes:
 
-- *add item here*
+- Fix test isolation problems: if a test calls transaction.commit() directly or
+  indirectly it can not be an integration test, either avoid the commit or
+  change the layer into a functional one.
+  Fixes: https://github.com/plone/plone.app.layout/issues/79
+  [gforcada]
 
 
 2.5.18 (2016-02-11)
diff --git a/plone/app/layout/links/tests/test_canonical_url.py b/plone/app/layout/links/tests/test_canonical_url.py
index eb3a095..632f35e 100644
--- a/plone/app/layout/links/tests/test_canonical_url.py
+++ b/plone/app/layout/links/tests/test_canonical_url.py
@@ -1,6 +1,6 @@
 # -*- coding: utf-8 -*-
 
-from plone.app.layout.testing import INTEGRATION_TESTING
+from plone.app.layout.testing import FUNCTIONAL_TESTING
 from plone.testing.z2 import Browser
 
 import unittest
@@ -8,7 +8,7 @@
 
 class ViewletTestCase(unittest.TestCase):
 
-    layer = INTEGRATION_TESTING
+    layer = FUNCTIONAL_TESTING
 
     def setUp(self):
         self.portal = self.layer['portal']


Repository: plone.app.layout


Branch: refs/heads/master
Date: 2016-03-01T01:54:10+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/plone.app.layout/commit/205b7d56bfb2f1fc95f713c94bc6603b49ca16d6

Merge pull request #80 from plone/fix-test-isolation-problems

Fix test isolation problems

Files changed:
M CHANGES.rst
M plone/app/layout/links/tests/test_canonical_url.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8cdd33d..6faad97 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,11 @@ New:
 
 Fixes:
 
-- *add item here*
+- Fix test isolation problems: if a test calls transaction.commit() directly or
+  indirectly it can not be an integration test, either avoid the commit or
+  change the layer into a functional one.
+  Fixes: https://github.com/plone/plone.app.layout/issues/79
+  [gforcada]
 
 
 2.5.18 (2016-02-11)
diff --git a/plone/app/layout/links/tests/test_canonical_url.py b/plone/app/layout/links/tests/test_canonical_url.py
index eb3a095..632f35e 100644
--- a/plone/app/layout/links/tests/test_canonical_url.py
+++ b/plone/app/layout/links/tests/test_canonical_url.py
@@ -1,6 +1,6 @@
 # -*- coding: utf-8 -*-
 
-from plone.app.layout.testing import INTEGRATION_TESTING
+from plone.app.layout.testing import FUNCTIONAL_TESTING
 from plone.testing.z2 import Browser
 
 import unittest
@@ -8,7 +8,7 @@
 
 class ViewletTestCase(unittest.TestCase):
 
-    layer = INTEGRATION_TESTING
+    layer = FUNCTIONAL_TESTING
 
     def setUp(self):
         self.portal = self.layer['portal']


