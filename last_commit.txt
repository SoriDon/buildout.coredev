Repository: plone.app.theming


Branch: refs/heads/master
Date: 2016-02-26T20:58:23+01:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/plone.app.theming/commit/6d0184e05c14898a256382afc1010831f4d082bc

fix tests to get expected 404 responses

Files changed:
M src/plone/app/theming/tests/test_transform.py

diff --git a/src/plone/app/theming/tests/test_transform.py b/src/plone/app/theming/tests/test_transform.py
index 6562cb5..d0f9607 100644
--- a/src/plone/app/theming/tests/test_transform.py
+++ b/src/plone/app/theming/tests/test_transform.py
@@ -621,6 +621,7 @@ def test_theme_for_404(self):
         transaction.commit()
 
         browser = Browser(app)
+        browser.addHeader('Accept', 'text/html')
         error = None
         try:
             browser.open('{0:s}/404_page'.format(portal.absolute_url()))
@@ -648,6 +649,7 @@ def test_theme_params_on_404(self):
         transaction.commit()
 
         browser = Browser(app)
+        browser.addHeader('Accept', 'text/html')
         error = None
         try:
             browser.open('{0:s}/404_page'.format(portal.absolute_url()))
@@ -696,6 +698,7 @@ def test_navroot_params_on_404_widget_in_path(self):
         transaction.commit()
 
         browser = Browser(app)
+        browser.addHeader('Accept', 'text/html')
         error = None
         try:
             browser.open(


Repository: plone.app.theming


Branch: refs/heads/master
Date: 2016-02-29T11:00:57+01:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/plone.app.theming/commit/64a4e196ab9064cd918cdfdc3c9ddd9e8637490d

Merge pull request #96 from plone/ebr-http-errors

fix tests to get expected 404 responses

Files changed:
M src/plone/app/theming/tests/test_transform.py

diff --git a/src/plone/app/theming/tests/test_transform.py b/src/plone/app/theming/tests/test_transform.py
index 6562cb5..d0f9607 100644
--- a/src/plone/app/theming/tests/test_transform.py
+++ b/src/plone/app/theming/tests/test_transform.py
@@ -621,6 +621,7 @@ def test_theme_for_404(self):
         transaction.commit()
 
         browser = Browser(app)
+        browser.addHeader('Accept', 'text/html')
         error = None
         try:
             browser.open('{0:s}/404_page'.format(portal.absolute_url()))
@@ -648,6 +649,7 @@ def test_theme_params_on_404(self):
         transaction.commit()
 
         browser = Browser(app)
+        browser.addHeader('Accept', 'text/html')
         error = None
         try:
             browser.open('{0:s}/404_page'.format(portal.absolute_url()))
@@ -696,6 +698,7 @@ def test_navroot_params_on_404_widget_in_path(self):
         transaction.commit()
 
         browser = Browser(app)
+        browser.addHeader('Accept', 'text/html')
         error = None
         try:
             browser.open(


