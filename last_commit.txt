Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-10-30T15:50:58-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/c3b85efb89c3af6f46f8ce012b9fbb21643f16be

Fix regression from #3665 (missing content types) (#3667)

Files changed:
M Products/CMFPlone/factory.py

b'diff --git a/Products/CMFPlone/factory.py b/Products/CMFPlone/factory.py\nindex 51b7493ac8..afa1dbb5b6 100644\n--- a/Products/CMFPlone/factory.py\n+++ b/Products/CMFPlone/factory.py\n@@ -154,22 +154,21 @@ def addPloneSite(context, site_id, title=\'Plone site\', description=\'\',\n \n         # Install default content types profile if user do not select "example content"\n         # during site creation.\n-        content_types_profile = (\n-            content_profile_id\n-            if setup_content and content_profile_id\n-            else _TYPES_PROFILE\n-        )\n         if setup_content:\n             if content_profile_id:\n-                content_types_profile = content_profile_id\n+                content_profiles = [content_profile_id]\n             elif "plone.volto:default" in extension_ids:\n-                content_types_profile = "plone.volto:default-homepage"\n+                content_profiles = [\n+                    _TYPES_PROFILE,\n+                    "plone.volto:default-homepage",\n+                ]\n             else:\n-                content_types_profile = _CONTENT_PROFILE\n+                content_profiles = [_CONTENT_PROFILE]\n         else:\n-            content_types_profile = _TYPES_PROFILE\n+            content_profiles = [_TYPES_PROFILE]\n \n-        setup_tool.runAllImportStepsFromProfile(f\'profile-{content_types_profile}\')\n+        for profile_id in content_profiles:\n+            setup_tool.runAllImportStepsFromProfile(f\'profile-{profile_id}\')\n \n         props = dict(\n             title=title,\n'

