Repository: plone.app.widgets


Branch: refs/heads/master
Date: 2022-04-03T15:23:36+02:00
Author: petschki (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.widgets/commit/a7ee5671737f4f2ed64e8d2b9f3929993be8d9f7

fix robot tests

Files changed:
M plone/app/widgets/tests/robot/test_querystring_widget.robot

b'diff --git a/plone/app/widgets/tests/robot/test_querystring_widget.robot b/plone/app/widgets/tests/robot/test_querystring_widget.robot\nindex 0042129c..db0b57e7 100644\n--- a/plone/app/widgets/tests/robot/test_querystring_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_querystring_widget.robot\n@@ -26,23 +26,21 @@ Querystring Widget rows appear and disappear correctly\n         Wait Until Page Does Not Contain Element  css=${querywidget_selector} .querystring-criteria-wrapper:nth-child(2)\n \n \n-*** Comment out until we can figure out what is wrong with this test... ***\n-\n-*** Querystring Widget date criteria master/select behaviour is correct ***\n-***  Given I\'m logged in as a \'Site Administrator\'  ***\n-***    And I create a collection  My Collection ***\n-***   When I select criteria index in row  1  Expiration date ***\n-***        Date criteria operators are functional  1 ***\n-***   When I select criteria index in row  1  Event end date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Effective date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Event start date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Creation date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Modification date ***\n-***       Date criteria operators are functional  1 ***\n+Querystring Widget date criteria master/select behaviour is correct ***\n+  Given I\'m logged in as a \'Site Administrator\'\n+    And I create a collection  My Collection\n+   When I select criteria index in row  1  Expiration date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Event end date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Effective date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Event start date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Creation date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Modification date\n+        Date criteria operators are functional  1\n \n \n Querystring Widget text criteria master/select behaviour is correct\n@@ -66,14 +64,14 @@ Querystring Widget metadata criteria master/select behaviour is correct\n    When I select criteria index in row  1  Short name\n         Operator slave field becomes visible  1  .querystring-criteria-value-StringWidget\n    When I select criteria index in row  1  Creator\n-    And I select criteria operator in row  1  Is\n-        Operator slave field becomes visible  1  .querystring-criteria-value-StringWidget\n-   When I select criteria index in row  1  Location\n-    And I select criteria operator in row  1  Relative path\n-        Operator slave field becomes visible  1  .querystring-criteria-value-RelativePathWidget\n+    And I select criteria operator in row  1  Matches any of\n+        Operator slave field becomes visible  1  .querystring-criteria-value-MultipleSelectionWidget\n    When I select criteria index in row  1  Location\n-    And I select criteria operator in row  1  Absolute path\n         Operator slave field becomes visible  1  .querystring-criteria-value-ReferenceWidget\n+   When I select criteria index in row  1  Location\n+    And I select criteria operator in row  1  Advanced Mode\n+    And I select criteria operator in row  1  Relative Path\n+        Operator slave field becomes visible  1  .querystring-criteria-value-RelativePathWidget\n    When I select criteria index in row  1  Review state\n         Operator slave field becomes visible  1  .querystring-criteria-value-MultipleSelectionWidget\n \n@@ -82,7 +80,7 @@ Collection Creation works\n   Given I\'m logged in as a \'Site Administrator\'\n     And I create a collection  My Collection\n    When I select criteria index in row  1  Location\n-    And I select criteria operator in row  1  Absolute path\n+    And I select criteria operator in row  1  Advanced Mode\n     And I save\n         Wait until page contains Element  jquery=.contenttype-collection:contains(My Collection)\n \n@@ -93,13 +91,17 @@ I select criteria index in row\n   [Arguments]  ${number}  ${label}\n   ${criteria_row} =  Convert to String  ${querywidget_selector} .querystring-criteria-wrapper:nth-child(${number})\n   Click Element  css=${criteria_row} .querystring-criteria-index .select2-container a\n-  Input Text  css=.select2-drop-active .select2-input  text=${label}\n-  Press Key  css=.select2-drop-active .select2-input  \\\\13\n+  Wait until Element is Visible  css=#select2-drop .select2-input\n+  Input Text  css=#select2-drop .select2-input  text=${label}\n+  Press Key  css=#select2-drop .select2-input  \\\\13\n \n I select criteria operator in row\n   [Arguments]  ${number}  ${label}\n-  ${criteria_selector} =  Convert to String  ${querywidget_selector} .querystring-criteria-wrapper:nth-child(${number}) .querystring-criteria-operator select\n-  Select From List By Label  css=${criteria_selector}  ${label}\n+  ${criteria_selector} =  Convert to String  ${querywidget_selector} .querystring-criteria-wrapper:nth-child(${number}) .querystring-criteria-operator .select2-container .select2-choice\n+  Click Link  css=${criteria_selector}\n+  Wait until Element is Visible  css=#select2-drop\n+  Click Element  xpath=//div[@id="select2-drop"]/ul[@class="select2-results"]//*[contains(text(), "${label}")]\n+  Wait until Element is not Visible  css=#select2-drop\n \n Operator slave field becomes visible\n   [Arguments]  ${number}  ${selector}\n'

Repository: plone.app.widgets


Branch: refs/heads/master
Date: 2022-04-03T15:24:12+02:00
Author: petschki (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.widgets/commit/2f05428667479026cff7c02ee847f439594e9d29

changelog

Files changed:
A news/214.bugfix

b'diff --git a/news/214.bugfix b/news/214.bugfix\nnew file mode 100644\nindex 00000000..15d0c572\n--- /dev/null\n+++ b/news/214.bugfix\n@@ -0,0 +1,2 @@\n+fix robot tests\n+[petschki]\n'

Repository: plone.app.widgets


Branch: refs/heads/master
Date: 2022-04-04T09:40:52+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.widgets/commit/acc92f2509efeba87db512177f7f00e8ca04739a

Merge pull request #214 from plone/robottest-fixes

fix robot tests

Files changed:
A news/214.bugfix
M plone/app/widgets/tests/robot/test_querystring_widget.robot

b'diff --git a/news/214.bugfix b/news/214.bugfix\nnew file mode 100644\nindex 00000000..15d0c572\n--- /dev/null\n+++ b/news/214.bugfix\n@@ -0,0 +1,2 @@\n+fix robot tests\n+[petschki]\ndiff --git a/plone/app/widgets/tests/robot/test_querystring_widget.robot b/plone/app/widgets/tests/robot/test_querystring_widget.robot\nindex 0042129c..db0b57e7 100644\n--- a/plone/app/widgets/tests/robot/test_querystring_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_querystring_widget.robot\n@@ -26,23 +26,21 @@ Querystring Widget rows appear and disappear correctly\n         Wait Until Page Does Not Contain Element  css=${querywidget_selector} .querystring-criteria-wrapper:nth-child(2)\n \n \n-*** Comment out until we can figure out what is wrong with this test... ***\n-\n-*** Querystring Widget date criteria master/select behaviour is correct ***\n-***  Given I\'m logged in as a \'Site Administrator\'  ***\n-***    And I create a collection  My Collection ***\n-***   When I select criteria index in row  1  Expiration date ***\n-***        Date criteria operators are functional  1 ***\n-***   When I select criteria index in row  1  Event end date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Effective date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Event start date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Creation date ***\n-***       Date criteria operators are functional  1 ***\n-***  When I select criteria index in row  1  Modification date ***\n-***       Date criteria operators are functional  1 ***\n+Querystring Widget date criteria master/select behaviour is correct ***\n+  Given I\'m logged in as a \'Site Administrator\'\n+    And I create a collection  My Collection\n+   When I select criteria index in row  1  Expiration date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Event end date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Effective date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Event start date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Creation date\n+        Date criteria operators are functional  1\n+   When I select criteria index in row  1  Modification date\n+        Date criteria operators are functional  1\n \n \n Querystring Widget text criteria master/select behaviour is correct\n@@ -66,14 +64,14 @@ Querystring Widget metadata criteria master/select behaviour is correct\n    When I select criteria index in row  1  Short name\n         Operator slave field becomes visible  1  .querystring-criteria-value-StringWidget\n    When I select criteria index in row  1  Creator\n-    And I select criteria operator in row  1  Is\n-        Operator slave field becomes visible  1  .querystring-criteria-value-StringWidget\n-   When I select criteria index in row  1  Location\n-    And I select criteria operator in row  1  Relative path\n-        Operator slave field becomes visible  1  .querystring-criteria-value-RelativePathWidget\n+    And I select criteria operator in row  1  Matches any of\n+        Operator slave field becomes visible  1  .querystring-criteria-value-MultipleSelectionWidget\n    When I select criteria index in row  1  Location\n-    And I select criteria operator in row  1  Absolute path\n         Operator slave field becomes visible  1  .querystring-criteria-value-ReferenceWidget\n+   When I select criteria index in row  1  Location\n+    And I select criteria operator in row  1  Advanced Mode\n+    And I select criteria operator in row  1  Relative Path\n+        Operator slave field becomes visible  1  .querystring-criteria-value-RelativePathWidget\n    When I select criteria index in row  1  Review state\n         Operator slave field becomes visible  1  .querystring-criteria-value-MultipleSelectionWidget\n \n@@ -82,7 +80,7 @@ Collection Creation works\n   Given I\'m logged in as a \'Site Administrator\'\n     And I create a collection  My Collection\n    When I select criteria index in row  1  Location\n-    And I select criteria operator in row  1  Absolute path\n+    And I select criteria operator in row  1  Advanced Mode\n     And I save\n         Wait until page contains Element  jquery=.contenttype-collection:contains(My Collection)\n \n@@ -93,13 +91,17 @@ I select criteria index in row\n   [Arguments]  ${number}  ${label}\n   ${criteria_row} =  Convert to String  ${querywidget_selector} .querystring-criteria-wrapper:nth-child(${number})\n   Click Element  css=${criteria_row} .querystring-criteria-index .select2-container a\n-  Input Text  css=.select2-drop-active .select2-input  text=${label}\n-  Press Key  css=.select2-drop-active .select2-input  \\\\13\n+  Wait until Element is Visible  css=#select2-drop .select2-input\n+  Input Text  css=#select2-drop .select2-input  text=${label}\n+  Press Key  css=#select2-drop .select2-input  \\\\13\n \n I select criteria operator in row\n   [Arguments]  ${number}  ${label}\n-  ${criteria_selector} =  Convert to String  ${querywidget_selector} .querystring-criteria-wrapper:nth-child(${number}) .querystring-criteria-operator select\n-  Select From List By Label  css=${criteria_selector}  ${label}\n+  ${criteria_selector} =  Convert to String  ${querywidget_selector} .querystring-criteria-wrapper:nth-child(${number}) .querystring-criteria-operator .select2-container .select2-choice\n+  Click Link  css=${criteria_selector}\n+  Wait until Element is Visible  css=#select2-drop\n+  Click Element  xpath=//div[@id="select2-drop"]/ul[@class="select2-results"]//*[contains(text(), "${label}")]\n+  Wait until Element is not Visible  css=#select2-drop\n \n Operator slave field becomes visible\n   [Arguments]  ${number}  ${selector}\n'

