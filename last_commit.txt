Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2023-09-22T15:22:59+02:00
Author: Mauro Amico (mamico) <mauro.amico@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/98bbf8deecdb210096bd2d9f6f13db0d97fcf522

fix: avoid searching all users when many_users is flagged

Files changed:
M Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py

b'diff --git a/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py b/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\nindex 27b817a144..d4216be172 100644\n--- a/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\n+++ b/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\n@@ -53,7 +53,6 @@ def update(self):\n             search = form.get("form.button.Search", None) is not None\n             edit = form.get("form.button.Edit", None) is not None and toDelete\n             add = form.get("form.button.Add", None) is not None and toAdd\n-            isBatched = form.get("b_start", None) is not None\n             findAll = (\n                 form.get("form.button.FindAll", None) is not None\n                 and not self.many_users\n@@ -64,7 +63,7 @@ def update(self):\n             if findAll or unbatchedAll or edit or add:\n                 form["searchstring"] = ""\n             self.searchString = form.get("searchstring", "")\n-            if findAll or isBatched or unbatchedAll or bool(self.searchString):\n+            if findAll or bool(self.searchString):\n                 self.searchResults = self.getPotentialMembers(self.searchString)\n \n             if search or findAll:\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2023-09-22T17:00:17+02:00
Author: Mauro Amico (mamico) <mauro.amico@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/f3096371d80c3ca8a5829c12976bd0ab2d2c08a4

fix tests

Files changed:
M Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py

b'diff --git a/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py b/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\nindex d4216be172..a8f19fa26f 100644\n--- a/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\n+++ b/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\n@@ -63,7 +63,7 @@ def update(self):\n             if findAll or unbatchedAll or edit or add:\n                 form["searchstring"] = ""\n             self.searchString = form.get("searchstring", "")\n-            if findAll or bool(self.searchString):\n+            if not (self.many_users) or bool(self.searchString):\n                 self.searchResults = self.getPotentialMembers(self.searchString)\n \n             if search or findAll:\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2023-09-25T14:53:31+02:00
Author: Mauro Amico (mamico) <mauro.amico@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/53d55beb99433088b5af2cd27e886ade024051ea

chhangelog

Files changed:
A news/3845.bugfix

b'diff --git a/news/3845.bugfix b/news/3845.bugfix\nnew file mode 100644\nindex 0000000000..36023919e3\n--- /dev/null\n+++ b/news/3845.bugfix\n@@ -0,0 +1 @@\n+avoid searching all users after group editing, when many_users is flagged @mamico\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2023-10-04T14:55:35+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/0577f0c557ecf9d50b6ccb9f6d2aac511fdf5292

Merge pull request #3845 from plone/many_users

fix: avoid searching all users when many_users is flagged

Files changed:
A news/3845.bugfix
M Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py

b'diff --git a/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py b/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\nindex 27b817a144..a8f19fa26f 100644\n--- a/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\n+++ b/Products/CMFPlone/controlpanel/browser/usergroups_groupmembership.py\n@@ -53,7 +53,6 @@ def update(self):\n             search = form.get("form.button.Search", None) is not None\n             edit = form.get("form.button.Edit", None) is not None and toDelete\n             add = form.get("form.button.Add", None) is not None and toAdd\n-            isBatched = form.get("b_start", None) is not None\n             findAll = (\n                 form.get("form.button.FindAll", None) is not None\n                 and not self.many_users\n@@ -64,7 +63,7 @@ def update(self):\n             if findAll or unbatchedAll or edit or add:\n                 form["searchstring"] = ""\n             self.searchString = form.get("searchstring", "")\n-            if findAll or isBatched or unbatchedAll or bool(self.searchString):\n+            if not (self.many_users) or bool(self.searchString):\n                 self.searchResults = self.getPotentialMembers(self.searchString)\n \n             if search or findAll:\ndiff --git a/news/3845.bugfix b/news/3845.bugfix\nnew file mode 100644\nindex 0000000000..36023919e3\n--- /dev/null\n+++ b/news/3845.bugfix\n@@ -0,0 +1 @@\n+avoid searching all users after group editing, when many_users is flagged @mamico\n'

