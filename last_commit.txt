Repository: plone.i18n


Branch: refs/heads/master
Date: 2016-02-03T21:52:30+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.i18n/commit/affeca2fe1ec1154ebd27efc276f35096782db8c

fix test (don't expect role from pac-tests)

Files changed:
M plone/i18n/tests/test_languageutility.py
M plone/i18n/tests/test_negotiation.py

diff --git a/plone/i18n/tests/test_languageutility.py b/plone/i18n/tests/test_languageutility.py
index f1ed6ee..7333c1f 100644
--- a/plone/i18n/tests/test_languageutility.py
+++ b/plone/i18n/tests/test_languageutility.py
@@ -5,6 +5,8 @@
 from zope.component import getUtility
 from Products.CMFPlone.interfaces import ILanguageSchema
 from plone.i18n.interfaces import ILanguageUtility
+from plone.app.testing import setRoles
+from plone.app.testing import TEST_USER_ID
 
 from plone.i18n.tests import base
 
@@ -13,6 +15,7 @@ class TestLanguageTool(base.TestCase):
 
     def afterSetUp(self):
         self.ltool = getToolByName(self.portal, 'portal_languages')
+        setRoles(self.layer['portal'], TEST_USER_ID, ['Contributor'])
         self.settings = getUtility(IRegistry).forInterface(
             ILanguageSchema,
             prefix='plone')
diff --git a/plone/i18n/tests/test_negotiation.py b/plone/i18n/tests/test_negotiation.py
index b130df2..7b89b3a 100644
--- a/plone/i18n/tests/test_negotiation.py
+++ b/plone/i18n/tests/test_negotiation.py
@@ -2,6 +2,8 @@
 
 from plone.app.testing import TEST_USER_PASSWORD
 from plone.app.testing import TEST_USER_NAME
+from plone.app.testing import setRoles
+from plone.app.testing import TEST_USER_ID
 
 from plone.registry.interfaces import IRegistry
 from zope.component import getUtility
@@ -69,6 +71,7 @@ class TestCombinedLanguageNegotiation(LanguageNegotiationTestCase):
 
     def afterSetUp(self):
         LanguageNegotiationTestCase.afterSetUp(self)
+        setRoles(self.layer['portal'], TEST_USER_ID, ['Contributor'])
         # set some allowed languages and make sure we don't use combined
         # language codes
         self.settings.use_combined_language_codes = True
@@ -102,6 +105,7 @@ class TestContentLanguageNegotiation(LanguageNegotiationTestCase):
 
     def afterSetUp(self):
         LanguageNegotiationTestCase.afterSetUp(self)
+        setRoles(self.layer['portal'], TEST_USER_ID, ['Contributor'])
         self.settings.available_languages = ['en', 'nl', 'fr']
         self.settings.use_content_negotiation = 1
         self.settings.display_flags = 0
@@ -177,6 +181,7 @@ class TestCcTLDLanguageNegotiation(LanguageNegotiationTestCase):
 
     def afterSetUp(self):
         LanguageNegotiationTestCase.afterSetUp(self)
+        # setRoles(self.layer['portal'], TEST_USER_ID, ['Contributor'])
         self.settings.available_languages = ['en', 'nl', 'fr']
         self.settings.use_cctld_negotiation = 1
         self.settings.display_flags = 0


