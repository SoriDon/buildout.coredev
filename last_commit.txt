Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-04-30T07:06:31+02:00
Author: Andreas Jung (zopyx) <info@zopyx.com>
Commit: https://github.com/plone/plone.restapi/commit/43d5f61e7c3320de3fad03a6d5850f5c9bb17c7c

Better term lookup error logging (#1366)

* added

* better error logging for Term lookup errors

* blacke-ed

Files changed:
A news/1365.feature
M src/plone/restapi/serializer/dxfields.py

b'diff --git a/news/1365.feature b/news/1365.feature\nnew file mode 100644\nindex 000000000..9724e0544\n--- /dev/null\n+++ b/news/1365.feature\n@@ -0,0 +1,2 @@\n+better error logging for term lookup errors\n+[ajung]\ndiff --git a/src/plone/restapi/serializer/dxfields.py b/src/plone/restapi/serializer/dxfields.py\nindex de04b387e..86eed9adc 100644\n--- a/src/plone/restapi/serializer/dxfields.py\n+++ b/src/plone/restapi/serializer/dxfields.py\n@@ -82,7 +82,15 @@ def __call__(self):\n                     term = value_type.vocabulary.getTerm(v)\n                     values.append({"token": term.token, "title": term.title})\n                 except LookupError:\n-                    log.warning("Term lookup error: %r" % v)\n+                    log.warning(\n+                        "Term lookup error: %r %s (%s:%s)"\n+                        % (\n+                            v,\n+                            self.field.title,\n+                            self.context.portal_type,\n+                            self.context.absolute_url(1),\n+                        )\n+                    )\n             value = values\n         return json_compatible(value)\n \n'

