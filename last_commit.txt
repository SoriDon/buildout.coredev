Repository: mockup


Branch: refs/heads/master
Date: 2022-05-18T00:10:37+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/mockup/commit/2604397277a3048ee77594e29c48b67d1f378df7

maint(Bundle): Also upload a compiled bundle release for GitHub.

Files changed:
M Makefile

b'diff --git a/Makefile b/Makefile\nindex 48bf42664..f7eb7b442 100644\n--- a/Makefile\n+++ b/Makefile\n@@ -46,12 +46,20 @@ bundle: stamp-yarn\n #\thttps://github.com/settings/tokens\n #\tand https://github.com/release-it/release-it/blob/master/docs/github-releases.md#automated\n \n+release-zip: clean-dist bundle\n+\t$(eval PACKAGE_VERSION := $(shell node -p "require(\'./package.json\').version"))\n+\t@echo name is $(PACKAGE_NAME)\n+\t@echo version is $(PACKAGE_VERSION)\n+\tmkdir -p dist/$(PACKAGE_NAME)-bundle-$(PACKAGE_VERSION)\n+\t-mv dist/* dist/$(PACKAGE_NAME)-bundle-$(PACKAGE_VERSION)\n+\tcd dist/ && zip -r $(PACKAGE_NAME)-bundle-$(PACKAGE_VERSION).zip $(PACKAGE_NAME)-bundle-$(PACKAGE_VERSION)/\n \n .PHONY: release-major\n release-major: check\n \tnpx release-it major --dry-run --ci && \\\n \t\tnpx release-it major --ci && \\\n-\t\tnpx release-it --github.release --github.update --no-github.draft --no-increment --no-git --no-npm --ci && \\\n+\t\tmake release-zip && \\\n+\t\tnpx release-it --github.release --github.update --github.assets=dist/*.zip --no-github.draft --no-increment --no-git --no-npm --ci && \\\n \t\tgit checkout CHANGES.md\n \n \n@@ -59,7 +67,8 @@ release-major: check\n release-minor: check\n \tnpx release-it minor --dry-run --ci && \\\n \t\tnpx release-it minor --ci && \\\n-\t\tnpx release-it --github.release --github.update --no-github.draft --no-increment --no-git --no-npm --ci && \\\n+\t\tmake release-zip && \\\n+\t\tnpx release-it --github.release --github.update --github.assets=dist/*.zip --no-github.draft --no-increment --no-git --no-npm --ci && \\\n \t\tgit checkout CHANGES.md\n \n \n@@ -67,7 +76,8 @@ release-minor: check\n release-patch: check\n \tnpx release-it patch --dry-run --ci && \\\n \t\tnpx release-it patch --ci && \\\n-\t\tnpx release-it --github.release --github.update --no-github.draft --no-increment --no-git --no-npm --ci && \\\n+\t\tmake release-zip && \\\n+\t\tnpx release-it --github.release --github.update --github.assets=dist/*.zip --no-github.draft --no-increment --no-git --no-npm --ci && \\\n \t\tgit checkout CHANGES.md\n \n \n@@ -75,7 +85,8 @@ release-patch: check\n prerelease:\n \tnpx release-it patch --dry-run --ci --preRelease=alpha && \\\n \t\tnpx release-it patch --ci --preRelease=alpha && \\\n-\t\tnpx release-it --github.preRelease --github.update --no-github.draft --no-increment --no-git --no-npm --ci && \\\n+\t\tmake release-zip && \\\n+\t\tnpx release-it --github.release --github.update --github.assets=dist/*.zip --no-github.draft --no-increment --no-git --no-npm --ci && \\\n \t\tgit checkout CHANGES.md\n \n \n'

