Repository: plone.base


Branch: refs/heads/main
Date: 2023-04-11T13:26:35+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.base/commit/3fa57152dfeb80a49c0c2528fca08be3cf1e1db6

Configuring with plone/meta

Files changed:
A news/3333c742.internal
M .gitignore
M .meta.toml
M pyproject.toml
M setup.cfg
M src/plone/base/interfaces/__init__.py
M src/plone/base/permissions.py
M tox.ini

b'diff --git a/.gitignore b/.gitignore\nindex e9bb955..9281265 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -1,3 +1,4 @@\n *.egg-info\n __pycache__\n-venv\n\\ No newline at end of file\n+venv\n+.tox\ndiff --git a/.meta.toml b/.meta.toml\nindex 8560e56..dbe0027 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -2,12 +2,7 @@\n # https://github.com/plone/meta/tree/master/config/default\n [meta]\n template = "default"\n-commit-id = "13d8d6c0"\n+commit-id = "3333c742"\n \n [codespell]\n additional-ignores = "ist,discreet"\n-\n-[dependencies]\n-mappings = [\n-    "Zope = [\'Products.Five\', \'Products.PageTemplates\', \'ZTUtils\']",\n-    ]\ndiff --git a/news/3333c742.internal b/news/3333c742.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/3333c742.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 7415149..f573fb5 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -46,4 +46,39 @@ target-version = ["py38"]\n ignore-words-list = "ist,discreet"\n \n [tool.dependencychecker]\n-Zope = [\'Products.Five\', \'Products.PageTemplates\', \'ZTUtils\']\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # Zope dependencies\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\', \'ExtensionClass\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\', \'six\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n+]\n+\'plone.base\' = [\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\'\n+]\n+python-dateutil = [\'dateutil\']\ndiff --git a/setup.cfg b/setup.cfg\nindex 8409376..c444ef0 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -30,26 +30,14 @@ python_requires = >=3.8\n install_requires =\n     setuptools\n     # be aware to _not_ add dependencies to plone.app.* or Plones Products.* packages!\n-    AccessControl\n-    Acquisition\n-    ZODB\n-    Zope>=5\n+    # do not add transitive depndencies covered by CMFCore (which includes Zope)\n+    # see pyproject.toml tool.dependencychecker section for details\n     plone.batching\n     plone.registry\n     plone.schema\n     plone.z3cform\n-    Products.BTreeFolder2\n     Products.CMFCore\n     Products.CMFDynamicViewFTI\n-    transaction\n-    zExceptions\n-    zope.component\n-    zope.deprecation\n-    zope.i18n\n-    zope.i18nmessageid\n-    zope.interface\n-    zope.publisher\n-    zope.schema\n namespace_packages =\n     plone\n \n@@ -61,27 +49,19 @@ zip_safe = False\n [options.extras_require]\n test =\n     plone.subrequest\n-    zope.tal\n+    plone.portlets  # transitive undeclared by plone.protect (over plone.subrequest)\n+                    # remove when https://github.com/plone/plone.protect/pull/99\n+                    # is merged and released\n \n [options.packages.find]\n where =\n     src\n \n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [bdist_wheel]\n universal = 0\n \n-[check-manifest]\n-ignore =\n-  *.cfg\n-  *.json\n-  *.yml\n-  .coveragerc\n-  .editorconfig\n-  .gitattributes\n-  .meta.toml\n-  .pre-commit-config.yaml\n-  tox.ini\n-\n [flake8]\n doctests = 1\n ignore =\n@@ -93,6 +73,10 @@ ignore =\n     E203,\n     # black takes care of spaces after commas\n     E231,\n-per-file-ignores =\n-    src/plone/base/interfaces/__init__.py:F401\n-    src/plone/base/permissions.py:F401,E402\n+\n+[check-manifest]\n+ignore =\n+    .editorconfig\n+    .meta.toml\n+    .pre-commit-config.yaml\n+    tox.ini\ndiff --git a/src/plone/base/interfaces/__init__.py b/src/plone/base/interfaces/__init__.py\nindex 23a2530..6cb90ec 100644\n--- a/src/plone/base/interfaces/__init__.py\n+++ b/src/plone/base/interfaces/__init__.py\n@@ -1,63 +1,63 @@\n-from .basetool import IPloneBaseTool\n-from .basetool import IPloneCatalogTool\n-from .basetool import IPloneTool\n-from .breadcrumbs import IHideFromBreadcrumbs\n-from .constrains import IConstrainTypes\n-from .constrains import ISelectableConstrainTypes\n-from .controlpanel import IActionSchema\n-from .controlpanel import IControlPanel\n-from .controlpanel import IDateAndTimeSchema\n-from .controlpanel import IEditingSchema\n-from .controlpanel import IFilterSchema\n-from .controlpanel import IImagingSchema\n-from .controlpanel import ILinkSchema\n-from .controlpanel import ILoginSchema\n-from .controlpanel import IMailSchema\n-from .controlpanel import IMaintenanceSchema\n-from .controlpanel import IMarkupSchema\n-from .controlpanel import INavigationSchema\n-from .controlpanel import INewActionSchema\n-from .controlpanel import ISearchSchema\n-from .controlpanel import ISecuritySchema\n-from .controlpanel import ISiteSchema\n-from .controlpanel import ISocialMediaSchema\n-from .controlpanel import ITinyMCEAdvancedSchema\n-from .controlpanel import ITinyMCELayoutSchema\n-from .controlpanel import ITinyMCEPluginSchema\n-from .controlpanel import ITinyMCEResourceTypesSchema\n-from .controlpanel import ITinyMCESchema\n-from .controlpanel import ITinyMCESpellCheckerSchema\n-from .controlpanel import ITypesSchema\n-from .controlpanel import IUserGroupsSettingsSchema\n-from .events import IConfigurationChangedEvent\n-from .events import IReorderedEvent\n-from .events import ISiteManagerCreatedEvent\n-from .images import IImageScalesAdapter\n-from .images import IImageScalesFieldAdapter\n-from .installable import INonInstallable\n-from .interface import IInterfaceTool\n-from .language import ILanguage\n-from .login import IForcePasswordChange\n-from .login import IInitialLogin\n-from .login import ILogin\n-from .login import ILoginForm\n-from .login import ILoginFormSchema\n-from .login import ILoginHelpForm\n-from .login import ILoginHelpFormSchema\n-from .login import IRedirectAfterLogin\n-from .migration import IMigrationTool\n-from .password_reset import IPasswordResetToolView\n-from .password_reset import IPWResetTool\n-from .patterns import IPatternsSettings\n-from .properties import IPropertiesTool\n-from .properties import ISimpleItemWithProperties\n-from .resources import IBundleRegistry\n-from .resources import IResourceRegistry\n-from .siteroot import IMigratingPloneSiteRoot\n-from .siteroot import INavigationRoot\n-from .siteroot import IPloneSiteRoot\n-from .siteroot import ITestCasePloneSiteRoot\n-from .structure import INonStructuralFolder\n-from .syndication import ISiteSyndicationSettings\n-from .translationservice import ITranslationServiceTool\n-from .workflow import IWorkflowChain\n+from .basetool import IPloneBaseTool  # noqa: F401\n+from .basetool import IPloneCatalogTool  # noqa: F401\n+from .basetool import IPloneTool  # noqa: F401\n+from .breadcrumbs import IHideFromBreadcrumbs  # noqa: F401\n+from .constrains import IConstrainTypes  # noqa: F401\n+from .constrains import ISelectableConstrainTypes  # noqa: F401\n+from .controlpanel import IActionSchema  # noqa: F401\n+from .controlpanel import IControlPanel  # noqa: F401\n+from .controlpanel import IDateAndTimeSchema  # noqa: F401\n+from .controlpanel import IEditingSchema  # noqa: F401\n+from .controlpanel import IFilterSchema  # noqa: F401\n+from .controlpanel import IImagingSchema  # noqa: F401\n+from .controlpanel import ILinkSchema  # noqa: F401\n+from .controlpanel import ILoginSchema  # noqa: F401\n+from .controlpanel import IMailSchema  # noqa: F401\n+from .controlpanel import IMaintenanceSchema  # noqa: F401\n+from .controlpanel import IMarkupSchema  # noqa: F401\n+from .controlpanel import INavigationSchema  # noqa: F401\n+from .controlpanel import INewActionSchema  # noqa: F401\n+from .controlpanel import ISearchSchema  # noqa: F401\n+from .controlpanel import ISecuritySchema  # noqa: F401\n+from .controlpanel import ISiteSchema  # noqa: F401\n+from .controlpanel import ISocialMediaSchema  # noqa: F401\n+from .controlpanel import ITinyMCEAdvancedSchema  # noqa: F401\n+from .controlpanel import ITinyMCELayoutSchema  # noqa: F401\n+from .controlpanel import ITinyMCEPluginSchema  # noqa: F401\n+from .controlpanel import ITinyMCEResourceTypesSchema  # noqa: F401\n+from .controlpanel import ITinyMCESchema  # noqa: F401\n+from .controlpanel import ITinyMCESpellCheckerSchema  # noqa: F401\n+from .controlpanel import ITypesSchema  # noqa: F401\n+from .controlpanel import IUserGroupsSettingsSchema  # noqa: F401\n+from .events import IConfigurationChangedEvent  # noqa: F401\n+from .events import IReorderedEvent  # noqa: F401\n+from .events import ISiteManagerCreatedEvent  # noqa: F401\n+from .images import IImageScalesAdapter  # noqa: F401\n+from .images import IImageScalesFieldAdapter  # noqa: F401\n+from .installable import INonInstallable  # noqa: F401\n+from .interface import IInterfaceTool  # noqa: F401\n+from .language import ILanguage  # noqa: F401\n+from .login import IForcePasswordChange  # noqa: F401\n+from .login import IInitialLogin  # noqa: F401\n+from .login import ILogin  # noqa: F401\n+from .login import ILoginForm  # noqa: F401\n+from .login import ILoginFormSchema  # noqa: F401\n+from .login import ILoginHelpForm  # noqa: F401\n+from .login import ILoginHelpFormSchema  # noqa: F401\n+from .login import IRedirectAfterLogin  # noqa: F401\n+from .migration import IMigrationTool  # noqa: F401\n+from .password_reset import IPasswordResetToolView  # noqa: F401\n+from .password_reset import IPWResetTool  # noqa: F401\n+from .patterns import IPatternsSettings  # noqa: F401\n+from .properties import IPropertiesTool  # noqa: F401\n+from .properties import ISimpleItemWithProperties  # noqa: F401\n+from .resources import IBundleRegistry  # noqa: F401\n+from .resources import IResourceRegistry  # noqa: F401\n+from .siteroot import IMigratingPloneSiteRoot  # noqa: F401\n+from .siteroot import INavigationRoot  # noqa: F401\n+from .siteroot import IPloneSiteRoot  # noqa: F401\n+from .siteroot import ITestCasePloneSiteRoot  # noqa: F401\n+from .structure import INonStructuralFolder  # noqa: F401\n+from .syndication import ISiteSyndicationSettings  # noqa: F401\n+from .translationservice import ITranslationServiceTool  # noqa: F401\n+from .workflow import IWorkflowChain  # noqa: F401\ndiff --git a/src/plone/base/permissions.py b/src/plone/base/permissions.py\nindex d00040f..e04f288 100644\n--- a/src/plone/base/permissions.py\n+++ b/src/plone/base/permissions.py\n@@ -1,3 +1,4 @@\n+# flake8: noqa\n """ CMFPlone product permissions """\n from AccessControl import ModuleSecurityInfo\n \ndiff --git a/tox.ini b/tox.ini\nindex c079715..903851b 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,6 +1,8 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n [tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n envlist =\n     format\n     lint\n@@ -37,15 +39,30 @@ deps =\n     graphviz  # optional dependency of pipdeptree\n commands =\n     dependencychecker\n-    sh -c \'pipdeptree --exclude setuptools,pipdeptree,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n \n [testenv:test]\n usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n deps =\n     zope.testrunner\n-    plone.portlets  # undeclared dependency of plone.protect\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n commands =\n-    zope-testrunner --test-path={toxinidir}/src -s plone.base\n+    zope-testrunner --all --test-path={toxinidir}/src -s plone.base {posargs}\n+extras =\n+    test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir}/src -s plone.base {posargs}\n+    coverage report -m --format markdown\n extras =\n     test\n'

Repository: plone.base


Branch: refs/heads/main
Date: 2023-04-13T17:38:23+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.base/commit/d4562955897ea90f2c930ba734d676738395a73a

configure flake8 ignores in setup.cfg (fragile)

Files changed:
M setup.cfg
M src/plone/base/interfaces/__init__.py
M src/plone/base/permissions.py

b'diff --git a/setup.cfg b/setup.cfg\nindex c444ef0..e35fcef 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -73,6 +73,9 @@ ignore =\n     E203,\n     # black takes care of spaces after commas\n     E231,\n+per-file-ignores =\n+    src/plone/base/interfaces/__init__.py:F401\n+    src/plone/base/permissions.py:F401,E402\n \n [check-manifest]\n ignore =\ndiff --git a/src/plone/base/interfaces/__init__.py b/src/plone/base/interfaces/__init__.py\nindex 6cb90ec..23a2530 100644\n--- a/src/plone/base/interfaces/__init__.py\n+++ b/src/plone/base/interfaces/__init__.py\n@@ -1,63 +1,63 @@\n-from .basetool import IPloneBaseTool  # noqa: F401\n-from .basetool import IPloneCatalogTool  # noqa: F401\n-from .basetool import IPloneTool  # noqa: F401\n-from .breadcrumbs import IHideFromBreadcrumbs  # noqa: F401\n-from .constrains import IConstrainTypes  # noqa: F401\n-from .constrains import ISelectableConstrainTypes  # noqa: F401\n-from .controlpanel import IActionSchema  # noqa: F401\n-from .controlpanel import IControlPanel  # noqa: F401\n-from .controlpanel import IDateAndTimeSchema  # noqa: F401\n-from .controlpanel import IEditingSchema  # noqa: F401\n-from .controlpanel import IFilterSchema  # noqa: F401\n-from .controlpanel import IImagingSchema  # noqa: F401\n-from .controlpanel import ILinkSchema  # noqa: F401\n-from .controlpanel import ILoginSchema  # noqa: F401\n-from .controlpanel import IMailSchema  # noqa: F401\n-from .controlpanel import IMaintenanceSchema  # noqa: F401\n-from .controlpanel import IMarkupSchema  # noqa: F401\n-from .controlpanel import INavigationSchema  # noqa: F401\n-from .controlpanel import INewActionSchema  # noqa: F401\n-from .controlpanel import ISearchSchema  # noqa: F401\n-from .controlpanel import ISecuritySchema  # noqa: F401\n-from .controlpanel import ISiteSchema  # noqa: F401\n-from .controlpanel import ISocialMediaSchema  # noqa: F401\n-from .controlpanel import ITinyMCEAdvancedSchema  # noqa: F401\n-from .controlpanel import ITinyMCELayoutSchema  # noqa: F401\n-from .controlpanel import ITinyMCEPluginSchema  # noqa: F401\n-from .controlpanel import ITinyMCEResourceTypesSchema  # noqa: F401\n-from .controlpanel import ITinyMCESchema  # noqa: F401\n-from .controlpanel import ITinyMCESpellCheckerSchema  # noqa: F401\n-from .controlpanel import ITypesSchema  # noqa: F401\n-from .controlpanel import IUserGroupsSettingsSchema  # noqa: F401\n-from .events import IConfigurationChangedEvent  # noqa: F401\n-from .events import IReorderedEvent  # noqa: F401\n-from .events import ISiteManagerCreatedEvent  # noqa: F401\n-from .images import IImageScalesAdapter  # noqa: F401\n-from .images import IImageScalesFieldAdapter  # noqa: F401\n-from .installable import INonInstallable  # noqa: F401\n-from .interface import IInterfaceTool  # noqa: F401\n-from .language import ILanguage  # noqa: F401\n-from .login import IForcePasswordChange  # noqa: F401\n-from .login import IInitialLogin  # noqa: F401\n-from .login import ILogin  # noqa: F401\n-from .login import ILoginForm  # noqa: F401\n-from .login import ILoginFormSchema  # noqa: F401\n-from .login import ILoginHelpForm  # noqa: F401\n-from .login import ILoginHelpFormSchema  # noqa: F401\n-from .login import IRedirectAfterLogin  # noqa: F401\n-from .migration import IMigrationTool  # noqa: F401\n-from .password_reset import IPasswordResetToolView  # noqa: F401\n-from .password_reset import IPWResetTool  # noqa: F401\n-from .patterns import IPatternsSettings  # noqa: F401\n-from .properties import IPropertiesTool  # noqa: F401\n-from .properties import ISimpleItemWithProperties  # noqa: F401\n-from .resources import IBundleRegistry  # noqa: F401\n-from .resources import IResourceRegistry  # noqa: F401\n-from .siteroot import IMigratingPloneSiteRoot  # noqa: F401\n-from .siteroot import INavigationRoot  # noqa: F401\n-from .siteroot import IPloneSiteRoot  # noqa: F401\n-from .siteroot import ITestCasePloneSiteRoot  # noqa: F401\n-from .structure import INonStructuralFolder  # noqa: F401\n-from .syndication import ISiteSyndicationSettings  # noqa: F401\n-from .translationservice import ITranslationServiceTool  # noqa: F401\n-from .workflow import IWorkflowChain  # noqa: F401\n+from .basetool import IPloneBaseTool\n+from .basetool import IPloneCatalogTool\n+from .basetool import IPloneTool\n+from .breadcrumbs import IHideFromBreadcrumbs\n+from .constrains import IConstrainTypes\n+from .constrains import ISelectableConstrainTypes\n+from .controlpanel import IActionSchema\n+from .controlpanel import IControlPanel\n+from .controlpanel import IDateAndTimeSchema\n+from .controlpanel import IEditingSchema\n+from .controlpanel import IFilterSchema\n+from .controlpanel import IImagingSchema\n+from .controlpanel import ILinkSchema\n+from .controlpanel import ILoginSchema\n+from .controlpanel import IMailSchema\n+from .controlpanel import IMaintenanceSchema\n+from .controlpanel import IMarkupSchema\n+from .controlpanel import INavigationSchema\n+from .controlpanel import INewActionSchema\n+from .controlpanel import ISearchSchema\n+from .controlpanel import ISecuritySchema\n+from .controlpanel import ISiteSchema\n+from .controlpanel import ISocialMediaSchema\n+from .controlpanel import ITinyMCEAdvancedSchema\n+from .controlpanel import ITinyMCELayoutSchema\n+from .controlpanel import ITinyMCEPluginSchema\n+from .controlpanel import ITinyMCEResourceTypesSchema\n+from .controlpanel import ITinyMCESchema\n+from .controlpanel import ITinyMCESpellCheckerSchema\n+from .controlpanel import ITypesSchema\n+from .controlpanel import IUserGroupsSettingsSchema\n+from .events import IConfigurationChangedEvent\n+from .events import IReorderedEvent\n+from .events import ISiteManagerCreatedEvent\n+from .images import IImageScalesAdapter\n+from .images import IImageScalesFieldAdapter\n+from .installable import INonInstallable\n+from .interface import IInterfaceTool\n+from .language import ILanguage\n+from .login import IForcePasswordChange\n+from .login import IInitialLogin\n+from .login import ILogin\n+from .login import ILoginForm\n+from .login import ILoginFormSchema\n+from .login import ILoginHelpForm\n+from .login import ILoginHelpFormSchema\n+from .login import IRedirectAfterLogin\n+from .migration import IMigrationTool\n+from .password_reset import IPasswordResetToolView\n+from .password_reset import IPWResetTool\n+from .patterns import IPatternsSettings\n+from .properties import IPropertiesTool\n+from .properties import ISimpleItemWithProperties\n+from .resources import IBundleRegistry\n+from .resources import IResourceRegistry\n+from .siteroot import IMigratingPloneSiteRoot\n+from .siteroot import INavigationRoot\n+from .siteroot import IPloneSiteRoot\n+from .siteroot import ITestCasePloneSiteRoot\n+from .structure import INonStructuralFolder\n+from .syndication import ISiteSyndicationSettings\n+from .translationservice import ITranslationServiceTool\n+from .workflow import IWorkflowChain\ndiff --git a/src/plone/base/permissions.py b/src/plone/base/permissions.py\nindex e04f288..d00040f 100644\n--- a/src/plone/base/permissions.py\n+++ b/src/plone/base/permissions.py\n@@ -1,4 +1,3 @@\n-# flake8: noqa\n """ CMFPlone product permissions """\n from AccessControl import ModuleSecurityInfo\n \n'

Repository: plone.base


Branch: refs/heads/main
Date: 2023-04-15T09:41:34+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.base/commit/08f2a275bf95d9c5764f4e6e57ce37a2720f4ab5

Merge pull request #34 from plone/config-with-default-template-38fe6d57

Configuring with plone/meta

Files changed:
A news/3333c742.internal
M .gitignore
M .meta.toml
M pyproject.toml
M setup.cfg
M tox.ini

b'diff --git a/.gitignore b/.gitignore\nindex e9bb955..9281265 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -1,3 +1,4 @@\n *.egg-info\n __pycache__\n-venv\n\\ No newline at end of file\n+venv\n+.tox\ndiff --git a/.meta.toml b/.meta.toml\nindex 8560e56..dbe0027 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -2,12 +2,7 @@\n # https://github.com/plone/meta/tree/master/config/default\n [meta]\n template = "default"\n-commit-id = "13d8d6c0"\n+commit-id = "3333c742"\n \n [codespell]\n additional-ignores = "ist,discreet"\n-\n-[dependencies]\n-mappings = [\n-    "Zope = [\'Products.Five\', \'Products.PageTemplates\', \'ZTUtils\']",\n-    ]\ndiff --git a/news/3333c742.internal b/news/3333c742.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/3333c742.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 7415149..f573fb5 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -46,4 +46,39 @@ target-version = ["py38"]\n ignore-words-list = "ist,discreet"\n \n [tool.dependencychecker]\n-Zope = [\'Products.Five\', \'Products.PageTemplates\', \'ZTUtils\']\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # Zope dependencies\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\', \'ExtensionClass\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\', \'six\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n+]\n+\'plone.base\' = [\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\'\n+]\n+python-dateutil = [\'dateutil\']\ndiff --git a/setup.cfg b/setup.cfg\nindex 8409376..e35fcef 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -30,26 +30,14 @@ python_requires = >=3.8\n install_requires =\n     setuptools\n     # be aware to _not_ add dependencies to plone.app.* or Plones Products.* packages!\n-    AccessControl\n-    Acquisition\n-    ZODB\n-    Zope>=5\n+    # do not add transitive depndencies covered by CMFCore (which includes Zope)\n+    # see pyproject.toml tool.dependencychecker section for details\n     plone.batching\n     plone.registry\n     plone.schema\n     plone.z3cform\n-    Products.BTreeFolder2\n     Products.CMFCore\n     Products.CMFDynamicViewFTI\n-    transaction\n-    zExceptions\n-    zope.component\n-    zope.deprecation\n-    zope.i18n\n-    zope.i18nmessageid\n-    zope.interface\n-    zope.publisher\n-    zope.schema\n namespace_packages =\n     plone\n \n@@ -61,27 +49,19 @@ zip_safe = False\n [options.extras_require]\n test =\n     plone.subrequest\n-    zope.tal\n+    plone.portlets  # transitive undeclared by plone.protect (over plone.subrequest)\n+                    # remove when https://github.com/plone/plone.protect/pull/99\n+                    # is merged and released\n \n [options.packages.find]\n where =\n     src\n \n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n [bdist_wheel]\n universal = 0\n \n-[check-manifest]\n-ignore =\n-  *.cfg\n-  *.json\n-  *.yml\n-  .coveragerc\n-  .editorconfig\n-  .gitattributes\n-  .meta.toml\n-  .pre-commit-config.yaml\n-  tox.ini\n-\n [flake8]\n doctests = 1\n ignore =\n@@ -96,3 +76,10 @@ ignore =\n per-file-ignores =\n     src/plone/base/interfaces/__init__.py:F401\n     src/plone/base/permissions.py:F401,E402\n+\n+[check-manifest]\n+ignore =\n+    .editorconfig\n+    .meta.toml\n+    .pre-commit-config.yaml\n+    tox.ini\ndiff --git a/tox.ini b/tox.ini\nindex c079715..903851b 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,6 +1,8 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n [tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n envlist =\n     format\n     lint\n@@ -37,15 +39,30 @@ deps =\n     graphviz  # optional dependency of pipdeptree\n commands =\n     dependencychecker\n-    sh -c \'pipdeptree --exclude setuptools,pipdeptree,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n \n [testenv:test]\n usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n deps =\n     zope.testrunner\n-    plone.portlets  # undeclared dependency of plone.protect\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n commands =\n-    zope-testrunner --test-path={toxinidir}/src -s plone.base\n+    zope-testrunner --all --test-path={toxinidir}/src -s plone.base {posargs}\n+extras =\n+    test\n+\n+[testenv:coverage]\n+usedevelop = true\n+constrain_package_deps = true\n+set_env = ROBOT_BROWSER=headlesschrome\n+deps =\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir}/src -s plone.base {posargs}\n+    coverage report -m --format markdown\n extras =\n     test\n'

