Repository: plone.app.content


Branch: refs/heads/master
Date: 2016-02-17T21:10:29+09:00
Author: Manabu TERADA (terapyon) <terada@cmscom.jp>
Commit: https://github.com/plone/plone.app.content/commit/f16726643e9d3b0368b8958b193bdddf2a9a641d

added translation functionality to  folder content panel

Files changed:
M plone/app/content/browser/vocabulary.py

diff --git a/plone/app/content/browser/vocabulary.py b/plone/app/content/browser/vocabulary.py
index 34906f1..db6bff2 100644
--- a/plone/app/content/browser/vocabulary.py
+++ b/plone/app/content/browser/vocabulary.py
@@ -17,6 +17,9 @@
 from zope.schema.interfaces import ICollection
 from zope.schema.interfaces import IVocabularyFactory
 from zope.security.interfaces import IPermission
+from Products.CMFPlone import PloneMessageFactory as _
+from zope.i18n import translate
+from Products.CMFPlone.utils import safe_unicode
 import inspect
 import itertools
 
@@ -153,7 +156,7 @@ def __call__(self):
                             continue
                     if key == 'path':
                         val = val[len(base_path):]
-                    item[key] = val
+                    item[key] = translate(_(safe_unicode(val)), context=self.request)
                 items.append(item)
         else:
             for item in results:


Repository: plone.app.content


Branch: refs/heads/master
Date: 2016-02-17T21:13:52+09:00
Author: Manabu TERADA (terapyon) <terada@cmscom.jp>
Commit: https://github.com/plone/plone.app.content/commit/6bfe33a1d05167167a8a4830864679ff1d8451cb

added CHANGES message

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index ed4d588..782d2bd 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,7 @@ New:
 
 Fixes:
 
-- *add item here*
+- added translation functionality to  folder content panel [terapyon]
 
 
 3.0.17 (2016-02-08)


Repository: plone.app.content


Branch: refs/heads/master
Date: 2016-02-18T16:54:09+09:00
Author: Manabu TERADA (terapyon) <terada@cmscom.jp>
Commit: https://github.com/plone/plone.app.content/commit/92e974961f1bf09fc8b00434be20779c8fd18b3d

ignored unabled translation attributes which likes id/title/date/etc for translation functionality to  folder content panel

Files changed:
M plone/app/content/browser/vocabulary.py

diff --git a/plone/app/content/browser/vocabulary.py b/plone/app/content/browser/vocabulary.py
index db6bff2..3e19121 100644
--- a/plone/app/content/browser/vocabulary.py
+++ b/plone/app/content/browser/vocabulary.py
@@ -134,6 +134,14 @@ def __call__(self):
         if isinstance(attributes, basestring) and attributes:
             attributes = attributes.split(',')
 
+        translate_ignored = [
+            'Creator', 'Date', 'Description', 'Title', 'author_name',
+            'cmf_uid', 'commentators', 'created', 'effective', 'end',
+            'expires', 'getIcon', 'getId', 'getRemoteUrl', 'in_response_to',
+            'listCreators', 'location', 'modified', 'start', 'sync_uid',
+            'path', 'getURL', 'EffectiveDate', 'getObjSize', 'id',
+            'UID', 'ExpirationDate', 'ModificationDate', 'CreationDate',
+        ]
         if attributes:
             base_path = getNavigationRoot(context)
             for vocab_item in results:
@@ -156,7 +164,10 @@ def __call__(self):
                             continue
                     if key == 'path':
                         val = val[len(base_path):]
-                    item[key] = translate(_(safe_unicode(val)), context=self.request)
+                    if key not in translate_ignored and isinstance(val, basestring):
+                        item[key] = translate(_(safe_unicode(val)), context=self.request)
+                    else:
+                        item[key] = val
                 items.append(item)
         else:
             for item in results:


Repository: plone.app.content


Branch: refs/heads/master
Date: 2016-02-18T17:08:44+09:00
Author: Manabu TERADA (terapyon) <terada@cmscom.jp>
Commit: https://github.com/plone/plone.app.content/commit/f7bf51b017f6f0bc099ea8a7b321eea4807c14c1

Added issue link in CHANGES.rst

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 782d2bd..7889a70 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -11,6 +11,7 @@ New:
 Fixes:
 
 - added translation functionality to  folder content panel [terapyon]
+  https://github.com/plone/Products.CMFPlone/issues/1398
 
 
 3.0.17 (2016-02-08)


Repository: plone.app.content


Branch: refs/heads/master
Date: 2016-02-18T18:43:07+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/plone.app.content/commit/5a1c80198d06899809a1312f601d6b0a341bf06c

Merge pull request #71 from plonejp/master

added translation functionality to folder content panel

Files changed:
M CHANGES.rst
M plone/app/content/browser/vocabulary.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ed4d588..7889a70 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ New:
 
 Fixes:
 
-- *add item here*
+- added translation functionality to  folder content panel [terapyon]
+  https://github.com/plone/Products.CMFPlone/issues/1398
 
 
 3.0.17 (2016-02-08)
diff --git a/plone/app/content/browser/vocabulary.py b/plone/app/content/browser/vocabulary.py
index 34906f1..3e19121 100644
--- a/plone/app/content/browser/vocabulary.py
+++ b/plone/app/content/browser/vocabulary.py
@@ -17,6 +17,9 @@
 from zope.schema.interfaces import ICollection
 from zope.schema.interfaces import IVocabularyFactory
 from zope.security.interfaces import IPermission
+from Products.CMFPlone import PloneMessageFactory as _
+from zope.i18n import translate
+from Products.CMFPlone.utils import safe_unicode
 import inspect
 import itertools
 
@@ -131,6 +134,14 @@ def __call__(self):
         if isinstance(attributes, basestring) and attributes:
             attributes = attributes.split(',')
 
+        translate_ignored = [
+            'Creator', 'Date', 'Description', 'Title', 'author_name',
+            'cmf_uid', 'commentators', 'created', 'effective', 'end',
+            'expires', 'getIcon', 'getId', 'getRemoteUrl', 'in_response_to',
+            'listCreators', 'location', 'modified', 'start', 'sync_uid',
+            'path', 'getURL', 'EffectiveDate', 'getObjSize', 'id',
+            'UID', 'ExpirationDate', 'ModificationDate', 'CreationDate',
+        ]
         if attributes:
             base_path = getNavigationRoot(context)
             for vocab_item in results:
@@ -153,7 +164,10 @@ def __call__(self):
                             continue
                     if key == 'path':
                         val = val[len(base_path):]
-                    item[key] = val
+                    if key not in translate_ignored and isinstance(val, basestring):
+                        item[key] = translate(_(safe_unicode(val)), context=self.request)
+                    else:
+                        item[key] = val
                 items.append(item)
         else:
             for item in results:


