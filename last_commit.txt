Repository: plone.app.users


Branch: refs/heads/master
Date: 2015-11-22T21:00:01-03:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/plone.app.users/commit/329f02d5a0dfda02566fa2b961b0fd6509fdf9a6

Update Site Setup link in all control panels (fixes plone/Products.CMFPlone#1255)

Files changed:
M CHANGES.rst
M plone/app/users/browser/registersettingspanel.py
M plone/app/users/browser/schema_layout.pt
M plone/app/users/tests/flexible_user_registration.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 7886a35..512bd37 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ New:
 
 Fixes:
 
-- *add item here*
+- Update Site Setup link in all control panels (fixes https://github.com/plone/Products.CMFPlone/issues/1255)
+  [davilima6]
 
 
 2.3.2 (2015-10-28)
diff --git a/plone/app/users/browser/registersettingspanel.py b/plone/app/users/browser/registersettingspanel.py
index 25da2aa..ada65e0 100644
--- a/plone/app/users/browser/registersettingspanel.py
+++ b/plone/app/users/browser/registersettingspanel.py
@@ -9,7 +9,6 @@
 from z3c.form import field
 from z3c.form import form
 from z3c.form.browser.orderedselect import OrderedSelectFieldWidget
-from zope.component import getMultiAdapter
 
 
 class RegistrationControlPanel(form.Form):
@@ -64,7 +63,7 @@ def action_save(self, action):
     #         (self.context, self.request),
     #         name='absolute_url'
     #     )()
-    #     self.request.response.redirect(url + '/plone_control_panel')
+    #     self.request.response.redirect(url + '/@@overview-controlpanel')
 
     def updateActions(self):
         super(RegistrationControlPanel, self).updateActions()
diff --git a/plone/app/users/browser/schema_layout.pt b/plone/app/users/browser/schema_layout.pt
index 0de8dd0..8dcdb3c 100644
--- a/plone/app/users/browser/schema_layout.pt
+++ b/plone/app/users/browser/schema_layout.pt
@@ -10,9 +10,8 @@
 
 <div metal:fill-slot="prefs_configlet_main">
 
-  <a href=""
-     id="setup-link"
-     tal:attributes="href string:$portal_url/plone_control_panel"
+  <a id="setup-link" class="link-parent"
+     tal:attributes="href string:$portal_url/@@overview-controlpanel"
      i18n:translate="">
       Site Setup
   </a> &rsaquo;
@@ -37,7 +36,7 @@
            href="${portal_url}/@@member-fields"
              i18n:translate="label_member_fields">Member fields</a>
       </div>
-      <tal:block tal:replace="structure view/contents|view/render"/>
+      <tal:block tal:replace="structure view/contents|view/render" />
     </div>
 
   </div>
@@ -46,4 +45,3 @@
 
 </body>
 </html>
-
diff --git a/plone/app/users/tests/flexible_user_registration.rst b/plone/app/users/tests/flexible_user_registration.rst
index f86a1bb..cc0cc3d 100644
--- a/plone/app/users/tests/flexible_user_registration.rst
+++ b/plone/app/users/tests/flexible_user_registration.rst
@@ -37,7 +37,7 @@ depend on a mail server properly set-up:
     True
 
 Check that the site admin has a link to the configlet in the control panel.
-    >>> browser.open('http://nohost/plone/plone_control_panel')
+    >>> browser.open('http://nohost/plone/@@overview-controlpanel')
     >>> browser.getLink('Users and Groups').click()
     >>> 'Member fields' in browser.contents
     True


Repository: plone.app.users


Branch: refs/heads/master
Date: 2015-11-25T01:34:34+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/plone.app.users/commit/7c7e9d7740903b2a683521c170be74794ea9f54d

Merge pull request #52 from plone/fix_sitesetup_link

Update Site Setup link in all control panels

Files changed:
M CHANGES.rst
M plone/app/users/browser/registersettingspanel.py
M plone/app/users/browser/schema_layout.pt
M plone/app/users/tests/flexible_user_registration.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 7886a35..512bd37 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ New:
 
 Fixes:
 
-- *add item here*
+- Update Site Setup link in all control panels (fixes https://github.com/plone/Products.CMFPlone/issues/1255)
+  [davilima6]
 
 
 2.3.2 (2015-10-28)
diff --git a/plone/app/users/browser/registersettingspanel.py b/plone/app/users/browser/registersettingspanel.py
index 25da2aa..ada65e0 100644
--- a/plone/app/users/browser/registersettingspanel.py
+++ b/plone/app/users/browser/registersettingspanel.py
@@ -9,7 +9,6 @@
 from z3c.form import field
 from z3c.form import form
 from z3c.form.browser.orderedselect import OrderedSelectFieldWidget
-from zope.component import getMultiAdapter
 
 
 class RegistrationControlPanel(form.Form):
@@ -64,7 +63,7 @@ def action_save(self, action):
     #         (self.context, self.request),
     #         name='absolute_url'
     #     )()
-    #     self.request.response.redirect(url + '/plone_control_panel')
+    #     self.request.response.redirect(url + '/@@overview-controlpanel')
 
     def updateActions(self):
         super(RegistrationControlPanel, self).updateActions()
diff --git a/plone/app/users/browser/schema_layout.pt b/plone/app/users/browser/schema_layout.pt
index 0de8dd0..8dcdb3c 100644
--- a/plone/app/users/browser/schema_layout.pt
+++ b/plone/app/users/browser/schema_layout.pt
@@ -10,9 +10,8 @@
 
 <div metal:fill-slot="prefs_configlet_main">
 
-  <a href=""
-     id="setup-link"
-     tal:attributes="href string:$portal_url/plone_control_panel"
+  <a id="setup-link" class="link-parent"
+     tal:attributes="href string:$portal_url/@@overview-controlpanel"
      i18n:translate="">
       Site Setup
   </a> &rsaquo;
@@ -37,7 +36,7 @@
            href="${portal_url}/@@member-fields"
              i18n:translate="label_member_fields">Member fields</a>
       </div>
-      <tal:block tal:replace="structure view/contents|view/render"/>
+      <tal:block tal:replace="structure view/contents|view/render" />
     </div>
 
   </div>
@@ -46,4 +45,3 @@
 
 </body>
 </html>
-
diff --git a/plone/app/users/tests/flexible_user_registration.rst b/plone/app/users/tests/flexible_user_registration.rst
index f86a1bb..cc0cc3d 100644
--- a/plone/app/users/tests/flexible_user_registration.rst
+++ b/plone/app/users/tests/flexible_user_registration.rst
@@ -37,7 +37,7 @@ depend on a mail server properly set-up:
     True
 
 Check that the site admin has a link to the configlet in the control panel.
-    >>> browser.open('http://nohost/plone/plone_control_panel')
+    >>> browser.open('http://nohost/plone/@@overview-controlpanel')
     >>> browser.getLink('Users and Groups').click()
     >>> 'Member fields' in browser.contents
     True


