Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-05-03T13:17:31+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/55f7e47aff9ec0825dcc757ab68378b7d35e1e7c

Fixed timestamp calculation in history service on Python 3.10.

Fixes https://github.com/plone/plone.restapi/issues/1391

Files changed:
A news/1391.bugfix
M src/plone/restapi/services/history/get.py

b'diff --git a/news/1391.bugfix b/news/1391.bugfix\nnew file mode 100644\nindex 000000000..75d3e7f44\n--- /dev/null\n+++ b/news/1391.bugfix\n@@ -0,0 +1,2 @@\n+Fixed timestamp calculation in history service on Python 3.10.\n+[maurits]\ndiff --git a/src/plone/restapi/services/history/get.py b/src/plone/restapi/services/history/get.py\nindex 404eec5d2..22095e615 100644\n--- a/src/plone/restapi/services/history/get.py\n+++ b/src/plone/restapi/services/history/get.py\n@@ -71,7 +71,7 @@ def reply(self):\n             # Versioning entries use a timestamp,\n             # workflow ISO formatted string\n             if not isinstance(item["time"], str):\n-                item["time"] = dt.fromtimestamp(item["time"]).isoformat()\n+                item["time"] = dt.fromtimestamp(int(item["time"])).isoformat()\n \n             # The create event has an empty \'action\', but we like it to say\n             # \'Create\', alike the transition_title\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-05-03T17:18:28+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.restapi/commit/986131f4e5150a4e4df78aa8b02c9ab34c322009

Merge pull request #1392 from plone/maurits-python-310

Fixed timestamp calculation in history service on Python 3.10.

Files changed:
A news/1391.bugfix
M src/plone/restapi/services/history/get.py

b'diff --git a/news/1391.bugfix b/news/1391.bugfix\nnew file mode 100644\nindex 000000000..75d3e7f44\n--- /dev/null\n+++ b/news/1391.bugfix\n@@ -0,0 +1,2 @@\n+Fixed timestamp calculation in history service on Python 3.10.\n+[maurits]\ndiff --git a/src/plone/restapi/services/history/get.py b/src/plone/restapi/services/history/get.py\nindex 404eec5d2..22095e615 100644\n--- a/src/plone/restapi/services/history/get.py\n+++ b/src/plone/restapi/services/history/get.py\n@@ -71,7 +71,7 @@ def reply(self):\n             # Versioning entries use a timestamp,\n             # workflow ISO formatted string\n             if not isinstance(item["time"], str):\n-                item["time"] = dt.fromtimestamp(item["time"]).isoformat()\n+                item["time"] = dt.fromtimestamp(int(item["time"])).isoformat()\n \n             # The create event has an empty \'action\', but we like it to say\n             # \'Create\', alike the transition_title\n'

