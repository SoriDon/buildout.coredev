Repository: plone.tiles


Branch: refs/heads/master
Date: 2016-02-16T14:32:35+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.tiles/commit/a07211ac6204b74380335d0f16ed5d14f3ec07fb

strange HREF replacement problem

Files changed:
M plone/tiles/esi.py

diff --git a/plone/tiles/esi.py b/plone/tiles/esi.py
index 31bceaf..c30cfb3 100644
--- a/plone/tiles/esi.py
+++ b/plone/tiles/esi.py
@@ -14,14 +14,13 @@
 BODY_CHILDREN = re.compile(r'<body[^>]*>(.*)</body>', re.I | re.S)
 
 ESI_NAMESPACE_MAP = {'esi': 'http://www.edge-delivery.org/esi/1.0'}
+_ESI_HREF = u'href="%(url)s/@@%(esiMode)s?%(queryString)s"'
 ESI_TEMPLATE = u'''\
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
     <body>
-        <a class="_esi_placeholder"
-           rel="esi"
-           href="%(url)s/@@%(esiMode)s?%(queryString)s"></a>
+        <a class="_esi_placeholder" rel="esi" ''' + _ESI_HREF + '''></a>
     </body>
 </html>
 '''


