Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2016-02-10T10:31:46-06:00
Author: nathan.vangheem () <nathan.vangheem@wildcardcorp.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/2007548e7c3b03ad916108b633a8907bd42fa7fa

Make sure to have image scale before generating tag for album view

Files changed:
M CHANGES.rst
M plone/app/contenttypes/browser/templates/listing_album.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index af66498..dde415c 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -13,6 +13,9 @@ New:
 
 Fixes:
 
+- Make sure to have image scale before generating tag for album view
+  [vangheem]
+
 - Also remove collections upon uninstalling.
   [pbauer]
 
diff --git a/plone/app/contenttypes/browser/templates/listing_album.pt b/plone/app/contenttypes/browser/templates/listing_album.pt
index 1bff8f9..9127208 100644
--- a/plone/app/contenttypes/browser/templates/listing_album.pt
+++ b/plone/app/contenttypes/browser/templates/listing_album.pt
@@ -22,14 +22,15 @@
 
   <metal:listingmacro define-macro="listing">
   <tal:images tal:repeat="image images">
-    <div class="photoAlbumEntry">
+    <div class="photoAlbumEntry"
+         tal:define="ob image/getObject;
+                     scale ob/@@images;
+                     img_tag python:scale.scale('image', scale='thumb')">
       <a tal:attributes="href string:${image/getURL}/view;
                          title image/Description">
         <span class="photoAlbumEntryWrapper">
-          <img tal:define="ob image/getObject;
-                           scale ob/@@images;
-                           img_tag python:scale.scale('image', scale='thumb').tag()"
-              tal:replace="structure img_tag" />
+          <img tal:condition="img_tag"
+              tal:replace="structure img_tag/tag" />
         </span>
         <span class="photoAlbumEntryTitle" tal:content="image/Title">
             Title


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2016-02-17T00:21:21+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.contenttypes/commit/5b10b961fbce95f791752cf1dfde5ab487bb9ca2

Merge pull request #322 from plone/missing-scale-album

Make sure to have image scale before generating tag for album view

Files changed:
M CHANGES.rst
M plone/app/contenttypes/browser/templates/listing_album.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index af66498..dde415c 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -13,6 +13,9 @@ New:
 
 Fixes:
 
+- Make sure to have image scale before generating tag for album view
+  [vangheem]
+
 - Also remove collections upon uninstalling.
   [pbauer]
 
diff --git a/plone/app/contenttypes/browser/templates/listing_album.pt b/plone/app/contenttypes/browser/templates/listing_album.pt
index 1bff8f9..9127208 100644
--- a/plone/app/contenttypes/browser/templates/listing_album.pt
+++ b/plone/app/contenttypes/browser/templates/listing_album.pt
@@ -22,14 +22,15 @@
 
   <metal:listingmacro define-macro="listing">
   <tal:images tal:repeat="image images">
-    <div class="photoAlbumEntry">
+    <div class="photoAlbumEntry"
+         tal:define="ob image/getObject;
+                     scale ob/@@images;
+                     img_tag python:scale.scale('image', scale='thumb')">
       <a tal:attributes="href string:${image/getURL}/view;
                          title image/Description">
         <span class="photoAlbumEntryWrapper">
-          <img tal:define="ob image/getObject;
-                           scale ob/@@images;
-                           img_tag python:scale.scale('image', scale='thumb').tag()"
-              tal:replace="structure img_tag" />
+          <img tal:condition="img_tag"
+              tal:replace="structure img_tag/tag" />
         </span>
         <span class="photoAlbumEntryTitle" tal:content="image/Title">
             Title


