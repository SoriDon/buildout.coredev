Repository: mockup


Branch: refs/heads/master
Date: 2019-02-27T18:23:44+01:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/mockup/commit/958ea141055f4a514204e390716c6b07fdcfce58

Fix highlight of current item if image or file

Files changed:
M mockup/patterns/navigationmarker/pattern.js
M news/885.bugfix

b'diff --git a/mockup/patterns/navigationmarker/pattern.js b/mockup/patterns/navigationmarker/pattern.js\nindex c0669036c..bd1d72969 100644\n--- a/mockup/patterns/navigationmarker/pattern.js\n+++ b/mockup/patterns/navigationmarker/pattern.js\n@@ -18,12 +18,13 @@ define([\n         name: \'navigationmarker\',\n         trigger: \'.pat-navigationmarker\',\n         parser: \'mockup\',\n-\n         init: function() {\n+            var self = this;\n             var href = document.querySelector(\'head link[rel="canonical"]\').href || window.location.href;\n \n             $(\'a\', this.$el).each(function () {\n-                if (href.indexOf(this.href) !== -1) {\n+                var navlink = this.href.replace(\'/view\',\'\')\n+                if (href.indexOf(navlink) !== -1) {\n                     var parent = $(this).parent();\n \n                     // check the input-openers within the path\n@@ -34,14 +35,12 @@ define([\n \n                     // set "inPath" to all nav items which are within the current path\n                     parent.addClass(\'inPath\');\n-\n                     // set "current" to the current selected nav item, if it is in the navigation structure.\n-                    if (href === this.href) {\n+                    if (href === navlink) {\n                         parent.addClass(\'current\');\n                     }\n                 }\n             });\n-\n         }\n     });\n \ndiff --git a/news/885.bugfix b/news/885.bugfix\nindex 5a05a62cb..8dfbba06b 100644\n--- a/news/885.bugfix\n+++ b/news/885.bugfix\n@@ -1,2 +1,2 @@\n-Removed condition for mobile devices, solved via css and not needed anymore.\n+Fix highlight of current item in nav for image and file.\n [agitator]\n\\ No newline at end of file\n'

Repository: mockup


Branch: refs/heads/master
Date: 2019-03-04T11:59:30+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/mockup/commit/3d2a95d7d954f8a825fbfb3068194fa82e713635

Merge pull request #899 from plone/fix-current-image-file

Fix highlight of current item if image or file

Files changed:
M mockup/patterns/navigationmarker/pattern.js
M news/885.bugfix

b'diff --git a/mockup/patterns/navigationmarker/pattern.js b/mockup/patterns/navigationmarker/pattern.js\nindex c0669036c..bd1d72969 100644\n--- a/mockup/patterns/navigationmarker/pattern.js\n+++ b/mockup/patterns/navigationmarker/pattern.js\n@@ -18,12 +18,13 @@ define([\n         name: \'navigationmarker\',\n         trigger: \'.pat-navigationmarker\',\n         parser: \'mockup\',\n-\n         init: function() {\n+            var self = this;\n             var href = document.querySelector(\'head link[rel="canonical"]\').href || window.location.href;\n \n             $(\'a\', this.$el).each(function () {\n-                if (href.indexOf(this.href) !== -1) {\n+                var navlink = this.href.replace(\'/view\',\'\')\n+                if (href.indexOf(navlink) !== -1) {\n                     var parent = $(this).parent();\n \n                     // check the input-openers within the path\n@@ -34,14 +35,12 @@ define([\n \n                     // set "inPath" to all nav items which are within the current path\n                     parent.addClass(\'inPath\');\n-\n                     // set "current" to the current selected nav item, if it is in the navigation structure.\n-                    if (href === this.href) {\n+                    if (href === navlink) {\n                         parent.addClass(\'current\');\n                     }\n                 }\n             });\n-\n         }\n     });\n \ndiff --git a/news/885.bugfix b/news/885.bugfix\nindex 5a05a62cb..8dfbba06b 100644\n--- a/news/885.bugfix\n+++ b/news/885.bugfix\n@@ -1,2 +1,2 @@\n-Removed condition for mobile devices, solved via css and not needed anymore.\n+Fix highlight of current item in nav for image and file.\n [agitator]\n\\ No newline at end of file\n'

