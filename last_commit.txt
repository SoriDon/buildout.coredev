Repository: plone.app.layout


Branch: refs/heads/master
Date: 2022-09-20T16:13:29+02:00
Author: Laurent Lasudry (laulaz) <lasudry@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/1c9bfc50b6f986d4c7c4ed4c65ae185830a0343c

Fix undefined logger variable

Files changed:
A news/323.bugfix
M plone/app/layout/viewlets/social.py

b'diff --git a/news/323.bugfix b/news/323.bugfix\nnew file mode 100644\nindex 00000000..7b520145\n--- /dev/null\n+++ b/news/323.bugfix\n@@ -0,0 +1,2 @@\n+Fix undefined logger variable\n+[laulaz]\ndiff --git a/plone/app/layout/viewlets/social.py b/plone/app/layout/viewlets/social.py\nindex eb11af0b..65996c55 100644\n--- a/plone/app/layout/viewlets/social.py\n+++ b/plone/app/layout/viewlets/social.py\n@@ -11,6 +11,10 @@\n from zope.component import queryMultiAdapter\n from zope.component.hooks import getSite\n \n+import logging\n+\n+logger = logging.getLogger("plone.app.layout")\n+\n \n class SocialTagsViewlet(TitleViewlet):\n     def head_tag_filter(self, value):\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2022-09-20T16:13:47+02:00
Author: Laurent Lasudry (laulaz) <lasudry@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/5c921d29f3cd3fb35313a8c953e2c9402872547a

Use a variable to allow customization of social tags image scale

This refs #323

Files changed:
A news/323.feature
M plone/app/layout/viewlets/social.py

b'diff --git a/news/323.feature b/news/323.feature\nnew file mode 100644\nindex 00000000..099511b5\n--- /dev/null\n+++ b/news/323.feature\n@@ -0,0 +1,2 @@\n+Use a variable to allow customization of the image scale used for social tags\n+[laulaz]\ndiff --git a/plone/app/layout/viewlets/social.py b/plone/app/layout/viewlets/social.py\nindex 65996c55..0f4f002a 100644\n--- a/plone/app/layout/viewlets/social.py\n+++ b/plone/app/layout/viewlets/social.py\n@@ -17,6 +17,8 @@\n \n \n class SocialTagsViewlet(TitleViewlet):\n+    social_image_scale = "great"\n+\n     def head_tag_filter(self, value):\n         if not isinstance(value, dict):\n             return\n@@ -100,7 +102,7 @@ def _get_tags(self):\n                 scales = self.context.restrictedTraverse(\'@@images\', None)\n                 if scales:\n                     try:\n-                        image = scales.scale(\'image\', scale=\'great\')\n+                        image = scales.scale(\'image\', scale=self.social_image_scale)\n                     except Exception as e:\n                         logger.exception(e)\n                 if image:\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2022-09-20T20:18:19+02:00
Author: Laurent Lasudry (laulaz) <lasudry@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/5a854bbf7f60f1cf9371ba022220ff5c52d16e65

Merge pull request #324 from plone/allow-social-image-scale-customization

Use a variable to allow customization of the image scale used for social tags

Files changed:
A news/323.bugfix
A news/323.feature
M plone/app/layout/viewlets/social.py

b'diff --git a/news/323.bugfix b/news/323.bugfix\nnew file mode 100644\nindex 00000000..7b520145\n--- /dev/null\n+++ b/news/323.bugfix\n@@ -0,0 +1,2 @@\n+Fix undefined logger variable\n+[laulaz]\ndiff --git a/news/323.feature b/news/323.feature\nnew file mode 100644\nindex 00000000..099511b5\n--- /dev/null\n+++ b/news/323.feature\n@@ -0,0 +1,2 @@\n+Use a variable to allow customization of the image scale used for social tags\n+[laulaz]\ndiff --git a/plone/app/layout/viewlets/social.py b/plone/app/layout/viewlets/social.py\nindex eb11af0b..0f4f002a 100644\n--- a/plone/app/layout/viewlets/social.py\n+++ b/plone/app/layout/viewlets/social.py\n@@ -11,8 +11,14 @@\n from zope.component import queryMultiAdapter\n from zope.component.hooks import getSite\n \n+import logging\n+\n+logger = logging.getLogger("plone.app.layout")\n+\n \n class SocialTagsViewlet(TitleViewlet):\n+    social_image_scale = "great"\n+\n     def head_tag_filter(self, value):\n         if not isinstance(value, dict):\n             return\n@@ -96,7 +102,7 @@ def _get_tags(self):\n                 scales = self.context.restrictedTraverse(\'@@images\', None)\n                 if scales:\n                     try:\n-                        image = scales.scale(\'image\', scale=\'great\')\n+                        image = scales.scale(\'image\', scale=self.social_image_scale)\n                     except Exception as e:\n                         logger.exception(e)\n                 if image:\n'

