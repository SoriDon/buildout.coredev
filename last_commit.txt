Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2015-12-13T22:37:23+01:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/Products.PlonePAS/commit/46652fd7215b1488f9ec3e564b1e8fba3ec00cef

Add back ordereddict (for python 2.6 support)

As Products.PlonePAS 5.x is being used on Plone 4.x python 2.6 support is expected.

Files changed:
M setup.py
M src/Products/PlonePAS/plugins/ufactory.py

diff --git a/setup.py b/setup.py
index e1b2b12..10ffc3f 100644
--- a/setup.py
+++ b/setup.py
@@ -37,7 +37,8 @@
         'plone.session',
         'setuptools',
         'zope.deprecation',
-        'plone.protect'
+        'plone.protect',
+        'ordereddict',
     ],
     extras_require=dict(
         test=[
diff --git a/src/Products/PlonePAS/plugins/ufactory.py b/src/Products/PlonePAS/plugins/ufactory.py
index db24491..b4e6b16 100644
--- a/src/Products/PlonePAS/plugins/ufactory.py
+++ b/src/Products/PlonePAS/plugins/ufactory.py
@@ -12,9 +12,13 @@
 from Products.PluggableAuthService.interfaces.propertysheets \
     import IPropertySheet
 from Products.PluggableAuthService.plugins.BasePlugin import BasePlugin
-from collections import OrderedDict
 from zope.interface import implementer
 
+try:
+    from collections import OrderedDict
+except ImportError:
+    from ordereddict import OrderedDict
+
 manage_addPloneUserFactoryForm = DTMLFile('../zmi/PloneUserFactoryForm',
                                           globals())
 


Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2015-12-14T11:11:44+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.PlonePAS/commit/37ac7f8b8b24c40fa204cf6bed17c65c8f362f2f

depend on ordereddict only in 2.6 and state changes

Files changed:
M CHANGES.rst
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index cb0c2ce..1f5950f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
+- bring back Python 2.6 support (in 2.6 depend on orderedict) and import
+  conditional with fallback.
+  [gforcada, jensens]
 
 
 5.0.5 (2015-12-08)
diff --git a/setup.py b/setup.py
index 10ffc3f..b9c0e5f 100644
--- a/setup.py
+++ b/setup.py
@@ -1,6 +1,7 @@
 # -*- coding: utf-8 -*-
 from setuptools import setup
 from setuptools import find_packages
+import sys
 
 version = '5.0.6.dev0'
 
@@ -8,6 +9,22 @@
 longdescription += '\n'
 longdescription += open("CHANGES.rst").read()
 
+install_requires = [
+        'plone.i18n',
+        'plone.memoize',
+        'plone.protect',
+        'plone.session',
+        'Products.CMFCore',
+        'Products.GenericSetup',
+        'Products.PluggableAuthService',
+        'setuptools',
+        'zope.deprecation',
+        'Zope2 >=2.13.22',
+    ],
+if sys.version_info < (2, 7):
+    # python 2.6 has no collections.ordereddict so we need to use this package
+    install_requires.append('ordereddict')
+
 setup(
     name='Products.PlonePAS',
     version=version,
@@ -27,19 +44,7 @@
     namespace_packages=['Products'],
     include_package_data=True,
     zip_safe=False,
-    install_requires=[
-        'Products.CMFCore',
-        'Products.GenericSetup',
-        'Products.PluggableAuthService',
-        'Zope2 >=2.13.22',
-        'plone.i18n',
-        'plone.memoize',
-        'plone.session',
-        'setuptools',
-        'zope.deprecation',
-        'plone.protect',
-        'ordereddict',
-    ],
+    install_requires=install_requires,
     extras_require=dict(
         test=[
             'plone.app.testing',


Repository: Products.PlonePAS


Branch: refs/heads/master
Date: 2015-12-14T22:46:32+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.PlonePAS/commit/451d13ab5906842930aa8881b9e0fe234102944c

Merge pull request #13 from plone/add-back-ordereddict

Add back ordereddict (for python 2.6 support)

Files changed:
M CHANGES.rst
M setup.py
M src/Products/PlonePAS/plugins/ufactory.py

diff --git a/CHANGES.rst b/CHANGES.rst
index cb0c2ce..1f5950f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
+- bring back Python 2.6 support (in 2.6 depend on orderedict) and import
+  conditional with fallback.
+  [gforcada, jensens]
 
 
 5.0.5 (2015-12-08)
diff --git a/setup.py b/setup.py
index e1b2b12..b9c0e5f 100644
--- a/setup.py
+++ b/setup.py
@@ -1,6 +1,7 @@
 # -*- coding: utf-8 -*-
 from setuptools import setup
 from setuptools import find_packages
+import sys
 
 version = '5.0.6.dev0'
 
@@ -8,6 +9,22 @@
 longdescription += '\n'
 longdescription += open("CHANGES.rst").read()
 
+install_requires = [
+        'plone.i18n',
+        'plone.memoize',
+        'plone.protect',
+        'plone.session',
+        'Products.CMFCore',
+        'Products.GenericSetup',
+        'Products.PluggableAuthService',
+        'setuptools',
+        'zope.deprecation',
+        'Zope2 >=2.13.22',
+    ],
+if sys.version_info < (2, 7):
+    # python 2.6 has no collections.ordereddict so we need to use this package
+    install_requires.append('ordereddict')
+
 setup(
     name='Products.PlonePAS',
     version=version,
@@ -27,18 +44,7 @@
     namespace_packages=['Products'],
     include_package_data=True,
     zip_safe=False,
-    install_requires=[
-        'Products.CMFCore',
-        'Products.GenericSetup',
-        'Products.PluggableAuthService',
-        'Zope2 >=2.13.22',
-        'plone.i18n',
-        'plone.memoize',
-        'plone.session',
-        'setuptools',
-        'zope.deprecation',
-        'plone.protect'
-    ],
+    install_requires=install_requires,
     extras_require=dict(
         test=[
             'plone.app.testing',
diff --git a/src/Products/PlonePAS/plugins/ufactory.py b/src/Products/PlonePAS/plugins/ufactory.py
index db24491..b4e6b16 100644
--- a/src/Products/PlonePAS/plugins/ufactory.py
+++ b/src/Products/PlonePAS/plugins/ufactory.py
@@ -12,9 +12,13 @@
 from Products.PluggableAuthService.interfaces.propertysheets \
     import IPropertySheet
 from Products.PluggableAuthService.plugins.BasePlugin import BasePlugin
-from collections import OrderedDict
 from zope.interface import implementer
 
+try:
+    from collections import OrderedDict
+except ImportError:
+    from ordereddict import OrderedDict
+
 manage_addPloneUserFactoryForm = DTMLFile('../zmi/PloneUserFactoryForm',
                                           globals())
 


