Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2018-10-01T15:14:55+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/fd05a2483a19e119fcec813bef37a963bfec3f6b

Fix the Format accessor

Files changed:
M CHANGES.rst
M plone/app/contenttypes/content.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex bd38fba8..72da4fcf 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -28,7 +28,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- The ``Format`` accessor should actually return the ``format`` attribute\n+  (see plone/Products.CMFPlone#2540)\n+  [ale-rt]\n \n \n 1.4.12 (2018-09-23)\ndiff --git a/plone/app/contenttypes/content.py b/plone/app/contenttypes/content.py\nindex 766fa379..b9068c88 100644\n--- a/plone/app/contenttypes/content.py\n+++ b/plone/app/contenttypes/content.py\n@@ -76,6 +76,14 @@ def results(self, **kwargs):\n class Document(Item):\n     """Convenience subclass for ``Document`` portal type\n     """\n+    def Format(self):\n+        \'\'\' Provide a proper accessor for the format attribute\n+        See https://github.com/plone/Products.CMFPlone/issues/2540\n+        \'\'\'\n+        format = self.format\n+        if six.PY2 and isinstance(format, six.text_type):\n+            format = self.format.encode()\n+        return format\n \n \n @implementer(IFile)\n'

Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2018-10-02T09:50:50+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/a8f65215ede27cecad1304da1eb1697213d1d305

Merge pull request #489 from plone/fix-format

Fix the Format accessor

Files changed:
M CHANGES.rst
M plone/app/contenttypes/content.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex bd38fba8..72da4fcf 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -28,7 +28,9 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- The ``Format`` accessor should actually return the ``format`` attribute\n+  (see plone/Products.CMFPlone#2540)\n+  [ale-rt]\n \n \n 1.4.12 (2018-09-23)\ndiff --git a/plone/app/contenttypes/content.py b/plone/app/contenttypes/content.py\nindex 766fa379..b9068c88 100644\n--- a/plone/app/contenttypes/content.py\n+++ b/plone/app/contenttypes/content.py\n@@ -76,6 +76,14 @@ def results(self, **kwargs):\n class Document(Item):\n     """Convenience subclass for ``Document`` portal type\n     """\n+    def Format(self):\n+        \'\'\' Provide a proper accessor for the format attribute\n+        See https://github.com/plone/Products.CMFPlone/issues/2540\n+        \'\'\'\n+        format = self.format\n+        if six.PY2 and isinstance(format, six.text_type):\n+            format = self.format.encode()\n+        return format\n \n \n @implementer(IFile)\n'

