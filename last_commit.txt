Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-01-29T16:43:58+01:00
Author: Gagaro (Gagaro) <gagaro42@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/8a404a4ab081b7544301523c457405d77c96973a

fix: add barceloneta path in less configuration

Files changed:
M CHANGES.rst
M Products/CMFPlone/_scripts/_generate_gruntfile.py
M Products/CMFPlone/resources/browser/mixins.py

diff --git a/CHANGES.rst b/CHANGES.rst
index bcae7a3..dfcd7ee 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ Changelog
 
 New:
 
-- *add item here*
+- Add barceloneta theme path in less configuration.
+  [Gagaro]
 
 Fixes:
 
diff --git a/Products/CMFPlone/_scripts/_generate_gruntfile.py b/Products/CMFPlone/_scripts/_generate_gruntfile.py
index a005d06..3ac0502 100644
--- a/Products/CMFPlone/_scripts/_generate_gruntfile.py
+++ b/Products/CMFPlone/_scripts/_generate_gruntfile.py
@@ -15,6 +15,8 @@
 from plone.resource.file import FilesystemFile
 
 from plone.subrequest import subrequest
+from plonetheme import barceloneta
+
 import uuid
 from zope.component import getUtility
 
@@ -241,6 +243,9 @@ def resource_to_dir(resource, file_type='.js'):
 globalVars['staticPath'] = "'" + os.path.join(
     os.path.dirname(CMFPlone.__file__),
     'static') + "'"
+globalVars['barcelonetaPath'] = "'" + os.path.join(
+    os.path.dirname(barceloneta.__file__),
+    'theme') + "'"
 
 less_vars_params = {
     'site_url': 'LOCAL',
diff --git a/Products/CMFPlone/resources/browser/mixins.py b/Products/CMFPlone/resources/browser/mixins.py
index fcce396..40fb148 100644
--- a/Products/CMFPlone/resources/browser/mixins.py
+++ b/Products/CMFPlone/resources/browser/mixins.py
@@ -56,6 +56,7 @@ def __call__(self):
         result += "isPlone: true,\n"
         result += "isMockup: false,\n"
         result += "staticPath: '\"%s/++plone++static\"',\n" % site_url
+        result += "barcelonetaPath: '\"%s/++theme++barceloneta\"',\n" % site_url
 
         less_vars_params = {
             'site_url': site_url,
@@ -103,6 +104,7 @@ def __call__(self):
         result2 += "'@isPlone': true,\n"
         result2 += "'@isMockup': false,\n"
         result2 += "'@staticPath: '\"%s/++plone++static\"',\n" % site_url
+        result2 += "'@barcelonetaPath: '\"%s/++theme++barceloneta\"',\n" % site_url
 
         less_vars_params = {
             'site_url': site_url,


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-01-30T18:41:40-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/0ea978c05e4e0d7cfa55b1bd5fabaf84a611eebb

Merge pull request #1347 from plone/fix-thememapper

fix: add barceloneta path in less configuration

Files changed:
M CHANGES.rst
M Products/CMFPlone/_scripts/_generate_gruntfile.py
M Products/CMFPlone/resources/browser/mixins.py

diff --git a/CHANGES.rst b/CHANGES.rst
index bcae7a3..dfcd7ee 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ Changelog
 
 New:
 
-- *add item here*
+- Add barceloneta theme path in less configuration.
+  [Gagaro]
 
 Fixes:
 
diff --git a/Products/CMFPlone/_scripts/_generate_gruntfile.py b/Products/CMFPlone/_scripts/_generate_gruntfile.py
index a005d06..3ac0502 100644
--- a/Products/CMFPlone/_scripts/_generate_gruntfile.py
+++ b/Products/CMFPlone/_scripts/_generate_gruntfile.py
@@ -15,6 +15,8 @@
 from plone.resource.file import FilesystemFile
 
 from plone.subrequest import subrequest
+from plonetheme import barceloneta
+
 import uuid
 from zope.component import getUtility
 
@@ -241,6 +243,9 @@ def resource_to_dir(resource, file_type='.js'):
 globalVars['staticPath'] = "'" + os.path.join(
     os.path.dirname(CMFPlone.__file__),
     'static') + "'"
+globalVars['barcelonetaPath'] = "'" + os.path.join(
+    os.path.dirname(barceloneta.__file__),
+    'theme') + "'"
 
 less_vars_params = {
     'site_url': 'LOCAL',
diff --git a/Products/CMFPlone/resources/browser/mixins.py b/Products/CMFPlone/resources/browser/mixins.py
index fcce396..40fb148 100644
--- a/Products/CMFPlone/resources/browser/mixins.py
+++ b/Products/CMFPlone/resources/browser/mixins.py
@@ -56,6 +56,7 @@ def __call__(self):
         result += "isPlone: true,\n"
         result += "isMockup: false,\n"
         result += "staticPath: '\"%s/++plone++static\"',\n" % site_url
+        result += "barcelonetaPath: '\"%s/++theme++barceloneta\"',\n" % site_url
 
         less_vars_params = {
             'site_url': site_url,
@@ -103,6 +104,7 @@ def __call__(self):
         result2 += "'@isPlone': true,\n"
         result2 += "'@isMockup': false,\n"
         result2 += "'@staticPath: '\"%s/++plone++static\"',\n" % site_url
+        result2 += "'@barcelonetaPath: '\"%s/++theme++barceloneta\"',\n" % site_url
 
         less_vars_params = {
             'site_url': site_url,


