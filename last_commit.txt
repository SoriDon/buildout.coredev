Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2018-05-30T16:49:52+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/2df112f3a281f2799da4e37cc169809940db8a2f

When allowing unicode ids in py3 Zope changed the regex for allowed ids

See https://github.com/zopefoundation/Zope/pull/181

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/testCheckId.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9250c067b..8ffca9605 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -66,6 +66,9 @@ New Features:
 
 Bug Fixes:
 
+- Fix tests after changes in disallowed object ids in Zope.
+  [pbauer]
+
 - Do not include too new upgrades when upgrading Plone Site.
   Otherwise the Plone Site ends up at a newer version that the filesystem code supports,
   giving an error when upgrading, and resulting in possibly missed upgrades later.
diff --git a/Products/CMFPlone/tests/testCheckId.py b/Products/CMFPlone/tests/testCheckId.py
index 40f2334a1..9e961a369 100644
--- a/Products/CMFPlone/tests/testCheckId.py
+++ b/Products/CMFPlone/tests/testCheckId.py
@@ -64,14 +64,14 @@ def testAlternativeId(self):
         self.assertEqual(r, None)   # success
 
     def testBadId(self):
+        # See https://github.com/zopefoundation/Zope/pull/181
         r = self.folder.check_id('=')
-        self.assertEqual(r, u'= is not a legal name. The following characters '
-                            u'are invalid: =')
+        self.assertEqual(r, None)
 
     def testDecodeId(self):
+        # See https://github.com/zopefoundation/Zope/pull/181
         r = self.folder.check_id('\xc3\xa4')
-        self.assertEqual(r, u'\xe4 is not a legal name. The following '
-                            u'characters are invalid: \xe4')
+        self.assertEqual(r, None)
 
     def testCatalogIndex(self):
         # TODO: Tripwire


