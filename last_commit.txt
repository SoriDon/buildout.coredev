Repository: plone.app.uuid


Branch: refs/heads/master
Date: 2022-10-07T16:51:19+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.uuid/commit/983c445d9956f955a09123a944a9d82cdb6c66bc

Process the catalog queue before looking up in the catalog

Fixes #15

Files changed:
A news/15.bugfix
M plone/app/uuid/utils.py

b'diff --git a/news/15.bugfix b/news/15.bugfix\nnew file mode 100644\nindex 0000000..d93eda6\n--- /dev/null\n+++ b/news/15.bugfix\n@@ -0,0 +1,2 @@\n+Process the catalog queue before looking up in the catalog\n+[ale-rt]\ndiff --git a/plone/app/uuid/utils.py b/plone/app/uuid/utils.py\nindex 70871d3..8201167 100644\n--- a/plone/app/uuid/utils.py\n+++ b/plone/app/uuid/utils.py\n@@ -1,5 +1,6 @@\n # -*- coding: utf-8 -*-\n from AccessControl import Unauthorized\n+from Products.CMFCore.indexing import processQueue\n from Products.CMFCore.utils import getToolByName\n from Products.ZCatalog.query import IndexQuery\n from zope.component.hooks import getSite\n@@ -40,6 +41,9 @@ def uuidToPhysicalPath(uuid):\n     if catalog is None:\n         return\n     index = catalog.Indexes["UID"]\n+\n+    # Process the catalog queue in case we have pending relevant operations\n+    processQueue()\n     try:\n         # This uses a private attribute, so be careful.\n         rid = index._index.get(uuid)\n'

Repository: plone.app.uuid


Branch: refs/heads/master
Date: 2022-10-10T13:53:13+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.uuid/commit/2194e998d31928447edd87bbbc6852deb7c31240

Merge pull request #16 from plone/15.fixed

Process the catalog queue before looking up in the catalog

Files changed:
A news/15.bugfix
M plone/app/uuid/utils.py

b'diff --git a/news/15.bugfix b/news/15.bugfix\nnew file mode 100644\nindex 0000000..d93eda6\n--- /dev/null\n+++ b/news/15.bugfix\n@@ -0,0 +1,2 @@\n+Process the catalog queue before looking up in the catalog\n+[ale-rt]\ndiff --git a/plone/app/uuid/utils.py b/plone/app/uuid/utils.py\nindex 70871d3..8201167 100644\n--- a/plone/app/uuid/utils.py\n+++ b/plone/app/uuid/utils.py\n@@ -1,5 +1,6 @@\n # -*- coding: utf-8 -*-\n from AccessControl import Unauthorized\n+from Products.CMFCore.indexing import processQueue\n from Products.CMFCore.utils import getToolByName\n from Products.ZCatalog.query import IndexQuery\n from zope.component.hooks import getSite\n@@ -40,6 +41,9 @@ def uuidToPhysicalPath(uuid):\n     if catalog is None:\n         return\n     index = catalog.Indexes["UID"]\n+\n+    # Process the catalog queue in case we have pending relevant operations\n+    processQueue()\n     try:\n         # This uses a private attribute, so be careful.\n         rid = index._index.get(uuid)\n'

