Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-22T01:46:09+05:30
Author: anirudhhkashyap (anirudhhkashyap) <anirudh.k.harish@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/3e3d77ce1d3faa3316f1464460dd25f2ae200eb3

Add unrestricted keyword argument to uuidToObject()

Setting the unrestricted flag to True invokes the unrestrictedTraversal() instead of restrictedTraversal().
Invoking the latter threw the Unauthorized Exception. Now the object can be accessed depending on the unrestricted flag.

Files changed:
A news/1448.bugfix
M src/plone/restapi/serializer/utils.py

b'diff --git a/news/1448.bugfix b/news/1448.bugfix\nnew file mode 100644\nindex 000000000..9bf359bb6\n--- /dev/null\n+++ b/news/1448.bugfix\n@@ -0,0 +1,2 @@\n+Fix for test cases failing when deprecating uuidToObject() from `plone.outputfilters.browser.resolveuid`.\n+[anirudhhkashyap]\n\\ No newline at end of file\ndiff --git a/src/plone/restapi/serializer/utils.py b/src/plone/restapi/serializer/utils.py\nindex 15b37a41a..7bdd516c0 100644\n--- a/src/plone/restapi/serializer/utils.py\n+++ b/src/plone/restapi/serializer/utils.py\n@@ -1,4 +1,4 @@\n-from plone.outputfilters.browser.resolveuid import uuidToObject\n+from plone.app.uuid.utils import uuidToObject\n from plone.outputfilters.browser.resolveuid import uuidToURL\n from plone.restapi.interfaces import IObjectPrimaryFieldTarget\n from zope.component import queryMultiAdapter\n@@ -23,7 +23,10 @@ def uid_to_url(path):\n     if suffix:\n         href += "/" + suffix\n     else:\n-        target_object = uuidToObject(uid)\n+        """ Pass unrestricted flag as true so the object is accessible.\n+        At uuidToObject(), this leads to unrestrictedTraverse() to be invoked instead of restrictedTraverse().\n+        """\n+        target_object = uuidToObject(uid, unrestricted = True)\n         if target_object:\n             adapter = queryMultiAdapter(\n                 (target_object, target_object.REQUEST), IObjectPrimaryFieldTarget\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-23T23:12:06+05:30
Author: Anirudh H Kashyap (anirudhhkashyap) <68481927+anirudhhkashyap@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/db68ab7d98983de90144f46003542fcb839baaa6

Revert "Add unrestricted keyword argument to uuidToObject() (#1471)"

This reverts commit d35126751afcc5d3c5ea222af571dcb430c20f38.

Files changed:
M src/plone/restapi/serializer/utils.py
D news/1448.bugfix

b'diff --git a/news/1448.bugfix b/news/1448.bugfix\ndeleted file mode 100644\nindex 9bf359bb6..000000000\n--- a/news/1448.bugfix\n+++ /dev/null\n@@ -1,2 +0,0 @@\n-Fix for test cases failing when deprecating uuidToObject() from `plone.outputfilters.browser.resolveuid`.\n-[anirudhhkashyap]\n\\ No newline at end of file\ndiff --git a/src/plone/restapi/serializer/utils.py b/src/plone/restapi/serializer/utils.py\nindex c3d9f6db1..15b37a41a 100644\n--- a/src/plone/restapi/serializer/utils.py\n+++ b/src/plone/restapi/serializer/utils.py\n@@ -1,4 +1,4 @@\n-from plone.app.uuid.utils import uuidToObject\n+from plone.outputfilters.browser.resolveuid import uuidToObject\n from plone.outputfilters.browser.resolveuid import uuidToURL\n from plone.restapi.interfaces import IObjectPrimaryFieldTarget\n from zope.component import queryMultiAdapter\n@@ -8,7 +8,7 @@\n \n RESOLVEUID_RE = re.compile("^[./]*resolve[Uu]id/([^/]*)/?(.*)$")\n \n-# Takes the resolveID URL and returns a URL to the actual object\n+\n def uid_to_url(path):\n     if not path:\n         return ""\n@@ -23,10 +23,7 @@ def uid_to_url(path):\n     if suffix:\n         href += "/" + suffix\n     else:\n-        # Pass unrestricted flag as true so the object is accessible.\n-        # At uuidToObject(), this leads to unrestrictedTraverse() to be invoked instead of restrictedTraverse().\n-        \n-        target_object = uuidToObject(uid, unrestricted=True)\n+        target_object = uuidToObject(uid)\n         if target_object:\n             adapter = queryMultiAdapter(\n                 (target_object, target_object.REQUEST), IObjectPrimaryFieldTarget\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-23T23:59:23+05:30
Author: anirudhhkashyap (anirudhhkashyap) <anirudh.k.harish@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/c308fbdaa354eec2cca73a56088f192cb61b8337

Merge branch 'revert-1471-uuidToObject-Deprecation' of https://github.com/plone/plone.restapi into revert-1471-uuidToObject-Deprecation

Files changed:


b''

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-24T00:13:47+05:30
Author: anirudhhkashyap (anirudhhkashyap) <anirudh.k.harish@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/d2700e32cd4ae191c08c3ee7e956782ccc15c887

Add minor code formatting

Made so flake8 and black code formatting tests pass.

Files changed:
A news/1488.bugfix
M src/plone/restapi/serializer/utils.py
D news/1448.bugfix

b'diff --git a/news/1448.bugfix b/news/1488.bugfix\nsimilarity index 100%\nrename from news/1448.bugfix\nrename to news/1488.bugfix\ndiff --git a/src/plone/restapi/serializer/utils.py b/src/plone/restapi/serializer/utils.py\nindex 7bdd516c0..6bfe13235 100644\n--- a/src/plone/restapi/serializer/utils.py\n+++ b/src/plone/restapi/serializer/utils.py\n@@ -9,6 +9,7 @@\n RESOLVEUID_RE = re.compile("^[./]*resolve[Uu]id/([^/]*)/?(.*)$")\n \n \n+# Takes the resolveID URL and returns a URL to the actual object\n def uid_to_url(path):\n     if not path:\n         return ""\n@@ -23,10 +24,9 @@ def uid_to_url(path):\n     if suffix:\n         href += "/" + suffix\n     else:\n-        """ Pass unrestricted flag as true so the object is accessible.\n-        At uuidToObject(), this leads to unrestrictedTraverse() to be invoked instead of restrictedTraverse().\n-        """\n-        target_object = uuidToObject(uid, unrestricted = True)\n+        # Pass unrestricted flag as true so the object is accessible.\n+        # At uuidToObject(), this leads to unrestrictedTraverse() to be invoked instead of restrictedTraverse().\n+        target_object = uuidToObject(uid, unrestricted=True)\n         if target_object:\n             adapter = queryMultiAdapter(\n                 (target_object, target_object.REQUEST), IObjectPrimaryFieldTarget\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-24T12:19:08+05:30
Author: Anirudh H Kashyap (anirudhhkashyap) <68481927+anirudhhkashyap@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/63fb03a2cc7f4a2d4ed80142a09d06f08a02f2eb

Rename 1488.bugfix to 1448.bugfix

Files changed:
A news/1448.bugfix
D news/1488.bugfix

b'diff --git a/news/1488.bugfix b/news/1448.bugfix\nsimilarity index 85%\nrename from news/1488.bugfix\nrename to news/1448.bugfix\nindex 9bf359bb6..ae5b9ca44 100644\n--- a/news/1488.bugfix\n+++ b/news/1448.bugfix\n@@ -1,2 +1,2 @@\n Fix for test cases failing when deprecating uuidToObject() from `plone.outputfilters.browser.resolveuid`.\n-[anirudhhkashyap]\n\\ No newline at end of file\n+[anirudhhkashyap]\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-08-24T10:47:33+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.restapi/commit/90de38adc630704ea1c12adf73c9e179d2fdedd7

Merge pull request #1473 from anirudhhkashyap/revert-1471-uuidToObject-Deprecation

Minor code formatting changes

Files changed:
M news/1448.bugfix
M src/plone/restapi/serializer/utils.py

b'diff --git a/news/1448.bugfix b/news/1448.bugfix\nindex 9bf359bb6..ae5b9ca44 100644\n--- a/news/1448.bugfix\n+++ b/news/1448.bugfix\n@@ -1,2 +1,2 @@\n Fix for test cases failing when deprecating uuidToObject() from `plone.outputfilters.browser.resolveuid`.\n-[anirudhhkashyap]\n\\ No newline at end of file\n+[anirudhhkashyap]\ndiff --git a/src/plone/restapi/serializer/utils.py b/src/plone/restapi/serializer/utils.py\nindex c3d9f6db1..6bfe13235 100644\n--- a/src/plone/restapi/serializer/utils.py\n+++ b/src/plone/restapi/serializer/utils.py\n@@ -8,6 +8,7 @@\n \n RESOLVEUID_RE = re.compile("^[./]*resolve[Uu]id/([^/]*)/?(.*)$")\n \n+\n # Takes the resolveID URL and returns a URL to the actual object\n def uid_to_url(path):\n     if not path:\n@@ -25,7 +26,6 @@ def uid_to_url(path):\n     else:\n         # Pass unrestricted flag as true so the object is accessible.\n         # At uuidToObject(), this leads to unrestrictedTraverse() to be invoked instead of restrictedTraverse().\n-        \n         target_object = uuidToObject(uid, unrestricted=True)\n         if target_object:\n             adapter = queryMultiAdapter(\n'

