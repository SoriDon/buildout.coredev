Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-20T19:07:07+01:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/documentation/commit/60f4e131002083871e2b6edcc3baf64d4aca4850

Add storybook deployment

Files changed:
M .github/workflows/build_deploy.yml

b'diff --git a/.github/workflows/build_deploy.yml b/.github/workflows/build_deploy.yml\nindex 65d161a8..fa33ce30 100644\n--- a/.github/workflows/build_deploy.yml\n+++ b/.github/workflows/build_deploy.yml\n@@ -30,6 +30,9 @@ jobs:\n       - name: Prepare deploy\n         run: make deploy\n \n+      - name: StoryBook build\n+        run: cd submodules/volto && yarn && yarn build-storybook -o _build/html/storybook\n+\n       - name: Deploy to server\n         id: deploy\n         uses: Pendect/action-rsyncer@v1.1.0\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-20T19:11:38+01:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/documentation/commit/283781518adb5e0b619e2cbe863986e3afbf43b4

Add yarn cache

Files changed:
M .github/workflows/build_deploy.yml

b'diff --git a/.github/workflows/build_deploy.yml b/.github/workflows/build_deploy.yml\nindex fa33ce30..f061608a 100644\n--- a/.github/workflows/build_deploy.yml\n+++ b/.github/workflows/build_deploy.yml\n@@ -30,6 +30,27 @@ jobs:\n       - name: Prepare deploy\n         run: make deploy\n \n+      # node setup\n+      - name: Use Node.js ${{ matrix.node-version }}\n+        uses: actions/setup-node@v1\n+        working-directory: submodules/volto\n+        with:\n+          node-version: ${{ matrix.node-version }}\n+\n+      # node cache\n+      - name: Get yarn cache directory path\n+        id: yarn-cache-dir-path\n+        working-directory: submodules/volto\n+        run: echo "::set-output name=dir::$(yarn cache dir)"\n+      - uses: actions/cache@v1\n+        id: yarn-cache # use this to check for `cache-hit` (`steps.yarn-cache.outputs.cache-hit != \'true\'`)\n+        working-directory: submodules/volto\n+        with:\n+          path: ${{ steps.yarn-cache-dir-path.outputs.dir }}\n+          key: ${{ runner.os }}-yarn-${{ hashFiles(\'**/yarn.lock\') }}\n+          restore-keys: |\n+            ${{ runner.os }}-yarn-\n+\n       - name: StoryBook build\n         run: cd submodules/volto && yarn && yarn build-storybook -o _build/html/storybook\n \n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-02-20T19:18:21+01:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/documentation/commit/e67b6eb68b68d19fa882fb0bb7b991a3adcf0240

Add storybook to Netlify previews

Files changed:
M Makefile

b'diff --git a/Makefile b/Makefile\nindex 1ce399cf..68b71d6d 100644\n--- a/Makefile\n+++ b/Makefile\n@@ -211,6 +211,11 @@ netlify:\n \tgit submodule update; \\\n \tln -s ../submodules/volto/docs/source ./docs/volto\n \tcd $(DOCS_DIR) && sphinx-build -b html $(ALLSPHINXOPTS) $(BUILDDIR)/html\n+\tmake storybook\n+\n+.PHONY: storybook\n+storybook:\n+\tcd submodules/volto && yarn && yarn build-storybook -o ../../_build/html/storybook\n \n .PHONY: all\n all: clean spellcheck linkcheck html  ## Clean docs build, then run linkcheck and spellcheck, and build html\n'

Repository: documentation


Branch: refs/heads/6-dev
Date: 2022-03-10T04:49:29-08:00
Author: Steve Piercy (stevepiercy) <web@stevepiercy.com>
Commit: https://github.com/plone/documentation/commit/9d6b5a0efe636a6f81dbfc5eb9656b0b50c73a98

Merge pull request #1187 from plone/storybookdeploy

Add storybook deployment

Files changed:
M .github/workflows/build_deploy.yml
M Makefile

b'diff --git a/.github/workflows/build_deploy.yml b/.github/workflows/build_deploy.yml\nindex 65d161a8..f061608a 100644\n--- a/.github/workflows/build_deploy.yml\n+++ b/.github/workflows/build_deploy.yml\n@@ -30,6 +30,30 @@ jobs:\n       - name: Prepare deploy\n         run: make deploy\n \n+      # node setup\n+      - name: Use Node.js ${{ matrix.node-version }}\n+        uses: actions/setup-node@v1\n+        working-directory: submodules/volto\n+        with:\n+          node-version: ${{ matrix.node-version }}\n+\n+      # node cache\n+      - name: Get yarn cache directory path\n+        id: yarn-cache-dir-path\n+        working-directory: submodules/volto\n+        run: echo "::set-output name=dir::$(yarn cache dir)"\n+      - uses: actions/cache@v1\n+        id: yarn-cache # use this to check for `cache-hit` (`steps.yarn-cache.outputs.cache-hit != \'true\'`)\n+        working-directory: submodules/volto\n+        with:\n+          path: ${{ steps.yarn-cache-dir-path.outputs.dir }}\n+          key: ${{ runner.os }}-yarn-${{ hashFiles(\'**/yarn.lock\') }}\n+          restore-keys: |\n+            ${{ runner.os }}-yarn-\n+\n+      - name: StoryBook build\n+        run: cd submodules/volto && yarn && yarn build-storybook -o _build/html/storybook\n+\n       - name: Deploy to server\n         id: deploy\n         uses: Pendect/action-rsyncer@v1.1.0\ndiff --git a/Makefile b/Makefile\nindex 1ce399cf..68b71d6d 100644\n--- a/Makefile\n+++ b/Makefile\n@@ -211,6 +211,11 @@ netlify:\n \tgit submodule update; \\\n \tln -s ../submodules/volto/docs/source ./docs/volto\n \tcd $(DOCS_DIR) && sphinx-build -b html $(ALLSPHINXOPTS) $(BUILDDIR)/html\n+\tmake storybook\n+\n+.PHONY: storybook\n+storybook:\n+\tcd submodules/volto && yarn && yarn build-storybook -o ../../_build/html/storybook\n \n .PHONY: all\n all: clean spellcheck linkcheck html  ## Clean docs build, then run linkcheck and spellcheck, and build html\n'

