Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2017-10-10T23:24:32+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/f54d45a566c0ecad9f7b78bbc9a693ba89df9dc4

Fixed add-on listed as uninstalled when default profile is not the first.

Fixes https://github.com/plone/Products.CMFPlone/issues/2166.

Files changed:
M CHANGES.rst
M Products/CMFPlone/controlpanel/browser/quickinstaller.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 1a86e542a..137341e09 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,6 +22,10 @@ New features:
 
 Bug fixes:
 
+- Fixed add-on listed as uninstalled when the default profile is not the first alphabetically.
+  Fixes `issue 2166 <https://github.com/plone/Products.CMFPlone/issues/2166>`_.
+  [maurits]
+
 - Less variables: Fix calculation of screen max sizes.
   Max sizes were two pixels too high.
   [thet]
diff --git a/Products/CMFPlone/controlpanel/browser/quickinstaller.py b/Products/CMFPlone/controlpanel/browser/quickinstaller.py
index 49a73f0be..e5b109b97 100644
--- a/Products/CMFPlone/controlpanel/browser/quickinstaller.py
+++ b/Products/CMFPlone/controlpanel/browser/quickinstaller.py
@@ -548,7 +548,7 @@ def marshall_addons(self):
             profile_type = pid_parts[-1]
             if product_id not in addons:
                 # get some basic information on the product
-                installed = self.is_profile_installed(pid)
+                installed = self.is_product_installed(product_id)
                 upgrade_info = {}
                 if installed:
                     upgrade_info = self.upgrade_info(product_id)


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2017-10-11T12:15:29+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/f358830ebf653a4d22457d0d52ebc51dd20691ea

Merge pull request #2172 from plone/issue-2166-addon-uninstalled

Fixed add-on listed as uninstalled when default profile is not the first

Files changed:
M CHANGES.rst
M Products/CMFPlone/controlpanel/browser/quickinstaller.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 1a86e542a..137341e09 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,6 +22,10 @@ New features:
 
 Bug fixes:
 
+- Fixed add-on listed as uninstalled when the default profile is not the first alphabetically.
+  Fixes `issue 2166 <https://github.com/plone/Products.CMFPlone/issues/2166>`_.
+  [maurits]
+
 - Less variables: Fix calculation of screen max sizes.
   Max sizes were two pixels too high.
   [thet]
diff --git a/Products/CMFPlone/controlpanel/browser/quickinstaller.py b/Products/CMFPlone/controlpanel/browser/quickinstaller.py
index 49a73f0be..e5b109b97 100644
--- a/Products/CMFPlone/controlpanel/browser/quickinstaller.py
+++ b/Products/CMFPlone/controlpanel/browser/quickinstaller.py
@@ -548,7 +548,7 @@ def marshall_addons(self):
             profile_type = pid_parts[-1]
             if product_id not in addons:
                 # get some basic information on the product
-                installed = self.is_profile_installed(pid)
+                installed = self.is_product_installed(product_id)
                 upgrade_info = {}
                 if installed:
                     upgrade_info = self.upgrade_info(product_id)


