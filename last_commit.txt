Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-05-09T12:35:44+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/e13d15c78c2d074608b250a1e32bf7c118e283cd

Move the generation of two test scripts out of buildout.

The buildout parts theoretically could automatically replace something in the scripts, but this feature was not used.
So in practice it simply renamed the files and copied them to the bin directory.
Instead, I now rename them in the repository, and call them directly in GHA.
Simplifies things.

Case in point: the 3.7-6.0 tests currently fail because `bin/test-no-uncommitted-doc-changes` is not found:
https://github.com/plone/plone.restapi/pull/1414#issuecomment-1120897719

Files changed:
A test-no-sphinx-warnings
A test-no-uncommitted-doc-changes
M .github/workflows/tests.yml
M base.cfg
D test-no-sphinx-warnings.in
D test-no-uncommitted-doc-changes.in

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex 9fdf80b32..62516686e 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -65,11 +65,11 @@ jobs:\n \n       # test no uncommited changes\n       - name: test no uncommited changes\n-        run: bin/test-no-uncommitted-doc-changes\n+        run: ./test-no-uncommitted-doc-changes\n         env:\n           PYTHON_VERSION: ${{ matrix.python-version }}\n           PLONE_VERSION: ${{ matrix.plone-version }}\n \n       # test sphinx warnings\n #      - name: sphinx\n-#        run: if [ "${{ matrix.plone-version }}" == "5.2" ] && [ ${{ matrix.python-version }} == \'3.7\' ]; then bin/test-no-sphinx-warnings; fi\n+#        run: if [ "${{ matrix.plone-version }}" == "5.2" ] && [ ${{ matrix.python-version }} == \'3.7\' ]; then ./test-no-sphinx-warnings; fi\ndiff --git a/base.cfg b/base.cfg\nindex 8f22ca372..33f786f8e 100644\n--- a/base.cfg\n+++ b/base.cfg\n@@ -5,8 +5,6 @@ parts =\n     instance\n     test\n     test-coverage\n-    test-no-uncommitted-doc-changes\n-    test-no-sphinx-warnings\n     code-analysis\n     dependencychecker\n     dependencies\n@@ -87,18 +85,6 @@ input = inline:\n output = ${buildout:directory}/bin/test-coverage\n mode = 755\n \n-[test-no-uncommitted-doc-changes]\n-recipe = collective.recipe.template\n-input = test-no-uncommitted-doc-changes.in\n-output = bin/test-no-uncommitted-doc-changes\n-mode = 755\n-\n-[test-no-sphinx-warnings]\n-recipe = collective.recipe.template\n-input = test-no-sphinx-warnings.in\n-output = bin/test-no-sphinx-warnings\n-mode = 755\n-\n [code-analysis]\n recipe = plone.recipe.codeanalysis\n directory = ${buildout:directory}/src\ndiff --git a/test-no-sphinx-warnings.in b/test-no-sphinx-warnings\nsimilarity index 100%\nrename from test-no-sphinx-warnings.in\nrename to test-no-sphinx-warnings\ndiff --git a/test-no-uncommitted-doc-changes.in b/test-no-uncommitted-doc-changes\nsimilarity index 100%\nrename from test-no-uncommitted-doc-changes.in\nrename to test-no-uncommitted-doc-changes\n'

Repository: plone.restapi


Branch: refs/heads/master
Date: 2022-05-09T15:03:17+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.restapi/commit/4f4101c229ee238b1b957e902fbacdced1439301

Merge pull request #1420 from plone/maurits-test-no-script-generation-in-buildout

Move the generation of two test scripts out of buildout.

Files changed:
A test-no-sphinx-warnings
A test-no-uncommitted-doc-changes
M .github/workflows/tests.yml
M base.cfg
D test-no-sphinx-warnings.in
D test-no-uncommitted-doc-changes.in

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex 9fdf80b32..62516686e 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -65,11 +65,11 @@ jobs:\n \n       # test no uncommited changes\n       - name: test no uncommited changes\n-        run: bin/test-no-uncommitted-doc-changes\n+        run: ./test-no-uncommitted-doc-changes\n         env:\n           PYTHON_VERSION: ${{ matrix.python-version }}\n           PLONE_VERSION: ${{ matrix.plone-version }}\n \n       # test sphinx warnings\n #      - name: sphinx\n-#        run: if [ "${{ matrix.plone-version }}" == "5.2" ] && [ ${{ matrix.python-version }} == \'3.7\' ]; then bin/test-no-sphinx-warnings; fi\n+#        run: if [ "${{ matrix.plone-version }}" == "5.2" ] && [ ${{ matrix.python-version }} == \'3.7\' ]; then ./test-no-sphinx-warnings; fi\ndiff --git a/base.cfg b/base.cfg\nindex 8f22ca372..33f786f8e 100644\n--- a/base.cfg\n+++ b/base.cfg\n@@ -5,8 +5,6 @@ parts =\n     instance\n     test\n     test-coverage\n-    test-no-uncommitted-doc-changes\n-    test-no-sphinx-warnings\n     code-analysis\n     dependencychecker\n     dependencies\n@@ -87,18 +85,6 @@ input = inline:\n output = ${buildout:directory}/bin/test-coverage\n mode = 755\n \n-[test-no-uncommitted-doc-changes]\n-recipe = collective.recipe.template\n-input = test-no-uncommitted-doc-changes.in\n-output = bin/test-no-uncommitted-doc-changes\n-mode = 755\n-\n-[test-no-sphinx-warnings]\n-recipe = collective.recipe.template\n-input = test-no-sphinx-warnings.in\n-output = bin/test-no-sphinx-warnings\n-mode = 755\n-\n [code-analysis]\n recipe = plone.recipe.codeanalysis\n directory = ${buildout:directory}/src\ndiff --git a/test-no-sphinx-warnings.in b/test-no-sphinx-warnings\nsimilarity index 100%\nrename from test-no-sphinx-warnings.in\nrename to test-no-sphinx-warnings\ndiff --git a/test-no-uncommitted-doc-changes.in b/test-no-uncommitted-doc-changes\nsimilarity index 100%\nrename from test-no-uncommitted-doc-changes.in\nrename to test-no-uncommitted-doc-changes\n'

