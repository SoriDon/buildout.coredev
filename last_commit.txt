Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2017-10-22T15:16:09+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/428dd60a45c69cb8d8be54e2aea48efe7046b0cd

Add zcml-condition plone-52 for conditional configuration

Files changed:
M CHANGES.rst
M Products/CMFPlone/meta.zcml
M Products/CMFPlone/tests/testMigrationTool.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 95891ac0f..a51a0af10 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -34,3 +34,6 @@ Bug Fixes:
 
 - Display real version of Zope, not of the empty meta-package Zope2.
   [pbauer]
+
+- Add zcml-condition plone-52 for conditional configuration.
+  [pbauer]
diff --git a/Products/CMFPlone/meta.zcml b/Products/CMFPlone/meta.zcml
index a317b7399..fc3411c1b 100644
--- a/Products/CMFPlone/meta.zcml
+++ b/Products/CMFPlone/meta.zcml
@@ -17,6 +17,7 @@
     <meta:provides feature="plone-44" />
     <meta:provides feature="plone-5" />
     <meta:provides feature="plone-51" />
+    <meta:provides feature="plone-52" />
 
     <include package="Products.CMFCore" file="meta.zcml" />
     <include package="Products.GenericSetup" file="meta.zcml" />
diff --git a/Products/CMFPlone/tests/testMigrationTool.py b/Products/CMFPlone/tests/testMigrationTool.py
index 22694674d..d128a492d 100644
--- a/Products/CMFPlone/tests/testMigrationTool.py
+++ b/Products/CMFPlone/tests/testMigrationTool.py
@@ -44,11 +44,11 @@ def testDoUpgrades(self):
         request.form['profile_id'] = _DEFAULT_PROFILE
 
         steps = []
-        for u in upgrades:
-            if isinstance(u, list):
-                steps.extend([s['id'] for s in u])
+        for upgrade in upgrades:
+            if isinstance(upgrade, list):
+                steps.extend([s['id'] for s in upgrade])
             else:
-                steps.append(u['id'])
+                steps.append(upgrade['id'])
 
         request.form['upgrades'] = steps
         self.setup.manage_doUpgrades(request=request)


