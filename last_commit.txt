Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-04-22T11:09:47-05:00
Author: Jens Vagelpohl (dataflake) <jens@mineralware.com>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/5ec5732eda79c3911c413e3b6d72db797a080ebd

Fix ZServer instance creation with better WSGI flag checking

Files changed:
A news/95.bugfix
M src/plone/recipe/zope2instance/ctl.py

b"diff --git a/news/95.bugfix b/news/95.bugfix\nnew file mode 100644\nindex 0000000..c1604b5\n--- /dev/null\n+++ b/news/95.bugfix\n@@ -0,0 +1 @@\n+Fix ZServer instance creation with better WSGI flag checking\ndiff --git a/src/plone/recipe/zope2instance/ctl.py b/src/plone/recipe/zope2instance/ctl.py\nindex be22154..dc39944 100644\n--- a/src/plone/recipe/zope2instance/ctl.py\n+++ b/src/plone/recipe/zope2instance/ctl.py\n@@ -938,7 +938,12 @@ def main(args=None):\n     options.interpreter = os.path.join(options.directory, 'bin', 'interpreter')\n     if sys.platform == 'win32':\n         options.interpreter += '-script.py'\n-    if six.PY2 and (options.wsgi or '').lower() in ('off', 'false', '0'):\n+\n+    if options.wsgi is not None and \\\n+       options.wsgi.lower() in ('off', 'false', '0'):\n+        options.wsgi = None\n+\n+    if six.PY2 and not options.wsgi:\n         # only use zserver in Python 2 and if wsgi is disabled\n         from ZServer.Zope2.Startup import run\n         script = os.path.join(os.path.dirname(run.__file__), 'run.py')\n"

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-04-23T07:30:17+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/ea6fd404bdaca65e9ada2e31318b7f45fd3723fc

Merge pull request #96 from plone/issue_95

Fix ZServer instance creation with better WSGI flag checking

Files changed:
A news/95.bugfix
M src/plone/recipe/zope2instance/ctl.py

b"diff --git a/news/95.bugfix b/news/95.bugfix\nnew file mode 100644\nindex 0000000..c1604b5\n--- /dev/null\n+++ b/news/95.bugfix\n@@ -0,0 +1 @@\n+Fix ZServer instance creation with better WSGI flag checking\ndiff --git a/src/plone/recipe/zope2instance/ctl.py b/src/plone/recipe/zope2instance/ctl.py\nindex be22154..dc39944 100644\n--- a/src/plone/recipe/zope2instance/ctl.py\n+++ b/src/plone/recipe/zope2instance/ctl.py\n@@ -938,7 +938,12 @@ def main(args=None):\n     options.interpreter = os.path.join(options.directory, 'bin', 'interpreter')\n     if sys.platform == 'win32':\n         options.interpreter += '-script.py'\n-    if six.PY2 and (options.wsgi or '').lower() in ('off', 'false', '0'):\n+\n+    if options.wsgi is not None and \\\n+       options.wsgi.lower() in ('off', 'false', '0'):\n+        options.wsgi = None\n+\n+    if six.PY2 and not options.wsgi:\n         # only use zserver in Python 2 and if wsgi is disabled\n         from ZServer.Zope2.Startup import run\n         script = os.path.join(os.path.dirname(run.__file__), 'run.py')\n"

