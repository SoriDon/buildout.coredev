Repository: plone.app.layout


Branch: refs/heads/master
Date: 2022-05-02T20:33:17+03:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.app.layout/commit/2f11ad8d4994507d77fa098204623db4db6daa55

Allow overiding navigation_depth via request param in GlobalSectionsViewlet

Files changed:
M plone/app/layout/viewlets/common.py

b'diff --git a/plone/app/layout/viewlets/common.py b/plone/app/layout/viewlets/common.py\nindex 79fb687e..280e24c2 100644\n--- a/plone/app/layout/viewlets/common.py\n+++ b/plone/app/layout/viewlets/common.py\n@@ -304,11 +304,12 @@ def navtree(self):\n         settings = self.settings\n         if not settings.generate_tabs:\n             return ret\n+        navigation_depth = int(self.request.get("navigation_depth") or settings.navigation_depth)\n \n         query = {\n             "path": {\n                 "query": self.navtree_path,\n-                "depth": settings.navigation_depth,\n+                "depth": navigation_depth,\n             },\n             "portal_type": {"query": settings.displayed_types},\n             "Language": self.current_language,\n'

