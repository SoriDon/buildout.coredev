Repository: plone.schemaeditor


Branch: refs/heads/master
Date: 2022-08-04T22:49:00+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.schemaeditor/commit/a50ac2c14e2d2b9bea2fd2adaf418347d48464e8

Fix incomplete validation error for invalid field name.

According to the regular expression, a field must start with a lowercase character.
I am not sure this is really needed.  But now the validation error matches the expression.
I got a question from a customer about this.

Files changed:
A news/93.bugfix
M plone/schemaeditor/interfaces.py
M plone/schemaeditor/tests/editing.rst

b"diff --git a/news/93.bugfix b/news/93.bugfix\nnew file mode 100644\nindex 0000000..8a49c25\n--- /dev/null\n+++ b/news/93.bugfix\n@@ -0,0 +1,3 @@\n+Fix incomplete validation error for invalid field name.\n+According to the regular expression, a field must start with a lowercase character.\n+[maurits]\ndiff --git a/plone/schemaeditor/interfaces.py b/plone/schemaeditor/interfaces.py\nindex 569674f..8b09855 100644\n--- a/plone/schemaeditor/interfaces.py\n+++ b/plone/schemaeditor/interfaces.py\n@@ -146,8 +146,8 @@ class IFieldEditFormSchema(Interface):\n def isValidFieldName(value):\n     if not ID_RE.match(value):\n         raise Invalid(\n-            _(u'Please use only letters, numbers and the following '\n-              u'characters: _.')\n+            _(u'Please start with a lowercase letter and after this use only letters, '\n+              u'numbers and the following characters: _.')\n         )\n     if value in RESERVED_NAMES:\n         raise Invalid(\ndiff --git a/plone/schemaeditor/tests/editing.rst b/plone/schemaeditor/tests/editing.rst\nindex 94ed777..19352f3 100644\n--- a/plone/schemaeditor/tests/editing.rst\n+++ b/plone/schemaeditor/tests/editing.rst\n@@ -327,7 +327,7 @@ Let's add a 'extra-info' fieldset to the IDummySchema schema::\n     >>> browser.getControl('Short Name').value = 'extra-info'\n     >>> browser.getControl('Add').click()\n     >>> browser.contents\n-    '<...Please use only letters, numbers and the following characters...'\n+    '<...Please start with a lowercase letter and after this use only letters, numbers and the following characters...'\n     >>> browser.getControl('Short Name').value = 'extra_info'\n     >>> browser.getControl('Add').click()\n     [event: ContainerModifiedEvent on InterfaceClass]\n"

Repository: plone.schemaeditor


Branch: refs/heads/master
Date: 2022-08-05T14:49:16+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.schemaeditor/commit/da4b6f1572afc51e710b8e342ff7f72331add86f

Merge pull request #93 from plone/maurits-invalid-fieldname-validation-error

Fix incomplete validation error for invalid field name.

Files changed:
A news/93.bugfix
M plone/schemaeditor/interfaces.py
M plone/schemaeditor/tests/editing.rst

b"diff --git a/news/93.bugfix b/news/93.bugfix\nnew file mode 100644\nindex 0000000..8a49c25\n--- /dev/null\n+++ b/news/93.bugfix\n@@ -0,0 +1,3 @@\n+Fix incomplete validation error for invalid field name.\n+According to the regular expression, a field must start with a lowercase character.\n+[maurits]\ndiff --git a/plone/schemaeditor/interfaces.py b/plone/schemaeditor/interfaces.py\nindex 569674f..8b09855 100644\n--- a/plone/schemaeditor/interfaces.py\n+++ b/plone/schemaeditor/interfaces.py\n@@ -146,8 +146,8 @@ class IFieldEditFormSchema(Interface):\n def isValidFieldName(value):\n     if not ID_RE.match(value):\n         raise Invalid(\n-            _(u'Please use only letters, numbers and the following '\n-              u'characters: _.')\n+            _(u'Please start with a lowercase letter and after this use only letters, '\n+              u'numbers and the following characters: _.')\n         )\n     if value in RESERVED_NAMES:\n         raise Invalid(\ndiff --git a/plone/schemaeditor/tests/editing.rst b/plone/schemaeditor/tests/editing.rst\nindex 94ed777..19352f3 100644\n--- a/plone/schemaeditor/tests/editing.rst\n+++ b/plone/schemaeditor/tests/editing.rst\n@@ -327,7 +327,7 @@ Let's add a 'extra-info' fieldset to the IDummySchema schema::\n     >>> browser.getControl('Short Name').value = 'extra-info'\n     >>> browser.getControl('Add').click()\n     >>> browser.contents\n-    '<...Please use only letters, numbers and the following characters...'\n+    '<...Please start with a lowercase letter and after this use only letters, numbers and the following characters...'\n     >>> browser.getControl('Short Name').value = 'extra_info'\n     >>> browser.getControl('Add').click()\n     [event: ContainerModifiedEvent on InterfaceClass]\n"

