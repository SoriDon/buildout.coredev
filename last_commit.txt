Repository: Products.CMFPlacefulWorkflow


Branch: refs/heads/master
Date: 2018-09-24T00:31:51+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.CMFPlacefulWorkflow/commit/072bd4bb76984832d6fa6c90e998577fcc09798b

Fix almost all tests in exportimport.txt in Python3

Was not able to fix this one:
```
&gt;&gt;&gt; snapshotResults = ps.createSnapshot('sn1')
```

Files changed:
M Products/CMFPlacefulWorkflow/tests/exportimport.txt

b'diff --git a/Products/CMFPlacefulWorkflow/tests/exportimport.txt b/Products/CMFPlacefulWorkflow/tests/exportimport.txt\nindex 89ab2af..19bffd3 100644\n--- a/Products/CMFPlacefulWorkflow/tests/exportimport.txt\n+++ b/Products/CMFPlacefulWorkflow/tests/exportimport.txt\n@@ -24,10 +24,14 @@ policy::\n \n     >>> ps = getToolByName(portal, \'portal_setup\')\n     >>> specific_context = \'profile-Products.CMFPlacefulWorkflow.tests:exportimport\'\n-    >>> ps.runImportStepFromProfile(specific_context, \'portal_placeful_workflow\')\n-    {\'messages\': {\'portal_placeful_workflow\': \'placeful_workflow: Folder\n-    imported.\\nplaceful_workflow: Workflow tool imported.\', u\'workflow\': \'\'},\n-    \'steps\': [u\'workflow\', \'portal_placeful_workflow\']}\n+    >>> ps.runImportStepFromProfile(specific_context, \'portal_placeful_workflow\') == {\n+    ...     \'messages\': {\n+    ...         \'portal_placeful_workflow\': \'placeful_workflow: Folder imported.\\nplaceful_workflow: Workflow tool imported.\',\n+    ...         u\'workflow\': \'\'\n+    ...     },\n+    ...     \'steps\': [u\'workflow\', \'portal_placeful_workflow\']\n+    ... }\n+    True\n \n     >>> ppw.getWorkflowPolicyIds()\n     (\'intranet\', \'old-plone\', \'one-state\', \'simple-publication\', \'baz_policy\')\n@@ -72,13 +76,13 @@ Export the portal_placeful_workflow step::\n The export produces a file for the tool itself::\n \n     >>> import tarfile\n-    >>> from six import StringIO\n+    >>> from io import BytesIO\n     >>> archive = tarfile.open(\n     ...     name=\'export\',\n-    ...     fileobj=StringIO(tarball))\n+    ...     fileobj=BytesIO(tarball))\n \n     >>> print(archive.extractfile(\n-    ...     \'portal_placeful_workflow.xml\').read())\n+    ...     \'portal_placeful_workflow.xml\').read().decode())\n     <?xml version="1.0" encoding="utf-8"?>\n     <object name="portal_placeful_workflow" meta_type="Placeful Workflow Tool">\n      <property name="title"></property>\n@@ -93,7 +97,7 @@ The export produces a file for the tool itself::\n \n The export also produces a file for any policies::\n \n-    >>> print(archive.extractfile(\'portal_placeful_workflow/baz_policy.xml\').read())\n+    >>> print(archive.extractfile(\'portal_placeful_workflow/baz_policy.xml\').read().decode())\n     <?xml version="1.0" encoding="utf-8"?>\n     <object name="baz_policy" meta_type="WorkflowPolicy">\n      <property name="title">Baz Policy</property>\n'

Repository: Products.CMFPlacefulWorkflow


Branch: refs/heads/master
Date: 2018-09-25T14:13:12+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlacefulWorkflow/commit/8c6fc6a6a369dce2ba0e7f55f7c806f72d137f44

Merge pull request #24 from plone/python3

Fix almost all tests in exportimport.txt in Python3

Files changed:
M Products/CMFPlacefulWorkflow/tests/exportimport.txt

b'diff --git a/Products/CMFPlacefulWorkflow/tests/exportimport.txt b/Products/CMFPlacefulWorkflow/tests/exportimport.txt\nindex 89ab2af..19bffd3 100644\n--- a/Products/CMFPlacefulWorkflow/tests/exportimport.txt\n+++ b/Products/CMFPlacefulWorkflow/tests/exportimport.txt\n@@ -24,10 +24,14 @@ policy::\n \n     >>> ps = getToolByName(portal, \'portal_setup\')\n     >>> specific_context = \'profile-Products.CMFPlacefulWorkflow.tests:exportimport\'\n-    >>> ps.runImportStepFromProfile(specific_context, \'portal_placeful_workflow\')\n-    {\'messages\': {\'portal_placeful_workflow\': \'placeful_workflow: Folder\n-    imported.\\nplaceful_workflow: Workflow tool imported.\', u\'workflow\': \'\'},\n-    \'steps\': [u\'workflow\', \'portal_placeful_workflow\']}\n+    >>> ps.runImportStepFromProfile(specific_context, \'portal_placeful_workflow\') == {\n+    ...     \'messages\': {\n+    ...         \'portal_placeful_workflow\': \'placeful_workflow: Folder imported.\\nplaceful_workflow: Workflow tool imported.\',\n+    ...         u\'workflow\': \'\'\n+    ...     },\n+    ...     \'steps\': [u\'workflow\', \'portal_placeful_workflow\']\n+    ... }\n+    True\n \n     >>> ppw.getWorkflowPolicyIds()\n     (\'intranet\', \'old-plone\', \'one-state\', \'simple-publication\', \'baz_policy\')\n@@ -72,13 +76,13 @@ Export the portal_placeful_workflow step::\n The export produces a file for the tool itself::\n \n     >>> import tarfile\n-    >>> from six import StringIO\n+    >>> from io import BytesIO\n     >>> archive = tarfile.open(\n     ...     name=\'export\',\n-    ...     fileobj=StringIO(tarball))\n+    ...     fileobj=BytesIO(tarball))\n \n     >>> print(archive.extractfile(\n-    ...     \'portal_placeful_workflow.xml\').read())\n+    ...     \'portal_placeful_workflow.xml\').read().decode())\n     <?xml version="1.0" encoding="utf-8"?>\n     <object name="portal_placeful_workflow" meta_type="Placeful Workflow Tool">\n      <property name="title"></property>\n@@ -93,7 +97,7 @@ The export produces a file for the tool itself::\n \n The export also produces a file for any policies::\n \n-    >>> print(archive.extractfile(\'portal_placeful_workflow/baz_policy.xml\').read())\n+    >>> print(archive.extractfile(\'portal_placeful_workflow/baz_policy.xml\').read().decode())\n     <?xml version="1.0" encoding="utf-8"?>\n     <object name="baz_policy" meta_type="WorkflowPolicy">\n      <property name="title">Baz Policy</property>\n'

