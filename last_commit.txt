Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-11-24T11:05:25+02:00
Author: Asko Soukka (datakurre) <asko.soukka@iki.fi>
Commit: https://github.com/plone/Products.CMFPlone/commit/22efd424cc7da15b8983af05becccdde944451e6

Add support for TinyMCE content CSS set by theme to point to a remote site

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/tinymce.py

diff --git a/CHANGES.rst b/CHANGES.rst
index d59bb45..be190e0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -142,8 +142,13 @@ Bug fixes:
 - Style display menu headings differently from actions [alecm]
 
 - Avoid dependency on plone.app.imaging. [davisagli]
+
 - Fix TinyMCE table styles [vangheem]
 
+- Fix TinyMCE content CSS support to allow themes to define
+  external content CSS URLs (as with CDN like setup).
+  [datakurre]
+
 - Add utf8 headers to all Python source files. [jensens]
 
 - Add default icon for top-level contentview and contentmenu toolbar entries [alecm]
diff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py
index 8627a1b..5e9e5dc 100644
--- a/Products/CMFPlone/patterns/tinymce.py
+++ b/Products/CMFPlone/patterns/tinymce.py
@@ -42,10 +42,11 @@ def get_content_css(self, style_css=''):
         theme = self.get_theme()
         tinymce_content_css = getattr(theme, 'tinymce_content_css', None)
         if tinymce_content_css is not None:
-            files.extend([
-                self.nav_root_url + _
-                for _ in theme.tinymce_content_css.split(',')
-            ])
+            for path in theme.tinymce_content_css.split(','):
+                if path.startswith('http://') or path.startswith('https://'):
+                    files.append(path)
+                else:
+                    files.append(self.nav_root_url + path)
 
         return ','.join(files)
 


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2016-12-22T01:06:23+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/f993fc23799819078a59c3dfbf5e61c176a59556

Merge pull request #1850 from plone/datakurre-tinymce-content-css

Add support for TinyMCE content CSS set by theme to point to a remote site

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/tinymce.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 6985e7d..e1025a8 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -175,8 +175,13 @@ Bug fixes:
 - Style display menu headings differently from actions [alecm]
 
 - Avoid dependency on plone.app.imaging. [davisagli]
+
 - Fix TinyMCE table styles [vangheem]
 
+- Fix TinyMCE content CSS support to allow themes to define
+  external content CSS URLs (as with CDN like setup).
+  [datakurre]
+
 - Add utf8 headers to all Python source files. [jensens]
 
 - Add default icon for top-level contentview and contentmenu toolbar entries [alecm]
diff --git a/Products/CMFPlone/patterns/tinymce.py b/Products/CMFPlone/patterns/tinymce.py
index 8627a1b..5e9e5dc 100644
--- a/Products/CMFPlone/patterns/tinymce.py
+++ b/Products/CMFPlone/patterns/tinymce.py
@@ -42,10 +42,11 @@ def get_content_css(self, style_css=''):
         theme = self.get_theme()
         tinymce_content_css = getattr(theme, 'tinymce_content_css', None)
         if tinymce_content_css is not None:
-            files.extend([
-                self.nav_root_url + _
-                for _ in theme.tinymce_content_css.split(',')
-            ])
+            for path in theme.tinymce_content_css.split(','):
+                if path.startswith('http://') or path.startswith('https://'):
+                    files.append(path)
+                else:
+                    files.append(self.nav_root_url + path)
 
         return ','.join(files)
 


