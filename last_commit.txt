Repository: mockup


Branch: refs/heads/master
Date: 2016-05-05T00:10:55-05:00
Author: nathan.vangheem () <nathan.vangheem@wildcardcorp.com>
Commit: https://github.com/plone/mockup/commit/1266cabdf3a088a1c439458f262af1dc285984df

Fix issue where using filter when paging would not work in the structure pattern

Files changed:
M CHANGES.rst
M mockup/patterns/structure/js/views/textfilter.js

diff --git a/CHANGES.rst b/CHANGES.rst
index ba162ad..205a17b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -41,6 +41,9 @@ New:
 
 Fixes:
 
+- Fix issue where using filter when paging would not work in the structure pattern
+  [vangheem]
+
 - Fix positioning of popovers in structure
   [vangheem]
 
diff --git a/mockup/patterns/structure/js/views/textfilter.js b/mockup/patterns/structure/js/views/textfilter.js
index 13f1b73..3cae611 100644
--- a/mockup/patterns/structure/js/views/textfilter.js
+++ b/mockup/patterns/structure/js/views/textfilter.js
@@ -64,12 +64,14 @@ define([
         self.timeoutId = setTimeout(function() {
           var criterias = $.parseJSON(self.$queryString.val());
           self.app.additionalCriterias = criterias;
+          self.app.collection.currentPage = 1;
           self.app.collection.pager();
         }, this.keyupDelay);
       });
       self.queryString.$el.on('initialized', function() {
         self.queryString.$sortOn.on('change', function() {
           self.app['sort_on'] = self.queryString.$sortOn.val(); // jshint ignore:line
+          self.app.collection.currentPage = 1;
           self.app.collection.pager();
         });
         self.queryString.$sortOrder.change(function() {
@@ -78,6 +80,7 @@ define([
           } else {
             self.app['sort_order'] = 'ascending'; // jshint ignore:line
           }
+          self.app.collection.currentPage = 1;
           self.app.collection.pager();
         });
       });
@@ -91,6 +94,7 @@ define([
       }
       self.timeoutId = setTimeout(function() {
         self.term = $(event.currentTarget).val();
+        self.app.collection.currentPage = 1;
         self.app.collection.pager();
       }, this.keyupDelay);
     }


Repository: mockup


Branch: refs/heads/master
Date: 2016-05-05T00:23:14-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/28681a6f7be44a9c352b4f4a5260613359f5bd68

Merge pull request #668 from plone/fix-filter-paging-structure

Fix issue where using filter when paging would not work

Files changed:
M CHANGES.rst
M mockup/patterns/structure/js/views/textfilter.js

diff --git a/CHANGES.rst b/CHANGES.rst
index ba162ad..205a17b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -41,6 +41,9 @@ New:
 
 Fixes:
 
+- Fix issue where using filter when paging would not work in the structure pattern
+  [vangheem]
+
 - Fix positioning of popovers in structure
   [vangheem]
 
diff --git a/mockup/patterns/structure/js/views/textfilter.js b/mockup/patterns/structure/js/views/textfilter.js
index 13f1b73..3cae611 100644
--- a/mockup/patterns/structure/js/views/textfilter.js
+++ b/mockup/patterns/structure/js/views/textfilter.js
@@ -64,12 +64,14 @@ define([
         self.timeoutId = setTimeout(function() {
           var criterias = $.parseJSON(self.$queryString.val());
           self.app.additionalCriterias = criterias;
+          self.app.collection.currentPage = 1;
           self.app.collection.pager();
         }, this.keyupDelay);
       });
       self.queryString.$el.on('initialized', function() {
         self.queryString.$sortOn.on('change', function() {
           self.app['sort_on'] = self.queryString.$sortOn.val(); // jshint ignore:line
+          self.app.collection.currentPage = 1;
           self.app.collection.pager();
         });
         self.queryString.$sortOrder.change(function() {
@@ -78,6 +80,7 @@ define([
           } else {
             self.app['sort_order'] = 'ascending'; // jshint ignore:line
           }
+          self.app.collection.currentPage = 1;
           self.app.collection.pager();
         });
       });
@@ -91,6 +94,7 @@ define([
       }
       self.timeoutId = setTimeout(function() {
         self.term = $(event.currentTarget).val();
+        self.app.collection.currentPage = 1;
         self.app.collection.pager();
       }, this.keyupDelay);
     }


