Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2023-04-24T23:05:52+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/ef683ac34672bfb43e2a345075c328128510df13

fix circular dependency on plone.app.event for bbb code

Files changed:
A news/fix-circular-dependency.bugfix
M plone/app/portlets/portlets/calendar.py
M plone/app/portlets/portlets/events.py
M setup.py

b'diff --git a/news/fix-circular-dependency.bugfix b/news/fix-circular-dependency.bugfix\nnew file mode 100644\nindex 00000000..abbb8d1f\n--- /dev/null\n+++ b/news/fix-circular-dependency.bugfix\n@@ -0,0 +1,2 @@\n+Fix circular dependency on `plone.app.event`.\n+[@jensens]\ndiff --git a/plone/app/portlets/portlets/calendar.py b/plone/app/portlets/portlets/calendar.py\nindex b1af0295..700e6ca8 100644\n--- a/plone/app/portlets/portlets/calendar.py\n+++ b/plone/app/portlets/portlets/calendar.py\n@@ -1,2 +1,7 @@\n-# avoid broken persistent object\n-from plone.app.event.portlets.portlet_calendar import Assignment  # noqa F401\n+from zope.deferredimport import deprecated\n+\n+\n+deprecated(\n+    "Import from plone.app.event.portlets.portlet_calendar instead (will be removed in Plone 7)",\n+    Assignment="plone.app.event.portlets.portlet_calendar:Assignment",\n+)\ndiff --git a/plone/app/portlets/portlets/events.py b/plone/app/portlets/portlets/events.py\nindex f249a0f2..c9986594 100644\n--- a/plone/app/portlets/portlets/events.py\n+++ b/plone/app/portlets/portlets/events.py\n@@ -1,2 +1,7 @@\n-# avoid broken persistent object\n-from plone.app.event.portlets.portlet_events import Assignment  # noqa F401\n+from zope.deferredimport import deprecated\n+\n+\n+deprecated(\n+    "Import from plone.app.event.portlets.portlet_events instead (will be removed in Plone 7)",\n+    Assignment="plone.app.event.portlets.portlet_events:Assignment",\n+)\ndiff --git a/setup.py b/setup.py\nindex 08e7f463..05ec730a 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -27,7 +27,7 @@\n     keywords="portlets viewlets plone",\n     author="Plone Foundation",\n     author_email="plone-developers@lists.sourceforge.net",\n-    url="https://pypi.org/project/plone.app.portlets",\n+    url="https://github.com/plone/plone.app.portlets",\n     license="GPL version 2",\n     packages=find_packages(),\n     namespace_packages=["plone", "plone.app"],\n@@ -52,7 +52,6 @@\n         "ExtensionClass",\n         "feedparser",\n         "five.customerize",\n-        "plone.app.event",\n         "plone.app.i18n",\n         "plone.app.layout",\n         "plone.app.uuid",\n'

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2023-04-27T10:32:05+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.portlets/commit/927a127fc2178c19ff08f0c55df526ebeffe6c14

Merge pull request #174 from plone/fix-circular-dependency

fix circular dependency on plone.app.event for bbb code

Files changed:
A news/fix-circular-dependency.bugfix
M plone/app/portlets/portlets/calendar.py
M plone/app/portlets/portlets/events.py
M setup.py

b'diff --git a/news/fix-circular-dependency.bugfix b/news/fix-circular-dependency.bugfix\nnew file mode 100644\nindex 00000000..abbb8d1f\n--- /dev/null\n+++ b/news/fix-circular-dependency.bugfix\n@@ -0,0 +1,2 @@\n+Fix circular dependency on `plone.app.event`.\n+[@jensens]\ndiff --git a/plone/app/portlets/portlets/calendar.py b/plone/app/portlets/portlets/calendar.py\nindex b1af0295..700e6ca8 100644\n--- a/plone/app/portlets/portlets/calendar.py\n+++ b/plone/app/portlets/portlets/calendar.py\n@@ -1,2 +1,7 @@\n-# avoid broken persistent object\n-from plone.app.event.portlets.portlet_calendar import Assignment  # noqa F401\n+from zope.deferredimport import deprecated\n+\n+\n+deprecated(\n+    "Import from plone.app.event.portlets.portlet_calendar instead (will be removed in Plone 7)",\n+    Assignment="plone.app.event.portlets.portlet_calendar:Assignment",\n+)\ndiff --git a/plone/app/portlets/portlets/events.py b/plone/app/portlets/portlets/events.py\nindex f249a0f2..c9986594 100644\n--- a/plone/app/portlets/portlets/events.py\n+++ b/plone/app/portlets/portlets/events.py\n@@ -1,2 +1,7 @@\n-# avoid broken persistent object\n-from plone.app.event.portlets.portlet_events import Assignment  # noqa F401\n+from zope.deferredimport import deprecated\n+\n+\n+deprecated(\n+    "Import from plone.app.event.portlets.portlet_events instead (will be removed in Plone 7)",\n+    Assignment="plone.app.event.portlets.portlet_events:Assignment",\n+)\ndiff --git a/setup.py b/setup.py\nindex 08e7f463..05ec730a 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -27,7 +27,7 @@\n     keywords="portlets viewlets plone",\n     author="Plone Foundation",\n     author_email="plone-developers@lists.sourceforge.net",\n-    url="https://pypi.org/project/plone.app.portlets",\n+    url="https://github.com/plone/plone.app.portlets",\n     license="GPL version 2",\n     packages=find_packages(),\n     namespace_packages=["plone", "plone.app"],\n@@ -52,7 +52,6 @@\n         "ExtensionClass",\n         "feedparser",\n         "five.customerize",\n-        "plone.app.event",\n         "plone.app.i18n",\n         "plone.app.layout",\n         "plone.app.uuid",\n'

