Repository: plone.app.layout


Branch: refs/heads/master
Date: 2021-11-18T14:39:25+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.layout/commit/648faa2701558bc771c1daf5b7413d401857f79f

Remove long deprecated getCion from ILayoutPolicy and its impl.

Files changed:
A news/270.breaking
M plone/app/layout/globals/interfaces.py
M plone/app/layout/globals/layout.py

b'diff --git a/news/270.breaking b/news/270.breaking\nnew file mode 100644\nindex 00000000..93cc8a42\n--- /dev/null\n+++ b/news/270.breaking\n@@ -0,0 +1 @@\n+Remove long deprecated ``getIcon``` from layout-policy. [jensens]\ndiff --git a/plone/app/layout/globals/interfaces.py b/plone/app/layout/globals/interfaces.py\nindex 5cbe5b52..61413a7f 100644\n--- a/plone/app/layout/globals/interfaces.py\n+++ b/plone/app/layout/globals/interfaces.py\n@@ -61,17 +61,6 @@ def have_portlets(manager_name, view=None):\n     def icons_visible():\n         """Returns True if icons should be shown or False otherwise."""\n \n-    def getIcon(item):\n-        """\n-        deprecated for Plone > 5.0 see\n-        https://github.com/plone/Products.CMFPlone/issues/1151\n-        Returns an object which implements the IContentIcon interface and\n-        provides the informations necessary to render an icon. The item\n-        parameter needs to be adaptable to IContentIcon. Icons can be disabled\n-        globally or just for anonymous users with the icon_visibility property\n-        in site_properties.\n-        """\n-\n     def bodyClass(template, view):\n         """Returns the CSS class to be used on the body tag."""\n \ndiff --git a/plone/app/layout/globals/layout.py b/plone/app/layout/globals/layout.py\nindex f523a5cd..f687ceb6 100644\n--- a/plone/app/layout/globals/layout.py\n+++ b/plone/app/layout/globals/layout.py\n@@ -1,8 +1,6 @@\n-# -*- coding: utf-8 -*-\n from plone.app.layout.globals.interfaces import IBodyClassAdapter\n from plone.app.layout.globals.interfaces import ILayoutPolicy\n from plone.app.layout.globals.interfaces import IViewView\n-from plone.app.layout.icons.interfaces import IContentIcon\n from plone.i18n.normalizer.interfaces import IIDNormalizer\n from plone.memoize.view import memoize\n from plone.portlets.interfaces import IPortletManager\n@@ -22,7 +20,6 @@\n from zope.component import getUtility\n from zope.component import queryMultiAdapter\n from zope.component import queryUtility\n-from zope.deprecation import deprecate\n from zope.interface import alsoProvides\n from zope.interface import implementer\n from zope.interface import Interface\n@@ -128,25 +125,6 @@ def thumb_visible(self):\n         else:\n             return False\n \n-    @deprecate(\n-        "deprecated since Plone 4, ContentIcons are rendered as Fonts now see"\n-        "https://docs.plone.org/develop/addons/index.html"\n-        "#upgrading-to-plone-5-1."\n-    )\n-    def getIcon(self, item):\n-        """Returns an object which implements the IContentIcon interface and\n-        provides the informations necessary to render an icon. The item\n-        parameter needs to be adaptable to IContentIcon. Icons can be disabled\n-        globally or just for anonymous users with the icon_visibility property\n-        in site_properties.\n-        """\n-        context = self.context\n-        if not self.icons_visible():\n-            icon = getMultiAdapter((context, self.request, None), IContentIcon)\n-        else:\n-            icon = getMultiAdapter((context, self.request, item), IContentIcon)\n-        return icon\n-\n     def _toolbar_classes(self):\n         """current toolbar controlling classes"""\n         if not self._context_state.is_toolbar_visible():\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2021-11-18T18:01:00+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.layout/commit/4a24b1ababa8b55214aa2e5081f6607242e6c508

Merge pull request #270 from plone/rm-deprecated-geticonn

Remove long deprecated getCion from ILayoutPolicy and its impl.

Files changed:
A news/270.breaking
M plone/app/layout/globals/interfaces.py
M plone/app/layout/globals/layout.py

b'diff --git a/news/270.breaking b/news/270.breaking\nnew file mode 100644\nindex 00000000..93cc8a42\n--- /dev/null\n+++ b/news/270.breaking\n@@ -0,0 +1 @@\n+Remove long deprecated ``getIcon``` from layout-policy. [jensens]\ndiff --git a/plone/app/layout/globals/interfaces.py b/plone/app/layout/globals/interfaces.py\nindex 5cbe5b52..61413a7f 100644\n--- a/plone/app/layout/globals/interfaces.py\n+++ b/plone/app/layout/globals/interfaces.py\n@@ -61,17 +61,6 @@ def have_portlets(manager_name, view=None):\n     def icons_visible():\n         """Returns True if icons should be shown or False otherwise."""\n \n-    def getIcon(item):\n-        """\n-        deprecated for Plone > 5.0 see\n-        https://github.com/plone/Products.CMFPlone/issues/1151\n-        Returns an object which implements the IContentIcon interface and\n-        provides the informations necessary to render an icon. The item\n-        parameter needs to be adaptable to IContentIcon. Icons can be disabled\n-        globally or just for anonymous users with the icon_visibility property\n-        in site_properties.\n-        """\n-\n     def bodyClass(template, view):\n         """Returns the CSS class to be used on the body tag."""\n \ndiff --git a/plone/app/layout/globals/layout.py b/plone/app/layout/globals/layout.py\nindex f523a5cd..f687ceb6 100644\n--- a/plone/app/layout/globals/layout.py\n+++ b/plone/app/layout/globals/layout.py\n@@ -1,8 +1,6 @@\n-# -*- coding: utf-8 -*-\n from plone.app.layout.globals.interfaces import IBodyClassAdapter\n from plone.app.layout.globals.interfaces import ILayoutPolicy\n from plone.app.layout.globals.interfaces import IViewView\n-from plone.app.layout.icons.interfaces import IContentIcon\n from plone.i18n.normalizer.interfaces import IIDNormalizer\n from plone.memoize.view import memoize\n from plone.portlets.interfaces import IPortletManager\n@@ -22,7 +20,6 @@\n from zope.component import getUtility\n from zope.component import queryMultiAdapter\n from zope.component import queryUtility\n-from zope.deprecation import deprecate\n from zope.interface import alsoProvides\n from zope.interface import implementer\n from zope.interface import Interface\n@@ -128,25 +125,6 @@ def thumb_visible(self):\n         else:\n             return False\n \n-    @deprecate(\n-        "deprecated since Plone 4, ContentIcons are rendered as Fonts now see"\n-        "https://docs.plone.org/develop/addons/index.html"\n-        "#upgrading-to-plone-5-1."\n-    )\n-    def getIcon(self, item):\n-        """Returns an object which implements the IContentIcon interface and\n-        provides the informations necessary to render an icon. The item\n-        parameter needs to be adaptable to IContentIcon. Icons can be disabled\n-        globally or just for anonymous users with the icon_visibility property\n-        in site_properties.\n-        """\n-        context = self.context\n-        if not self.icons_visible():\n-            icon = getMultiAdapter((context, self.request, None), IContentIcon)\n-        else:\n-            icon = getMultiAdapter((context, self.request, item), IContentIcon)\n-        return icon\n-\n     def _toolbar_classes(self):\n         """current toolbar controlling classes"""\n         if not self._context_state.is_toolbar_visible():\n'

