Repository: mockup


Branch: refs/heads/master
Date: 2019-02-08T16:08:49+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/db2a594de73d31deb06f6f62fa8d3b04be129b95

Specify Node version (minimal maintained version) and Yarn as engines

Files changed:
M package.json

b'diff --git a/package.json b/package.json\nindex 863a33459..a115e998b 100644\n--- a/package.json\n+++ b/package.json\n@@ -4,6 +4,10 @@\n   "description": "A collection of client side patterns for faster and easier web development",\n   "homepage": "http://plone.github.io/mockup",\n   "license": "BSD-3-Clause",\n+  "engines": {\n+    "node": ">=8.0.0",\n+    "yarn": "^1.13.0"\n+  },\n   "dependencies": {\n     "ace-builds": "https://github.com/ajaxorg/ace-builds.git#v1.2.6",\n     "backbone": "https://github.com/jashkenas/backbone.git#1.1.2",\n'

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-08T16:08:49+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/88fc3f720bda2c9bf1cd7ebe59654b4800bea68f

Update moment.js from 2.10.6 to 2.24.0

Files changed:
M package.json
M yarn.lock

b'diff --git a/package.json b/package.json\nindex a115e998b..76cb4d278 100644\n--- a/package.json\n+++ b/package.json\n@@ -15,9 +15,9 @@\n     "bootstrap": "https://github.com/twbs/bootstrap.git#v3.3.6",\n     "cs-jqtree-contextmenu": "https://github.com/ChadSikorra/jqTreeContextMenu.git#master",\n     "datatables.net": "https://github.com/DataTables/Dist-DataTables.git#1.10.16",\n-    "datatables.net-bs": "https://github.com/DataTables/Dist-DataTables-Bootstrap.git#1.10.16",\n     "datatables.net-autofill": "https://github.com/DataTables/Dist-DataTables-AutoFill.git#2.2.2",\n     "datatables.net-autofill-bs": "https://github.com/DataTables/Dist-DataTables-AutoFill-Bootstrap.git#2.2.2",\n+    "datatables.net-bs": "https://github.com/DataTables/Dist-DataTables-Bootstrap.git#1.10.16",\n     "datatables.net-buttons": "https://github.com/DataTables/Dist-DataTables-Buttons.git#1.4.2",\n     "datatables.net-buttons-bs": "https://github.com/DataTables/Dist-DataTables-Buttons-Bootstrap.git#1.4.2",\n     "datatables.net-colreorder": "https://github.com/DataTables/Dist-DataTables-ColReorder.git#1.4.1",\n@@ -43,8 +43,8 @@\n     "jquery.browser": "https://github.com/gabceb/jquery-browser-plugin.git#v0.1.0",\n     "jquery.cookie": "https://github.com/carhartl/jquery-cookie.git#v1.4.1",\n     "jquery.recurrenceinput.js": "https://github.com/collective/jquery.recurrenceinput.js.git#master",\n-    "logging": "https://github.com/Patternslib/logging.git#v1.0.2",\n-    "moment": "https://github.com/moment/moment.git#2.10.6",\n+    "logging": "https://github.com/Patternslib/logging.git#1.0.2",\n+    "moment": "2.24.0",\n     "patternslib": "https://github.com/Patternslib/Patterns.git#2.1.2",\n     "pickadate": "https://github.com/amsul/pickadate.js.git#3.5.6",\n     "react": "https://github.com/facebook/react.git#v0.10.0",\ndiff --git a/yarn.lock b/yarn.lock\nindex a8c4a5bee..b07166060 100644\n--- a/yarn.lock\n+++ b/yarn.lock\n@@ -2764,9 +2764,9 @@ jqtree@>=0.16:\n   version "1.4.1"\n   resolved "https://github.com/carhartl/jquery-cookie.git#7f88a4e631aba8a8c688fd8999ce6b9bcfd50718"\n \n-"jquery.recurrenceinput.js@https://github.com/collective/jquery.recurrenceinput.js.git#thet-npm":\n+"jquery.recurrenceinput.js@https://github.com/collective/jquery.recurrenceinput.js.git#master":\n   version "1.6.0"\n-  resolved "https://github.com/collective/jquery.recurrenceinput.js.git#84af75b92770dff10767cb2ade40c134ca1e8047"\n+  resolved "https://github.com/collective/jquery.recurrenceinput.js.git#deaec1116575d81698778f87d8c08f02487aadf9"\n   dependencies:\n     jquery ""\n \n@@ -3191,7 +3191,7 @@ log4js@^3.0.0:\n     rfdc "^1.1.2"\n     streamroller "0.7.0"\n \n-"logging@https://github.com/Patternslib/logging.git#v1.0.2":\n+"logging@https://github.com/Patternslib/logging.git#1.0.2":\n   version "1.0.2"\n   resolved "https://github.com/Patternslib/logging.git#a31a550c2083089de2c677c169d7e0b0fb7a7967"\n \n@@ -3400,9 +3400,10 @@ mocha@~3.5.3:\n     mkdirp "0.5.1"\n     supports-color "3.1.2"\n \n-"moment@https://github.com/moment/moment.git#2.10.6":\n-  version "2.10.6"\n-  resolved "https://github.com/moment/moment.git#f3fbef9d9875bbff340b527dbe3f1c447a942f69"\n+moment@2.24.0:\n+  version "2.24.0"\n+  resolved "https://registry.yarnpkg.com/moment/-/moment-2.24.0.tgz#0d055d53f5052aa653c9f6eb68bb5d12bf5c2b5b"\n+  integrity sha512-bV7f+6l2QigeBBZSM/6yTNq4P2fNpSWj/0e7jQcy87A8e7o2nAfP/34/2ky5Vw4B9S446EtIhodAzkFCcR4dQg==\n \n ms@2.0.0:\n   version "2.0.0"\n'

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-08T16:08:49+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/3ac29a493e61304419b55d25f6888201b4906806

Load moment.js locale dynamically, based on current selected language

Files changed:
M mockup/patterns/moment/pattern.js

b"diff --git a/mockup/patterns/moment/pattern.js b/mockup/patterns/moment/pattern.js\nindex ed5d91d31..be9b20a36 100644\n--- a/mockup/patterns/moment/pattern.js\n+++ b/mockup/patterns/moment/pattern.js\n@@ -81,12 +81,15 @@\n  */\n \n \n+var lang = document.querySelector('html').lang;\n+\n define([\n   'jquery',\n   'pat-base',\n   'moment',\n+  'moment-url/' + lang,\n   'mockup-i18n'\n-], function($, Base, moment, i18n) {\n+], function($, Base, moment, locale, i18n) {\n \n   var Moment = Base.extend({\n     name: 'moment',\n"

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-08T16:08:49+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/0465f891756906e9e073bb11169b006f8b780f2e

Set English as default moment.js locale

Files changed:
M mockup/patterns/moment/pattern.js

b"diff --git a/mockup/patterns/moment/pattern.js b/mockup/patterns/moment/pattern.js\nindex be9b20a36..5ed6f569d 100644\n--- a/mockup/patterns/moment/pattern.js\n+++ b/mockup/patterns/moment/pattern.js\n@@ -81,7 +81,7 @@\n  */\n \n \n-var lang = document.querySelector('html').lang;\n+var lang = document.querySelector('html').lang || 'en';\n \n define([\n   'jquery',\n"

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-08T16:16:22+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/48a4fea1c1ba52c25361162e1a89b0b9b785bb61

Configure require.js to interpret imported paths in 'moment-url'

Files changed:
M mockup/js/config.js

b"diff --git a/mockup/js/config.js b/mockup/js/config.js\nindex 2bf7ca517..b5bf175b6 100644\n--- a/mockup/js/config.js\n+++ b/mockup/js/config.js\n@@ -128,6 +128,7 @@\n       'mockup-ui-url': 'js/ui',\n       'mockup-utils': 'js/utils',\n       'moment': 'node_modules/moment/moment',\n+      'moment-url': 'node_modules/moment/locale',\n       'picker': 'node_modules/pickadate/lib/picker',\n       'picker.date': 'node_modules/pickadate/lib/picker.date',\n       'picker.time': 'node_modules/pickadate/lib/picker.time',\n"

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-12T16:42:49+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/c7994832fb5d736232e6fee10d2aabf1e13961f3

Change strategy so tests pass (also, account for 'en' locale being builtin)

Files changed:
M mockup/patterns/moment/pattern.js

b"diff --git a/mockup/patterns/moment/pattern.js b/mockup/patterns/moment/pattern.js\nindex 5ed6f569d..cfb5080ee 100644\n--- a/mockup/patterns/moment/pattern.js\n+++ b/mockup/patterns/moment/pattern.js\n@@ -80,16 +80,14 @@\n  *\n  */\n \n-\n-var lang = document.querySelector('html').lang || 'en';\n-\n define([\n   'jquery',\n   'pat-base',\n-  'moment',\n-  'moment-url/' + lang,\n-  'mockup-i18n'\n-], function($, Base, moment, locale, i18n) {\n+  'mockup-i18n',\n+  'moment'\n+], function($, Base, i18n, moment) {\n+\n+  lazyLoadMomentLocale();\n \n   var Moment = Base.extend({\n     name: 'moment',\n@@ -149,5 +147,15 @@ define([\n   });\n \n   return Moment;\n-\n });\n+\n+function lazyLoadMomentLocale() {\n+  var lang = document.querySelector('html').lang || 'en';\n+\n+  if (lang === 'en') {\n+    // English locale is built-in, no need to load\n+    return;\n+  }\n+\n+  require(['moment-url/' + lang]);\n+}\n"

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-12T16:42:49+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/04041d631424a825740b6116530bb94845e9afe8

Match minimal engine dependencies to the ones used in CI environment

Files changed:
M package.json

b'diff --git a/package.json b/package.json\nindex 76cb4d278..a4786c341 100644\n--- a/package.json\n+++ b/package.json\n@@ -5,8 +5,8 @@\n   "homepage": "http://plone.github.io/mockup",\n   "license": "BSD-3-Clause",\n   "engines": {\n-    "node": ">=8.0.0",\n-    "yarn": "^1.13.0"\n+    "node": ">=8.12.0",\n+    "yarn": "^1.3.2"\n   },\n   "dependencies": {\n     "ace-builds": "https://github.com/ajaxorg/ace-builds.git#v1.2.6",\n'

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-12T18:09:22+01:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/mockup/commit/93f109bf7e3d0fd8f5acce5e091e2287f7b7c3c4

Add towncrier entry (changelog)

Files changed:
A news/887.feature

b"diff --git a/news/887.feature b/news/887.feature\nnew file mode 100644\nindex 000000000..14eac3875\n--- /dev/null\n+++ b/news/887.feature\n@@ -0,0 +1,2 @@\n+* Lazy load Moment.js locale based on user's current portal language.\n+  [davilima6]\n"

Repository: mockup


Branch: refs/heads/master
Date: 2019-02-12T18:10:23+01:00
Author: agitator (agitator) <agitator@users.noreply.github.com>
Commit: https://github.com/plone/mockup/commit/17e79404d56b2734969f6fc02ef7b4dfa459c475

Merge pull request #887 from plone/momentjsLazyLoadLocales

moment.js: lazy load locales

Files changed:
A news/887.feature
M mockup/js/config.js
M mockup/patterns/moment/pattern.js
M package.json
M yarn.lock

b'diff --git a/mockup/js/config.js b/mockup/js/config.js\nindex 2bf7ca517..b5bf175b6 100644\n--- a/mockup/js/config.js\n+++ b/mockup/js/config.js\n@@ -128,6 +128,7 @@\n       \'mockup-ui-url\': \'js/ui\',\n       \'mockup-utils\': \'js/utils\',\n       \'moment\': \'node_modules/moment/moment\',\n+      \'moment-url\': \'node_modules/moment/locale\',\n       \'picker\': \'node_modules/pickadate/lib/picker\',\n       \'picker.date\': \'node_modules/pickadate/lib/picker.date\',\n       \'picker.time\': \'node_modules/pickadate/lib/picker.time\',\ndiff --git a/mockup/patterns/moment/pattern.js b/mockup/patterns/moment/pattern.js\nindex ed5d91d31..cfb5080ee 100644\n--- a/mockup/patterns/moment/pattern.js\n+++ b/mockup/patterns/moment/pattern.js\n@@ -80,13 +80,14 @@\n  *\n  */\n \n-\n define([\n   \'jquery\',\n   \'pat-base\',\n-  \'moment\',\n-  \'mockup-i18n\'\n-], function($, Base, moment, i18n) {\n+  \'mockup-i18n\',\n+  \'moment\'\n+], function($, Base, i18n, moment) {\n+\n+  lazyLoadMomentLocale();\n \n   var Moment = Base.extend({\n     name: \'moment\',\n@@ -146,5 +147,15 @@ define([\n   });\n \n   return Moment;\n-\n });\n+\n+function lazyLoadMomentLocale() {\n+  var lang = document.querySelector(\'html\').lang || \'en\';\n+\n+  if (lang === \'en\') {\n+    // English locale is built-in, no need to load\n+    return;\n+  }\n+\n+  require([\'moment-url/\' + lang]);\n+}\ndiff --git a/news/887.feature b/news/887.feature\nnew file mode 100644\nindex 000000000..14eac3875\n--- /dev/null\n+++ b/news/887.feature\n@@ -0,0 +1,2 @@\n+* Lazy load Moment.js locale based on user\'s current portal language.\n+  [davilima6]\ndiff --git a/package.json b/package.json\nindex 863a33459..a4786c341 100644\n--- a/package.json\n+++ b/package.json\n@@ -4,6 +4,10 @@\n   "description": "A collection of client side patterns for faster and easier web development",\n   "homepage": "http://plone.github.io/mockup",\n   "license": "BSD-3-Clause",\n+  "engines": {\n+    "node": ">=8.12.0",\n+    "yarn": "^1.3.2"\n+  },\n   "dependencies": {\n     "ace-builds": "https://github.com/ajaxorg/ace-builds.git#v1.2.6",\n     "backbone": "https://github.com/jashkenas/backbone.git#1.1.2",\n@@ -11,9 +15,9 @@\n     "bootstrap": "https://github.com/twbs/bootstrap.git#v3.3.6",\n     "cs-jqtree-contextmenu": "https://github.com/ChadSikorra/jqTreeContextMenu.git#master",\n     "datatables.net": "https://github.com/DataTables/Dist-DataTables.git#1.10.16",\n-    "datatables.net-bs": "https://github.com/DataTables/Dist-DataTables-Bootstrap.git#1.10.16",\n     "datatables.net-autofill": "https://github.com/DataTables/Dist-DataTables-AutoFill.git#2.2.2",\n     "datatables.net-autofill-bs": "https://github.com/DataTables/Dist-DataTables-AutoFill-Bootstrap.git#2.2.2",\n+    "datatables.net-bs": "https://github.com/DataTables/Dist-DataTables-Bootstrap.git#1.10.16",\n     "datatables.net-buttons": "https://github.com/DataTables/Dist-DataTables-Buttons.git#1.4.2",\n     "datatables.net-buttons-bs": "https://github.com/DataTables/Dist-DataTables-Buttons-Bootstrap.git#1.4.2",\n     "datatables.net-colreorder": "https://github.com/DataTables/Dist-DataTables-ColReorder.git#1.4.1",\n@@ -39,8 +43,8 @@\n     "jquery.browser": "https://github.com/gabceb/jquery-browser-plugin.git#v0.1.0",\n     "jquery.cookie": "https://github.com/carhartl/jquery-cookie.git#v1.4.1",\n     "jquery.recurrenceinput.js": "https://github.com/collective/jquery.recurrenceinput.js.git#master",\n-    "logging": "https://github.com/Patternslib/logging.git#v1.0.2",\n-    "moment": "https://github.com/moment/moment.git#2.10.6",\n+    "logging": "https://github.com/Patternslib/logging.git#1.0.2",\n+    "moment": "2.24.0",\n     "patternslib": "https://github.com/Patternslib/Patterns.git#2.1.2",\n     "pickadate": "https://github.com/amsul/pickadate.js.git#3.5.6",\n     "react": "https://github.com/facebook/react.git#v0.10.0",\ndiff --git a/yarn.lock b/yarn.lock\nindex a8c4a5bee..b07166060 100644\n--- a/yarn.lock\n+++ b/yarn.lock\n@@ -2764,9 +2764,9 @@ jqtree@>=0.16:\n   version "1.4.1"\n   resolved "https://github.com/carhartl/jquery-cookie.git#7f88a4e631aba8a8c688fd8999ce6b9bcfd50718"\n \n-"jquery.recurrenceinput.js@https://github.com/collective/jquery.recurrenceinput.js.git#thet-npm":\n+"jquery.recurrenceinput.js@https://github.com/collective/jquery.recurrenceinput.js.git#master":\n   version "1.6.0"\n-  resolved "https://github.com/collective/jquery.recurrenceinput.js.git#84af75b92770dff10767cb2ade40c134ca1e8047"\n+  resolved "https://github.com/collective/jquery.recurrenceinput.js.git#deaec1116575d81698778f87d8c08f02487aadf9"\n   dependencies:\n     jquery ""\n \n@@ -3191,7 +3191,7 @@ log4js@^3.0.0:\n     rfdc "^1.1.2"\n     streamroller "0.7.0"\n \n-"logging@https://github.com/Patternslib/logging.git#v1.0.2":\n+"logging@https://github.com/Patternslib/logging.git#1.0.2":\n   version "1.0.2"\n   resolved "https://github.com/Patternslib/logging.git#a31a550c2083089de2c677c169d7e0b0fb7a7967"\n \n@@ -3400,9 +3400,10 @@ mocha@~3.5.3:\n     mkdirp "0.5.1"\n     supports-color "3.1.2"\n \n-"moment@https://github.com/moment/moment.git#2.10.6":\n-  version "2.10.6"\n-  resolved "https://github.com/moment/moment.git#f3fbef9d9875bbff340b527dbe3f1c447a942f69"\n+moment@2.24.0:\n+  version "2.24.0"\n+  resolved "https://registry.yarnpkg.com/moment/-/moment-2.24.0.tgz#0d055d53f5052aa653c9f6eb68bb5d12bf5c2b5b"\n+  integrity sha512-bV7f+6l2QigeBBZSM/6yTNq4P2fNpSWj/0e7jQcy87A8e7o2nAfP/34/2ky5Vw4B9S446EtIhodAzkFCcR4dQg==\n \n ms@2.0.0:\n   version "2.0.0"\n'

