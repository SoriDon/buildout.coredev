Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2019-08-29T07:51:37+02:00
Author: Daniel Havlik (dhavlik) <dh@gocept.com>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/8275f5ba00486f49b38a3d837c589a745ed88f0d

repair incomplete commit from last PR (sry) (#125)

Files changed:
M news/122.bugfix
M src/plone/recipe/zope2instance/ctl.py

b'diff --git a/news/122.bugfix b/news/122.bugfix\nindex 3ffd825..07cd201 100644\n--- a/news/122.bugfix\n+++ b/news/122.bugfix\n@@ -1 +1 @@\n-Fixed a deprecation warning when importing "makerequest" from Testing.ZopeTestCase.utils. This also fixes a side effect which can bite you if you rely on ZOPETESTCASE environment variable, only being set to "1" during test runs.\n+Fixed a deprecation warning when importing `makerequest` from Testing.ZopeTestCase.utils. This also fixes a side effect which can bite you if you rely on ZOPETESTCASE environment variable, only being set to `1` during test runs.\ndiff --git a/src/plone/recipe/zope2instance/ctl.py b/src/plone/recipe/zope2instance/ctl.py\nindex a07b8c6..c6fd851 100644\n--- a/src/plone/recipe/zope2instance/ctl.py\n+++ b/src/plone/recipe/zope2instance/ctl.py\n@@ -679,7 +679,7 @@ def get_startup_cmd(self, python, more, pyflags=""):\n         if not self.options.no_request:\n             cmdline += (\n                 \'from Testing.makerequest import makerequest; \'\n-                \'app = Testing.makerequest.makerequest(app); \'\n+                \'app = makerequest(app); \'\n                 # REQUEST.traverse needs this but no reason not to set\n                 # this even if we\'re not traversing to an object\n                 \'app.REQUEST[\\\'PARENTS\\\'] = [app]; \'\n'

