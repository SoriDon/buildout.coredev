Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-05-02T00:32:26+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/d56ad580768f338df5c09a48ca33a62a2ff53903

Move discussion Key to plone.app.discussion

Files changed:
M Products/CMFPlone/__init__.py

b'diff --git a/Products/CMFPlone/__init__.py b/Products/CMFPlone/__init__.py\nindex 592d2e4264..207ba2cdec 100644\n--- a/Products/CMFPlone/__init__.py\n+++ b/Products/CMFPlone/__init__.py\n@@ -17,15 +17,16 @@\n     os.path.join(\'skins\', \'plone_images\', \'logoIcon.png\'),\n     cmfplone_globals)}\n \n-DISCUSSION_ANNOTATION_KEY = \'plone.app.discussion:conversation\'\n-\n zope.deferredimport.initialize()\n zope.deferredimport.deprecated(\n     "Import from plone.base instead (to be removed in Plone 7)",\n     PloneMessageFactory=\'plone.base:PloneMessageFactory\',\n     PloneLocalesMessageFactory=\'plone.base:PloneMessageFactory\',\n )\n-\n+zope.deferredimport.deprecated(\n+    "Import from plone.app.discussion.interfaces instead (to be removed in Plone 7)",\n+    DISCUSSION_ANNOTATION_KEY=\'plone.app.discussion.interfaces:DISCUSSION_ANNOTATION_KEY\',\n+)\n \n def initialize(context):\n \n@@ -70,6 +71,7 @@ def initialize(context):\n     allow_class(ObjectMoved)\n     allow_class(WorkflowException)\n \n+    # bbb - remove in Plone 7\n     from Products.CMFPlone.PloneBatch import Batch\n     allow_class(Batch)\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-05-03T15:23:22+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/7c96cd21ca6edbc549c0744254fa91fb69ca0034

add newsfile

Files changed:
A news/3520.breaking

b'diff --git a/news/3520.breaking b/news/3520.breaking\nnew file mode 100644\nindex 0000000000..4ceaf83e08\n--- /dev/null\n+++ b/news/3520.breaking\n@@ -0,0 +1,2 @@\n+Move discussion Key to plone.app.discussion\n+[jensens]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-05-03T15:23:41+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/a041182991519915e07ea381ce97c6ec1c53b082

Merge branch 'master' into deprecate-discussion-key

Files changed:
A Products/CMFPlone/browser/templates/recently_modified.pt
A Products/CMFPlone/browser/templates/recently_published.pt
A news/3515.bugfix.1
A news/5.bugfix
M Products/CMFPlone/browser/configure.zcml
M Products/CMFPlone/profiles/default/skins.xml
M Products/CMFPlone/tests/robot/robodoc/config-screens.robot
M Products/CMFPlone/tests/robot/robodoc/managing_content.robot
M Products/CMFPlone/tests/robot/test_actionmenu.robot
M Products/CMFPlone/tests/robot/test_controlpanel_actions.robot
M Products/CMFPlone/tests/robot/test_controlpanel_filter.robot
M Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot
M Products/CMFPlone/tests/robot/test_controlpanel_search.robot
M Products/CMFPlone/tests/robot/test_controlpanel_types.robot
M Products/CMFPlone/tests/robot/test_edit.robot
M Products/CMFPlone/tests/robot/test_portlets.robot
D Products/CMFPlone/skins/plone_templates/recently_modified.pt
D Products/CMFPlone/skins/plone_templates/recently_modified.pt.metadata
D Products/CMFPlone/skins/plone_templates/recently_published.pt
D Products/CMFPlone/skins/plone_templates/recently_published.pt.metadata

b'diff --git a/Products/CMFPlone/browser/configure.zcml b/Products/CMFPlone/browser/configure.zcml\nindex e450097538..009ec8f691 100644\n--- a/Products/CMFPlone/browser/configure.zcml\n+++ b/Products/CMFPlone/browser/configure.zcml\n@@ -293,4 +293,18 @@\n       permission="zope.Public"\n       />\n \n+  <browser:page\n+      for="*"\n+      name="recently_modified"\n+      template="templates/recently_modified.pt"\n+      permission="zope2.View"\n+      />\n+\n+  <browser:page\n+      for="*"\n+      name="recently_published"\n+      template="templates/recently_published.pt"\n+      permission="zope2.View"\n+      />\n+\n </configure>\ndiff --git a/Products/CMFPlone/skins/plone_templates/recently_modified.pt b/Products/CMFPlone/browser/templates/recently_modified.pt\nsimilarity index 95%\nrename from Products/CMFPlone/skins/plone_templates/recently_modified.pt\nrename to Products/CMFPlone/browser/templates/recently_modified.pt\nindex 7ee649e256..9393d9cfd7 100644\n--- a/Products/CMFPlone/skins/plone_templates/recently_modified.pt\n+++ b/Products/CMFPlone/browser/templates/recently_modified.pt\n@@ -15,7 +15,6 @@\n      tal:define="path context/@@plone_portal_state/navigation_root_path;\n                  results python:container.portal_catalog(sort_on=\'modified\',sort_order=\'reverse\',path=path);\n                  Batch python:modules[\'Products.CMFPlone\'].Batch;\n-                 DateTime python:modules[\'DateTime\'].DateTime;\n                  b_start python:request.get(\'b_start\',0);\n                  normalizeString nocall:context/@@plone/normalizeString;\n                  toLocalizedTime nocall:context/@@plone/toLocalizedTime;">\n@@ -30,8 +29,7 @@\n     </div>\n \n     <div id="content-core"\n-         tal:define="site_properties context/portal_properties/site_properties;\n-                     isAnon context/@@plone_portal_state/anonymous;\n+         tal:define="isAnon context/@@plone_portal_state/anonymous;\n                      portal context/@@plone_portal_state/portal;\n                      show_about python:not isAnon or context.portal_registry[\'plone.allow_anon_views_about\'];">\n         <form name="searchresults" action="" method="post" tal:condition="results"\ndiff --git a/Products/CMFPlone/skins/plone_templates/recently_published.pt b/Products/CMFPlone/browser/templates/recently_published.pt\nsimilarity index 95%\nrename from Products/CMFPlone/skins/plone_templates/recently_published.pt\nrename to Products/CMFPlone/browser/templates/recently_published.pt\nindex cccd879ec9..07f0eca6c7 100644\n--- a/Products/CMFPlone/skins/plone_templates/recently_published.pt\n+++ b/Products/CMFPlone/browser/templates/recently_published.pt\n@@ -14,7 +14,6 @@\n <metal:main fill-slot="main"\n      tal:define="results python:container.portal_catalog(sort_on=\'modified\',sort_order=\'reverse\',review_state=\'published\');\n                  Batch python:modules[\'Products.CMFPlone\'].Batch;\n-                 DateTime python:modules[\'DateTime\'].DateTime;\n                  b_start python:request.get(\'b_start\',0);\n                  toLocalizedTime nocall:context/@@plone/toLocalizedTime;\n                  normalize nocall:context/@@plone/normalizeString;">\n@@ -29,8 +28,7 @@\n     </div>\n \n     <div id="content-core"\n-         tal:define="site_properties context/portal_properties/site_properties;\n-                     isAnon context/@@plone_portal_state/anonymous;\n+         tal:define="isAnon context/@@plone_portal_state/anonymous;\n                      portal context/@@plone_portal_state/portal;\n                      show_about python:not isAnon or context.portal_registry[\'plone.allow_anon_views_about\'];\n                      image_scale portal/@@image_scale">\ndiff --git a/Products/CMFPlone/profiles/default/skins.xml b/Products/CMFPlone/profiles/default/skins.xml\nindex 0a115c2ebc..4dd376ef0a 100644\n--- a/Products/CMFPlone/profiles/default/skins.xml\n+++ b/Products/CMFPlone/profiles/default/skins.xml\n@@ -7,14 +7,11 @@\n     directory="Products.CMFPlone:skins/plone_images"/>\n  <object name="plone_scripts" meta_type="Filesystem Directory View"\n     directory="Products.CMFPlone:skins/plone_scripts"/>\n- <object name="plone_templates" meta_type="Filesystem Directory View"\n-    directory="Products.CMFPlone:skins/plone_templates"/>\n  <object name="plone_wysiwyg" meta_type="Filesystem Directory View"\n     directory="Products.CMFPlone:skins/plone_wysiwyg"/>\n  <skin-path name="Plone Default">\n   <layer name="custom"/>\n   <layer name="plone_wysiwyg"/>\n-  <layer name="plone_templates"/>\n   <layer name="plone_scripts"/>\n   <layer name="plone_images"/>\n  </skin-path>\ndiff --git a/Products/CMFPlone/skins/plone_templates/recently_modified.pt.metadata b/Products/CMFPlone/skins/plone_templates/recently_modified.pt.metadata\ndeleted file mode 100644\nindex 5d68938f48..0000000000\n--- a/Products/CMFPlone/skins/plone_templates/recently_modified.pt.metadata\n+++ /dev/null\n@@ -1,2 +0,0 @@\n-[default]\n-title=Recently modified\ndiff --git a/Products/CMFPlone/skins/plone_templates/recently_published.pt.metadata b/Products/CMFPlone/skins/plone_templates/recently_published.pt.metadata\ndeleted file mode 100644\nindex 3e086cc76a..0000000000\n--- a/Products/CMFPlone/skins/plone_templates/recently_published.pt.metadata\n+++ /dev/null\n@@ -1,2 +0,0 @@\n-[default]\n-title=Recently published\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/config-screens.robot b/Products/CMFPlone/tests/robot/robodoc/config-screens.robot\nindex 36697f6176..8422f57999 100644\n--- a/Products/CMFPlone/tests/robot/robodoc/config-screens.robot\n+++ b/Products/CMFPlone/tests/robot/robodoc/config-screens.robot\n@@ -47,7 +47,7 @@ Show Content setup screen\n \n     Click element  type_id\n \n-    Select From List  name=type_id  Document\n+    Select From List By Label  name=type_id  Document\n \n     Capture and crop page screenshot\n     ...  ${CURDIR}/_robot/content-document.png\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/managing_content.robot b/Products/CMFPlone/tests/robot/robodoc/managing_content.robot\nindex 370363e6f5..1d5de8ccb7 100644\n--- a/Products/CMFPlone/tests/robot/robodoc/managing_content.robot\n+++ b/Products/CMFPlone/tests/robot/robodoc/managing_content.robot\n@@ -27,7 +27,7 @@ add rule\n     Click element  css=#form-widgets-description\n     Input text  css=#form-widgets-description  this rule is meant for folders where new staff is having a go\n     Click element  css=#formfield-form-widgets-event\n-    Select From List  id=form-widgets-event  Object modified\n+    Select From List By Label  id=form-widgets-event  Object modified\n \n \n     Capture and crop page screenshot\n@@ -195,4 +195,4 @@ Show right portlets\n \n     Capture and crop page screenshot\n     ...  ${CURDIR}/_robot/portlet-footer.png\n-    ...  css=#content\n\\ No newline at end of file\n+    ...  css=#content\ndiff --git a/Products/CMFPlone/tests/robot/test_actionmenu.robot b/Products/CMFPlone/tests/robot/test_actionmenu.robot\nindex 4182e6a59e..cb85f84351 100644\n--- a/Products/CMFPlone/tests/robot/test_actionmenu.robot\n+++ b/Products/CMFPlone/tests/robot/test_actionmenu.robot\n@@ -113,23 +113,6 @@ workflow link is clicked\n     Click Link  xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n     Click Link  xpath=(//li[@id=\'plone-contentmenu-workflow\']/div/ul/li/a)[1]\n     Page Should Contain  Item state changed.\n-    # FIXME: The above \'Click Link\' fails on Internet Explorer, but the\n-    # following keywords \'workflow link is clicked softly\' passes. Until we\n-    # know why, we check if the above worked and if not, we try the other\n-    # approach.\n-    @{value} =  Run Keyword And Ignore Error\n-    ...         Page Should Contain  Item state changed.\n-    Run Keyword If  \'@{value}[0]\' == \'FAIL\'\n-    ...         workflow link is clicked softly\n-\n-workflow link is clicked softly\n-    [Documentation]  This works on Internet Explorer, but not on Firefox...\n-    Mouse Over  xpath=//*[@id=\'plone-contentmenu-workflow\']/a\n-    Click Link  xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n-    Mouse Over  xpath=(//li[@id=\'plone-contentmenu-workflow\']//a)[1]\n-    Mouse Down  xpath=(//li[@id=\'plone-contentmenu-workflow\']//a)[1]\n-    Mouse Up  xpath=(//li[@id=\'plone-contentmenu-workflow\']//a)[1]\n-    Wait until page contains  Item state changed.\n \n Open Menu\n     [Arguments]  ${elementId}\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\nindex afee018bef..3d7bfd015f 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n@@ -105,7 +105,7 @@ I add a new action\n \n I delete an action\n   Click Button    css=section:nth-child(3) li:first-child button[name=delete]\n-  Confirm Action\n+  Handle alert\n \n I hide an action\n   Click Button    css=section:nth-child(3) li:first-child button[name=hide]\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\nindex 4f69ef5ea7..d056bf0a8e 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n@@ -119,7 +119,7 @@ the \'h1\' tag is stripped when a document is saved\n   Click Button  Save\n   Wait until page contains  Changes saved\n   Page should contain  heading\n-  XPath Should Match X Times  //div[@id=\'content-core\']//h1  0  message=h1 should have been stripped out\n+  Page Should Contain Element  //div[@id=\'content-core\']//h1  limit=0  message=h1 should have been stripped out\n \n the \'${tag}\' tag is preserved when a document is saved\n   ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n@@ -128,7 +128,7 @@ the \'${tag}\' tag is preserved when a document is saved\n   Input RichText  <${tag}>lorem ipsum</${tag}>\n   Click Button  Save\n   Wait until page contains  Changes saved\n-  XPath Should Match X Times  //div[@id=\'content-core\']//${tag}  1  message=the ${tag} tag should have been preserved\n+  Page Should Contain Element  //div[@id=\'content-core\']//${tag}  limit=1  message=the ${tag} tag should have been preserved\n \n the \'${attribute}\' attribute is preserved when a document is saved\n   ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n@@ -137,7 +137,7 @@ the \'${attribute}\' attribute is preserved when a document is saved\n   Input RichText  <span ${attribute}="foo">lorem ipsum</span>\n   Click Button  Save\n   Wait until page contains  Changes saved\n-  XPath Should Match X Times  //span[@${attribute}]  1  message=the ${attribute} tag should have been preserved\n+  Page Should Contain Element  //span[@${attribute}]  limit=1  message=the ${attribute} tag should have been preserved\n \n success message should contain information regarding caching\n   Element Should Contain  css=.alert-warning  HTML generation is heavily cached across Plone. You may have to edit existing content or restart your server to see the changes.\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot b/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\nindex bdad652733..7518cd3a03 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\n@@ -112,14 +112,14 @@ I choose to not show \'${workflow_state}\' items\n the document \'${title}\' shows up in the navigation\n   Go to  ${PLONE_URL}\n   Wait until page contains  Powered by Plone\n-  XPath Should Match X Times  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  1  message=The global navigation should have contained the item \'${title}\'\n+  Page Should Contain Element  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  limit=1  message=The global navigation should have contained the item \'${title}\'\n \n the document \'${title}\' does not show up in the navigation\n   Go to  ${PLONE_URL}\n   Wait until page contains  Powered by Plone\n-  XPath Should Match X Times  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  0  message=The global navigation should not have contained the item \'${title}\'\n+  Page Should Contain Element  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  limit=0  message=The global navigation should not have contained the item \'${title}\'\n \n the document \'${title}\' does not show up in the sitemap\n   Go to  ${PLONE_URL}/sitemap\n   Wait until page contains  Powered by Plone\n-  XPath Should Match X Times  //ul[@id=\'portal-sitemap\']/li/a/span[contains(text(), \'${title}\')]  0  message=The sitemap should not have contained the item \'${title}\'\n+  Page Should Contain Element  //ul[@id=\'portal-sitemap\']/li/a/span[contains(text(), \'${title}\')]  limit=0  message=The sitemap should not have contained the item \'${title}\'\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_search.robot b/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\nindex dc0185a2b4..395c160b30 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\n@@ -79,6 +79,6 @@ searching for \'${search_term}\' will not return any results\n   Input Text  xpath=//form[@id=\'searchform\']//input[@name=\'SearchableText\']  ${search_term}\n   Submit Form  name=searchform\n   Wait until page contains  items matching your search terms\n-  XPath Should Match X Times  //span[@id=\'search-results-number\' and contains(.,\'0\')]  1\n+  Page Should Contain Element  //span[@id=\'search-results-number\' and contains(.,\'0\')]  1\n \n \ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_types.robot b/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\nindex 4c211f255f..ad494dd09b 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\n@@ -55,7 +55,7 @@ Globaly enabled comments\n # --- WHEN -------------------------------------------------------------------\n \n I select \'${content_type}\' in types dropdown\n-  Select from list  name=type_id  ${content_type}\n+  Select from list by label  name=type_id  ${content_type}\n   Wait until page contains  Globally addable\n \n Allow discussion\n@@ -63,7 +63,7 @@ Allow discussion\n   Click Button  Save\n \n I select \'${workflow}\' workflow\n-  Select from list  name=new_workflow  ${workflow}\n+  Select from list by label  name=new_workflow  ${workflow}\n   Click Button  Save\n \n I add new Link \'${id}\'\ndiff --git a/Products/CMFPlone/tests/robot/test_edit.robot b/Products/CMFPlone/tests/robot/test_edit.robot\nindex 67ad46425e..9c8935560e 100644\n--- a/Products/CMFPlone/tests/robot/test_edit.robot\n+++ b/Products/CMFPlone/tests/robot/test_edit.robot\n@@ -106,12 +106,12 @@ I save the page\n    Click Button  Save\n \n I select a date using the dropdowns\n-    Select From List  xpath=//select[@id=\'edit_form_effectiveDate_0_year\']  2001\n-    Select From List  xpath=//select[@id=\'edit_form_effectiveDate_0_month\']  January\n-    Select From List  xpath=//select[@id=\'edit_form_effectiveDate_0_day\']  01\n-    Select From List  xpath=//select[@id=\'edit_form_effectiveDate_0_hour\']  01\n-    Select From List  xpath=//select[@id=\'edit_form_effectiveDate_0_minute\']  00\n-    Select From List  xpath=//select[@id=\'edit_form_effectiveDate_0_ampm\']  AM\n+    Select From List By Label  xpath=//select[@id=\'edit_form_effectiveDate_0_year\']  2001\n+    Select From List By Label  xpath=//select[@id=\'edit_form_effectiveDate_0_month\']  January\n+    Select From List By Label  xpath=//select[@id=\'edit_form_effectiveDate_0_day\']  01\n+    Select From List By Label  xpath=//select[@id=\'edit_form_effectiveDate_0_hour\']  01\n+    Select From List By Label  xpath=//select[@id=\'edit_form_effectiveDate_0_minute\']  00\n+    Select From List By Label  xpath=//select[@id=\'edit_form_effectiveDate_0_ampm\']  AM\n \n I click the calendar icon\n \ndiff --git a/Products/CMFPlone/tests/robot/test_portlets.robot b/Products/CMFPlone/tests/robot/test_portlets.robot\nindex abfb6ddc21..6167adc91b 100644\n--- a/Products/CMFPlone/tests/robot/test_portlets.robot\n+++ b/Products/CMFPlone/tests/robot/test_portlets.robot\n@@ -28,10 +28,10 @@ a manage portlets view\n     Wait until page contains  Manage portlets\n \n I add a \'${portletname}\' portlet to the left column\n-    Select from list  xpath=//div[@id="portletmanager-plone-leftcolumn"]//select  ${portletname}\n+    Select from list by label  xpath=//div[@id="portletmanager-plone-leftcolumn"]//select  ${portletname}\n \n I add a \'${portletname}\' portlet to the right column\n-    Select from list  xpath=//div[@id="portletmanager-plone-rightcolumn"]//select  ${portletname}\n+    Select from list by label  xpath=//div[@id="portletmanager-plone-rightcolumn"]//select  ${portletname}\n \n I delete a \'${portlet}\'\' portlet from the left column\n     Click Link  xpath=//div[@id="portal-column-one"]//div[@class="portletHeader" and contains(.,"${portlet}")]//a[@class="delete"]  don\'t wait\ndiff --git a/news/3515.bugfix.1 b/news/3515.bugfix.1\nnew file mode 100644\nindex 0000000000..7288e59239\n--- /dev/null\n+++ b/news/3515.bugfix.1\n@@ -0,0 +1,2 @@\n+Moved ``recently_modified`` and ``recently_published`` skin templates to browser views.\n+[maurits]\ndiff --git a/news/5.bugfix b/news/5.bugfix\nnew file mode 100644\nindex 0000000000..cddac02902\n--- /dev/null\n+++ b/news/5.bugfix\n@@ -0,0 +1,2 @@\n+Make compatible with robotframework 3-5.\n+[maurits]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2022-05-03T17:16:34+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/c856cb1846c22d1948e8643c34361891461b8885

Merge pull request #3520 from plone/deprecate-discussion-key

Move discussion Key to plone.app.discussion

Files changed:
A news/3520.breaking
M Products/CMFPlone/__init__.py

b'diff --git a/Products/CMFPlone/__init__.py b/Products/CMFPlone/__init__.py\nindex 592d2e4264..207ba2cdec 100644\n--- a/Products/CMFPlone/__init__.py\n+++ b/Products/CMFPlone/__init__.py\n@@ -17,15 +17,16 @@\n     os.path.join(\'skins\', \'plone_images\', \'logoIcon.png\'),\n     cmfplone_globals)}\n \n-DISCUSSION_ANNOTATION_KEY = \'plone.app.discussion:conversation\'\n-\n zope.deferredimport.initialize()\n zope.deferredimport.deprecated(\n     "Import from plone.base instead (to be removed in Plone 7)",\n     PloneMessageFactory=\'plone.base:PloneMessageFactory\',\n     PloneLocalesMessageFactory=\'plone.base:PloneMessageFactory\',\n )\n-\n+zope.deferredimport.deprecated(\n+    "Import from plone.app.discussion.interfaces instead (to be removed in Plone 7)",\n+    DISCUSSION_ANNOTATION_KEY=\'plone.app.discussion.interfaces:DISCUSSION_ANNOTATION_KEY\',\n+)\n \n def initialize(context):\n \n@@ -70,6 +71,7 @@ def initialize(context):\n     allow_class(ObjectMoved)\n     allow_class(WorkflowException)\n \n+    # bbb - remove in Plone 7\n     from Products.CMFPlone.PloneBatch import Batch\n     allow_class(Batch)\n \ndiff --git a/news/3520.breaking b/news/3520.breaking\nnew file mode 100644\nindex 0000000000..4ceaf83e08\n--- /dev/null\n+++ b/news/3520.breaking\n@@ -0,0 +1,2 @@\n+Move discussion Key to plone.app.discussion\n+[jensens]\n'

