Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2019-03-21T08:57:08+01:00
Author: Gil Forcada (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/f217a4293233e5df659f6b5137b274ebeb450afa

index/reindex/unindex the object itself

Do not defer to p.a.discussion own tool.

That's needed so that collective.indexing can patch comments,
so in turn can be indexed by Solr.

Files changed:
M plone/app/discussion/subscribers.py

b'diff --git a/plone/app/discussion/subscribers.py b/plone/app/discussion/subscribers.py\nindex c3717e53..0234c972 100644\n--- a/plone/app/discussion/subscribers.py\n+++ b/plone/app/discussion/subscribers.py\n@@ -5,12 +5,10 @@\n def index_object(obj, event):\n     """Index the object when it is added/modified to the conversation.\n     """\n-    catalog = getToolByName(obj, \'portal_catalog\')\n-    return catalog.reindexObject(obj)\n+    obj.indexObject()\n \n \n def unindex_object(obj, event):\n     """Unindex the object when it is removed from the conversation.\n     """\n-    catalog = getToolByName(obj, \'portal_catalog\')\n-    return catalog.unindexObject(obj)\n+    obj.unindexObject()\n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2019-03-21T08:57:24+01:00
Author: Gil Forcada (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/8cb659c82880ec561f2ba4ffca27c9bb13ae6650

Add news entry

Files changed:
A news/77.feature

b'diff --git a/news/77.feature b/news/77.feature\nnew file mode 100644\nindex 00000000..b03dc48f\n--- /dev/null\n+++ b/news/77.feature\n@@ -0,0 +1,3 @@\n+Index/reindex/unindex the comment itself, do not defer to ``ICommentingTool``.\n+This way it can be integrated into collective.indexing and Solr (or any other indexing tool).\n+[gforcada]\n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2019-03-22T17:21:36+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/bc42fb2d9a02af94d34480e26797ed3f64cb18ca

Merge pull request #152 from derFreitag/index-comments-on-solr

Index comments on Solr

Files changed:
A news/77.feature
M plone/app/discussion/subscribers.py

b'diff --git a/news/77.feature b/news/77.feature\nnew file mode 100644\nindex 00000000..b03dc48f\n--- /dev/null\n+++ b/news/77.feature\n@@ -0,0 +1,3 @@\n+Index/reindex/unindex the comment itself, do not defer to ``ICommentingTool``.\n+This way it can be integrated into collective.indexing and Solr (or any other indexing tool).\n+[gforcada]\ndiff --git a/plone/app/discussion/subscribers.py b/plone/app/discussion/subscribers.py\nindex c3717e53..0234c972 100644\n--- a/plone/app/discussion/subscribers.py\n+++ b/plone/app/discussion/subscribers.py\n@@ -5,12 +5,10 @@\n def index_object(obj, event):\n     """Index the object when it is added/modified to the conversation.\n     """\n-    catalog = getToolByName(obj, \'portal_catalog\')\n-    return catalog.reindexObject(obj)\n+    obj.indexObject()\n \n \n def unindex_object(obj, event):\n     """Unindex the object when it is removed from the conversation.\n     """\n-    catalog = getToolByName(obj, \'portal_catalog\')\n-    return catalog.unindexObject(obj)\n+    obj.unindexObject()\n'

